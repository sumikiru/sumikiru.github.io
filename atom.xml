<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Sumikiruã®Blog</title>
  
  <subtitle>å¯„ç¾å¥½äºæœªæ¥ï¼Œæ”¶å«Œå¿ƒäºç°ä»Š</subtitle>
  <link href="https://sumikiru.top/atom.xml" rel="self"/>
  
  <link href="https://sumikiru.top/"/>
  <updated>2024-12-12T05:10:58.029Z</updated>
  <id>https://sumikiru.top/</id>
  
  <author>
    <name>Sumikiru</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è¯­è¨€åŸºç¡€3.æ–‡ä»¶æ“ä½œä¸C++11æ–°ç‰¹æ€§</title>
    <link href="https://sumikiru.top/posts/9da932c7.html"/>
    <id>https://sumikiru.top/posts/9da932c7.html</id>
    <published>2024-12-12T12:06:29.000Z</published>
    <updated>2024-12-12T05:10:58.029Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ–‡ç« å‚è€ƒ: <a href="https://www.zhihu.com/column/c_1479157429707059201">C++å­¦ä¹ ç¬”è®°â€”â€”CODspielen</a></p><h1 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h1><h2 id="æ–‡æœ¬æ“ä½œ"><a href="#æ–‡æœ¬æ“ä½œ" class="headerlink" title="æ–‡æœ¬æ“ä½œ"></a>æ–‡æœ¬æ“ä½œ</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span><span class="comment">//åŒ…å«è¯»å†™æ–‡ä»¶çš„å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ofstreamï¼Œå†™æ–‡ä»¶ï¼›</span></span><br><span class="line"><span class="comment">//ifstreamï¼Œè¯»æ–‡ä»¶ï¼›</span></span><br><span class="line"><span class="comment">//fstreamï¼Œè¯»å†™æ–‡ä»¶ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–‡ä»¶ç±»å‹åˆ†ä¸ºæ–‡æœ¬æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test01</span><span class="params">()</span><span class="comment">//å†™æ–‡ä»¶</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//1, åŒ…å«å¤´æ–‡ä»¶fstreamï¼›</span></span><br><span class="line"><span class="comment">//2, åˆ›å»ºæµå¯¹è±¡ï¼›</span></span><br><span class="line">ofstream ofs;<span class="comment">//å†™æ–‡ä»¶ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3, æŒ‡å®šæ‰“å¼€æ–¹å¼ï¼›</span></span><br><span class="line">ofs.<span class="built_in">open</span>(<span class="string">&quot;text01.txt&quot;</span>, ios::out);<span class="comment">//ios::outæ˜¯å†™æ–‡ä»¶çš„æ‰“å¼€æ–¹å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å¼€æ–¹å¼ï¼š</span></span><br><span class="line"><span class="comment">//ios::inè¯»æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ios::outå†™æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ios::truncå¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œå…ˆåˆ é™¤ï¼Œå†åˆ›å»º</span></span><br><span class="line"><span class="comment">//ios::binaryäºŒè¿›åˆ¶æ–¹å¼</span></span><br><span class="line"><span class="comment">//å¯é…åˆä½¿ç”¨ï¼Œä¸­é—´åŠ |; å¦‚ç”¨äºŒè¿›åˆ¶å†™æ–‡ä»¶ï¼Œios::binary | ios::out</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//4, å¾€æ–‡ä»¶é‡Œå†™å†…å®¹ï¼›</span></span><br><span class="line">ofs &lt;&lt; <span class="string">&quot;å¼ ä¸‰&quot;</span> &lt;&lt; endl;<span class="comment">//å·¦ç§»è¿ç®—ç¬¦&lt;&lt;æ„æ€å°±æ˜¯è¾“å‡ºï¼Œè¿™é‡Œæ˜¯å¾€æ–‡ä»¶é‡Œè¾“å‡ºï¼Œcoutæ˜¯å¾€å±å¹•ä¸Šè¾“å‡ºï¼›</span></span><br><span class="line">ofs &lt;&lt; <span class="string">&quot;ç”·&quot;</span> &lt;&lt; endl;</span><br><span class="line">ofs &lt;&lt; <span class="string">&quot;18å²&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//5,å…³é—­æ–‡ä»¶</span></span><br><span class="line">ofs.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02</span><span class="params">()</span><span class="comment">//è¯»æ–‡ä»¶</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ifstream ifs;<span class="comment">//è¯»æ–‡ä»¶çš„æµå¯¹è±¡</span></span><br><span class="line">ifs.<span class="built_in">open</span>(<span class="string">&quot;text01.txt&quot;</span>,ios::in);<span class="comment">//ios::inæ˜¯è¯»æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">if</span> (!ifs.<span class="built_in">is_open</span>())<span class="comment">//åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æ‰“å¼€æˆåŠŸ</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;æ–‡ä»¶æ‰“å¼€å¤±è´¥&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯»æ•°æ®æœ‰4ç§æ–¹å¼</span></span><br><span class="line"><span class="comment">//ç¬¬1ç§ï¼š</span></span><br><span class="line"><span class="comment">//char buf[1024] = &#123; 0 &#125;;//åˆå§‹åŒ–å­—ç¬¦æ•°ç»„</span></span><br><span class="line"><span class="comment">//while (ifs&gt;&gt;buf)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; buf &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬2ç§ï¼š</span></span><br><span class="line"><span class="comment">/*char buf[1024] = &#123; 0 &#125;;</span></span><br><span class="line"><span class="comment">while (ifs.getline(buf, sizeof(buf)))</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; buf &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬3ç§ï¼š</span></span><br><span class="line">string buf;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">getline</span>(ifs, buf))</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; buf &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬4ç§(ä¸æ¨è)ï¼š</span></span><br><span class="line"><span class="comment">//char c;</span></span><br><span class="line"><span class="comment">//while ((c = ifs.get()) != EOF)//æ¯æ¬¡åªè¯»ä¸€ä¸ªå­—ç¬¦, EOFæ˜¯æ–‡ä»¶å°¾éƒ¨ end of file</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; c;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">ifs.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">test01</span>();</span><br><span class="line"><span class="built_in">test02</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h2 id="äºŒè¿›åˆ¶æ“ä½œ"><a href="#äºŒè¿›åˆ¶æ“ä½œ" class="headerlink" title="äºŒè¿›åˆ¶æ“ä½œ"></a>äºŒè¿›åˆ¶æ“ä½œ</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span><span class="comment">//åŒ…å«è¯»å†™æ–‡ä»¶çš„å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">char</span> m_Name[<span class="number">64</span>];<span class="comment">//å§“å//ç”¨Cè¯­è¨€ä¸­çš„å­—ç¬¦æ•°ç»„ï¼Œä¸è¦ç”¨C++çš„å­—ç¬¦ä¸²stringï¼Œå®¹æ˜“å‡ºé—®é¢˜ï¼</span></span><br><span class="line"><span class="type">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test03</span><span class="params">()</span><span class="comment">//å†™æ–‡ä»¶</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//1,åŒ…å«å¤´æ–‡ä»¶fstreamï¼›</span></span><br><span class="line"><span class="comment">//2,åˆ›å»ºæµå¯¹è±¡ï¼ŒåŒæ—¶æ‰“å¼€æ–‡ä»¶ï¼›</span></span><br><span class="line"><span class="comment">//ofstream ofs;</span></span><br><span class="line"><span class="function">ofstream <span class="title">ofs</span><span class="params">(<span class="string">&quot;person.txt&quot;</span>, ios::out | ios::binary)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3,æ‰“å¼€æ–‡ä»¶ï¼›</span></span><br><span class="line"><span class="comment">//ofs.open(&quot;person.txt&quot;,ios::out | ios::binary);//ç”¨äºŒè¿›åˆ¶å†™æ–‡ä»¶ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//4,å†™æ–‡ä»¶ï¼›</span></span><br><span class="line">Person p = &#123; <span class="string">&quot;æå››&quot;</span>, <span class="number">28</span> &#125;;</span><br><span class="line">ofs.<span class="built_in">write</span>((<span class="type">const</span> <span class="type">char</span>*)&amp;p, <span class="built_in">sizeof</span>(Person));<span class="comment">//person.txtæ–‡ä»¶é‡Œä¼šæœ‰ä¹±ç æˆ–é—æ¼ï¼Œä¸è¿‡èƒ½è¯»å›æ¥å°±è¡Œï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//5,å…³é—­æ–‡ä»¶ï¼›</span></span><br><span class="line">ofs.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04</span><span class="params">()</span><span class="comment">//è¯»æ–‡ä»¶</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ifstream ifs;</span><br><span class="line">ifs.<span class="built_in">open</span>(<span class="string">&quot;person.txt&quot;</span>, ios::in | ios::binary);</span><br><span class="line"><span class="keyword">if</span> (!ifs.<span class="built_in">is_open</span>())<span class="comment">//åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æ‰“å¼€æˆåŠŸ</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;æ–‡ä»¶æ‰“å¼€å¤±è´¥&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person p;</span><br><span class="line">ifs.<span class="built_in">read</span>((<span class="type">char</span>*)&amp;p, <span class="built_in">sizeof</span>(Person));</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å§“å:&quot;</span> &lt;&lt; p.m_Name &lt;&lt; <span class="string">&quot;\t&quot;</span> &lt;&lt; <span class="string">&quot;å¹´é¾„ï¼š&quot;</span> &lt;&lt; p.m_Age &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">ifs.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–°ç‰¹æ€§"><a href="#æ–°ç‰¹æ€§" class="headerlink" title="æ–°ç‰¹æ€§"></a>æ–°ç‰¹æ€§</h1><h2 id="æ˜“ç”¨æ€§çš„æ”¹è¿›"><a href="#æ˜“ç”¨æ€§çš„æ”¹è¿›" class="headerlink" title="æ˜“ç”¨æ€§çš„æ”¹è¿›"></a>æ˜“ç”¨æ€§çš„æ”¹è¿›</h2><h3 id="auto"><a href="#auto" class="headerlink" title="auto"></a>auto</h3><p>ä¸å»ºè®®æ»¥ç”¨ï¼Œæ–¹ä¾¿ç›´æ¥å†™å‡ºç±»å‹çš„å°±ç›´æ¥å†™ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">double</span> <span class="title">func01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1.1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Test01</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> m_a;</span><br><span class="line">string m_b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test01_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">auto</span> b = <span class="number">1</span>;<span class="comment">//è‡ªåŠ¨æ¨å¯¼bä¸ºintç±»å‹ï¼›</span></span><br><span class="line"><span class="keyword">auto</span> c = <span class="built_in">func01</span>();<span class="comment">//è‡ªåŠ¨æ¨å¯¼cä¸ºdoubleç±»å‹ï¼›</span></span><br><span class="line"></span><br><span class="line">Test01 str;</span><br><span class="line"><span class="keyword">auto</span> d = str;<span class="comment">//è‡ªåŠ¨æ¨å¯¼dä¸ºè‡ªå®šä¹‰çš„Test01ç±»å‹ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func02</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (vector&lt;<span class="type">int</span>&gt;::iterator it = v.<span class="built_in">begin</span>(); it != v.<span class="built_in">end</span>(); it++)<span class="comment">//ä¼ ç»Ÿå†™æ³•</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> ii = v.<span class="built_in">begin</span>(); ii != v.<span class="built_in">end</span>(); ii++)<span class="comment">//ç”¨autoè‡ªåŠ¨æ¨å¯¼iiä¸ºvector&lt;int&gt;çš„è¿­ä»£å™¨ç±»å‹</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//C++14ä¸­ä¹Ÿå¯ä½œä¸ºå‡½æ•°è¿”å›ç±»å‹çš„æ¨å¯¼</span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">func14</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//å¦‚æœå‡½æ•°å®ç°ä¸­å«æœ‰å¤šä¸ªreturnè¯­å¥ï¼Œè¿™äº›è¡¨è¾¾å¼å¿…é¡»å¯ä»¥æ¨æ–­ä¸ºç›¸åŒçš„ç±»å‹ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœreturnè¯­å¥è¿”å›åˆå§‹åŒ–åˆ—è¡¨ï¼Œè¿”å›å€¼ç±»å‹æ¨å¯¼ä¹Ÿä¼šå¤±è´¥ï¼›</span></span><br><span class="line"><span class="comment">//return &#123; 1, 2, 3 &#125;; // error</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœå‡½æ•°æ˜¯è™šå‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨è¿”å›å€¼ç±»å‹æ¨å¯¼ï¼›</span></span><br><span class="line"><span class="comment">/*virtual auto func() </span></span><br><span class="line"><span class="comment">&#123; </span></span><br><span class="line"><span class="comment">return 1; </span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿”å›ç±»å‹æ¨å¯¼å¯ä»¥ç”¨åœ¨é€’å½’å‡½æ•°ä¸­ï¼Œä½†æ˜¯é€’å½’è°ƒç”¨å¿…é¡»ä»¥è‡³å°‘ä¸€ä¸ªè¿”å›è¯­å¥ä½œä¸ºå…ˆå¯¼ï¼›</span></span><br><span class="line"><span class="keyword">if</span> (i == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> i;  <span class="comment">// return int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">func14</span>(i - <span class="number">1</span>) + i; <span class="comment">// ok</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//autoä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1ï¼Œå®šä¹‰å˜é‡æ—¶å¿…é¡»åˆå§‹åŒ–ï¼š</span></span><br><span class="line"><span class="comment">auto a;//æ²¡æœ‰åˆå§‹åŒ–aï¼Œæ— æ³•æ¨å¯¼açš„ç±»å‹ï¼›</span></span><br><span class="line"><span class="comment">a = 10;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2, VSç¼–è¯‘å™¨ä¸æ”¯æŒå‡½æ•°å½¢å‚æ˜¯autoå˜é‡ï¼›</span></span><br><span class="line"><span class="comment">void func(auto a)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3ï¼Œautoå˜é‡ä¸èƒ½ä½œä¸ºè‡ªå®šä¹‰ç±»å‹ç»“æ„ä½“æˆ–è€…ç±»çš„æˆå‘˜å˜é‡ï¼›</span></span><br><span class="line"><span class="comment">class A</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">//auto a; //ä¸å¯ä»¥ä½œä¸ºæˆå‘˜å˜é‡ï¼›</span></span><br><span class="line"><span class="comment">//auto b = 0; //å³ä¾¿åˆå§‹åŒ–äº†ï¼Œä¹Ÿä¸å¯ä»¥ï¼›</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4ï¼Œä¸å¯ä»¥å®šä¹‰ä¸€ä¸ªautoæ•°ç»„ï¼›</span></span><br><span class="line"><span class="comment">auto arr[] = &#123;1, 2, 3&#125;;//ä¸å…è®¸ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5ï¼Œæ¨¡æ¿å®ä¾‹åŒ–ç±»å‹ä¸èƒ½æ˜¯autoç±»å‹ï¼›</span></span><br><span class="line"><span class="comment">vector&lt;int&gt; a;</span></span><br><span class="line"><span class="comment">//vector&lt;auto&gt; b;//ä¸å¯ä»¥ï¼›</span></span><br><span class="line"><span class="comment">//vector&lt;auto&gt; c = &#123; 1 &#125;;//å³ä¾¿åˆå§‹åŒ–äº†ï¼Œä¹Ÿä¸å¯ä»¥ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></p><h3 id="decltype"><a href="#decltype" class="headerlink" title="decltype"></a>decltype</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;typeinfo&gt;</span><span class="comment">//typeidç”¨</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">decltypeç±»ä¼¼autoçš„åå‡½æ•°ï¼Œautoå¯ä»¥å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œè€Œdecltypeå¯ä»¥ä»ä¸€ä¸ªå˜é‡æˆ–è¡¨è¾¾å¼ä¸­å¾—åˆ°å…¶ç±»å‹ï¼Œå†å®šä¹‰å…¶ä»–å˜é‡ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="comment">//åŒ¿åæšä¸¾å˜é‡</span></span><br><span class="line">&#123;</span><br><span class="line">OK,</span><br><span class="line">ERROR</span><br><span class="line">&#125; flag;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">decltype</span>(i) j = <span class="number">0</span>;<span class="comment">//decltype(i)å°±æ˜¯ä»iè·å–åˆ°içš„ç±»å‹ä¸ºintï¼Œç„¶åç”¨è¿™ä¸ªç±»å‹å®šä¹‰å˜é‡jï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(j).<span class="built_in">name</span>() &lt;&lt; endl;<span class="comment">//è¾“å‡ºintï¼Œä¹Ÿå°±æ˜¯jçš„ç±»å‹ä¹Ÿæ˜¯intï¼Œæ˜¯ä»iè·å–çš„ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(j).<span class="built_in">hash_code</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> a;</span><br><span class="line"><span class="type">double</span> b;</span><br><span class="line"><span class="keyword">decltype</span>(a + b) c;</span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(c).<span class="built_in">name</span>() &lt;&lt; endl;<span class="comment">//è¾“å‡ºdouble</span></span><br><span class="line"></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; tmp;</span><br><span class="line"><span class="keyword">decltype</span>(tmp.<span class="built_in">begin</span>())k; <span class="comment">//å®šä¹‰kä¸ºè¿­ä»£å™¨ç±»å‹</span></span><br><span class="line"><span class="keyword">for</span> (k = tmp.<span class="built_in">begin</span>(); k != tmp.<span class="built_in">end</span>(); k++)<span class="comment">//ä¹Ÿå¯ä»¥ç›´æ¥ç”¨for(auto k = tmp.begin(); k != tmp.end(); k++)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">decltype</span>(flag) flag2;<span class="comment">//å¯ä»¥ç”¨decltypeè·å–åˆ°ç±»å‹ï¼Œå†å®šä¹‰å…¶ä»–å˜é‡ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(flag2).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(flag2).<span class="built_in">hash_code</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">test02_01</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿½è¸ªå‡½æ•°çš„è¿”å›ç±»å‹"><a href="#è¿½è¸ªå‡½æ•°çš„è¿”å›ç±»å‹" class="headerlink" title="è¿½è¸ªå‡½æ•°çš„è¿”å›ç±»å‹"></a>è¿½è¸ªå‡½æ•°çš„è¿”å›ç±»å‹</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func03</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> <span class="comment">//ä¼ ç»Ÿå†™æ³•</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">func04</span><span class="params">(<span class="type">int</span> a, <span class="type">double</span> b)</span>-&gt;<span class="type">int</span> <span class="comment">//æŒ‡å®šå‡½æ•°è¿”å›å€¼ç±»å‹ï¼Œå‰é¢æ¢æˆautoï¼Œè¿™æ ·æ›´çµæ´»</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">func05</span><span class="params">(<span class="type">int</span> a, <span class="type">double</span> b)</span>-&gt;<span class="title">decltype</span><span class="params">(a + b)</span> <span class="comment">//å€ŸåŠ©decltypeï¼ŒæŒ‡å®šå‡½æ•°è¿”å›å€¼ç±»å‹</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test03_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="type">double</span> b = <span class="number">9.8</span>;</span><br><span class="line"><span class="keyword">auto</span> c = <span class="built_in">func04</span>(a, b);</span><br><span class="line"><span class="keyword">auto</span> d = <span class="built_in">func05</span>(a, b);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;c= &quot;</span> &lt;&lt; c &lt;&lt; <span class="string">&quot; typeid= &quot;</span> &lt;&lt; <span class="built_in">typeid</span>(c).<span class="built_in">name</span>() &lt;&lt; endl; <span class="comment">//19, int</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;d= &quot;</span> &lt;&lt; d &lt;&lt; <span class="string">&quot; typeid= &quot;</span> &lt;&lt; <span class="built_in">typeid</span>(d).<span class="built_in">name</span>() &lt;&lt; endl; <span class="comment">//19.8, double</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é…åˆæ¨¡æ¿ä½¿ç”¨ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T1, <span class="keyword">class</span> T2&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">mul</span><span class="params">(<span class="type">const</span> T1 &amp;t1, <span class="type">const</span> T2 &amp;t2)</span>-&gt;<span class="title">decltype</span><span class="params">(t1 * t2)</span> <span class="comment">//ä¹˜æ³•è¿ç®—</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> t1 * t2; <span class="comment">//t2å’Œt2ç±»å‹æ˜¯ä¸ç¡®å®šçš„ï¼Œæ˜¯æ³›å‹çš„ï¼Œæ‰€ä»¥è¦ç”¨decltypeæ¥æŒ‡å®šç±»å‹ï¼Œç”¨autoè‡ªåŠ¨æ¨å¯¼ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test03_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">auto</span> m = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">auto</span> n = <span class="number">12.6</span>;</span><br><span class="line"><span class="keyword">auto</span> k = <span class="built_in">mul</span>(m, n);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;k= &quot;</span> &lt;&lt; k &lt;&lt; <span class="string">&quot; typeid= &quot;</span> &lt;&lt; <span class="built_in">typeid</span>(k).<span class="built_in">name</span>() &lt;&lt; endl; <span class="comment">//100.8, double</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆå§‹åŒ–åˆ—è¡¨å’Œæˆå‘˜"><a href="#åˆå§‹åŒ–åˆ—è¡¨å’Œæˆå‘˜" class="headerlink" title="åˆå§‹åŒ–åˆ—è¡¨å’Œæˆå‘˜"></a>åˆå§‹åŒ–åˆ—è¡¨å’Œæˆå‘˜</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">int</span> m_a;</span><br><span class="line"><span class="type">int</span> m_b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">/*A(int i, int j) //ä¼ ç»Ÿæœ‰å‚æ„é€ å†™æ³•</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">m_a = i;</span></span><br><span class="line"><span class="comment">m_b = j;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*A() :m_a(1), m_b(2) //åˆå§‹åŒ–åˆ—è¡¨ï¼Œåˆ©ç”¨æœ‰å‚æ„é€ ç›´æ¥èµ‹å€¼ï¼Œä½†ä¸å¯ä¼ å‚</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">A</span>(<span class="type">int</span> i, <span class="type">int</span> j) :<span class="built_in">m_a</span>(i), <span class="built_in">m_b</span>(j) <span class="comment">//åˆå§‹åŒ–åˆ—è¡¨ï¼Œç­‰ä»·äºæœ‰å‚æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">int</span> m_a&#123;<span class="number">1</span>&#125;; <span class="comment">//ç›´æ¥èµ‹å€¼åˆå§‹åŒ–ï¼Œä¸ä¾èµ–æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="type">int</span> m_b = <span class="number">2</span>;  <span class="comment">//ç›´æ¥èµ‹å€¼åˆå§‹åŒ–ï¼Œä¸ä¾èµ–æ„é€ å‡½æ•°</span></span><br><span class="line">string m_name &#123; <span class="string">&quot;Tom&quot;</span> &#125;; <span class="comment">//ç›´æ¥èµ‹å€¼åˆå§‹åŒ–ï¼Œä¸ä¾èµ–æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">A tmp&#123; <span class="number">10</span>, <span class="number">20</span> &#125;;<span class="comment">//å®ä¾‹åŒ–å¯¹è±¡æ—¶ç›´æ¥èµ‹å€¼åˆå§‹åŒ–ï¼Œéœ€è¦å­˜åœ¨æœ‰å‚æ„é€ æˆ–åˆå§‹åŒ–åˆ—è¡¨</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">B obj;</span><br><span class="line">cout &lt;&lt; obj.m_a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; obj.m_b &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; obj.m_name &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; obj.tmp.m_a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; obj.tmp.m_b &lt;&lt; endl;</span><br><span class="line"><span class="comment">//1 2 Tom 10 20</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ—è¡¨åˆå§‹åŒ–ï¼š</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Test04_01</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="type">int</span> b;</span><br><span class="line">string name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Test04_01 t = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="string">&quot;Jerry&quot;</span> &#125;;<span class="comment">//ç”¨&#123;&#125;çš„æ–¹å¼èµ‹å€¼å°±å«åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a1 = <span class="number">2</span>;<span class="comment">//ä¼ ç»Ÿå†™æ³•</span></span><br><span class="line"><span class="type">int</span> a2 = &#123; <span class="number">3</span> &#125;;<span class="comment">//ä¹Ÿå¯ä»¥ç›´æ¥è¿™æ ·å†™ï¼Œä¹Ÿå«åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">int</span> a3&#123; <span class="number">4</span> &#125;;<span class="comment">//ä¹Ÿå¯ä»¥ç›´æ¥è¿™æ ·å†™ï¼Œä¹Ÿå«åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> arr1[] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;;<span class="comment">//ä¼ ç»Ÿå†™æ³•</span></span><br><span class="line"><span class="type">int</span> arr2[]&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;<span class="comment">//åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; arr3&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ğŸ’­é˜²æ­¢ç±»å‹æ”¶çª„ï¼š</span></span><br><span class="line"><span class="comment">//ç±»å‹æ”¶çª„æŒ‡çš„æ˜¯å¯¼è‡´æ•°æ®å†…å®¹å‘ç”Ÿå˜åŒ–æˆ–è€…ç²¾åº¦ä¸¢å¤±çš„éšå¼ç±»å‹è½¬æ¢ã€‚ä½¿ç”¨åˆ—è¡¨åˆå§‹åŒ–å¯ä»¥é˜²æ­¢ç±»å‹æ”¶çª„ï¼›</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> a = <span class="number">1024</span>;</span><br><span class="line"><span class="type">char</span> b = a;<span class="comment">//å¯ç¼–è¯‘é€šè¿‡ï¼Œä½†æ•°æ®ä¼šä¸¢å¤±ï¼Œæ”¶çª„ï¼Œå› ä¸ºæ”¾ä¸ä¸‹</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; b &lt;&lt; endl;//æ˜¾ç¤ºä¸å‡ºå†…å®¹ï¼Œè¦ç”¨Cè¯­è¨€çš„æ‰“å°</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d \n&quot;</span>, b); <span class="comment">//è¾“å‡º0ï¼Œæ•°æ®ä¸¢å¤±äº†</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//char c = &#123; a &#125;;//ç”¨åˆ—è¡¨åˆå§‹åŒ–ï¼Œä¸ä¼šæ”¶çª„ï¼Œä½†æ˜¯ç±»å‹è½¬æ¢é”™è¯¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŸºäºèŒƒå›´çš„forå¾ªç¯"><a href="#åŸºäºèŒƒå›´çš„forå¾ªç¯" class="headerlink" title="åŸºäºèŒƒå›´çš„forå¾ªç¯"></a>åŸºäºèŒƒå›´çš„forå¾ªç¯</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func05_01</span><span class="params">(T &amp;a)</span><span class="comment">// åŸå†™æ³•func05_01(int *a)æ˜¯æŠŠæ•°ç»„açš„å…ƒç´ åœ°å€ä¼ å…¥ï¼Œå½¢å‚ä¸­çš„æ•°ç»„æ˜¯æŒ‡é’ˆå˜é‡ï¼Œä¸æ˜¯æ•°ç»„ï¼Œæ— æ³•ç¡®å®šå…ƒç´ ä¸ªæ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> temp : a)<span class="comment">//åŸºäºèŒƒå›´çš„forå¾ªç¯ï¼Œæ•°ç»„çš„èŒƒå›´éœ€è¦æ˜¯ç¡®å®šçš„ï¼›æ”¹æˆæ¨¡æ¿åå¯ä»¥ä½¿ç”¨ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; temp &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test05_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a[]&#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span> &#125;;</span><br><span class="line"><span class="type">int</span> len = <span class="built_in">sizeof</span>(a) / <span class="built_in">sizeof</span>(a[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//#if 0</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)<span class="comment">//ä¼ ç»Ÿå†™æ³•</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> temp = a[i];</span><br><span class="line">temp *= <span class="number">2</span>;</span><br><span class="line">cout &lt;&lt; temp &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> temp : a) <span class="comment">//ç­‰ä»·äºä¸Šè¿°å†™æ³•</span></span><br><span class="line">&#123;</span><br><span class="line">temp *= <span class="number">2</span>;</span><br><span class="line">cout &lt;&lt; temp &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"><span class="comment">//#endif //æ¡ä»¶ç¼–è¯‘</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)<span class="comment">//ä¼ ç»Ÿå†™æ³•</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> &amp;temp = a[i]; <span class="comment">//å¼•ç”¨ï¼Œå¯ä»¥æ”¹æ•°ç»„å…ƒç´ çš„å€¼</span></span><br><span class="line">temp *= <span class="number">2</span>;</span><br><span class="line">cout &lt;&lt; temp &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> &amp;temp : a) <span class="comment">//å¼•ç”¨</span></span><br><span class="line">&#123;</span><br><span class="line">temp *= <span class="number">2</span>;</span><br><span class="line">cout &lt;&lt; temp &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸºäºèŒƒå›´çš„forå¾ªç¯ï¼Œæ•°ç»„çš„èŒƒå›´éœ€è¦æ˜¯ç¡®å®šçš„</span></span><br><span class="line"><span class="built_in">func05_01</span>(a);<span class="comment">//æŠŠæ•°ç»„açš„å…ƒç´ åœ°å€ä¼ å…¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é™æ€æ–­è¨€"><a href="#é™æ€æ–­è¨€" class="headerlink" title="é™æ€æ–­è¨€"></a>é™æ€æ–­è¨€</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cassert&gt;</span> <span class="comment">//æ–­è¨€å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">C++æä¾›äº†è°ƒè¯•å·¥å…·assertï¼Œæ˜¯ä¸€ä¸ªå®ï¼Œç”¨äºåœ¨è¿è¡Œé˜¶æ®µå¯¹æ–­è¨€è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œæ‰§è¡Œç¨‹åºï¼Œå¦åˆ™è°ƒç”¨abort()ï¼›</span></span><br><span class="line"><span class="comment">C++11æ–°å¢äº†static_assertï¼Œé™æ€æ–­è¨€ï¼Œä¸ç”¨ç­‰åˆ°è¿è¡Œé˜¶æ®µæ£€æŸ¥ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå°±æ£€æŸ¥ï¼Œå¯ä»¥æ›´æ—©æŠ¥å‘Šé”™è¯¯ï¼ŒåŒæ—¶å‡å°‘è¿è¡Œæ—¶çš„å¼€é”€ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test06_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">//assert(flag);</span></span><br><span class="line"><span class="built_in">assert</span>(!flag);<span class="comment">//æ–­è¨€ï¼Œå¦‚æœflag == trueï¼Œå°±ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›å¦åˆ™ä¸­æ–­ï¼Œæç¤ºé”™è¯¯</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;hello world&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test06_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//é™æ€æ–­ä¸»è¯­æ³•ï¼šstatic_assert(æ¡ä»¶(å¸¸é‡è¡¨è¾¾å¼), &quot;æç¤ºçš„å­—ç¬¦ä¸²&quot;); //å› ä¸ºæ˜¯ç¼–è¯‘é˜¶æ®µå°±æ£€æŸ¥ï¼Œæ‰€ä»¥æ¡ä»¶æ˜¯å¸¸é‡ï¼Œä¸èƒ½æ˜¯å˜é‡ï¼›</span></span><br><span class="line"><span class="built_in">static_assert</span>(<span class="built_in">sizeof</span>(<span class="type">void</span>*) == <span class="number">4</span>, <span class="string">&quot;64ä½ç³»ç»Ÿä¸æ”¯æŒ&quot;</span>); <span class="comment">//æŒ‡é’ˆå 4ä½ï¼Œè¯´æ˜æ˜¯32ä½ç³»ç»Ÿ</span></span><br><span class="line"><span class="comment">//static_assert(sizeof(void*) == 8, &quot;32ä½ç³»ç»Ÿä¸æ”¯æŒ&quot;); //æŒ‡é’ˆå 8ä½ï¼Œè¯´æ˜æ˜¯64ä½ç³»ç»Ÿ</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;hello C++ 11&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="noexceptä¿®é¥°ç¬¦"><a href="#noexceptä¿®é¥°ç¬¦" class="headerlink" title="noexceptä¿®é¥°ç¬¦"></a>noexceptä¿®é¥°ç¬¦</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">C++11ä½¿ç”¨noexceptæ›¿ä»£throw()ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func07_01</span><span class="params">()</span><span class="comment">//å¯æŠ›å‡ºå¼‚å¸¸</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func07_02</span><span class="params">()</span> <span class="title">throw</span><span class="params">()</span> <span class="comment">//ä¸å¯æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œä½†C++11å·²ç»ä¸ç”¨throw()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func07_03</span><span class="params">()</span> <span class="keyword">noexcept</span> <span class="comment">//ä¸å¯æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œç›¸å½“äºnoexcept(true)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸš€noexcept å’Œ try/catch:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdexcept&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹1ï¼šnoexceptç”¨æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SafeDivide</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">double</span> <span class="title">divide</span><span class="params">(<span class="type">double</span> numerator, <span class="type">double</span> denominator)</span> <span class="keyword">noexcept</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (denominator == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœåˆ†æ¯ä¸º0ï¼Œä¸æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯è¿”å›0</span></span><br><span class="line">            <span class="comment">// å› ä¸ºå‡½æ•°å£°æ˜ä¸ºnoexceptï¼Œå¦‚æœæœ‰å¼‚å¸¸å°†è°ƒç”¨std::terminate</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> numerator / denominator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹2ï¼štry-catchç”¨æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UnsafeDivide</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">double</span> <span class="title">divide</span><span class="params">(<span class="type">double</span> numerator, <span class="type">double</span> denominator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (denominator == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœåˆ†æ¯ä¸º0ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">throw</span> std::<span class="built_in">invalid_argument</span>(<span class="string">&quot;Denominator cannot be zero.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> numerator / denominator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨noexceptå‡½æ•°</span></span><br><span class="line">    <span class="type">double</span> result1 = SafeDivide::<span class="built_in">divide</span>(<span class="number">10</span>, <span class="number">0</span>);</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Result with SafeDivide: &quot;</span> &lt;&lt; result1 &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨try-catchæ•è·UnsafeDivideå‡½æ•°çš„å¼‚å¸¸</span></span><br><span class="line">    <span class="type">double</span> result2;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        result2 = UnsafeDivide::<span class="built_in">divide</span>(<span class="number">10</span>, <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="built_in">catch</span> (<span class="type">const</span> std::invalid_argument&amp; e) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Caught exception: &quot;</span> &lt;&lt; e.<span class="built_in">what</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="comment">// å¤„ç†å¼‚å¸¸ï¼Œä¾‹å¦‚ç»™result2èµ‹å€¼</span></span><br><span class="line">        result2 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Result with UnsafeDivide: &quot;</span> &lt;&lt; result2 &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="nullptrçš„ä½¿ç”¨"><a href="#nullptrçš„ä½¿ç”¨" class="headerlink" title="nullptrçš„ä½¿ç”¨"></a>nullptrçš„ä½¿ç”¨</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">nullptræ˜¯ä¸ºäº†è§£å†³ä»¥å‰C++ä¸­NULLçš„äºŒä¹‰æ€§(0å’Œç©ºæŒ‡é’ˆ)è€Œå¼•è¿›çš„ä¸€ç§æ–°çš„ç±»å‹ï¼Œå› ä¸ºNULLå®é™…ä¸Šä»£è¡¨çš„æ˜¯0ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func08_01</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; __LINE__ &lt;&lt; endl;<span class="comment">//æ‰“å°è¡Œæ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func08_01</span><span class="params">(<span class="type">int</span> *a)</span><span class="comment">//é‡è½½</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; __LINE__ &lt;&lt; endl;<span class="comment">//æ‰“å°è¡Œæ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test08_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> *p = <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">int</span> *p2 = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> *p3 = <span class="literal">nullptr</span>;<span class="comment">//ç©ºæŒ‡é’ˆï¼Œnullptråªèƒ½ç»™æŒ‡é’ˆèµ‹å€¼ï¼Œä¸èƒ½ç»™intå˜é‡èµ‹å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">func08_01</span>(<span class="number">0</span>);<span class="comment">//ç°åœ¨æ˜¯é»˜è®¤ç”¨C++11ï¼Œæ²¡æœ‰æ­§ä¹‰ï¼Œä¼šè°ƒç”¨å€¼ä¼ é€’é‚£ä¸ªå‡½æ•°ï¼Œä½†æ˜¯ä»¥å‰çš„ç‰ˆæœ¬ä¼šæœ‰æ­§ä¹‰ï¼›</span></span><br><span class="line"><span class="built_in">func08_01</span>(<span class="literal">NULL</span>);<span class="comment">//æŠ¥é”™ï¼šè¿˜æ˜¯è°ƒç”¨å€¼ä¼ é€’é‚£ä¸ªå‡½æ•°ï¼Œäº§ç”Ÿæ­§ä¹‰ï¼›</span></span><br><span class="line"><span class="built_in">func08_01</span>(<span class="literal">nullptr</span>);<span class="comment">//è¿™æ ·å°±ä¼šè°ƒç”¨æŒ‡é’ˆä¼ é€’é‚£ä¸ªå‡½æ•°ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">func08_01</span>(p);</span><br><span class="line"><span class="built_in">func08_01</span>(p2);</span><br><span class="line"><span class="built_in">func08_01</span>(p3);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="literal">NULL</span>;<span class="comment">//è­¦å‘Šï¼šå°†NULLè½¬æ¢ä¸ºéæŒ‡é’ˆçš„intç±»å‹</span></span><br><span class="line"><span class="comment">//int b = nullptr;//ä¸èƒ½ç»™intå˜é‡èµ‹å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (p == p3)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;equal&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸš©å¼ºç±»å‹æšä¸¾"><a href="#ğŸš©å¼ºç±»å‹æšä¸¾" class="headerlink" title="ğŸš©å¼ºç±»å‹æšä¸¾"></a>ğŸš©å¼ºç±»å‹æšä¸¾</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä¼ ç»Ÿæšä¸¾ä¸­ï¼Œå³ä½¿æšä¸¾åä¸åŒï¼Œä½†æ˜¯å¦‚æœå˜é‡ç›¸åŒï¼Œä¹Ÿä¼šåˆ¤å®šä¸ºé‡å®šä¹‰ï¼›</span></span><br><span class="line"><span class="comment">ä¹Ÿä¸èƒ½æŒ‡å®šæˆå‘˜å˜é‡çš„ç±»å‹ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//enum Status</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//OK,</span></span><br><span class="line"><span class="comment">//Error</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//enum Status2</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//OK,</span></span><br><span class="line"><span class="comment">//Error</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å¼ºç±»å‹æšä¸¾ï¼šåœ¨enumååŠ ä¸Šclassæˆ–structä¿®é¥°ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">Status</span></span><br><span class="line">&#123;</span><br><span class="line">OK,</span><br><span class="line">Error</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum struct</span> <span class="title class_">Status2</span></span><br><span class="line">&#123;</span><br><span class="line">OK,</span><br><span class="line">Error</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">Status3</span> : <span class="type">char</span> <span class="comment">//å¼ºç±»å‹æšä¸¾ï¼Œå¯ä»¥æŒ‡å®šæˆå‘˜å˜é‡çš„ç±»å‹ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">OK = <span class="number">3</span>,</span><br><span class="line">Error = <span class="number">4</span> <span class="comment">//å¯ä»¥èµ‹å€¼</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">Status4</span> : <span class="type">long</span> <span class="type">long</span> <span class="comment">//å¼ºç±»å‹æšä¸¾ï¼Œå¯ä»¥æŒ‡å®šæˆå‘˜å˜é‡çš„ç±»å‹ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">OK,</span><br><span class="line">Error</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test09_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//éœ€è¦åŠ æšä¸¾ç±»å‹çš„ä½œç”¨åŸŸï¼›</span></span><br><span class="line"><span class="comment">//Status flag = OK;</span></span><br><span class="line">Status flag = Status::OK;</span><br><span class="line">Status2 flag2 = Status2::Error;</span><br><span class="line">Status3 flag3 = Status3::OK;</span><br><span class="line">Status3 flag4 = Status3::Error;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d %d %d\n&quot;</span>, flag, flag2, flag3, flag4);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆå‘˜å˜é‡ç±»å‹å¯è¢«æŒ‡å®š</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(Status::OK) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(Status2::OK) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(Status3::OK) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(Status4::OK) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼˜ç‚¹ï¼š</p><ol><li><strong>ç±»å‹å®‰å…¨</strong>ï¼šå¼ºç±»å‹æšä¸¾æä¾›äº†æ›´å¼ºçš„ç±»å‹å®‰å…¨ä¿éšœï¼Œç¡®ä¿äº†ä¸åŒæšä¸¾ç±»å‹çš„å€¼ä¸èƒ½éšå¼è½¬æ¢ï¼Œå‡å°‘äº†ç±»å‹æ··æ·†çš„é”™è¯¯ã€‚</li><li><strong>ä½œç”¨åŸŸé™åˆ¶</strong>ï¼šå¼ºç±»å‹æšä¸¾ä¸ä¼šæ±¡æŸ“å¤–å›´ä½œç”¨åŸŸï¼Œæšä¸¾å€¼è¢«é™å®šåœ¨æšä¸¾ç±»çš„ä½œç”¨åŸŸå†…ã€‚</li><li><strong>å¯è¯»æ€§</strong>ï¼šå¼ºç±»å‹æšä¸¾é€šè¿‡æ˜ç¡®çš„åç§°é™å®šæä¾›äº†æ›´å¥½çš„ä»£ç å¯è¯»æ€§ï¼Œé¿å…äº†æšä¸¾å€¼åœ¨åŒä¸€ä½œç”¨åŸŸä¸‹çš„æ½œåœ¨å†²çªã€‚</li><li><strong>å‘½åç©ºé—´æ”¯æŒ</strong>ï¼šå¼ºç±»å‹æšä¸¾å¯ä»¥åŒ…å«åœ¨å‘½åç©ºé—´ä¸­ï¼Œé¿å…æšä¸¾å€¼ä¸å…¨å±€å˜é‡å†²çªã€‚</li><li><strong>ä¸ç±»é›†æˆ</strong>ï¼šå¯å°†å¼ºç±»å‹æšä¸¾ä½œä¸ºç±»æˆå‘˜æˆ–ä¸ç±»å…¶ä»–æˆå‘˜ä¸€èµ·ä½¿ç”¨ï¼Œæé«˜ç±»çš„å°è£…æ€§å’Œæ•°æ®å®Œæ•´æ€§ã€‚</li><li><strong>constexpræ”¯æŒ</strong>ï¼šå¼ºç±»å‹æšä¸¾å¯ä»¥ä¸constexprç»“åˆä½¿ç”¨ï¼Œä½¿å¾—æšä¸¾å€¼å¯ä»¥åœ¨ç¼–è¯‘æ—¶è¿›è¡Œè®¡ç®—ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ul><li><strong>éšå¼è½¬æ¢é™åˆ¶</strong>ï¼šç¼ºå°‘äº†éšå¼è½¬æ¢çš„èƒ½åŠ›ï¼Œè¿™æ˜¯åœ¨éœ€è¦å°†å¼ºç±»å‹æšä¸¾å€¼è½¬æ¢ä¸ºæ•´æ•°ç±»å‹æ—¶çš„ä¸€ä¸ªä¸ä¾¿ã€‚</li></ul><h3 id="å¸¸é‡è¡¨è¾¾å¼-constexpr"><a href="#å¸¸é‡è¡¨è¾¾å¼-constexpr" class="headerlink" title="å¸¸é‡è¡¨è¾¾å¼ constexpr"></a>å¸¸é‡è¡¨è¾¾å¼ constexpr</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å¸¸é‡è¡¨è¾¾å¼å…è®¸ä¸€äº›è®¡ç®—å‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µï¼Œè€Œä¸æ˜¯è¿è¡Œé˜¶æ®µï¼›</span></span><br><span class="line"><span class="comment">å¦‚æœæœ‰äº›äº‹å¯ä»¥åœ¨ç¼–è¯‘æ—¶åšï¼Œå¹¶ä¸”åªéœ€è¦åšä¸€æ¬¡ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦æ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶éƒ½è®¡ç®—ï¼Œå¯èŠ‚çœè¿è¡Œèµ„æºï¼Œæé«˜ç¨‹åºè¿è¡Œæ•ˆç‡ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getNum</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">const</span> <span class="type">int</span> <span class="title">getNum2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">int</span> <span class="title">getNum3</span><span class="params">()</span> <span class="comment">//å¸¸é‡è¡¨è¾¾å¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">Num_e</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//e1 = getNum(),//æšä¸¾æˆå‘˜åˆå§‹åŒ–å¿…é¡»æ˜¯æ•´å‹å¸¸é‡</span></span><br><span class="line"><span class="comment">//e1 = getNum2(),//å°±ç®—ç”¨constä¿®é¥°çš„å‡½æ•°ï¼Œä¹Ÿæ˜¯ä¸å…è®¸çš„</span></span><br><span class="line">e1 = <span class="built_in">getNum3</span>(),<span class="comment">//ç”¨å¸¸é‡è¡¨è¾¾å¼å°±å¯ä»¥ //åœ¨ç¼–è¯‘é˜¶æ®µå°±æ‰§è¡Œï¼Œè¿è¡Œæ—¶å°±ä¸ç”¨æ‰§è¡Œäº†</span></span><br><span class="line">e2</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test10_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> tmp = <span class="built_in">getNum3</span>(); <span class="comment">//å¸¸é‡</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> tmp1 = <span class="built_in">getNum3</span>(); <span class="comment">//ä¹Ÿæ˜¯å¸¸é‡</span></span><br><span class="line">cout &lt;&lt; tmp &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">Num_e1</span></span><br><span class="line">&#123;</span><br><span class="line">e1 = tmp,</span><br><span class="line">e2 = tmp1<span class="comment">//ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œtmpå¿…é¡»æ˜¯constexpræˆ–è€…constä¿®é¥°çš„å˜é‡</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d, %d, %d, %d\n&quot;</span>, Num_e::e1, Num_e::e2, Num_e1::e1, Num_e1::e2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">constexprå‡½æ•°çš„é™åˆ¶ï¼š</span></span><br><span class="line"><span class="comment">1ï¼Œå‡½æ•°ä¸­åªèƒ½æœ‰ä¸€ä¸ªreturnè¯­å¥ï¼Œä½†åœ¨C++14ä¸­å¤§å¹…æ”¾æ¾ï¼›</span></span><br><span class="line"><span class="comment">2ï¼Œå‡½æ•°å¿…é¡»æœ‰è¿”å›å€¼ï¼Œä¸èƒ½æ˜¯voidå‡½æ•°ï¼›</span></span><br><span class="line"><span class="comment">3ï¼Œåœ¨ä½¿ç”¨å‰å¿…é¡»å·²ç»æœ‰å®šä¹‰ï¼›</span></span><br><span class="line"><span class="comment">4ï¼Œreturnè¿”å›è¯­å¥è¡¨è¾¾å¼ä¸­ï¼Œä¸èƒ½ä½¿ç”¨åˆ°éå¸¸é‡è¡¨è¾¾å¼çš„å‡½æ•°ã€å…¨å±€æ•°æ®ï¼Œä¸”å¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ï¼Œæˆ–è€…å°±æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œä½†åœ¨C++14ä¸­å¤§å¹…æ”¾æ¾ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">int</span> <span class="title">func10_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//å…è®¸åŒ…å«typedef, using , é™æ€æ–­è¨€ï¼›</span></span><br><span class="line"><span class="built_in">static_assert</span>(<span class="number">1</span>, <span class="string">&quot;fail&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> a;<span class="comment">//æ–°ç¼–è¯‘å™¨å¯ä»¥</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a_10 = <span class="number">12</span>;<span class="comment">//å…¨å±€å˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">int</span> <span class="title">func10_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a_10;<span class="comment">//æ–°ç¼–è¯‘å™¨å¯ä»¥</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">int</span> <span class="title">func10_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//return  getNum();//è¿™æ ·ä¸è¡Œï¼Œå› ä¸ºgetNum()æ˜¯åœ¨è¿è¡Œæ—¶æ‰è°ƒç”¨ï¼Œè€Œconstexprå‡½æ•°è¦åœ¨ç¼–è¯‘æ—¶å°±è°ƒç”¨ï¼Œæ‰€ä»¥æ— æ³•èµ‹å€¼ï¼›</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">getNum3</span>();<span class="comment">//getNum3()ä¹Ÿæ˜¯åœ¨ç¼–è¯‘æ—¶è¢«è°ƒç”¨ï¼Œè¿™æ ·å¯ä»¥</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test10_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> m_a = <span class="built_in">func10_01</span>();</span><br><span class="line"><span class="type">int</span> m_b = <span class="built_in">func10_02</span>();</span><br><span class="line"><span class="type">int</span> m_c = <span class="built_in">func10_03</span>();</span><br><span class="line">cout &lt;&lt; m_a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; m_b &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; m_c &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»ä¸­å‡½æ•°æˆå‘˜æ˜¯å¸¸é‡è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//constexprä¿®é¥°æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ„é€ å‡½æ•°ä½“å¿…é¡»ä¸ºç©ºï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨çš„æ–¹å¼åˆå§‹åŒ–ï¼›</span></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="title">Date</span><span class="params">(<span class="type">int</span> y, <span class="type">int</span> m, <span class="type">int</span> d)</span> : year(y), month(m), day(d)</span></span><br><span class="line"><span class="function">&#123;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//constexpr int GetYear() è¿™æ ·å†™ä¼šæŠ¥é”™ï¼Œå› ä¸ºyearä¸æ˜¯ä¸€ä¸ªå¸¸é‡æˆ–è€…å¸¸é‡è¡¨è¾¾å¼</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">GetYear</span><span class="params">()</span> <span class="type">const</span><span class="comment">//å¯¹å¤–æ¥å£ï¼ŒåŠ ä¸Šconstexpråé¢ä¼šæç¤ºç±»å‹ä¸å…¼å®¹ï¼Œéœ€è¦ä½¿ç”¨å¸¸å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> year;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">GetMonth</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> month;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">GetDay</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> day;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">int</span> year;</span><br><span class="line"><span class="type">int</span> month;</span><br><span class="line"><span class="type">int</span> day;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test10_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> Date <span class="title">obj</span><span class="params">(<span class="number">2077</span>, <span class="number">8</span>, <span class="number">8</span>)</span></span>;<span class="comment">//å¿…é¡»ç”¨å¸¸é‡æˆ–å¸¸é‡è¡¨è¾¾å¼ç»™æ„é€ å‡½æ•°ä¼ å‚æ•°</span></span><br><span class="line">cout &lt;&lt; obj.<span class="built_in">GetYear</span>() &lt;&lt; <span class="string">&quot;å¹´&quot;</span> &lt;&lt; obj.<span class="built_in">GetMonth</span>() &lt;&lt; <span class="string">&quot;æœˆ&quot;</span> &lt;&lt; obj.<span class="built_in">GetDay</span>() &lt;&lt; <span class="string">&quot;æ—¥&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//C++14æ”¯æŒå˜é‡æ¨¡æ¿ï¼š</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">constexpr</span> T pi = <span class="built_in">T</span>(<span class="number">3.1415926535897932385L</span>);</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test10_04</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; pi&lt;<span class="type">int</span>&gt; &lt;&lt; endl; <span class="comment">// 3</span></span><br><span class="line">cout &lt;&lt; pi&lt;<span class="type">double</span>&gt; &lt;&lt; endl; <span class="comment">// 3.14159</span></span><br><span class="line"><span class="comment">//pi&lt;int&gt;æ˜¯åœ¨ç”¨intç±»å‹å®ä¾‹åŒ–æ¨¡æ¿</span></span><br><span class="line"><span class="comment">//(int)pi_variableåˆ™æ˜¯åœ¨å¯¹pi_variableï¼ˆå¦‚æœå®ƒæ˜¯ä¸€ä¸ªå˜é‡æˆ–å¯¹è±¡ï¼‰è¿›è¡Œç±»å‹è½¬æ¢</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŸç”Ÿå­—ç¬¦ä¸²"><a href="#åŸç”Ÿå­—ç¬¦ä¸²" class="headerlink" title="åŸç”Ÿå­—ç¬¦ä¸²"></a>åŸç”Ÿå­—ç¬¦ä¸²</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŸç”Ÿå­—ç¬¦ä¸²ä½¿ç”¨æˆ·æ‰€è§å³æ‰€å¾—ï¼Œä¼šä¿ç•™ç”¨æˆ·è¾“å…¥çš„æ ¼å¼è¾“å‡ºï¼›æ ¼å¼ï¼šR&quot;()&quot;;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">R&quot;(hello world)&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">R&quot;(hello \n</span></span><br><span class="line"><span class="string">world)&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">string str = <span class="string">R&quot;(hello \4 \r</span></span><br><span class="line"><span class="string">abc, mike</span></span><br><span class="line"><span class="string">hello\n)&quot;</span>;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hello world</span><br><span class="line">hello \n</span><br><span class="line">world</span><br><span class="line"></span><br><span class="line">hello \4 \r</span><br><span class="line">abc, mike</span><br><span class="line">hello\n</span><br></pre></td></tr></table></figure></p><h2 id="ğŸš©ç±»çš„æ”¹è¿›"><a href="#ğŸš©ç±»çš„æ”¹è¿›" class="headerlink" title="ğŸš©ç±»çš„æ”¹è¿›"></a>ğŸš©ç±»çš„æ”¹è¿›</h2><h3 id="ç»§æ‰¿æ„é€ "><a href="#ç»§æ‰¿æ„é€ " class="headerlink" title="ç»§æ‰¿æ„é€ "></a>ç»§æ‰¿æ„é€ </h3><p>æ ¼å¼ <code>using Base::Base;</code><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç»§æ‰¿æ„é€ ï¼š</span></span><br><span class="line"><span class="comment">C++11å…è®¸å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä½†é»˜è®¤æ„é€ ã€æ‹·è´æ„é€ ã€ç§»åŠ¨æ„é€ é™¤å¤–ï¼›</span></span><br><span class="line"><span class="comment">ç»§æ‰¿æ„é€ åªèƒ½åˆå§‹åŒ–çˆ¶ç±»ä¸­çš„å‚æ•°ï¼›</span></span><br><span class="line"><span class="comment">çˆ¶ç±»ä¸­çš„æ„é€ å‡½æ•°ä¸èƒ½æ˜¯ç§æœ‰çš„ï¼›</span></span><br><span class="line"><span class="comment">ç»§æ‰¿ä¸èƒ½æ˜¯è™šç»§æ‰¿ï¼›</span></span><br><span class="line"><span class="comment">ä½¿ç”¨äº†ç»§æ‰¿æ„é€ åï¼Œå­ç±»å°†ä¸ä¼šå†æä¾›é»˜è®¤æ„é€ äº†ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">A1</span>(<span class="type">int</span> x, <span class="type">int</span> y) <span class="comment">//æœ‰å‚æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line">a = x;</span><br><span class="line">b = y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="type">int</span> b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B1</span> : <span class="keyword">public</span> A1</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line"><span class="built_in">B12</span>(<span class="type">int</span> x, <span class="type">int</span> y):<span class="built_in">A12</span>(x, y)<span class="comment">//é€šè¿‡å‚æ•°åˆ—è¡¨ç»™çˆ¶ç±»æ„é€ å‡½æ•°ä¼ å‚ //C++11é‡Œä¸ç”¨è¿™æ ·å†™ï¼Œä¼šè‡ªåŠ¨ç»§æ‰¿</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> A1::A1; <span class="comment">//ç»§æ‰¿æ„é€ </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">show</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;a= &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, b= &quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ²¡æœ‰å¢åŠ æ–°çš„æˆå‘˜å˜é‡</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test12_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">B1 <span class="title">obj</span><span class="params">(<span class="number">77</span>, <span class="number">44</span>)</span></span>;</span><br><span class="line">obj.<span class="built_in">show</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="å§”æ‰˜æ„é€ "><a href="#å§”æ‰˜æ„é€ " class="headerlink" title="å§”æ‰˜æ„é€ "></a>å§”æ‰˜æ„é€ </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å§”æ‰˜æ„é€ ï¼š</span></span><br><span class="line"><span class="comment">å¦‚æœä¸€ä¸ªç±»åŒ…å«å¤šä¸ªæ„é€ å‡½æ•°ï¼ŒC++11å…è®¸åœ¨ä¸€ä¸ªæ„é€ å‡½æ•°çš„å®šä¹‰ä¸­ä½¿ç”¨å¦ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä½†å¿…é¡»é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">/*A2() //ä¼ ç»Ÿé»˜è®¤æ„é€ </span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">A2</span>() :<span class="built_in">A2</span>(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>) <span class="comment">//å§”æ‰˜æ„é€ ï¼Œåœ¨é»˜è®¤æ„é€ ä¸­è°ƒç”¨å…¶ä»–æ„é€ å‡½æ•°ï¼Œå¿…é¡»ç”¨åˆå§‹åŒ–åˆ—è¡¨ //é€šè¿‡å½¢å‚è‡ªåŠ¨è¯†åˆ«ä¸ºè°ƒç”¨A2(int x, char y)è¿™ä¸ª</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//ä¸¤ä¸ªå‚æ•°éƒ½å†™æ­»</span></span><br><span class="line"><span class="comment">//è¢«è°ƒç”¨çš„æ„é€ å‡½æ•°å¦‚æœæ˜¯privateï¼Œä¹Ÿå¯ä»¥è°ƒç”¨æˆåŠŸ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">A2</span>(<span class="type">int</span> x) :<span class="built_in">A2</span>(x, <span class="string">&#x27;b&#x27;</span>)<span class="comment">//å§”æ‰˜æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//åªæœ‰ä¸€ä¸ªæ˜¯å˜é‡ï¼Œå¦ä¸€ä¸ªå†™æ­»</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">A2</span>(<span class="type">char</span> x) :<span class="built_in">A2</span>(<span class="number">16</span>, x)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">A2</span>(<span class="type">int</span> x, <span class="type">char</span> y) :<span class="built_in">a</span>(x), <span class="built_in">b</span>(y)<span class="comment">//å¦‚æœæ˜¯privateï¼Œä¹Ÿå¯ä»¥è¢«è°ƒç”¨æˆåŠŸ</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="type">char</span> b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test12_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">A2 obj;<span class="comment">//æ²¡æœ‰ä¼ å‚ï¼Œä¹Ÿå°±æ˜¯è°ƒé»˜è®¤æ„é€ A2() :A2(1, &#x27;a&#x27;)ï¼Œè€Œé»˜è®¤æ„é€ ä¸­å§”æ‰˜è°ƒç”¨äº†å…¶ä»–æ„é€ ï¼Œæ‰€ä»¥ä¹Ÿå‘ç”Ÿäº†ä¼ å‚ï¼›</span></span><br><span class="line">cout &lt;&lt; obj.a &lt;&lt; obj.b &lt;&lt; endl;<span class="comment">//åœ¨å§”æ‰˜æ„é€ ä¸­å·²ç»ä¼ äº†å‚æ•°ï¼Œæ‰€ä»¥å·²ç»è¢«èµ‹å€¼äº†ï¼›//1a</span></span><br><span class="line"></span><br><span class="line"><span class="function">A2 <span class="title">obj1</span><span class="params">(<span class="number">5</span>)</span></span>;<span class="comment">//ä¼ ä¸€ä¸ªå‚æ•°ï¼Œä¼šè‡ªåŠ¨è¯†åˆ«ä¸ºè°ƒç”¨A2(int x) :A2(x, &#x27;b&#x27;)è¿™ä¸ªæ„é€ å‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°åªå§”æ‰˜äº†å¦ä¸€ä¸ªæ„é€ å‡½æ•°ï¼›</span></span><br><span class="line">cout &lt;&lt; obj1.a &lt;&lt; obj1.b &lt;&lt; endl;<span class="comment">//5b</span></span><br><span class="line"></span><br><span class="line"><span class="function">A2 <span class="title">obj2</span><span class="params">(<span class="string">&#x27;c&#x27;</span>)</span></span>;</span><br><span class="line">cout &lt;&lt; obj2.a &lt;&lt; obj2.b &lt;&lt; endl;<span class="comment">//16c</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç»§æ‰¿æ§åˆ¶ï¼šfinalå’Œoverride"><a href="#ç»§æ‰¿æ§åˆ¶ï¼šfinalå’Œoverride" class="headerlink" title="ç»§æ‰¿æ§åˆ¶ï¼šfinalå’Œoverride"></a>ç»§æ‰¿æ§åˆ¶ï¼šfinalå’Œoverride</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç»§æ‰¿æ§åˆ¶ï¼šfinalå’Œoverride</span></span><br><span class="line"><span class="comment">finalï¼šé˜»æ­¢ç±»çš„è¿›ä¸€æ­¥æ´¾ç”Ÿå’Œè™šå‡½æ•°çš„è¿›ä¸€æ­¥é‡å†™ï¼›</span></span><br><span class="line"><span class="comment">overrideï¼šç¡®ä¿åœ¨å­ç±»ä¸­å£°æ˜çš„å‡½æ•°è·ŸåŸºç±»çš„è™šå‡½æ•°ä¸€æ¨¡ä¸€æ ·ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A3</span> <span class="keyword">final</span> <span class="comment">//åŠ äº†finalä¸èƒ½è¢«ç»§æ‰¿</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//class A4 : public A3 //ä¸èƒ½ç»§æ‰¿</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A5</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">()</span> <span class="keyword">final</span> </span>= <span class="number">0</span>;<span class="comment">//çº¯è™šå‡½æ•° //åŠ äº†final è™šå‡½æ•°ä¸èƒ½è¢«é‡å†™</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A6</span> : <span class="keyword">public</span> A5</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//virtual void func() //å­ç±»é‡å†™ï¼Œå¦‚æœçˆ¶ç±»ä¸­æœ‰finalå°±ä¸èƒ½è¢«é‡å†™</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">int</span> a)</span> </span>= <span class="number">0</span>; <span class="comment">//çº¯è™šå‡½æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B3</span> : <span class="keyword">public</span> B2</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">int</span> a)</span> <span class="keyword">override</span> <span class="comment">//å­ç±»é‡å†™ï¼Œå¦‚æœæ¼äº†çˆ¶ç±»ä¸­çš„å½¢å‚ï¼Œé‚£è¿™ä¸ªå‡½æ•°å°±è¢«é‡å®šä¹‰äº†ï¼Œå¦‚æœä¸å¸Œæœ›é‡å®šä¹‰ï¼Œå°±åŠ ä¸Šoverrideï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//åŠ äº†overrideï¼Œå¦‚æœå­ç±»é‡å†™å’Œçˆ¶ç±»ä¸åŒï¼Œå°±ä¼šæç¤ºé”™è¯¯</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="ç±»é»˜è®¤å‡½æ•°çš„æ§åˆ¶ï¼š-defaultå’Œ-deleteå‡½æ•°"><a href="#ç±»é»˜è®¤å‡½æ•°çš„æ§åˆ¶ï¼š-defaultå’Œ-deleteå‡½æ•°" class="headerlink" title="ç±»é»˜è®¤å‡½æ•°çš„æ§åˆ¶ï¼š=defaultå’Œ=deleteå‡½æ•°"></a>ç±»é»˜è®¤å‡½æ•°çš„æ§åˆ¶ï¼š=defaultå’Œ=deleteå‡½æ•°</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç±»é»˜è®¤å‡½æ•°çš„æ§åˆ¶ï¼š=defaultå’Œ=deleteå‡½æ•°</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">å¦‚æœç¨‹åºå‘˜æ˜¾å¼å®šä¹‰äº†æœ‰å‚æ„é€ ï¼Œç¼–è¯‘å™¨å°†ä¸ä¼šè‡ªåŠ¨å†éšå¼ç”Ÿæˆé»˜è®¤æ„é€ äº†ï¼›</span></span><br><span class="line"><span class="comment">=defaultå‡½æ•°ï¼šè®©ç¼–è¯‘å™¨æä¾›é»˜è®¤æ„é€ ï¼Œä¸ç”¨ç¨‹åºå‘˜æ‰‹å†™ï¼›</span></span><br><span class="line"><span class="comment">C++æœ‰4ç±»ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œåˆ†åˆ«æ˜¯é»˜è®¤æ„é€ ã€æ‹·è´æ„é€ ã€ææ„ã€èµ‹å€¼è¿ç®—ç¬¦é‡è½½å‡½æ•°ï¼Œdefaultåªèƒ½ä¿®é¥°è¿™4ç±»å‡½æ•°ï¼›</span></span><br><span class="line"><span class="comment">å¯ä»¥ç±»å†…å£°æ˜ã€ç±»å¤–å®ç°ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">=deleteå‡½æ•°ï¼šåªéœ€åœ¨å‡½æ•°å£°æ˜ååŠ ä¸Š=deleteï¼Œå°±å¯å°†è¯¥å‡½æ•°ç¦ç”¨ï¼›</span></span><br><span class="line"><span class="comment">deleteå¯ä»¥ä¿®é¥°æ™®é€šå‡½æ•°å’Œæœ‰å‚æ„é€ ï¼Œä¸é™äºé»˜è®¤çš„4ç±»ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">X</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">/*X() //ä¸ºäº†å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œæ‰‹å†™é»˜è®¤æ„é€ ï¼Œä½†æ˜¯æ‰‹å†™çš„æ²¡æœ‰ç¼–è¯‘å™¨æä¾›çš„æ•ˆç‡é«˜ï¼Œ</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">X</span>() = <span class="keyword">default</span>;<span class="comment">//è®©ç¼–è¯‘å™¨æä¾›é»˜è®¤æ„é€ ï¼Œä¸æ˜¯æ‰‹å†™ï¼›</span></span><br><span class="line"><span class="comment">//X(int a) = default; //ä¸å¯ç”¨defaultä¿®é¥°</span></span><br><span class="line"><span class="comment">//int func() = default; //ä¸å¯ç”¨defaultä¿®é¥°</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">X</span>(<span class="type">int</span> i)</span><br><span class="line">&#123;</span><br><span class="line">a = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">X1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line"><span class="built_in">X1</span>(); <span class="comment">//ç±»å†…å£°æ˜</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">X1</span>(<span class="type">int</span> i)</span><br><span class="line">&#123;</span><br><span class="line">a = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">X1::<span class="built_in">X1</span>() = <span class="keyword">default</span>;<span class="comment">//ç±»å¤–å®ç°ï¼Œè¦åŠ ä½œç”¨åŸŸ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">X2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">X2</span>()<span class="comment">//é»˜è®¤æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;X2çš„é»˜è®¤æ„é€ çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//X2(const X2 &amp;x)//æ‹·è´æ„é€ </span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;X2çš„æ‹·è´æ„é€ çš„è°ƒç”¨&quot; &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">X2</span>(<span class="type">const</span> X2 &amp;x) = <span class="keyword">delete</span>;<span class="comment">//ç¦ç”¨æ‹·è´æ„é€ ï¼Œç±»ä¼¼å†™è¿›private //å¦‚æœä»€ä¹ˆéƒ½ä¸å†™ï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤æä¾›ï¼Œå¦‚æœæƒ³ç¦ç”¨è¿˜æ˜¯è¦åŠ =delete;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//X2 &amp;operator =(const X2 &amp;x) //èµ‹å€¼è¿ç®—ç¬¦é‡è½½å‡½æ•°ï¼Œé‡è½½&quot;=&quot;</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;X2çš„é‡è½½=è¿ç®—ç¬¦å‡½æ•°çš„è°ƒç”¨&quot; &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//return *this;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">X2 &amp;<span class="keyword">operator</span>= (<span class="type">const</span> X2 &amp;x) = <span class="keyword">delete</span>; <span class="comment">//ç¦ç”¨èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼Œç±»ä¼¼å†™è¿›private //å¦‚æœä»€ä¹ˆéƒ½ä¸å†™ï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤æä¾›ï¼Œå¦‚æœæƒ³ç¦ç”¨è¿˜æ˜¯è¦åŠ =delete;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">()</span> </span>= <span class="keyword">delete</span>;<span class="comment">//å¯ä»¥ä¿®é¥°æ™®é€šå‡½æ•°ï¼Œè®©func()ä¸å¯è¢«è°ƒç”¨ï¼›</span></span><br><span class="line"><span class="built_in">X2</span>(<span class="type">int</span> x) = <span class="keyword">delete</span>;<span class="comment">//å¯ä»¥ä¿®é¥°æœ‰å‚æ„é€ ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åªåœ¨æ ˆä¸Šåˆ›å»ºå¯¹è±¡ã€ç¦æ­¢åœ¨å †åŒºåˆ›å»ºå¯¹è±¡ï¼Œå¯ä»¥ç¦ç”¨é‡è½½newå’Œdeleteçš„å‡½æ•°ï¼š</span></span><br><span class="line"><span class="function"><span class="type">void</span> *<span class="keyword">operator</span> <span class="title">new</span><span class="params">(<span class="type">size_t</span> t)</span> </span>= <span class="keyword">delete</span>; <span class="comment">//ç¦ç”¨newï¼Œä¹Ÿå¯ä»¥å†™è¿›privateï¼›</span></span><br><span class="line"><span class="type">void</span> *<span class="keyword">operator</span> <span class="keyword">new</span>[](<span class="type">size_t</span> t) = <span class="keyword">delete</span>;<span class="comment">//ç¦ç”¨newä¸€ä¸ªæ•°ç»„</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="keyword">operator</span> <span class="title">delete</span><span class="params">(<span class="type">void</span> *ptr)</span> </span>= <span class="keyword">delete</span>; <span class="comment">//ç¦ç”¨deleteï¼›</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test12_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">X2 obj1;<span class="comment">//è°ƒç”¨é»˜è®¤æ„é€ </span></span><br><span class="line"><span class="comment">//X2 obj2 = obj1;//è°ƒç”¨æ‹·è´æ„é€ </span></span><br><span class="line"></span><br><span class="line">X2 obj3;<span class="comment">//è°ƒç”¨é»˜è®¤æ„é€ </span></span><br><span class="line"><span class="comment">//obj3 = obj1;//è°ƒç”¨èµ‹å€¼è¿ç®—ç¬¦é‡è½½å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//obj3.func();//æ— æ³•è°ƒç”¨</span></span><br><span class="line"><span class="comment">//X2 obj4(6);//æ— æ³•è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//X2 *p = new X2; //æ— æ³•åœ¨å †åŒºåˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="comment">//X2 *p = new X2[10]; //æ— æ³•åœ¨å †åŒºåˆ›å»ºæ•°ç»„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¨¡æ¿çš„æ”¹è¿›"><a href="#æ¨¡æ¿çš„æ”¹è¿›" class="headerlink" title="æ¨¡æ¿çš„æ”¹è¿›"></a>æ¨¡æ¿çš„æ”¹è¿›</h2><h3 id="å³å°–æ‹¬å·-gt-æ”¹è¿›"><a href="#å³å°–æ‹¬å·-gt-æ”¹è¿›" class="headerlink" title="å³å°–æ‹¬å·&gt;æ”¹è¿›"></a>å³å°–æ‹¬å·&gt;æ”¹è¿›</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å³å°–æ‹¬å·&gt;æ”¹è¿›ï¼š</span></span><br><span class="line"><span class="comment">C++11ä¸­ï¼Œè¦æ±‚ç¼–è¯‘å™¨å¯¹æ¨¡æ¿çš„&gt;åšå•ç‹¬å¤„ç†ï¼Œèƒ½å¤Ÿåˆ¤æ–­å‡º&quot;&gt;&gt;&quot;æ˜¯ä¸€ä¸ªå³ç§»æ“ä½œç¬¦è¿˜æ˜¯æ¨¡æ¿å‚æ•°è¡¨çš„ç»“æŸæ ‡è®°ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="type">int</span> i&gt; </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C1</span> </span><br><span class="line">&#123; </span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C2</span> </span><br><span class="line">&#123; </span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">C2&lt;C1&lt;<span class="number">8</span>&gt;&gt; obj1; <span class="comment">//æ¨¡æ¿å®ä¾‹åŒ–å¯¹è±¡ï¼Œæ¨¡æ¿åµŒå¥—æ¨¡æ¿//æ—§ç‰ˆæœ¬C++è¦æ±‚C2&lt;C1&lt;8&gt; &gt;ä¸­çš„&gt; &gt;ä¹‹é—´å¿…é¡»æœ‰ç©ºæ ¼ï¼Œè€ŒC++11ä¸éœ€è¦ï¼›</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¨¡æ¿çš„åˆ«å-using"><a href="#æ¨¡æ¿çš„åˆ«å-using" class="headerlink" title="æ¨¡æ¿çš„åˆ«å using"></a>æ¨¡æ¿çš„åˆ«å using</h3><p>æ ¼å¼ <code>using åˆ«å = åŸç±»å‹;</code><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ¨¡æ¿çš„åˆ«åï¼š</span></span><br><span class="line"><span class="comment">ä¼ ç»Ÿæ–¹æ³•ï¼štypedefèµ·åˆ«åï¼›</span></span><br><span class="line"><span class="comment">C++11ï¼šusing  ..= ..</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> int32; <span class="comment">//ä¼ ç»Ÿæ–¹æ³•</span></span><br><span class="line"><span class="keyword">using</span> my_int = <span class="type">int</span>; <span class="comment">//C++11</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//is_same åˆ¤æ–­ç±»å‹æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒå°±è¿”å›true</span></span><br><span class="line">cout &lt;&lt; is_same&lt;int32, my_int&gt;::value &lt;&lt; endl;<span class="comment">//1ï¼Œè¯´æ˜int32å’Œmy_intç±»å‹ç›¸åŒ</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(int32).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="built_in">typeid</span>(my_int).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">int32 a = <span class="number">1</span>;</span><br><span class="line">my_int b = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="å‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°"><a href="#å‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°" class="headerlink" title="å‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°"></a>å‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°ï¼š</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ™®é€šå‡½æ•°å¸¦é»˜è®¤å‚æ•°ï¼›</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_03</span><span class="params">(<span class="type">int</span> a = <span class="number">3</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»æ¨¡æ¿é»˜è®¤æ¨¡æ¿å‚æ•°ï¼›</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span> = <span class="type">int</span>&gt;</span><br><span class="line"><span class="keyword">class</span> C3</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">T a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°æ¨¡æ¿é»˜è®¤æ¨¡æ¿å‚æ•°ï¼›</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T </span>= <span class="type">int</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_04</span><span class="params">(T a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°å¿…é¡»ä»å³å¾€å·¦å®šä¹‰ï¼š</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T1</span> = <span class="type">int</span>, <span class="keyword">class</span> T2 = <span class="type">double</span>&gt; <span class="comment">//ä¸¤ä¸ªéƒ½ç»™é»˜è®¤å‚æ•°ï¼Œæ”¯æŒ</span></span><br><span class="line"><span class="keyword">class</span> C4</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">T1 t1;</span><br><span class="line">T2 t2;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T1</span>, <span class="keyword">class</span> <span class="title class_">T2</span>&gt; <span class="comment">//ä¸¤ä¸ªéƒ½ä¸ç»™é»˜è®¤å‚æ•°ï¼Œæ”¯æŒ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C5</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">T1 t1;</span><br><span class="line">T2 t2;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//template&lt;class T1 = int, class T2&gt; //å·¦è¾¹ç»™é»˜è®¤å‚æ•°ï¼Œå³è¾¹ä¸ç»™ï¼Œä¸æ”¯æŒ</span></span><br><span class="line"><span class="comment">//class C6</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//public:</span></span><br><span class="line"><span class="comment">//T1 t1;</span></span><br><span class="line"><span class="comment">//T2 t2;</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T1</span>, <span class="keyword">class</span> <span class="title class_">T2</span> = <span class="type">int</span>&gt; <span class="comment">//å·¦è¾¹ä¸ç»™é»˜è®¤å‚æ•°ï¼Œå³è¾¹ç»™ï¼Œæ”¯æŒ</span></span><br><span class="line"><span class="keyword">class</span> C7</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">T1 t1;</span><br><span class="line">T2 t2;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°æ¨¡æ¿åˆ™æ²¡æœ‰å¿…é¡»ä»å³å¾€å·¦çš„é™åˆ¶ï¼š</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T1</span> = <span class="type">int</span>, <span class="keyword">class</span> T2 = <span class="type">double</span>&gt; <span class="comment">//ä¸¤ä¸ªéƒ½ç»™é»˜è®¤å‚æ•°ï¼Œæ”¯æŒ</span></span><br><span class="line"><span class="type">void</span> <span class="built_in">test13_05</span>(T1 a, T2 b)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T1</span>, <span class="keyword">class</span> <span class="title class_">T2</span>&gt;<span class="comment">//ä¸¤ä¸ªéƒ½ä¸ç»™é»˜è®¤å‚æ•°ï¼Œæ”¯æŒ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_06</span><span class="params">(T1 a, T2 b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T1</span> = <span class="type">int</span>, <span class="keyword">class</span> T2&gt;<span class="comment">//å·¦è¾¹ä¸ç»™é»˜è®¤å‚æ•°ï¼Œå³è¾¹ç»™ï¼Œæ”¯æŒ</span></span><br><span class="line"><span class="type">void</span> <span class="built_in">test13_07</span>(T1 a, T2 b)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T1</span>, <span class="keyword">class</span> <span class="title class_">T2</span> = <span class="type">int</span>&gt;<span class="comment">//å·¦è¾¹ç»™é»˜è®¤å‚æ•°ï¼Œå³è¾¹ä¸ç»™ï¼Œæ”¯æŒ</span></span><br><span class="line"><span class="type">void</span> <span class="built_in">test13_08</span>(T1 a, T2 b)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¯å˜å‚æ•°æ¨¡æ¿ï¼ˆéš¾ç‚¹ï¼‰"><a href="#å¯å˜å‚æ•°æ¨¡æ¿ï¼ˆéš¾ç‚¹ï¼‰" class="headerlink" title="å¯å˜å‚æ•°æ¨¡æ¿ï¼ˆéš¾ç‚¹ï¼‰"></a>å¯å˜å‚æ•°æ¨¡æ¿ï¼ˆéš¾ç‚¹ï¼‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å¯å˜å‚æ•°æ¨¡æ¿ï¼šæ˜¯C++11æ–°å¢çš„æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œå®ƒå¯¹å‚æ•°è¿›è¡Œäº†é«˜åº¦æ³›åŒ–ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ... T&gt; <span class="comment">//åœ¨classå’ŒTä¸­é—´åŠ ... //Tå«ä½œæ¨¡æ¿å‚æ•°åŒ…ï¼Œå¯ä¼ å¤šä¸ªå‚æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func001</span><span class="params">(T ... a)</span><span class="comment">//aå«ä½œå‡½æ•°å‚æ•°åŒ…ï¼Œå¯ä¼ å¤šä¸ªå‚æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;num= &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>...(a) &lt;&lt; endl;<span class="comment">//æŸ¥çœ‹aå†…å‚æ•°çš„ä¸ªæ•°ï¼Œsizeof...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_09</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">func001</span>&lt;<span class="type">int</span>&gt;(<span class="number">10</span>);<span class="comment">//åªä¼ ä¸€ä¸ªå‚æ•°</span></span><br><span class="line"><span class="built_in">func001</span>&lt;<span class="type">int</span>, <span class="type">double</span>, <span class="type">char</span>&gt;(<span class="number">3</span>, <span class="number">3.14</span>, <span class="string">&#x27;d&#x27;</span>); <span class="comment">//å¯ä»¥åŒæ—¶ä¼ å¤šä¸ªä¸åŒç±»å‹å‚æ•°</span></span><br><span class="line"><span class="built_in">func001</span>(<span class="number">11</span>, <span class="number">13.5</span>, <span class="number">34</span>, <span class="string">&#x27;c&#x27;</span>);<span class="comment">//è‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼Œå¯ä»¥åŒæ—¶ä¼ å¤šä¸ªä¸åŒç±»å‹å‚æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…"><a href="#é€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…" class="headerlink" title="é€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…"></a>é€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…ï¼ˆè¾ƒå¸¸ç”¨ï¼‰ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//#if 0</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">debug</span><span class="params">()</span><span class="comment">//é€’å½’ç»ˆæ­¢å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å‚æ•°åŒ…é‡Œæ²¡æœ‰æ•°æ®äº†ä¼šç»ˆæ­¢</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;empty&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//#endif</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">debug</span><span class="params">(T t)</span><span class="comment">//é€’å½’ç»ˆæ­¢å‡½æ•°ï¼Œå‚æ•°åŒ…é‡Œåªæœ‰1ä¸ªå…ƒç´ æ—¶å°±ç»ˆæ­¢</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;last = &quot;</span> &lt;&lt; t &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T1, <span class="keyword">class</span> ... T2&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">debug</span><span class="params">(T1 t1, T2 ... t2)</span><span class="comment">//å‚æ•°åŒ…å±•å¼€å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; t1 &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="built_in">debug</span>(t2...); <span class="comment">//t2...æ¯è°ƒä¸€æ¬¡å°±å‡å°‘ä¸€ä¸ªå…ƒç´ ï¼Œç›´åˆ°ä¸ºç©ºï¼Œæ‰è°ƒç”¨ç»ˆæ­¢å‡½æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_10</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">debug</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">é€’å½’è°ƒç”¨è¿‡ç¨‹ï¼š</span></span><br><span class="line"><span class="comment">debug(1, 2, 3, 4);</span></span><br><span class="line"><span class="comment">debug(2, 3, 4);</span></span><br><span class="line"><span class="comment">debug(3, 4);</span></span><br><span class="line"><span class="comment">debug(4);</span></span><br><span class="line"><span class="comment">debug();</span></span><br><span class="line"><span class="comment">ç„¶åå†å›æº¯ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">debug</span>(<span class="number">22</span>, <span class="string">&quot;Tom&quot;</span>, <span class="number">3.14</span>, <span class="string">&#x27;c&#x27;</span>); <span class="comment">//å¯ä»¥åŒæ—¶ä¼ ä¸åŒç±»å‹</span></span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="éé€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…"><a href="#éé€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…" class="headerlink" title="éé€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…"></a>éé€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//éé€’å½’å±•å¼€æ¨¡æ¿å‚æ•°åŒ…ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ... T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">expand</span><span class="params">(T ... t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//å€ŸåŠ©é€—å·è¿ç®—ç¬¦å’Œåˆå§‹åŒ–åˆ—è¡¨</span></span><br><span class="line"><span class="type">int</span> a[] = &#123; (<span class="built_in">print</span>(t), <span class="number">0</span>)... &#125;;<span class="comment">//...è¡¨ç¤ºæ¯è°ƒç”¨ä¸€æ¬¡å°±å‡å°‘ä¸€ä¸ªå…ƒç´ ï¼Œç›´åˆ°ä¸ºç©ºï¼Œæ‰è°ƒç”¨ç»ˆæ­¢å‡½æ•°ï¼Œå½“å‰ç›¸å½“äºt2=(print(t), 0)</span></span><br><span class="line"><span class="comment">//æœ€åa[] = &#123;0, 0, 0, ... ,0&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_11</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">expand</span>(<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>); <span class="comment">//å¿…é¡»ä¼ ç›¸åŒç±»å‹</span></span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœï¼š5 6 7 8</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šå…³äº <code>(print (t), 0)</code>ï¼Œæ¯ä¸ªé€—å·è¿ç®—ç¬¦ä¸­çš„ <code>print(t)</code> è°ƒç”¨éƒ½ä¼šæ‰“å°ä¸€ä¸ªå‚æ•°ï¼Œç„¶åè¿”å›0ï¼ˆå› ä¸ºè¿™ä¸ªæ•°ç»„ a çš„æˆå‘˜å…ƒç´ ç±»å‹ä¸º intï¼‰ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ä½¿ç”¨ä¸€ä¸ª <code>0</code> è¿›è¡Œåˆå§‹åŒ–ï¼ˆä¸º1ä¸º2éƒ½å¯ä»¥ï¼Œæ•°ç»„ä»…ä½œå­˜å‚¨ç”¨é€”ï¼‰ã€‚æ‹¬å·ç”¨æ¥ç¡®ä¿é€—å·è¿ç®—ç¬¦çš„ä½œç”¨ã€‚</p><h4 id="ç»§æ‰¿æ–¹å¼å±•å¼€æ¨¡æ¿å‚æ•°åŒ…"><a href="#ç»§æ‰¿æ–¹å¼å±•å¼€æ¨¡æ¿å‚æ•°åŒ…" class="headerlink" title="ç»§æ‰¿æ–¹å¼å±•å¼€æ¨¡æ¿å‚æ•°åŒ…"></a>ç»§æ‰¿æ–¹å¼å±•å¼€æ¨¡æ¿å‚æ•°åŒ…</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç»§æ‰¿æ–¹å¼å±•å¼€æ¨¡æ¿å‚æ•°åŒ…ï¼š</span></span><br><span class="line"><span class="comment">//1ï¼Œå¯å˜å‚æ•°æ¨¡æ¿å£°æ˜ï¼›</span></span><br><span class="line"><span class="comment">//2ï¼Œé€’å½’ç»§æ‰¿æ¨¡æ¿ç±»ï¼›</span></span><br><span class="line"><span class="comment">//3ï¼Œé€’å½’ç»ˆæ­¢æ¡ä»¶ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ... T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span><span class="comment">//å‰ç½®å£°æ˜ï¼Œä¸ç„¶åé¢ä¼šæŠ¥é”™</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span>&lt;&gt;<span class="comment">//é€’å½’ç»ˆæ­¢å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">Head</span>, <span class="keyword">class</span> ... Tail&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span>&lt;Head, Tail...&gt; : <span class="keyword">public</span> Car&lt;Tail...&gt; <span class="comment">//é€’å½’ç»§æ‰¿è‡ªå·±</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Car</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;type= &quot;</span> &lt;&lt; <span class="built_in">typeid</span>(Head).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_12</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Car&lt;<span class="type">int</span>, <span class="type">double</span>, <span class="type">char</span>*, <span class="type">float</span>&gt; Ferrari;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¨¡æ¿ç±»é€’å½’å’Œç‰¹åŒ–æ–¹å¼å±•å¼€å‚æ•°åŒ…"><a href="#æ¨¡æ¿ç±»é€’å½’å’Œç‰¹åŒ–æ–¹å¼å±•å¼€å‚æ•°åŒ…" class="headerlink" title="æ¨¡æ¿ç±»é€’å½’å’Œç‰¹åŒ–æ–¹å¼å±•å¼€å‚æ•°åŒ…"></a>æ¨¡æ¿ç±»é€’å½’å’Œç‰¹åŒ–æ–¹å¼å±•å¼€å‚æ•°åŒ…</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¨¡æ¿ç±»é€’å½’å’Œç‰¹åŒ–æ–¹å¼å±•å¼€å‚æ•°åŒ…ï¼š</span></span><br><span class="line"><span class="comment">//1ï¼Œå˜é•¿æ¨¡æ¿å£°æ˜ï¼›</span></span><br><span class="line"><span class="comment">//2ï¼Œå˜é•¿æ¨¡æ¿ç±»å®šä¹‰ï¼›</span></span><br><span class="line"><span class="comment">//3ï¼Œé€’å½’ç»ˆæ­¢æ¡ä»¶ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="type">int</span> ... i&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span><span class="comment">//å‰ç½®å£°æ˜</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>&lt;&gt;<span class="comment">//é€’å½’ç»ˆæ­¢å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> val = <span class="number">1</span>;<span class="comment">//æœ€åæ²¡æœ‰å¯å˜å‚æ•°äº†ï¼Œå°±*1</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> sum = <span class="number">0</span>;<span class="comment">//æœ€åæ²¡æœ‰å¯å˜å‚æ•°äº†ï¼Œå°±+0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="type">int</span> first, <span class="type">int</span> ... last&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>&lt;first, last...&gt;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> val = first * Test&lt;last...&gt;::val; <span class="comment">//é€’å½’æ±‚ç§¯</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> sum = first + Test&lt;last...&gt;::sum; <span class="comment">//é€’å½’æ±‚å’Œ</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_13</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Test&lt;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> ,<span class="number">6</span>&gt; t;</span><br><span class="line">cout &lt;&lt; t.val &lt;&lt; endl; <span class="comment">//720</span></span><br><span class="line">cout &lt;&lt; t.sum &lt;&lt; endl; <span class="comment">//20</span></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; Test&lt;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&gt;::val &lt;&lt; endl; <span class="comment">//720</span></span><br><span class="line">cout &lt;&lt; Test&lt;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&gt;::sum &lt;&lt; endl; <span class="comment">//20</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å˜å‚æ¨¡æ¿çš„åº”ç”¨"><a href="#å˜å‚æ¨¡æ¿çš„åº”ç”¨" class="headerlink" title="å˜å‚æ¨¡æ¿çš„åº”ç”¨"></a>å˜å‚æ¨¡æ¿çš„åº”ç”¨</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å˜å‚æ¨¡æ¿çš„åº”ç”¨ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1ï¼Œprintå‡½æ•°ï¼š</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printX</span><span class="params">()</span> <span class="comment">//é€’å½’ç»ˆæ­¢å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span>...Types&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printX</span><span class="params">(<span class="type">const</span> T &amp;firstArg, <span class="type">const</span> Types &amp;...args)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; firstArg &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="built_in">printX</span>(args...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_14</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printX</span>(<span class="number">45</span>, <span class="number">9.8</span>, <span class="string">&quot;abc&quot;</span>, <span class="string">&#x27;m&#x27;</span>);</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//2ï¼Œmaxå‡½æ•°ï¼š</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">maximun</span><span class="params">(<span class="type">int</span> n)</span> <span class="comment">//é€’å½’ç»ˆæ­¢å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span>...T&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">maximun</span><span class="params">(<span class="type">int</span> n, T...args)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">max</span>(n, <span class="built_in">maximun</span>(args...));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_15</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="built_in">maximun</span>(<span class="number">57</span>, <span class="number">48</span>, <span class="number">60</span>, <span class="number">100</span>, <span class="number">20</span>, <span class="number">18</span>) &lt;&lt; endl; <span class="comment">//100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//C++11ä¹‹åå·²ç»æ”¯æŒäº†ç›´æ¥æ±‚å¤šä¸ªæ•°æ±‚æœ€å¤§å€¼çš„æ“ä½œï¼š</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">max</span>(&#123; <span class="number">57</span>, <span class="number">48</span>, <span class="number">60</span>, <span class="number">100</span>, <span class="number">20</span>, <span class="number">18</span> &#125;) &lt;&lt; endl; <span class="comment">//100</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3ï¼Œsumå‡½æ•°ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(T t)</span> <span class="comment">//é€’å½’ç»ˆæ­¢å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T1, <span class="keyword">class</span> ... T2&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(T1 first, T2...last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> first + <span class="built_in">sum</span>(last...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test13_16</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="built_in">sum</span>(<span class="number">33</span>, <span class="number">16</span>, <span class="number">28</span>, <span class="number">55</span>, <span class="number">100</span>) &lt;&lt; endl; <span class="comment">//232</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//C++14æ”¯æŒåˆ«åæ¨¡æ¿ï¼š</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">U</span>&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A13</span> </span><br><span class="line">&#123;</span><br><span class="line">T t;</span><br><span class="line">U u;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">using</span> B13 = A13&lt;T, <span class="type">int</span>&gt;;</span><br></pre></td></tr></table></figure><h2 id="å³å€¼å¼•ç”¨åŠå…¶åº”ç”¨"><a href="#å³å€¼å¼•ç”¨åŠå…¶åº”ç”¨" class="headerlink" title="å³å€¼å¼•ç”¨åŠå…¶åº”ç”¨"></a>å³å€¼å¼•ç”¨åŠå…¶åº”ç”¨</h2><h3 id="å³å€¼å¼•ç”¨"><a href="#å³å€¼å¼•ç”¨" class="headerlink" title="å³å€¼å¼•ç”¨"></a>å³å€¼å¼•ç”¨</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Cè¯­è¨€ä¸­ï¼Œèµ‹å€¼è¡¨è¾¾å¼ä¸­ï¼Œ=å·¦è¾¹çš„å«å·¦å€¼ï¼Œ=å³è¾¹çš„å«å³å€¼ï¼›</span></span><br><span class="line"><span class="comment">è€ŒC++ä¸­ï¼Œå¯ä»¥å–åœ°å€ã€æœ‰åå­—çš„å°±æ˜¯å·¦å€¼ï¼Œåä¹‹å°±æ˜¯å³å€¼ï¼›</span></span><br><span class="line"><span class="comment">ä¾‹å¦‚ï¼Œ</span></span><br><span class="line"><span class="comment">int b = 1;</span></span><br><span class="line"><span class="comment">int c = 2;</span></span><br><span class="line"><span class="comment">int a = b + c;</span></span><br><span class="line"><span class="comment">&amp;aæ˜¯å¯ä»¥æ“ä½œçš„ï¼Œè€Œ&amp;(b+c)ä¸å¯ä»¥ï¼Œæ‰€ä»¥aæ˜¯å·¦å€¼ï¼Œb+cæ˜¯å³å€¼ï¼›</span></span><br><span class="line"><span class="comment">å³å€¼è¡¨ç¤ºå­—é¢å¸¸é‡ã€è¡¨è¾¾å¼ã€å‡½æ•°çš„éå¼•ç”¨è¿”å›å€¼ç­‰ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">å·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨éƒ½å¿…é¡»é©¬ä¸Šåˆå§‹åŒ–ï¼›å¼•ç”¨å°±æ˜¯èµ·åˆ«åï¼›</span></span><br><span class="line"><span class="comment">å·¦å€¼å¼•ç”¨æ˜¯æœ‰åå­—å˜é‡çš„åˆ«åï¼Œè€Œå³å€¼å¼•ç”¨æ˜¯åŒ¿åå˜é‡çš„åˆ«åï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> &amp;<span class="title">func01_01</span><span class="params">()</span> <span class="comment">//è¿”å›å€¼ä¸ºå¼•ç”¨</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> tmp;<span class="comment">//é™æ€å˜é‡ä¸ä¼šé‡Šæ”¾</span></span><br><span class="line"><span class="keyword">return</span> tmp; <span class="comment">//è¿”å›çš„æ˜¯å·¦å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test01_01</span><span class="params">()</span> <span class="comment">//å·¦å€¼å¼•ç”¨</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="comment">//int &amp;b; //æ²¡æœ‰é©¬ä¸Šåˆå§‹åŒ–</span></span><br><span class="line"><span class="type">int</span> &amp;b = a; <span class="comment">//å·¦å€¼å¼•ç”¨ï¼Œèµ·åˆ«å</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> &amp;c = a; <span class="comment">//å·¦å€¼å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//int &amp;d = 1; //errorï¼Œå³å€¼</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> &amp;d = <span class="number">1</span>; <span class="comment">//å¸¸å¼•ç”¨ï¼Œå¯ä»¥ï¼Œå³å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> &amp;e = <span class="built_in">func01_01</span>(); <span class="comment">//å·¦å€¼å¼•ç”¨</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> &amp;f = <span class="built_in">func01_01</span>(); <span class="comment">//å·¦å€¼å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> tmp = <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> &amp;g = tmp; <span class="comment">//å·¦å€¼å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//const int &amp; ä¸‡èƒ½å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func01_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">8</span>; <span class="comment">//è¿”å›çš„æ˜¯å³å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test01_02</span><span class="params">()</span> <span class="comment">//å³å€¼å¼•ç”¨</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> &amp;&amp;a = <span class="number">1</span>; <span class="comment">//1è¿™å—å†…å­˜æœ¬æ¥æ²¡åå­—ï¼Œç»™è¿™å—å†…å­˜èµ·ä¸ªåå­—å«aï¼Œä»¥åå°±å¯ä»¥ç”¨aæ“ä½œè¿™å—å†…å­˜ï¼›</span></span><br><span class="line"><span class="comment">//å¦‚æœç›´æ¥ç”¨1ï¼Œä½¿ç”¨å®Œäº†å°±é‡Šæ”¾äº†ï¼Œç”¨å³å€¼å¼•ç”¨å¯ä»¥ç»§ç»­ä½¿ç”¨è¿™å—å†…å­˜ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> &amp;&amp;b = <span class="built_in">func01_02</span>(); <span class="comment">//å³å€¼å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> i = <span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> j = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> &amp;&amp;c = i + j; <span class="comment">//å³å€¼å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> k = <span class="number">6</span>;</span><br><span class="line"><span class="comment">//int &amp;&amp;d = k; //errorï¼Œä¸èƒ½æŠŠä¸€ä¸ªå·¦å€¼èµ‹å€¼ç»™ä¸€ä¸ªå³å€¼å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func01_03</span><span class="params">(<span class="type">int</span> &amp;tmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å·¦å€¼ = &quot;</span> &lt;&lt; tmp &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func01_03</span><span class="params">(<span class="type">int</span> &amp;&amp;tmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å³å€¼ = &quot;</span> &lt;&lt; tmp &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test01_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">func01_03</span>(a);<span class="comment">//aæ˜¯å·¦å€¼ï¼Œè°ƒç”¨å·¦å€¼é‚£ä¸ª</span></span><br><span class="line"><span class="built_in">func01_03</span>(<span class="number">11</span>); <span class="comment">//11æ˜¯å¸¸é‡ï¼Œæ˜¯å³å€¼ï¼Œè°ƒç”¨å³å€¼é‚£ä¸ª</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿”å›å€¼ä¼˜åŒ–æŠ€æœ¯ä¸ç§»åŠ¨è¯­ä¹‰"><a href="#è¿”å›å€¼ä¼˜åŒ–æŠ€æœ¯ä¸ç§»åŠ¨è¯­ä¹‰" class="headerlink" title="è¿”å›å€¼ä¼˜åŒ–æŠ€æœ¯ä¸ç§»åŠ¨è¯­ä¹‰"></a>è¿”å›å€¼ä¼˜åŒ–æŠ€æœ¯ä¸ç§»åŠ¨è¯­ä¹‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç§»åŠ¨è¯­ä¹‰ï¼š</span></span><br><span class="line"><span class="comment">å³å€¼å¼•ç”¨æ˜¯ç”¨æ¥æ”¯æŒç§»åŠ¨è¯­ä¹‰çš„ï¼Œç§»åŠ¨è¯­ä¹‰å¯ä»¥å°†èµ„æºï¼ˆå †ï¼Œç³»ç»Ÿå¯¹è±¡ç­‰ï¼‰ä»ä¸€ä¸ªå¯¹è±¡è½¬ç§»åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œ</span></span><br><span class="line"><span class="comment">è¿™æ ·å¯ä»¥å‡å°‘ä¸å¿…è¦çš„ä¸´æ—¶å¯¹è±¡çš„åˆ›å»ºã€æ‹·è´ã€ææ„ï¼Œå¯ä»¥å¤§å¹…æé«˜ç¨‹åºçš„æ•ˆç‡ï¼›ä¸´æ—¶å¯¹è±¡çš„åˆ›å»ºå’Œææ„ä¼šæ‹–æ…¢ç¨‹åºçš„é€Ÿåº¦ï¼›</span></span><br><span class="line"><span class="comment">ç§»åŠ¨è¯­ä¹‰å’Œæ‹·è´è¯­ä¹‰æ˜¯ç›¸å¯¹çš„ï¼Œç±»ä¼¼æ–‡ä»¶çš„å‰ªåˆ‡ä¸å¤åˆ¶ï¼›</span></span><br><span class="line"><span class="comment">é€šè¿‡ç§»åŠ¨è¯­ä¹‰ï¼Œä¸´æ—¶å¯¹è±¡ä¸­çš„èµ„æºå¯ä»¥è½¬ç§»åˆ°å…¶ä»–å¯¹è±¡é‡Œï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç§»åŠ¨è¯­ä¹‰çš„å®šä¹‰ï¼š</span></span><br><span class="line"><span class="comment">ç°æœ‰çš„C++å¯ä»¥å®šä¹‰æ‹·è´æ„é€ å’Œèµ‹å€¼å‡½æ•°ï¼Œä½†è¦å®ç°è½¬ç§»è¯­ä¹‰ï¼Œéœ€è¦å®šä¹‰è½¬ç§»æ„é€ å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å®šä¹‰è½¬ç§»èµ‹å€¼æ“ä½œç¬¦ï¼›</span></span><br><span class="line"><span class="comment">å¯¹äºå³å€¼çš„æ‹·è´å’Œèµ‹å€¼ï¼Œä¼šè°ƒç”¨è½¬ç§»æ„é€ å‡½æ•°å’Œè½¬ç§»èµ‹å€¼æ“ä½œç¬¦ï¼›</span></span><br><span class="line"><span class="comment">æ™®é€šå‡½æ•°çš„æ“ä½œç¬¦ä¹Ÿå¯ä»¥é€šè¿‡å³å€¼å¼•ç”¨æ“ä½œç¬¦å®ç°è½¬ç§»è¯­ä¹‰ï¼›</span></span><br><span class="line"><span class="comment">å³ä¾¿ä¸åšä¼˜åŒ–ï¼Œä½¿ç”¨ç§»åŠ¨æ„é€ å‡½æ•°ä¹Ÿå¯ä»¥å‡å°‘ä¸´æ—¶å¯¹è±¡çš„åˆ›å»ºã€æ‹·è´ã€ææ„æ“ä½œï¼Œæé«˜ç¨‹åºæ•ˆç‡ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç§»åŠ¨æ„é€ å’Œç§»åŠ¨èµ‹å€¼æ³¨æ„ç‚¹ï¼š</span></span><br><span class="line"><span class="comment">å‚æ•°ä¸ºéconstå³å€¼ï¼Œç”¨&amp;&amp;ï¼›</span></span><br><span class="line"><span class="comment">å‚æ•°ä¸å¯ä»¥æ˜¯å¸¸é‡ï¼Œå› ä¸ºéœ€è¦ä¿®æ”¹å³å€¼ï¼›</span></span><br><span class="line"><span class="comment">å‚æ•°çš„èµ„æºé“¾æ¥å’Œæ ‡è®°å¿…é¡»ä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯æŠŠåŸæ¥çš„åœ°å€ç½®ç©ºï¼Œå¦åˆ™ä¼šå¯¼è‡´æµ…æ‹·è´çš„é—®é¢˜ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">å¯¹äºéœ€è¦åŠ¨æ€ç”³è¯·å¤§é‡èµ„æºçš„ç±»ï¼Œåº”è¯¥åŠ ä¸Šç§»åŠ¨æ„é€ å’Œç§»åŠ¨èµ‹å€¼å‡½æ•°ï¼Œæé«˜ç¨‹åºæ•ˆç‡ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyString</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">MyString</span>(<span class="type">const</span> <span class="type">char</span> *tmp = <span class="string">&quot;abc&quot;</span>) <span class="comment">//æœ‰å‚æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line">len = <span class="built_in">strlen</span>(tmp); <span class="comment">//é•¿åº¦</span></span><br><span class="line">str = <span class="keyword">new</span> <span class="type">char</span>[len + <span class="number">1</span>]; <span class="comment">//å †åŒºç”³è¯·ç©ºé—´</span></span><br><span class="line"><span class="built_in">strcpy_s</span>(str, len + <span class="number">1</span>, tmp); <span class="comment">//å°†tmpä¸­å­—ç¬¦ä¸²å¤åˆ¶åˆ°str</span></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;æœ‰å‚æ„é€ çš„è°ƒç”¨ï¼šstr =&quot;</span> &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">MyString</span>(<span class="type">const</span> MyString &amp;tmp) <span class="comment">//æ‹·è´æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line">len = tmp.len;</span><br><span class="line">str = <span class="keyword">new</span> <span class="type">char</span>[len + <span class="number">1</span>]; <span class="comment">//æ·±æ‹·è´ï¼Œé˜²æ­¢å †åŒºå†…å­˜é‡å¤é‡Šæ”¾ï¼ˆæµ…æ‹·è´ï¼‰</span></span><br><span class="line"><span class="built_in">strcpy_s</span>(str, len + <span class="number">1</span>, tmp.str);</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;æ‹·è´æ„é€ çš„è°ƒç”¨ï¼šstr =&quot;</span> &lt;&lt; tmp.str &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">MyString</span>(MyString &amp;&amp;t) <span class="comment">//ç§»åŠ¨æ„é€  //å‚æ•°æ˜¯éconstçš„å³å€¼å¼•ç”¨ //åŠ äº†ç§»åŠ¨æ„é€ å°±ä¸ä¼šè°ƒç”¨æ‹·è´æ„é€ ï¼Œå¯ä»¥å‡å°‘ä¸´æ—¶å˜é‡çš„æ“ä½œ</span></span><br><span class="line">&#123;</span><br><span class="line">len = t.len;</span><br><span class="line">str = t.str; <span class="comment">//æ‹·è´åœ°å€ï¼Œæ²¡æœ‰é‡æ–°ç”³è¯·å†…å­˜ï¼å°±æ˜¯æµ…æ‹·è´ï¼</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ç§»åŠ¨æ„é€ çš„è°ƒç”¨ï¼šstr =&quot;</span> &lt;&lt; t.str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">t.str = <span class="literal">nullptr</span>;<span class="comment">//è¦æŠŠåŸæ¥çš„æŒ‡é’ˆç½®ç©ºï¼Œå¦åˆ™ä¼šä¸¤æ¬¡é‡Šæ”¾åŒä¸€å—å †åŒºçš„åœ°å€ï¼Œäº§ç”Ÿæµ…æ‹·è´çš„é—®é¢˜ï¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyString &amp;<span class="keyword">operator</span> = (<span class="type">const</span> MyString &amp;tmp) <span class="comment">//è¿ç®—ç¬¦é‡è½½</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (&amp;tmp == <span class="keyword">this</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…ˆé‡Šæ”¾åŸæ¥çš„å†…å­˜</span></span><br><span class="line">len = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">delete</span>[]str;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨å †åŒºé‡æ–°ç”³è¯·å†…å­˜</span></span><br><span class="line">len = tmp.len;</span><br><span class="line">str = <span class="keyword">new</span> <span class="type">char</span>[len + <span class="number">1</span>];</span><br><span class="line"><span class="built_in">strcpy_s</span>(str, len + <span class="number">1</span>, tmp.str);</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è¿ç®—ç¬¦é‡è½½çš„è°ƒç”¨ï¼šstr =&quot;</span> &lt;&lt; tmp.str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyString &amp;<span class="keyword">operator</span> = (MyString &amp;&amp;t)<span class="comment">//ç§»åŠ¨èµ‹å€¼ //å‚æ•°æ˜¯éconstçš„å³å€¼å¼•ç”¨ //åŠ äº†ç§»åŠ¨èµ‹å€¼å°±ä¸ä¼šè°ƒç”¨æ™®é€šè¿ç®—ç¬¦é‡è½½å‡½æ•°ï¼Œå¯æé«˜æ•ˆç‡</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (&amp;t == <span class="keyword">this</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…ˆé‡Šæ”¾åŸæ¥çš„å†…å­˜</span></span><br><span class="line">len = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">delete</span>[]str;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸éœ€è¦åœ¨å †åŒºé‡æ–°ç”³è¯·å†…å­˜</span></span><br><span class="line">len = t.len;</span><br><span class="line">str = t.str;<span class="comment">//æµ…æ‹·è´</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ç§»åŠ¨èµ‹å€¼å‡½æ•°çš„è°ƒç”¨ï¼šstr =&quot;</span> &lt;&lt; t.str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">t.str = <span class="literal">nullptr</span>;<span class="comment">//è¦æŠŠåŸæ¥çš„æŒ‡é’ˆç½®ç©ºï¼Œå¦åˆ™ä¼šäº§ç”Ÿæµ…æ‹·è´çš„é—®é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">~<span class="built_in">MyString</span>() <span class="comment">//ææ„å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ææ„å‡½æ•°çš„è°ƒç”¨ï¼Œ&quot;</span>;</span><br><span class="line"></span><br><span class="line">len = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (str != <span class="literal">nullptr</span>) <span class="comment">//ç§»åŠ¨æ„é€ ä¸­t.strç½®ç©ºåï¼Œå°±ä¸ä¼šè·‘è¿›è¿™ä¸ªåˆ†æ”¯ï¼Œä¹Ÿèƒ½æå‡æ•ˆç‡ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å·²æ“ä½œdeleteï¼Œstr = &quot;</span> &lt;&lt; str;</span><br><span class="line"><span class="keyword">delete</span>[]str;</span><br><span class="line">str = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">char</span> *str = <span class="literal">nullptr</span>; <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">int</span> len = <span class="number">0</span>; <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">MyString <span class="title">func</span><span class="params">()</span> <span class="comment">//è¿”å›æ™®é€šå¯¹è±¡ï¼Œä¸æ˜¯å¼•ç”¨ï¼Œè¿”å›çš„æ˜¯å³å€¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">MyString <span class="title">obj</span><span class="params">(<span class="string">&quot;CODspielen&quot;</span>)</span></span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;&amp;obj (å–åœ°å€) = &quot;</span> &lt;&lt; (<span class="type">void</span> *)&amp;obj &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> obj; <span class="comment">//å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œæ”¾åœ¨å†…å­˜ä¸­ä¸€ä¸ªä¸´æ—¶åŒºåŸŸå†…ï¼Œç”±æ—§å¯¹è±¡åˆå§‹åŒ–æ–°å¯¹è±¡ï¼Œæ‰€ä»¥è°ƒç”¨äº†æ‹·è´æ„é€ ï¼›</span></span><br><span class="line"><span class="comment">//è¿™é‡Œè¿”å›çš„å…¶å®æ˜¯ä¸´æ—¶åˆ›å»ºçš„å¯¹è±¡ï¼Œä¸æ˜¯objï¼›</span></span><br><span class="line"><span class="comment">//å¦‚æœä½¿ç”¨äº†ç§»åŠ¨æ„é€ ï¼Œè¿™é‡Œè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä¸è°ƒç”¨æ‹·è´æ„é€ ï¼›</span></span><br><span class="line"><span class="comment">//è¿”å›åï¼Œè°ƒç”¨ææ„å‡½æ•°ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">MyString s = <span class="built_in">func</span>(); <span class="comment">//ä¸´æ—¶å¯¹è±¡ç›´æ¥ç»™sï¼›</span></span><br><span class="line"><span class="comment">//è¿™é‡Œåšäº†ä¸€æ¬¡ä¼˜åŒ–ï¼Œå¦‚æœæ²¡ä¼˜åŒ–ï¼Œä¼šå†è°ƒç”¨ä¸€æ¬¡æ‹·è´æ„é€ ï¼Œå†è°ƒç”¨ä¸€æ¬¡ææ„ï¼›</span></span><br><span class="line"><span class="comment">//ä¼˜åŒ–å°±æ˜¯ç›´æ¥æŠŠä¸´æ—¶å¯¹è±¡ç»™åˆ°sï¼Œä¸å†ç»å†ä¸´æ—¶å˜é‡ï¼›</span></span><br><span class="line"><span class="comment">//å½“mainå‡½æ•°ç»“æŸåï¼Œsé‡Šæ”¾äº†ï¼Œå†è°ƒç”¨ææ„å‡½æ•°ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;&amp;s (å–åœ°å€) = &quot;</span> &lt;&lt; (<span class="type">void</span> *)&amp;s &lt;&lt; endl;</span><br><span class="line"><span class="comment">//åœ¨QTé‡Œï¼Œè¿™é‡ŒSçš„åœ°å€ä¼šç­‰äºobjçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯ä¸ä½¿ç”¨ä¸´æ—¶å˜é‡äº†ï¼Œæ‰€ä»¥åªä¼šè°ƒç”¨ä¸€æ¬¡æœ‰å‚æ„é€ ã€ä¸€æ¬¡ææ„ï¼Œ</span></span><br><span class="line"><span class="comment">//è€ŒVSé‡Œè¦è°ƒç”¨æ‹·è´æ„é€ å’Œå¦ä¸€æ¬¡ææ„ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¯å¦å¼€å¯è¿”å›å€¼ä¼˜åŒ–é€‰é¡¹ï¼šåœ¨cmdå‘½ä»¤è¡Œé‡Œæ·»åŠ è¯­å¥;</span></span><br><span class="line"><span class="comment">//g++ xxx.cpp -fno-elide-constructors -std = c++11</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">MyString &amp;&amp;s1 = <span class="built_in">func</span>(); <span class="comment">//å³å€¼å¼•ç”¨ï¼Œè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;&amp;s1 (å–åœ°å€) = &quot;</span> &lt;&lt; (<span class="type">void</span> *)&amp;s1 &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">MyString <span class="title">s2</span><span class="params">(<span class="string">&quot;CODplay&quot;</span>)</span></span>; <span class="comment">//å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">s2 = <span class="built_in">func</span>(); <span class="comment">//è°ƒç”¨èµ‹å€¼è¿ç®—ç¬¦ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;&amp;s2 (å–åœ°å€) = &quot;</span> &lt;&lt; (<span class="type">void</span> *)&amp;s2 &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="moveå’Œå®Œç¾è½¬å‘forward"><a href="#moveå’Œå®Œç¾è½¬å‘forward" class="headerlink" title="moveå’Œå®Œç¾è½¬å‘forward"></a>moveå’Œå®Œç¾è½¬å‘forward</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//moveå’Œå®Œç¾è½¬å‘forwardï¼š</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02_04</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">9</span>; <span class="comment">//aä¸ºå·¦å€¼</span></span><br><span class="line"><span class="comment">//int &amp;&amp;b = a; //error, ä¸èƒ½æŠŠä¸€ä¸ªå·¦å€¼èµ‹å€¼ç»™ä¸€ä¸ªå³å€¼å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> &amp;&amp;b = <span class="built_in">move</span>(a); <span class="comment">//è¿™æ ·å°±å¯ä»¥æŠŠå·¦å€¼aèµ‹å€¼ç»™å³å€¼bï¼Œå°†å·¦å€¼è½¬åŒ–æˆå³å€¼</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;b= &quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®Œç¾è½¬å‘forwardé€‚ç”¨äºï¼šéœ€è¦å°†ä¸€ç»„å‚æ•°åŸå°ä¸åŠ¨åœ°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œ</span></span><br><span class="line"><span class="comment">//åŒ…æ‹¬å‚æ•°å€¼ã€å·¦å³å€¼ã€æ˜¯å¦æ˜¯constï¼›</span></span><br><span class="line"><span class="comment">//å®Œç¾è½¬å‘è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰è¿™äº›å±æ€§éƒ½ä¸å˜ï¼ŒåŒæ—¶ä¸äº§ç”Ÿé¢å¤–çš„å¼€é”€ï¼›</span></span><br><span class="line"><span class="comment">//åœ¨æ³›å‹å‡½æ•°ä¸­ï¼Œè¿™æ ·çš„éœ€æ±‚éå¸¸æ™®éï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¼ ç»Ÿå†™æ³•ï¼Œéœ€è¦é‡è½½ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func02_01</span><span class="params">(<span class="type">const</span> T &amp;)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;const T &amp;&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func02_01</span><span class="params">(T &amp;)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;T &amp;&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func02_01</span><span class="params">(T &amp;&amp;)</span> <span class="comment">//è¿™é‡Œä¼šå‘ç”Ÿå¼•ç”¨æŠ˜å </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;T &amp;&amp;&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">forward_val</span><span class="params">(<span class="type">const</span> T &amp;tmp)</span> <span class="comment">//constç‰ˆæœ¬</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">func02_01</span>(tmp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">forward_val</span><span class="params">(T &amp;tmp)</span> <span class="comment">//æ™®é€šç‰ˆæœ¬</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">func02_01</span>(tmp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02_05</span><span class="params">()</span><span class="comment">//ä¼ ç»Ÿæ–¹æ³•ï¼Œéœ€è¦é‡è½½constå’Œæ™®é€šä¸¤ä¸ªç‰ˆæœ¬</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> &amp;b = <span class="number">1</span>;</span><br><span class="line">forward_val(a);<span class="comment">//å·¦å€¼</span></span><br><span class="line">forward_val(b);<span class="comment">//å³å€¼</span></span><br><span class="line">forward_val(<span class="number">12</span>);<span class="comment">//å³å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//c++ä¸­ï¼Œåˆ©ç”¨å¼•ç”¨æŠ˜å ï¼Œç»“åˆæ–°çš„æ¨¡æ¿æ¨å¯¼è§„åˆ’ï¼Œå¯ä»¥å®Œæˆå®Œç¾è½¬å‘ï¼›</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">const</span> <span class="type">int</span> T;</span><br><span class="line"><span class="keyword">typedef</span> T &amp; TR;</span><br><span class="line">TR &amp;v = <span class="number">1</span>;<span class="comment">//å¼•ç”¨æŠ˜å  //ç­‰äºæ˜¯const int &amp;&amp;v = 1;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//C++11å¼•ç”¨æŠ˜å è§„åˆ™ï¼š</span></span><br><span class="line"><span class="comment">//ä¸€æ—¦å®šä¹‰ä¸­å‡ºç°äº†å·¦ä¼ å¼•ç”¨ï¼Œå¼•ç”¨æŠ˜å æ€»æ˜¯å…ˆå°†å…¶æŠ˜å ä¸ºå·¦å€¼å¼•ç”¨</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">TRçš„ç±»å‹å®šä¹‰å£°æ˜vçš„ç±»å‹vçš„å®é™…ç±»å‹</span></span><br><span class="line"><span class="comment">T &amp;TRT &amp;</span></span><br><span class="line"><span class="comment">T &amp;TR &amp;T &amp;</span></span><br><span class="line"><span class="comment">T &amp;TR &amp;&amp;T &amp;</span></span><br><span class="line"><span class="comment">T &amp;&amp;TRT &amp;&amp;</span></span><br><span class="line"><span class="comment">T &amp;&amp;TR &amp;T &amp;</span></span><br><span class="line"><span class="comment">T &amp;&amp;TR &amp;&amp;T &amp;&amp;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//forwardå†™æ³•ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">forward_val1</span><span class="params">(T &amp;&amp;tmp)</span> <span class="comment">//å³å€¼å¼•ç”¨ //åªéœ€è¦å†™ä¸€ä¸ªï¼Œä¸éœ€è¦é‡è½½</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">func02_01</span>(forward&lt;T&gt;(tmp));<span class="comment">//ä¿æŒåŸå‚æ•°tmpçš„å·¦å³å€¼å±æ€§</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02_06</span><span class="params">()</span><span class="comment">//ä¼ ç»Ÿæ–¹æ³•ï¼Œéœ€è¦é‡è½½constå’Œæ™®é€šä¸¤ä¸ªç‰ˆæœ¬</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> &amp;b = <span class="number">1</span>;</span><br><span class="line">forward_val1(a);<span class="comment">//å·¦å€¼</span></span><br><span class="line">forward_val1(b);<span class="comment">//å³å€¼</span></span><br><span class="line">forward_val1(<span class="number">12</span>);<span class="comment">//å³å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸš©æ™ºèƒ½æŒ‡é’ˆ"><a href="#ğŸš©æ™ºèƒ½æŒ‡é’ˆ" class="headerlink" title="ğŸš©æ™ºèƒ½æŒ‡é’ˆ"></a>ğŸš©æ™ºèƒ½æŒ‡é’ˆ</h2><p>C++11ä¸­æœ‰<code>unique_ptr</code>, <code>shared_ptr</code>, <code>weak_ptr</code>ç­‰æ™ºèƒ½æŒ‡é’ˆï¼Œå®šä¹‰åœ¨<code>&lt;memory&gt;</code>ä¸­ï¼›<br>å¯ä»¥å¯¹åŠ¨æ€èµ„æºè¿›è¡Œç®¡ç†ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå·²æ„é€ çš„å¯¹è±¡ä¼šé”€æ¯ï¼Œå³å®ƒçš„ææ„å‡½æ•°æœ€ç»ˆä¼šè¢«è°ƒç”¨ã€‚</p><h3 id="unique-ptr"><a href="#unique-ptr" class="headerlink" title="unique_ptr"></a>unique_ptr</h3><ul><li><code>unique_ptr</code> æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œåˆ›å»ºçš„æ˜¯<font color="#2DC26B">å¯¹è±¡</font>ï¼Œä¸ç”¨åŠ  <code>*</code>ã€‚</li><li>æŒæœ‰å¯¹å¯¹è±¡çš„<font color="#2DC26B">ç‹¬æœ‰æƒ</font>ï¼ŒåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ª <code>unique_ptr</code> ç»‘å®šç»™å®šçš„å¯¹è±¡ï¼ˆé€šè¿‡ç¦æ­¢æ‹·è´è¯­ä¹‰ï¼Œåªç”¨ç§»åŠ¨è¯­ä¹‰ <code>move</code> æ¥å®ç°ï¼‰ã€‚</li><li><code>unique_ptr</code> ç”Ÿå‘½å‘¨æœŸï¼š<font color="#2DC26B">ä»æŒ‡é’ˆåˆ›å»ºå¼€å§‹ï¼Œç›´åˆ°ç¦»å¼€ä½œç”¨åŸŸå°±é‡Šæ”¾</font>ã€‚</li><li>ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œè‹¥å…¶æŒ‡å‘å¯¹è±¡ï¼Œåˆ™è¿™ä¸ªå¯¹è±¡è¢«é”€æ¯ï¼Œé»˜è®¤ä½¿ç”¨ <code>delete</code> æ“ä½œï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–æ“ä½œã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">test03_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">unique_ptr&lt;<span class="type">int</span>&gt; <span class="title">up1</span><span class="params">(<span class="keyword">new</span> <span class="type">int</span>(<span class="number">11</span>))</span></span>;<span class="comment">//åˆ›å»ºæ™ºèƒ½æŒ‡é’ˆå¯¹è±¡up1ï¼ŒæŒ‡å‘newå‡ºæ¥çš„å †åŒºç©ºé—´ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*up1= &quot;</span> &lt;&lt; *up1 &lt;&lt; endl; <span class="comment">//11 //é‡è½½äº†operator*()ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//unique_ptr&lt;int&gt; up2 = up1; //åŸæ¥è¦ç”¨æ‹·è´æ„é€ ï¼Œä½†æ˜¯ä½¿ç”¨äº†æ™ºèƒ½æŒ‡é’ˆåï¼Œup1å°±æ˜¯å”¯ä¸€çš„èƒ½æŒ‡å‘å †åŒºè¿™å—ç©ºé—´çš„æŒ‡é’ˆï¼Œè‡ªåŠ¨ç¦ç”¨äº†æ‹·è´æ„é€ ï¼Œä¸èƒ½æ‹·è´ä¸€ä¸ªup2ä¹ŸæŒ‡å‘è¿™å—ç©ºé—´ï¼›</span></span><br><span class="line">unique_ptr&lt;<span class="type">int</span>&gt; up2 = <span class="built_in">move</span>(up1); <span class="comment">//ä½†æ˜¯å¯ä»¥ä½¿ç”¨ç§»åŠ¨æ„é€ ï¼Œç›¸å½“äºæŠŠè¿™å—å†…å­˜ç»™äº†up2æŒ‡é’ˆï¼Œè€Œup1å°±ä¸èƒ½å†ä½¿ç”¨äº†ï¼Œè¿˜æ˜¯æœ‰å”¯ä¸€æ€§çš„ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*up2= &quot;</span> &lt;&lt; *up2 &lt;&lt; endl;</span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;*up1= &quot; &lt;&lt; *up1 &lt;&lt; endl;//è½¬ç§»ç»™up2åï¼Œup1å°±å˜æˆé‡æŒ‡é’ˆäº†ï¼Œä¸èƒ½å†ä½¿ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test03_01</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">~<span class="built_in">Test03_01</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ææ„å‡½æ•°çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test03_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">unique_ptr&lt;Test03_01&gt; <span class="title">up3</span><span class="params">(<span class="keyword">new</span> Test03_01)</span></span>; <span class="comment">//æ— éœ€æ‰‹åŠ¨é‡Šæ”¾</span></span><br><span class="line">up3 = <span class="literal">nullptr</span>; <span class="comment">//ä¹Ÿå¯ä»¥æ‰‹åŠ¨é‡Šæ”¾ï¼Œç›´æ¥æŒ‡å‘ç©ºï¼›</span></span><br><span class="line">up3.<span class="built_in">reset</span>();<span class="comment">//æ‰‹åŠ¨é‡Šæ”¾ï¼Œç”¨reset()å®ç°ï¼›//å¯ä»¥è¿ç»­æ‰‹åŠ¨é‡Šæ”¾å¤šæ¬¡ï¼Œåªä¼šææ„ä¸€æ¬¡ï¼Œä¸ä¼šå‡ºç°å¤šæ¬¡é‡Šæ”¾åŒä¸€ä¸ªç©ºé—´</span></span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"><span class="comment">//å¦‚æœæ˜¯è‡ªåŠ¨é‡Šæ”¾ï¼Œåœ¨è¿™é‡Œè¦ç¦»å¼€è¿™ä¸ªä½œç”¨åŸŸäº†ï¼Œæ­¤æ—¶æ‰ä¼šè°ƒç”¨ææ„å‡½æ•°ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test03_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">unique_ptr&lt;<span class="type">int</span>&gt; <span class="title">up1</span><span class="params">(<span class="keyword">new</span> <span class="type">int</span>(<span class="number">11</span>))</span></span>;</span><br><span class="line">up1.<span class="built_in">reset</span>();<span class="comment">//å¦‚æœæ˜¯æ— å‚ï¼Œä½œç”¨æ˜¯æ˜¾å¼é‡Šæ”¾å †åŒºå†…å­˜</span></span><br><span class="line">up1.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">int</span>(<span class="number">22</span>)); <span class="comment">//å¦‚æœæœ‰å‚ï¼Œå°±æ˜¯å…ˆé‡Šæ”¾åŸæ¥çš„å†…å­˜ï¼Œå†é‡æ–°ç»™up1ç»‘å®šä¸€å—æ–°çš„å †åŒºå†…å­˜ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*up1= &quot;</span> &lt;&lt; *up1 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> *p = up1.<span class="built_in">release</span>();<span class="comment">//é‡Šæ”¾æ§åˆ¶æƒï¼Œä½†ä¸é‡Šæ”¾å †åŒºå†…å­˜ï¼Œå°±æ˜¯æŠŠè¿™å—å†…å­˜ç»™åˆ°*pï¼Œup1å°±ä¸å†æœ‰æ§åˆ¶æƒäº†ï¼Œå°±å˜æˆé‡æŒ‡é’ˆäº†ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*p= &quot;</span> &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line"><span class="keyword">delete</span> p;<span class="comment">//*pä¸æ˜¯æ™ºèƒ½æŒ‡é’ˆï¼Œéœ€è¦æ‰‹åŠ¨é‡Šæ”¾äº†ï¼›</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="shared-ptr"><a href="#shared-ptr" class="headerlink" title="shared_ptr"></a>shared_ptr</h3><blockquote><p>å’Œ <code>unique_ptr</code> ç›¸åï¼Œ<code>shared_ptr</code> å…è®¸å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆçš„å¯¹è±¡<font color="#2DC26B">å…±äº«åŒä¸€å—å †åŒº</font>åˆ†é…çš„å†…å­˜ï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°å®ç°ã€‚<br>å¦‚æœæœ€åä¸€ä¸ªè¿™æ ·çš„æŒ‡é’ˆè¢«é”€æ¯ï¼Œä¹Ÿå°±æ˜¯è®¡æ•°å˜æˆ 0ï¼Œè¿™ä¸ªå¯¹è±¡æ‰ä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">test03_04</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">shared_ptr&lt;<span class="type">int</span>&gt; <span class="title">sp1</span><span class="params">(<span class="keyword">new</span> <span class="type">int</span>(<span class="number">8</span>))</span></span>;</span><br><span class="line">shared_ptr&lt;<span class="type">int</span>&gt; sp2 = sp1; <span class="comment">//å¯ä»¥è°ƒç”¨æ‹·è´æ„é€ ï¼Œsp2å’Œsp1éƒ½ç»‘å®šå †åŒºç©ºé—´ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è®¡æ•°å™¨1 = &quot;</span> &lt;&lt; sp1.<span class="built_in">use_count</span>() &lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨2 = &quot;</span> &lt;&lt; sp2.<span class="built_in">use_count</span>() &lt;&lt; endl; <span class="comment">//2  2</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*sp1 = &quot;</span> &lt;&lt; *sp1 &lt;&lt; <span class="string">&quot;  *sp2 = &quot;</span> &lt;&lt; *sp2 &lt;&lt; endl; <span class="comment">//8  8</span></span><br><span class="line"></span><br><span class="line">sp1.<span class="built_in">reset</span>();<span class="comment">//sp1è¢«é‡Šæ”¾ï¼Œåªæ˜¯é‡Šæ”¾sp1å’Œå †åŒºç©ºé—´çš„ç»‘å®šï¼Œè®¡æ•°å™¨å‡1ï¼Œåªè¦æ²¡æœ‰åˆ°0ï¼Œå †åŒºç©ºé—´å°±ä¸ä¼šè¢«é‡Šæ”¾ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è®¡æ•°å™¨1 = &quot;</span> &lt;&lt; sp1.<span class="built_in">use_count</span>() &lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨2 = &quot;</span> &lt;&lt; sp2.<span class="built_in">use_count</span>() &lt;&lt; endl; <span class="comment">//0  1</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*sp2 = &quot;</span> &lt;&lt; *sp2 &lt;&lt; endl; <span class="comment">//8</span></span><br><span class="line"></span><br><span class="line">sp2.<span class="built_in">reset</span>();<span class="comment">//sp1è¢«é‡Šæ”¾ï¼Œè®¡æ•°å™¨å‡åˆ°0ï¼Œå †åŒºç©ºé—´ä¹Ÿè¢«é‡Šæ”¾</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è®¡æ•°å™¨1 = &quot;</span> &lt;&lt; sp1.<span class="built_in">use_count</span>() &lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨2 = &quot;</span> &lt;&lt; sp2.<span class="built_in">use_count</span>() &lt;&lt; endl; <span class="comment">//0  0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="weak-ptr"><a href="#weak-ptr" class="headerlink" title="weak_ptr"></a>weak_ptr</h3><ul><li>é…åˆ <code>shared_ptr</code> ä½¿ç”¨ï¼Œå¯ä»¥ä»ä¸€ä¸ª <code>shared_ptr</code> æˆ–è€…å¦ä¸€ä¸ª <code>weak_ptr</code> å¯¹è±¡æ„é€ ï¼Œå®ƒçš„æ„é€ å’Œææ„<font color="#2DC26B">ä¸ä¼šå¼•èµ·å¼•ç”¨è®¡æ•°çš„å˜åŒ–</font>ã€‚</li><li>æ²¡æœ‰é‡è½½ <code>*</code> å’Œ <code>-&gt;</code>ï¼Œä½†å¯ä»¥ä½¿ç”¨ <code>lock</code> è·å¾—ä¸€ä¸ªå¯ç”¨çš„ <code>shared_ptr</code> å¯¹è±¡ã€‚</li><li><code>weak_ptr</code> å¯ä»¥æŒ‡å‘ <code>shared_ptr</code> æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯<font color="#2DC26B">å¹¶ä¸æ‹¥æœ‰è¯¥å†…å­˜</font>ã€‚</li><li>å¦‚æœä½¿ç”¨ <code>weak_ptr</code> çš„æˆå‘˜å‡½æ•° <code>lock</code>ï¼Œåˆ™å¯ä»¥è¿”å›å…¶æŒ‡å‘å†…å­˜çš„ä¸€ä¸ª <code>shared_ptr</code> å¯¹è±¡ï¼Œä¸”åœ¨æ‰€æŒ‡å‘å†…å­˜å·²ç»æ— æ•ˆæ—¶ï¼Œè¿”å›ç©ºå€¼ <code>nullptr</code>ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">test03_05</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">shared_ptr&lt;<span class="type">int</span>&gt; <span class="title">sp1</span><span class="params">(<span class="keyword">new</span> <span class="type">int</span>(<span class="number">6</span>))</span></span>;</span><br><span class="line">shared_ptr&lt;<span class="type">int</span>&gt; sp2 = sp1; <span class="comment">//2ä¸ªæŒ‡é’ˆå˜é‡ç»‘å®šåŒä¸€å—å†…å­˜</span></span><br><span class="line">weak_ptr&lt;<span class="type">int</span>&gt; wp = sp1; <span class="comment">//3ä¸ªæŒ‡é’ˆå˜é‡ç»‘å®šåŒä¸€å—å†…å­˜</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è®¡æ•°å™¨1 = &quot;</span> &lt;&lt; sp1.<span class="built_in">use_count</span>() </span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨2 = &quot;</span> &lt;&lt; sp2.<span class="built_in">use_count</span>() </span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨3 = &quot;</span> &lt;&lt; wp.<span class="built_in">use_count</span>() &lt;&lt; endl; <span class="comment">//2  2  2 //wpä¸ç»‘å®šå †åŒºå†…å­˜ï¼Œæ‰€ä»¥åªæœ‰2ä¸ªè®¡æ•°å™¨</span></span><br><span class="line"></span><br><span class="line">shared_ptr&lt;<span class="type">int</span>&gt; sp3 = wp.<span class="built_in">lock</span>(); <span class="comment">//ä½¿ç”¨lockè·å¾—ä¸€ä¸ªå¯ç”¨çš„shared_ptrå¯¹è±¡</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è®¡æ•°å™¨1 = &quot;</span> &lt;&lt; sp1.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨2 = &quot;</span> &lt;&lt; sp2.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨3 = &quot;</span> &lt;&lt; wp.<span class="built_in">use_count</span>() </span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨4 = &quot;</span> &lt;&lt; sp3.<span class="built_in">use_count</span>() &lt;&lt; endl; <span class="comment">//3  3  3  3</span></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*sp1 = &quot;</span> &lt;&lt; *sp1 &lt;&lt; <span class="string">&quot;  *sp2 = &quot;</span> &lt;&lt; *sp2 &lt;&lt; <span class="string">&quot;  *sp3 = &quot;</span> &lt;&lt; *sp3  &lt;&lt; endl; <span class="comment">//6  6  6</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;*wp = &quot; &lt;&lt; *wp &lt;&lt; endl; //wpæ²¡æœ‰å’Œå †åŒºå†…å­˜ç»‘å®šï¼Œä¸èƒ½ç”¨wpæ“ä½œå†…å­˜ï¼›</span></span><br><span class="line"></span><br><span class="line">sp1.<span class="built_in">reset</span>();</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è®¡æ•°å™¨1 = &quot;</span> &lt;&lt; sp1.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨2 = &quot;</span> &lt;&lt; sp2.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨3 = &quot;</span> &lt;&lt; wp.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨4 = &quot;</span> &lt;&lt; sp3.<span class="built_in">use_count</span>() &lt;&lt; endl; <span class="comment">//0  2  2  2</span></span><br><span class="line"></span><br><span class="line">sp2.<span class="built_in">reset</span>();</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è®¡æ•°å™¨1 = &quot;</span> &lt;&lt; sp1.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨2 = &quot;</span> &lt;&lt; sp2.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨3 = &quot;</span> &lt;&lt; wp.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨4 = &quot;</span> &lt;&lt; sp3.<span class="built_in">use_count</span>() &lt;&lt; endl; <span class="comment">//0  0  1  1</span></span><br><span class="line"></span><br><span class="line">sp3.<span class="built_in">reset</span>();</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è®¡æ•°å™¨1 = &quot;</span> &lt;&lt; sp1.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨2 = &quot;</span> &lt;&lt; sp2.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨3 = &quot;</span> &lt;&lt; wp.<span class="built_in">use_count</span>()</span><br><span class="line">&lt;&lt; <span class="string">&quot;  è®¡æ•°å™¨4 = &quot;</span> &lt;&lt; sp3.<span class="built_in">use_count</span>() &lt;&lt; endl; <span class="comment">//0  0  0  0</span></span><br><span class="line"></span><br><span class="line">wp.<span class="built_in">reset</span>();<span class="comment">//ä¸Šè¿°æ“ä½œå·²ç»å¯ä»¥ä½¿å¾—å †åŒºç©ºé—´è¢«é‡Šæ”¾ï¼Œè¿™é‡Œå¯åŠ ä¹Ÿå¯ä¸åŠ ï¼›</span></span><br><span class="line"></span><br><span class="line">shared_ptr&lt;<span class="type">int</span>&gt; tmp = wp.<span class="built_in">lock</span>(); <span class="comment">//å¦‚æœå †åŒºç©ºé—´å·²ç»é‡Šæ”¾ï¼Œåˆ™ç”¨wp.lock()åˆ›å»ºçš„å¯¹è±¡è¿”å›nullptrï¼›</span></span><br><span class="line"><span class="keyword">if</span> (tmp == <span class="literal">nullptr</span>)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å †åŒºç©ºé—´å·²ç»é‡Šæ”¾&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h2><blockquote><p>é—­åŒ…å®šä¹‰ï¼šå¸¦æœ‰<font color="#00b0f0">ä¸Šä¸‹æ–‡</font>çš„å‡½æ•°ï¼Œæœ‰<font color="#00b0f0">çŠ¶æ€</font>çš„å‡½æ•°ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª<font color="#00b0f0">ç±»</font>ã€‚</p></blockquote><ul><li>å¸¦æœ‰çŠ¶æ€ï¼Œå³<font color="#2DC26B">æ‹¥æœ‰è‡ªå·±çš„å˜é‡</font>ï¼Œè€Œä¸æ˜¯å…¨å±€å˜é‡ï¼Œä¹Ÿä¸æ˜¯ä¼ è¿›æ¥çš„å˜é‡ã€‚</li><li>å‡½æ•°å’ŒçŠ¶æ€æ†ç»‘ï¼Œå°±å½¢æˆäº†é—­åŒ…ã€‚</li><li>é—­åŒ…çš„çŠ¶æ€æ†ç»‘ï¼Œå¿…é¡»å‘ç”Ÿåœ¨<font color="#00b050">è¿è¡Œæ—¶</font>ã€‚</li><li>é—­åŒ…çš„å®ç°ï¼š<font color="#00b050">ä»¿å‡½æ•°ã€bind ç»‘å®šå™¨ã€Lambda è¡¨è¾¾å¼</font>ã€‚<h3 id="ä»¿å‡½æ•°"><a href="#ä»¿å‡½æ•°" class="headerlink" title="ä»¿å‡½æ•°"></a>ä»¿å‡½æ•°</h3>ä»¿å‡½æ•° <code>functor</code> ï¼ˆä¸æ˜¯ C++11 çš„æ–°å†…å®¹ï¼‰å°±æ˜¯ä½¿ä¸€ä¸ªç±»çš„ä½¿ç”¨çœ‹ä¸Šå»åƒä¸€ä¸ªå‡½æ•°ï¼Œå…¶å®ç°å°±æ˜¯åœ¨ç±»ä¸­å®ç°ä¸€ä¸ª <code>operator()</code>ï¼Œè¿™ä¸ªç±»å°±æœ‰äº†ç±»ä¼¼çš„å‡½æ•°è¡Œä¸ºï¼Œå°±æ˜¯ä¸€ä¸ªä»¿å‡½æ•°ç±»äº†ã€‚<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyFunc</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">MyFunc</span>(<span class="type">int</span> i) :<span class="built_in">r</span>(i) <span class="comment">//æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> tmp)</span> <span class="comment">//ä»¿å‡½æ•°ï¼Œé‡è½½operator()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> tmp + r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> <span class="comment">//ä»¿å‡½æ•°ï¼Œé‡è½½operator()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (a &gt; b &amp;&amp; b &gt; r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">int</span> r; <span class="comment">//classè‡ªå·±å¸¦çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯æœ‰çŠ¶æ€</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">MyFunc <span class="title">obj</span><span class="params">(<span class="number">8</span>)</span></span>;<span class="comment">//åˆ›å»ºå˜é‡ï¼Œå¹¶ä¸”ç»™rèµ‹å€¼</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">obj</span>(<span class="number">5</span>) &lt;&lt; endl; <span class="comment">//return 5 + 8</span></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="built_in">obj</span>(<span class="number">23</span>, <span class="number">44</span>) &lt;&lt; endl; <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="built_in">obj</span>(<span class="number">77</span>, <span class="number">44</span>) &lt;&lt; endl; <span class="comment">//true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="function-ä¸-bind-çš„ä½¿ç”¨"><a href="#function-ä¸-bind-çš„ä½¿ç”¨" class="headerlink" title="function ä¸ bind çš„ä½¿ç”¨"></a>function ä¸ bind çš„ä½¿ç”¨</h3><h4 id="function"><a href="#function" class="headerlink" title="function"></a>function</h4></li><li>C++ä¸­ï¼Œå¯è°ƒç”¨çš„å®ä½“ä¸»è¦åŒ…æ‹¬ï¼šå‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¼•ç”¨ã€å¯éšå¼è½¬æ¢ä¸ºå‡½æ•°æŒ‡å®šçš„å¯¹è±¡ï¼Œæˆ–è€…å®ç°äº† <code>operator()</code> çš„å¯¹è±¡ã€‚</li><li>C++11 ä¸­ï¼Œæ–°å¢äº† <code>std::function</code> ç±»æ¨¡æ¿ï¼ˆå¤´æ–‡ä»¶ <code>&lt;functional&gt;</code>ï¼‰ï¼Œæ˜¯å¯¹ C++ä¸­æ‰€æœ‰å¯è°ƒç”¨å®ä½“çš„ä¸€ç§æ¡ˆä¾‹ç±»å‹çš„æ‰“åŒ…ã€‚</li><li>é€šè¿‡æŒ‡å®šå‚æ•°æ¨¡æ¿ï¼Œå¯ä»¥ç»Ÿä¸€å¤„ç†å‡½æ•°ã€å‡½æ•°å¯¹è±¡ã€å‡½æ•°æŒ‡é’ˆï¼Œå¹¶å…è®¸ä¿å­˜å’Œå»¶è¿Ÿæ‰§è¡Œå®ƒä»¬ã€‚</li><li><code>function</code> å¯¹è±¡æœ€å¤§çš„ä½œç”¨ï¼šå®ç°å‡½æ•°å›è°ƒï¼Œä½†æ˜¯ä¸èƒ½ç”¨æ¥æ£€æŸ¥ç›¸ç­‰/ä¸ç›¸ç­‰ï¼Œä¸è¿‡å¯ä»¥ä¸ <code>NULL</code> / <code>nullptr</code> æ¯”è¾ƒã€‚</li><li>æ ¼å¼ <code>function&lt;void(int)&gt;</code> è¡¨ç¤ºè¿”å›ç±»å‹ä¸º voidï¼Œæ¥å—ä¸€ä¸ª int å‚æ•°çš„å¯è°ƒç”¨å¯¹è±¡ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ™®é€šå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func04_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt;  __func__ &lt;&lt; <span class="string">&quot;çš„è°ƒç”¨&quot;</span> &lt;&lt; endl; <span class="comment">//__func__å°±æ˜¯è¾“å‡ºå‡½æ•°å</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»ä¸­é™æ€å‡½æ•°</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test41</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">test_func</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; __func__ &lt;&lt; <span class="string">&quot;çš„è°ƒç”¨ï¼Œ&quot;</span> &lt;&lt; a &lt;&lt;  endl;;</span><br><span class="line"><span class="keyword">return</span> a * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»¿å‡½æ•°</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test42</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; __func__ &lt;&lt; <span class="string">&quot;çš„è°ƒç”¨ï¼Œ&quot;</span> &lt;&lt; a &lt;&lt; endl;;</span><br><span class="line"><span class="keyword">return</span> a * <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">function&lt;<span class="type">void</span>(/*æ²¡å‚æ•°å°±ä¸ç”¨å†™ï¼Œæˆ–è€…å†™<span class="type">void</span>; */)&gt; f1 = func04_01; <span class="comment">//åˆ›å»ºfunctionå¯¹è±¡ï¼Œå’Œå¯è°ƒç”¨çš„å®ä½“ç»‘å®šï¼Œè¿™é‡Œç»‘å®šæ™®é€šå‡½æ•°</span></span><br><span class="line"><span class="built_in">f1</span>(); <span class="comment">//ç­‰ä»·äºç›´æ¥è°ƒç”¨func04_01();</span></span><br><span class="line"></span><br><span class="line">function &lt;<span class="type">int</span>(<span class="type">int</span>)&gt; f2 = Test41::test_func; <span class="comment">//ç»‘å®šç±»å†…é™æ€å‡½æ•°ï¼›//é™æ€å‡½æ•°æ‰å¯ä»¥ç›´æ¥è¿™æ ·å†™ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">f2</span>(<span class="number">19</span>) &lt;&lt; endl;; <span class="comment">//ç­‰ä»·äºç›´æ¥è°ƒç”¨Test41::test_func();</span></span><br><span class="line"></span><br><span class="line">Test42 obj;</span><br><span class="line">function&lt;<span class="type">int</span>(<span class="type">int</span>)&gt; f3 = obj; <span class="comment">//ç»‘å®šä»¿å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ç»‘å®šå¯¹è±¡ï¼Œå› ä¸ºä»¿å‡½æ•°æœ¬èº«è°ƒç”¨æ˜¯obj()ï¼Œç›¸å½“äºå‡½æ•°åï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">f3</span>(<span class="number">7</span>) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>ğŸ¤”æ³¨ï¼šå¯è°ƒç”¨å®ä½“</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">myFunction</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">myFunction</span>(<span class="number">10</span>); <span class="comment">// ç›´æ¥è°ƒç”¨å‡½æ•°</span></span><br></pre></td></tr></table></figure><ol><li><strong>å‡½æ•°æŒ‡é’ˆ</strong>ï¼š<br>å‡½æ•°æŒ‡é’ˆæ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥è°ƒç”¨å‡½æ•°ã€‚å‡½æ•°æŒ‡é’ˆçš„ç±»å‹å¿…é¡»ä¸ç›®æ ‡å‡½æ•°çš„ç±»å‹ç›¸åŒ¹é…ã€‚</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">void</span> (*funcPtr)(<span class="type">int</span>) = myFunction;<span class="comment">// voidä¸ºè¿”å›ç±»å‹ï¼Œintä¸ºæ¥æ”¶å‚æ•°ç±»å‹</span></span><br><span class="line"><span class="built_in">funcPtr</span>(<span class="number">10</span>); <span class="comment">// é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°</span></span><br></pre></td></tr></table></figure><ol><li><strong>å‡½æ•°å¼•ç”¨</strong>ï¼š<br>å‡½æ•°å¼•ç”¨æ˜¯å‡½æ•°çš„åˆ«åï¼Œå¯ä»¥é€šè¿‡å‡½æ•°å¼•ç”¨æ¥è°ƒç”¨å‡½æ•°ã€‚å‡½æ•°å¼•ç”¨<font color="#00b050">åœ¨å£°æ˜æ—¶å¿…é¡»åˆå§‹åŒ–</font>ï¼Œå¹¶ä¸”<font color="#00b050">ä¸èƒ½æ›´æ”¹å¼•ç”¨ç›®æ ‡</font>ã€‚</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">void</span> (&amp;funcRef)(<span class="type">int</span>) = myFunction;</span><br><span class="line"><span class="built_in">funcRef</span>(<span class="number">10</span>); <span class="comment">// é€šè¿‡å‡½æ•°å¼•ç”¨è°ƒç”¨å‡½æ•°</span></span><br></pre></td></tr></table></figure><ol><li><strong>å¯éšå¼è½¬æ¢ä¸ºå‡½æ•°æŒ‡é’ˆçš„å¯¹è±¡ï¼š</strong><br>æŸäº›å¯¹è±¡å¯ä»¥éšå¼è½¬æ¢ä¸ºå‡½æ•°æŒ‡é’ˆï¼Œä¾‹å¦‚é€šè¿‡ <code>std::function</code> æˆ– <code>std::mem_fn</code> åŒ…è£…çš„å‡½æ•°å¯¹è±¡ã€‚</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::function&lt;<span class="type">void</span>(<span class="type">int</span>)&gt; funcObj = myFunction;</span><br><span class="line"><span class="built_in">funcObj</span>(<span class="number">10</span>); <span class="comment">// é€šè¿‡std::functionå¯¹è±¡è°ƒç”¨å‡½æ•°</span></span><br></pre></td></tr></table></figure><ol><li><strong>å®ç°äº† <code>operator()</code> çš„å¯¹è±¡</strong>ï¼š<br>è¿™äº›å¯¹è±¡è¢«ç§°ä¸ºå‡½æ•°å¯¹è±¡æˆ–ä»¿å‡½æ•°ï¼ˆFunctorï¼‰ã€‚å®ƒä»¬é€šè¿‡é‡è½½ <code>operator()</code> æ¥å®ç°ç±»ä¼¼å‡½æ•°è°ƒç”¨çš„è¡Œä¸ºã€‚</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">MyFunctor</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å‡½æ•°å¯¹è±¡çš„å®ç°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">MyFunctor functor;</span><br><span class="line"><span class="built_in">functor</span>(<span class="number">10</span>); <span class="comment">// é€šè¿‡å‡½æ•°å¯¹è±¡è°ƒç”¨</span></span><br></pre></td></tr></table></figure><h4 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h4><ul><li>é¢„å…ˆæŠŠå¯è°ƒç”¨å®ä½“çš„æŸäº›å‚æ•°ç»‘å®šåˆ°å·²æœ‰çš„å˜é‡ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„å¯è°ƒç”¨å®ä½“ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­å¸¸ç”¨ã€‚</li><li>C++11 ä¸­ï¼Œ<code>bind</code> çš„å‚æ•°ä¸ªæ•°ä¸å—é™ï¼Œç»‘å®šå…·ä½“å“ªäº›å‚æ•°ä¹Ÿä¸å—é™ï¼Œç”±ç”¨æˆ·æŒ‡å®šï¼Œéå¸¸çµæ´»ã€‚ç»‘å®šçš„å‚æ•°å¯ä»¥æ˜¯å ä½ç¬¦ï¼ˆæ¯”å¦‚ <code>placeholder::_2</code>ï¼‰</li><li>åŒæ ·åœ¨å¤´æ–‡ä»¶ <code>&lt;functional&gt;</code> ä¸­ï¼ŒåŸºæœ¬è¯­æ³•ä¸º <code>std::bind(callable, arg1, arg2, ..., argN)</code>ï¼Œå…¶ä¸­ <code>callable</code> è¡¨ç¤ºå¯è°ƒç”¨å¯¹è±¡ï¼Œå‡½æ•°è¿”å›ç±»å‹ä¸º <code>function&lt;RetType&gt;(ArgsType)</code></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">func04_02</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">bind</span>(func04_02, <span class="number">11</span>, <span class="number">22</span>)(<span class="comment">/*è¿™é‡Œé¢å¯ä»¥é¢å¤–ä¼ å‚ï¼Œä¹Ÿå¯ä»¥ä¸åŠ */</span>); <span class="comment">//11 22 //æŠŠfunc04_02å’Œ11ï¼Œ22ç»‘å®šï¼Œç­‰ä»·äºç›´æ¥è°ƒç”¨func04_02(11, 22)ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">bind</span>(func04_02, placeholders::_1, placeholders::_2)(<span class="number">5</span>, <span class="number">6</span>); <span class="comment">//5 6 //placeholders::_1ï¼Œå ä½ç¬¦ï¼Œè°ƒç”¨å‡½æ•°æ—¶ï¼Œè¢«åé¢æ‹¬å·ä¸­çš„ç¬¬1ä¸ªå‚æ•°æ›¿æ¢</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//placeholders::å†™èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œä½¿ç”¨å‘½åç©ºé—´ï¼Œusing namespace placeholders; //å†™åœ¨å¤´æ–‡ä»¶å¤„</span></span><br><span class="line"><span class="built_in">bind</span>(func04_02, _1, _2)(<span class="number">17</span>, <span class="number">18</span>); <span class="comment">//17 18 //è¿™æ ·å°±å¯ä»¥ç›´æ¥å†™_1, _2 </span></span><br><span class="line"><span class="built_in">bind</span>(func04_02, <span class="number">33</span>, _3)(<span class="number">77</span>, <span class="number">88</span>, <span class="number">44</span>, <span class="number">55</span>); <span class="comment">//33 44 //_3æ˜¯å ä½ç¬¦ï¼Œå…ˆå ä½ï¼Œä¼šè¢«åé¢æ‹¬å·ä¸­çš„ç¬¬3ä¸ªå‚æ•°æ›¿æ¢ </span></span><br><span class="line"><span class="built_in">bind</span>(func04_02, _2, _1)(<span class="number">99</span>, <span class="number">77</span>); <span class="comment">//77 99</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//bindä¸functionç»“åˆä½¿ç”¨ï¼š</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test43</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span><span class="comment">//éé™æ€æˆå‘˜å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;x = &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;ï¼Œy = &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a; <span class="comment">//æˆå‘˜å˜é‡</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> placeholder;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_04</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//ç»‘å®šéé™æ€æˆå‘˜å‡½æ•°ï¼š</span></span><br><span class="line">Test43 obj; <span class="comment">//éœ€è¦å…ˆåˆ›å»ºå¯¹è±¡ï¼Œè€Œé™æ€æˆå‘˜å‡½æ•°ä¸éœ€è¦åˆ›å»ºå¯¹è±¡ï¼›</span></span><br><span class="line">function&lt;<span class="type">void</span>(<span class="type">int</span>, <span class="type">int</span>)&gt; f1 = <span class="built_in">bind</span>(&amp;Test43::func, &amp;obj, _1, _2); <span class="comment">//bindç»‘å®šæˆå‘˜å‡½æ•°åï¼Œä¼ ç»™functionç»‘å®š</span></span><br><span class="line"><span class="built_in">f1</span>(<span class="number">98</span>, <span class="number">87</span>);<span class="comment">// x = 98, y = 87// ç›¸å½“äºè°ƒç”¨obj.func(98, 87);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»‘å®šæˆå‘˜å˜é‡ï¼š</span></span><br><span class="line">function&lt;<span class="type">int</span>&amp; ()&gt; f2 = <span class="built_in">bind</span>(&amp;Test43::a, &amp;obj); <span class="comment">//bindç»‘å®šå˜é‡åï¼Œä¼ ç»™functionç»‘å®š</span></span><br><span class="line"><span class="built_in">f2</span>() = <span class="number">111</span>; <span class="comment">//ç­‰ä»·äºobj.a = 111;</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;obj.a = &quot;</span> &lt;&lt; obj.a &lt;&lt; endl; <span class="comment">// obj.a = 111</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ğŸš©Lambda-è¡¨è¾¾å¼"><a href="#ğŸš©Lambda-è¡¨è¾¾å¼" class="headerlink" title="ğŸš©Lambda è¡¨è¾¾å¼"></a>ğŸš©Lambda è¡¨è¾¾å¼</h3><p>lambdaè¡¨è¾¾å¼æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ŒåŸºäºæ•°å­¦ä¸­çš„Î»æ¼”ç®—å¾—åã€‚<br>C++11ä¸­çš„lambdaè¡¨è¾¾å¼ç”¨äº<font color="#00b050">å®šä¹‰å¹¶åˆ›å»ºåŒ¿åçš„å‡½æ•°å¯¹è±¡</font>ï¼Œä»¥ç®€åŒ–ç¼–ç¨‹å·¥ä½œï¼›é€šå¸¸é…åˆå›è°ƒå‡½æ•°ä½¿ç”¨ã€‚</p><p>ğŸ’­<strong>Lambda è¡¨è¾¾å¼çš„ç»“æ„</strong>ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[]()<span class="keyword">mutable</span> exeption -&gt;<span class="type">int</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br><code>[]</code>ï¼šæ•è·åˆ—è¡¨ï¼Œæ ‡è¯†ä¸€ä¸ª Lambda è¡¨è¾¾å¼çš„å¼€å§‹ï¼Œä¸èƒ½çœç•¥ã€‚å¯è®¤ä¸ºæ˜¯å‡½æ•°åã€‚<font color="#00b050">æ•è·å¤–é¢çš„å‚æ•°å±æ€§</font>ï¼ˆè€Œéå‚æ•°æœ¬èº«ï¼‰ï¼Œç›¸å½“äºç±»çš„æˆå‘˜å˜é‡ã€‚<br><code>()</code>ï¼šæ²¡æœ‰å‚æ•°æ—¶å¯ä»¥çœç•¥ï¼Œæœ‰å‚æ•°æ—¶å†™åœ¨ () é‡Œï¼Œå’Œæ™®é€šå‡½æ•°çš„å‚æ•°å†™æ³•ä¸€è‡´ã€‚<br><code>mutable</code>ï¼šç”¨äºä¿®é¥°ç±»çš„æˆå‘˜å˜é‡ï¼Œå…è®¸åœ¨ <code>const</code> æˆå‘˜å‡½æ•°ä¸­ä¿®æ”¹è¢« <code>mutable</code> ä¿®é¥°çš„æˆå‘˜å˜é‡ã€‚</p><hr><p>ğŸ’­ <code>[]</code> å†…é€šå¸¸æœ‰ï¼š</p><ol><li>ç©ºï¼Œæ— ä»»ä½•å¯¹è±¡å‚æ•°</li><li><code>=</code>ï¼Œè¡¨ç¤ºå…¨éƒ¨å€¼ä¼ é€’</li><li><code>&amp;</code>ï¼Œè¡¨ç¤ºå…¨éƒ¨å¼•ç”¨ä¼ é€’</li><li><code>this</code>ï¼Œç±»å†…æˆå‘˜å˜é‡ï¼Œå’Œå…¨å±€å˜é‡</li><li><code>a</code>ï¼Œå°† a æŒ‰å€¼ä¼ é€’è¿›è¡Œä¼ é€’ï¼Œé»˜è®¤ä¸º constï¼Œå¦‚æœè¦ä¿®æ”¹å¯ä»¥åŠ ä¸Š <code>mutable</code> åœ¨ <code>()</code> å</li><li><code>&amp;a</code>ï¼Œå°† a æŒ‰å¼•ç”¨ä¼ é€’è¿›è¡Œä¼ é€’</li><li><code>a, &amp;b</code>ï¼Œa å€¼ä¼ é€’ï¼Œb å¼•ç”¨ä¼ é€’</li><li><code>=, &amp;a, &amp;b</code>ï¼Œé™¤äº† a å’Œ b å¼•ç”¨ä¼ é€’å¤–ï¼Œå…¶ä½™å€¼ä¼ é€’ï¼ˆ<code>=</code> è¦æ”¾åœ¨å‰é¢ï¼‰</li><li><code>&amp;, a, b</code>ï¼Œé™¤äº† a å’Œ b å€¼ä¼ é€’å¤–ï¼Œå…¶ä½™å¼•ç”¨ä¼ é€’ï¼ˆ<code>&amp;</code> è¦æ”¾åœ¨å‰é¢ï¼‰</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> tmp0 = <span class="number">9</span>; <span class="comment">//å…¨å±€å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test44</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">int</span> i = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">auto</span> f1 = [=]()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; tmp0 &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f1</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f2 = [&amp;]()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; tmp0 &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f2</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f3 = [<span class="keyword">this</span>]() <span class="comment">//thiså¯ä»¥æ•è·ç±»å†…æˆå‘˜å˜é‡ï¼Œå’Œå…¨å±€å˜é‡</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; tmp0 &lt;&lt; endl; <span class="comment">//è™½ç„¶æ˜¯thisï¼Œå…¨å±€å˜é‡ä¹Ÿå¯ä»¥æ•è·</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f3</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_05</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//å¤–éƒ¨å˜é‡</span></span><br><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> c = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f1 = []() <span class="comment">//å¯ä»¥ç”¨æŒ‡é’ˆæ¥æ”¶ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;<span class="comment">//éœ€è¦åŠ ;</span></span><br><span class="line"><span class="built_in">f1</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f2 = [a, b]() <span class="comment">//a,bç”¨å€¼ä¼ é€’</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f2</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f3 = [a, b](<span class="type">int</span> x, <span class="type">int</span> y)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; y &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f3</span>(<span class="number">14</span>, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f4 = [=]() <span class="comment">//å¤–é¢å˜é‡å…¨éƒ¨ä»¥å€¼ä¼ é€’ï¼Œä¼ ç»™Lambdaè¡¨è¾¾å¼ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f4</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f5 = [&amp;]() <span class="comment">//å¤–é¢å˜é‡å…¨éƒ¨ä»¥å¼•ç”¨ä¼ é€’ï¼Œä¼ ç»™Lambdaè¡¨è¾¾å¼ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f5</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f6 = [&amp;, a]() <span class="comment">//&amp;è¦æ”¾å‰é¢ï¼Œaç”¨å€¼ä¼ é€’ï¼Œå…¶ä»–ç”¨å¼•ç”¨ä¼ é€’ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; c &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f6</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f7 = [=, &amp;b]() <span class="comment">//=è¦æ”¾å‰é¢ï¼Œbç”¨å¼•ç”¨ä¼ é€’ï¼Œå…¶ä»–ç”¨å€¼ä¼ é€’ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//a++; //é»˜è®¤æ˜¯constï¼Œæ˜¯å³å€¼ï¼Œä¸å¯ä¿®æ”¹ï¼›</span></span><br><span class="line">cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; c &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f7</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f8 = [=]() <span class="keyword">mutable</span> <span class="comment">//é»˜è®¤æ˜¯constä¿®é¥°å‡½æ•°ä½“ï¼Œæƒ³æ”¹éœ€è¦åŠ mutableï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">a++;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; c &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; tmp0 &lt;&lt; endl; <span class="comment">//å…¨å±€å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//[]æ•è·çš„å˜é‡æ˜¯åŒä¸€ä¸ªä½œç”¨åŸŸä¸‹çš„å˜é‡ï¼Œå’Œå…¨å±€å˜é‡ï¼›</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f8</span>();</span><br><span class="line"></span><br><span class="line">Test44 t;</span><br><span class="line">t.<span class="built_in">func</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_06</span><span class="params">()</span> <span class="comment">//å€¼å’Œå¼•ç”¨ä¼ é€’çš„åŒºåˆ«</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">auto</span> a = <span class="number">88</span>;</span><br><span class="line"><span class="keyword">auto</span> f1 = [=]() <span class="keyword">mutable</span> <span class="comment">//ä¼ è¿›æ¥çš„aç»™äº†æ–°å»ºçš„ä¸€ä¸ªå˜é‡ï¼Œmutableæ”¹çš„åªæ˜¯è¿™ä¸ªæ–°å»ºçš„å˜é‡ï¼Œè€Œaæœ¬èº«ä¸ä¼šè¢«æ”¹ï¼Œæ“ä½œçš„ä¸æ˜¯åŒä¸€ä¸ªåœ°å€çš„å†…å­˜ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">a += <span class="number">10</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; endl; <span class="comment">//98</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f1</span>();</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;a2 = &quot;</span> &lt;&lt; a &lt;&lt; endl; <span class="comment">//88, è¿˜æ˜¯æ²¡æœ‰æ”¹å˜ï¼›ç›¸å½“äºæ™®é€šå‡½æ•°å€¼ä¼ é€’ä¸ä¼šæ”¹å˜å®å‚ï¼Œåªæ”¹å˜å½¢å‚ï¼›</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">222</span>;</span><br><span class="line"><span class="built_in">f1</span>();<span class="comment">//108, å’Œ222æ²¡å…³ç³»ï¼Œf1()å†…çš„ä¸´æ—¶å˜é‡è¢«æ“ä½œï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> b = <span class="number">66</span>;</span><br><span class="line"><span class="keyword">auto</span> f2 = [&amp;]() <span class="comment">//å¼•ç”¨ä¼ é€’ä¸ä¼šæ–°å»ºå˜é‡ï¼Œè€Œæ˜¯å–åœ°å€ï¼Œæ“ä½œçš„æ˜¯åŒä¸€å—å†…å­˜ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">b += <span class="number">10</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;b = &quot;</span> &lt;&lt; b &lt;&lt; endl;<span class="comment">//76</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f2</span>();</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;b2 = &quot;</span> &lt;&lt; b &lt;&lt; endl;<span class="comment">//76ï¼Œå¤–é¢çš„ä¹Ÿè¢«æ”¹äº†ï¼›ç›¸å½“äºæ™®é€šå‡½æ•°å¼•ç”¨ä¼ é€’ï¼Œå¯ä»¥æ”¹å˜å®å‚ï¼›</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">333</span>;</span><br><span class="line"><span class="built_in">f2</span>(); <span class="comment">//343, å’Œ333æœ‰å…³ç³»äº†ï¼›</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>Lambda è¡¨è¾¾å¼æ¯”ä»¿å‡½æ•°æ›´ç®€æ´ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_07</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> tmp = <span class="number">10</span>;</span><br><span class="line"><span class="function">MyFunc <span class="title">obj</span><span class="params">(tmp)</span></span>;<span class="comment">//è°ƒç”¨ä»¿å‡½æ•°æ„é€ å‡½æ•°</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">obj</span>(<span class="number">7</span>) &lt;&lt; endl;<span class="comment">//è°ƒç”¨ä»¿å‡½æ•°</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">obj</span>(<span class="number">18</span>, <span class="number">14</span>) &lt;&lt; endl;<span class="comment">//è°ƒç”¨ä»¿å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f = [tmp](<span class="type">int</span> r) <span class="comment">//ç”¨lambdaè¡¨è¾¾å¼ï¼Œä¸éœ€è¦å†™classå’Œoperator()é‡è½½äº†</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> tmp + r;</span><br><span class="line">&#125;;</span><br><span class="line">cout &lt;&lt; <span class="built_in">f</span>(<span class="number">8</span>) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> r = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">auto</span> f1 = [r](<span class="type">int</span> a, <span class="type">int</span> b)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">return</span> (a &gt; b &amp;&amp; b &gt; r);</span><br><span class="line">&#125;;</span><br><span class="line">cout &lt;&lt; <span class="built_in">f1</span>(<span class="number">19</span>, <span class="number">16</span>) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä»¿å‡½æ•°æ˜¯ç¼–è¯‘å™¨å®ç° Lambda çš„ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡ç¼–è¯‘å™¨å°† Lambda è¡¨è¾¾å¼è½¬åŒ–ä¸ºä¸€ä¸ªä»¿å‡½æ•°çš„å¯¹è±¡ã€‚<br>Lambda è¡¨è¾¾å¼å¯ä»¥è§†ä¸ºä»¿å‡½æ•°çš„ä¸€ç§<font color="#00b050">ç­‰ä»·å½¢å¼</font>ã€‚</p></blockquote><hr><p>ğŸ’­Lambda è¡¨è¾¾å¼çš„ç±»å‹ï¼š</p><ul><li>åœ¨ C++11 ä¸­æ˜¯é—­åŒ…ç±»å‹ï¼Œæ¯ä¸ª Lambda è¡¨è¾¾å¼ä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼ˆå³å€¼ï¼‰ã€‚å› æ­¤ä¸¥æ ¼æ¥è¯´ï¼ŒLambda è¡¨è¾¾å¼å¹¶éå‡½æ•°æŒ‡é’ˆã€‚</li><li>C++11 å…è®¸ Lambda è¡¨è¾¾å¼å‘å‡½æ•°æŒ‡é’ˆè½¬æ¢ï¼Œä½†å‰ææ˜¯ Lambda è¡¨è¾¾å¼æ²¡æœ‰æ•è·ä»»ä½•å˜é‡ï¼Œä¸”å‡½æ•°æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°åŸå‹å¿…é¡»è·Ÿ Lambda è¡¨è¾¾å¼æœ‰ç€ç›¸åŒçš„è¡¨è¾¾æ–¹å¼ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_08</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">function&lt;<span class="type">void</span>(<span class="type">int</span>)&gt; f1 = [](<span class="type">int</span> a) <span class="comment">//æ²¡æœ‰è¿”å›å€¼ï¼Œç›´æ¥ç»‘å®šlambdaè¡¨è¾¾å¼</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">f1</span>(<span class="number">100</span>); <span class="comment">//100</span></span><br><span class="line"></span><br><span class="line">function&lt;<span class="type">int</span>(<span class="type">int</span>)&gt; f2 = [](<span class="type">int</span> a) <span class="comment">//æœ‰è¿”å›å€¼ï¼Œç›´æ¥ç»‘å®šlambdaè¡¨è¾¾å¼</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> a + <span class="number">5</span>;</span><br><span class="line">&#125;;</span><br><span class="line">cout &lt;&lt; <span class="built_in">f2</span>(<span class="number">110</span>) &lt;&lt; endl; <span class="comment">//115</span></span><br><span class="line"></span><br><span class="line">function&lt;<span class="type">int</span>(<span class="type">int</span>, <span class="type">int</span>)&gt; f3 = bind <span class="comment">//bindå…ˆç»‘å®šlambdaè¡¨è¾¾å¼ï¼Œå†ä¼ ç»™functionå»ç»‘å®šf3</span></span><br><span class="line">( </span><br><span class="line">[](<span class="type">int</span> a, <span class="type">int</span> b) </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> a * <span class="number">2</span> + b;</span><br><span class="line">&#125;,</span><br><span class="line">_2, <span class="comment">//æŠŠä¼ å…¥çš„ç¬¬2ä¸ªå€¼ç”¨äºa</span></span><br><span class="line">_1 <span class="comment">//æŠŠä¼ å…¥çš„ç¬¬1ä¸ªå€¼ç”¨äºb</span></span><br><span class="line">);</span><br><span class="line">cout &lt;&lt; <span class="built_in">f3</span>(<span class="number">10</span>, <span class="number">8</span>) &lt;&lt; endl; <span class="comment">//26 //æŠŠ8ç”¨äºint aï¼ŒæŠŠ10ç”¨äºint b</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> f4 = [](<span class="type">int</span> x, <span class="type">int</span> y) -&gt; <span class="type">int</span> <span class="comment">//[]å†…ä¸èƒ½æ•è·å¤–éƒ¨å˜é‡ï¼Œæ‰èƒ½è½¬åŒ– ä¸ºå‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br><span class="line">cout &lt;&lt; <span class="built_in">f4</span>(<span class="number">3</span>, <span class="number">5</span>) &lt;&lt; endl; <span class="comment">//8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">decltype</span> (f4) tmp = f4; <span class="comment">//ç”¨decltypeæ¨å¯¼å‡ºf4çš„ç±»å‹ï¼Œç”¨è¿™ä¸ªç±»å‹åˆ›å»ºå¯¹è±¡tmpï¼ŒæŠŠf4èµ‹å€¼ç»™tmpï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">tmp</span>(<span class="number">6</span>, <span class="number">8</span>) &lt;&lt; endl;<span class="comment">//14</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">int</span><span class="params">(*PFUC)</span><span class="params">(<span class="type">int</span>, <span class="type">int</span>)</span></span>;<span class="comment">//å®šä¹‰å‡½æ•°æŒ‡é’ˆï¼Œå‚æ•°ç±»å‹ã€è¿”å›å€¼ä¸lambdaè¡¨è¾¾å¼ç›¸åŒ</span></span><br><span class="line">PFUC p1 = f4; <span class="comment">//lambdaè¡¨è¾¾å¼è½¬åŒ–ä¸ºå‡½æ•°æŒ‡é’ˆï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="built_in">p1</span>(<span class="number">10</span>, <span class="number">19</span>) &lt;&lt; endl;<span class="comment">//29</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//decltype (f4) = p1;//ä¸å¯æŠŠå‡½æ•°æŒ‡é’ˆè½¬åŒ–ä¸ºlambdaè¡¨è¾¾å¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambdaè¡¨è¾¾å¼ä¸for_eachï¼ˆéœ€è¦å¤´æ–‡ä»¶&lt;algorithm&gt;ï¼‰ç»“åˆä½¿ç”¨ï¼š</span></span><br><span class="line"><span class="type">int</span> tmp01 = <span class="number">5</span>;<span class="comment">//å…¨å±€å˜é‡</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; nums;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; largeNums; <span class="comment">//å¤§äºtmpçš„æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushLargeNums</span><span class="params">(<span class="type">int</span> &amp;n)</span> <span class="comment">//å›è°ƒå‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &gt; tmp01)</span><br><span class="line">&#123;</span><br><span class="line">largeNums.<span class="built_in">push_back</span>(n);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printNums</span><span class="params">(<span class="type">int</span> &amp;n)</span> <span class="comment">//å›è°ƒå‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; n &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_09</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">nums.<span class="built_in">push_back</span>(i + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¼ ç»Ÿå†™æ³•ï¼š</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = nums.<span class="built_in">begin</span>(); it != nums.<span class="built_in">end</span>(); it++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (*it &gt; tmp01)</span><br><span class="line">&#123;</span><br><span class="line">largeNums.<span class="built_in">push_back</span>(*it);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ä¼ ç»Ÿæ–¹æ³•æ‰“å°1ï¼š&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; largeNums.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; largeNums[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ä¼ ç»Ÿæ–¹æ³•æ‰“å°2ï¼š&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = largeNums.<span class="built_in">begin</span>(); it != largeNums.<span class="built_in">end</span>(); it++)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”¨lambdaè¡¨è¾¾å¼å’Œfor_eachï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°æ–¹å¼1ï¼šfor_each + å›è°ƒå‡½æ•°</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;for_each + å›è°ƒå‡½æ•°ï¼š&quot;</span>;</span><br><span class="line">largeNums.<span class="built_in">clear</span>();</span><br><span class="line">for_each(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>(), pushLargeNums); </span><br><span class="line">for_each(largeNums.<span class="built_in">begin</span>(), largeNums.<span class="built_in">end</span>(), printNums);</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°æ–¹å¼2ï¼šfor_each + lambdaè¡¨è¾¾å¼ï¼š</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;for_each + lambdaè¡¨è¾¾å¼ï¼š&quot;</span>;</span><br><span class="line">largeNums.<span class="built_in">clear</span>();</span><br><span class="line">for_each</span><br><span class="line">(</span><br><span class="line">nums.<span class="built_in">begin</span>(),</span><br><span class="line">nums.<span class="built_in">end</span>(),</span><br><span class="line">[&amp;](<span class="type">int</span> &amp;n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (n &gt; tmp01)</span><br><span class="line">&#123;</span><br><span class="line">largeNums.<span class="built_in">push_back</span>(n);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">for_each</span><br><span class="line">(</span><br><span class="line">largeNums.<span class="built_in">begin</span>(),</span><br><span class="line">largeNums.<span class="built_in">end</span>(),</span><br><span class="line">[](<span class="type">int</span> &amp;n)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; n &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>ğŸ’­C++14 ä¸­çš„æ›´æ–°ï¼š</p><ul><li>åœ¨ C++11 ä¸­ï¼ŒLambda è¡¨è¾¾å¼çš„å½¢å¼å‚æ•°éœ€è¦è¢«å£°æ˜ä¸ºå…·ä½“çš„ç±»å‹ï¼Œæ¯”å¦‚ <code>(int x)</code></li><li>C++14 ä¸­å¼•å…¥äº†æ³›å‹ Lambdaï¼Œå…è®¸å½¢å¼å‚æ•°å£°æ˜ä¸­ä½¿ç”¨ç±»å‹è¯´æ˜ç¬¦ <code>auto</code></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> f = [](<span class="keyword">auto</span> x, <span class="keyword">auto</span> y) </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> x + y; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³›å‹lambdaå‡½æ•°éµå¾ªæ¨¡æ¿å‚æ•°æ¨å¯¼çš„è§„åˆ™ï¼š</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">unnamed_lambda</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> U&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">operator</span><span class="params">()</span><span class="params">(T x, U y)</span> <span class="type">const</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="keyword">return</span> x + y; </span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">auto</span> lambda = unnamed_lambda&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Lambdaæ•è·å‚æ•°ä¸­ä½¿ç”¨èµ‹å€¼è¡¨è¾¾å¼ï¼š</span></span><br><span class="line"><span class="keyword">auto</span> lambda1 = [value = <span class="number">1</span>]()</span><br><span class="line">&#123; </span><br><span class="line"><span class="keyword">return</span> value; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambdaè¡¨è¾¾å¼å‚æ•°å¯ä»¥ç”¨autoï¼š</span></span><br><span class="line"><span class="keyword">auto</span> lambda2 = [](<span class="keyword">auto</span> a)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">C++åŸºç¡€ï¼šæ–‡ä»¶æ“ä½œä¸C++11æ–°ç‰¹æ€§</summary>
    
    
    
    <category term="C++è¯­è¨€åŸºç¡€" scheme="https://sumikiru.top/categories/C-%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="æ–‡ä»¶æ“ä½œ" scheme="https://sumikiru.top/tags/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"/>
    
    <category term="C++11æ–°ç‰¹æ€§" scheme="https://sumikiru.top/tags/C-11%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>GASä¸­æ–‡æ–‡æ¡£ï¼ˆæ›´æ–°ä¸­ï¼‰</title>
    <link href="https://sumikiru.top/posts/d0ae354a.html"/>
    <id>https://sumikiru.top/posts/d0ae354a.html</id>
    <published>2024-12-10T12:54:30.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<p><strong>æ›´æ–°æ—¶é—´ï¼š2024/11/26(æ›´æ–°ä¸­)</strong><br>ç¿»è¯‘æ­¤æ–‡æ—¶é—´: 2024.11.1<br>åŸæ–‡åœ°å€: <a href="https://github.com/BillEliot/GASDocumentation">tranek/GASDocumentation</a><br>ç¿»è¯‘åœ°å€(UE4.24): <a href="https://github.com/BillEliot/GASDocumentation_Chinese">BillEliot/GASDocumentation_Chinese</a><br>åé¦ˆ: <strong>github/PR</strong> or <strong>eliotwjz@gmail.com</strong></p><h1 id="GASDocumentation"><a href="#GASDocumentation" class="headerlink" title="GASDocumentation"></a>GASDocumentation</h1><p>æˆ‘ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å¤šäººæ¸¸æˆæ¨¡æ¿é¡¹ç›®æ¥é˜è¿°å¯¹Unreal Engine 5ä¸­GameplayAbilitySystem(GAS)æ’ä»¶çš„ç†è§£. è¿™ä¸æ˜¯å®˜æ–¹æ–‡æ¡£, å¹¶ä¸”è¿™ä¸ªé¡¹ç›®å’Œæˆ‘è‡ªå·±éƒ½ä¸æ¥è‡ªEpic Games. æˆ‘ä¸èƒ½ä¿è¯è¯¥æ–‡æ¡£çš„å‡†ç¡®æ€§.  </p><p>è¯¥æ–‡æ¡£çš„ç›®çš„æ˜¯é˜æ˜GASä¸­çš„ä¸»è¦æ¦‚å¿µå’Œç›¸å…³ç±», å¹¶ç»“åˆæˆ‘çš„ç»éªŒæä¾›ä¸€äº›é™„åŠ è¯´æ˜. åœ¨ç¤¾åŒºç”¨æˆ·ä¸­, å·²ç»å½¢æˆäº†å¤§é‡æœ‰å…³GASçš„â€éƒ¨è½çŸ¥è¯†â€, è€Œæˆ‘è‡´åŠ›äºå°†æˆ‘äº†è§£çš„å…¨éƒ¨åœ¨è¿™é‡Œåˆ†äº«.  </p><p>æ ·ä¾‹é¡¹ç›®å’Œæ–‡æ¡£ç›®å‰åŸºäº<code>Unreal Engine 5.3</code>. è¯¥æ–‡æ¡£æ‹¥æœ‰å¯ç”¨äºæ—§ç‰ˆæœ¬Unreal Engineçš„åˆ†æ”¯, ä½†æ˜¯å®ƒä»¬ä¸å†å—æ”¯æŒ, å¹¶ä¸”å¯èƒ½å­˜åœ¨bugå’Œè¿‡æ—¶ä¿¡æ¯.<br><a href="https://github.com/tranek/GASShooter">GASShooter</a>æ˜¯è¯¥æ ·ä¾‹é¡¹ç›®çš„å§å¦¹é¡¹ç›®, å…¶æ¼”ç¤ºäº†åŸºäºå¤šäººFPS/TPSçš„é«˜é˜¶GASæŠ€æœ¯.  </p><p>æœ€å¥½çš„æ–‡æ¡£æ°¸è¿œæ˜¯è¯¥æ’ä»¶çš„ä»£ç .  </p><hr><p><a name="table-of-contents"></a></p><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#gasdocumentation">GASDocumentation</a><ul><li><a href="#ç›®å½•">ç›®å½•</a></li><li><a href="#1-æ­¥å…¥gameplayabilitysystemæ’ä»¶">1. æ­¥å…¥GameplayAbilitySystemæ’ä»¶</a></li><li><a href="#2-æ ·ä¾‹é¡¹ç›®">2. æ ·ä¾‹é¡¹ç›®</a></li><li><a href="#3-ä½¿ç”¨gasåˆ›å»ºä¸€ä¸ªé¡¹ç›®">3. ä½¿ç”¨GASåˆ›å»ºä¸€ä¸ªé¡¹ç›®</a></li><li><a href="#4-gasæ¦‚å¿µ">4. GASæ¦‚å¿µ</a><ul><li><a href="#41-ability-system-component">4.1 Ability System Component</a><ul><li><a href="#411-åŒæ­¥æ¨¡å¼">4.1.1 åŒæ­¥æ¨¡å¼</a></li><li><a href="#412-è®¾ç½®å’Œåˆå§‹åŒ–">4.1.2 è®¾ç½®å’Œåˆå§‹åŒ–</a></li></ul></li><li><a href="#42-gameplay-tags">4.2 Gameplay Tags</a><ul><li><a href="#421-å“åº”gameplay-tagsçš„å˜åŒ–">4.2.1 å“åº”Gameplay Tagsçš„å˜åŒ–</a></li></ul></li><li><a href="#43-attribute">4.3 Attribute</a><ul><li><a href="#431-attributeå®šä¹‰">4.3.1 Attributeå®šä¹‰</a></li><li><a href="#432-basevalue-vs-currentvalue">4.3.2 BaseValue vs. CurrentValue</a></li><li><a href="#433-å…ƒmetaattribute">4.3.3 å…ƒ(Meta)Attribute</a></li><li><a href="#434-å“åº”attributeå˜åŒ–">4.3.4 å“åº”Attributeå˜åŒ–</a></li><li><a href="#435-è‡ªåŠ¨æ¨å¯¼attribute">4.3.5 è‡ªåŠ¨æ¨å¯¼Attribute</a></li></ul></li><li><a href="#44-attributeset">4.4 AttributeSet</a><ul><li><a href="#441-å®šä¹‰attributeset">4.4.1 å®šä¹‰AttributeSet</a></li><li><a href="#442-è®¾è®¡attributeset">4.4.2 è®¾è®¡AttributeSet</a><ul><li><a href="#4421-ä½¿ç”¨å•ç‹¬attributeçš„å­ç»„ä»¶">4.4.2.1 ä½¿ç”¨å•ç‹¬Attributeçš„å­ç»„ä»¶</a></li><li><a href="#4422-è¿è¡Œæ—¶æ·»åŠ å’Œç§»é™¤attributeset">4.4.2.2 è¿è¡Œæ—¶æ·»åŠ å’Œç§»é™¤AttributeSet</a></li><li><a href="#4423-item-attributeæ­¦å™¨å¼¹è¯">4.4.2.3 Item Attribute(æ­¦å™¨å¼¹è¯)</a><ul><li><a href="#44231-åœ¨ç‰©å“ä¸­ä½¿ç”¨æ™®é€šæµ®ç‚¹æ•°">4.4.2.3.1 åœ¨ç‰©å“ä¸­ä½¿ç”¨æ™®é€šæµ®ç‚¹æ•°</a></li><li><a href="#44232-åœ¨ç‰©å“ä¸­ä½¿ç”¨attributeset">4.4.2.3.2 åœ¨ç‰©å“ä¸­ä½¿ç”¨AttributeSet</a></li><li><a href="#44233-åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„asc">4.4.2.3.3 åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„ASC</a></li></ul></li></ul></li><li><a href="#443-å®šä¹‰attribute">4.4.3 å®šä¹‰Attribute</a></li><li><a href="#444-åˆå§‹åŒ–attribute">4.4.4 åˆå§‹åŒ–Attribute</a></li><li><a href="#445-preattributechange">4.4.5 PreAttributeChange()</a></li><li><a href="#446-postgameplayeffectexecute">4.4.6 PostGameplayEffectExecute()</a></li><li><a href="#447-onattributeaggregatorcreated">4.4.7 OnAttributeAggregatorCreated()</a></li></ul></li><li><a href="#45-gameplay-effects">4.5 Gameplay Effects</a><ul><li><a href="#451-å®šä¹‰gameplayeffect">4.5.1 å®šä¹‰GameplayEffect</a></li><li><a href="#452-åº”ç”¨gameplayeffect">4.5.2 åº”ç”¨GameplayEffect</a></li><li><a href="#453-ç§»é™¤gameplayeffect">4.5.3 ç§»é™¤GameplayEffect</a></li><li><a href="#454-gameplayeffectmodifier">4.5.4 GameplayEffectModifier</a><ul><li><a href="#4541-multiplyå’Œdivide-modifier">4.5.4.1 Multiplyå’ŒDivide Modifier</a></li><li><a href="#4542-modifierçš„gameplaytag">4.5.4.2 Modifierçš„GameplayTag</a></li></ul></li><li><a href="#455-gameplayeffectå †æ ˆ">4.5.5 GameplayEffectå †æ ˆ</a></li><li><a href="#456-æˆäºˆability">4.5.6 æˆäºˆAbility</a></li><li><a href="#457-gameplayeffectæ ‡ç­¾">4.5.7 GameplayEffectæ ‡ç­¾</a></li><li><a href="#458-å…ç–«">4.5.8 å…ç–«</a></li><li><a href="#459-gameplayeffectspec">4.5.9 GameplayEffectSpec</a><ul><li><a href="#4591-setbycaller">4.5.9.1 SetByCaller</a></li></ul></li><li><a href="#4510-gameplayeffectcontext">4.5.10 GameplayEffectContext</a></li><li><a href="#4511-modifier-magnitude-calculation">4.5.11 Modifier Magnitude Calculation</a></li><li><a href="#4512-gameplay-effect-execution-calculation">4.5.12 Gameplay Effect Execution Calculation</a><ul><li><a href="#45121-å‘é€æ•°æ®åˆ°execution-calculation">4.5.12.1 å‘é€æ•°æ®åˆ°Execution Calculation</a><ul><li><a href="#451211-setbycaller">4.5.12.1.1 SetByCaller</a></li><li><a href="#451212-backingæ•°æ®attributeè®¡ç®—modifier">4.5.12.1.2 Backingæ•°æ®Attributeè®¡ç®—Modifier</a></li><li><a href="#451213-backingæ•°æ®ä¸´æ—¶å˜é‡è®¡ç®—modifier">4.5.12.1.3 Backingæ•°æ®ä¸´æ—¶å˜é‡è®¡ç®—Modifier</a></li><li><a href="#451214-gameplayeffectcontext">4.5.12.1.4 GameplayEffectContext</a></li></ul></li></ul></li><li><a href="#4513-è‡ªå®šä¹‰åº”ç”¨éœ€æ±‚">4.5.13 è‡ªå®šä¹‰åº”ç”¨éœ€æ±‚</a></li><li><a href="#4514-èŠ±è´¹costgameplayeffect">4.5.14 èŠ±è´¹(Cost)GameplayEffect</a></li><li><a href="#4515-å†·å´cooldowngameplayeffect">4.5.15 å†·å´(Cooldown)GameplayEffect</a><ul><li><a href="#45151-è·å–cooldown-gameplayeffectçš„å‰©ä½™æ—¶é—´">4.5.15.1 è·å–Cooldown GameplayEffectçš„å‰©ä½™æ—¶é—´</a></li><li><a href="#45152-ç›‘å¬å†·å´å¼€å§‹å’Œç»“æŸ">4.5.15.2 ç›‘å¬å†·å´å¼€å§‹å’Œç»“æŸ</a></li><li><a href="#45153-é¢„æµ‹å†·å´æ—¶é—´">4.5.15.3 é¢„æµ‹å†·å´æ—¶é—´</a></li></ul></li><li><a href="#4516-ä¿®æ”¹å·²æ¿€æ´»gameplayeffectçš„æŒç»­æ—¶é—´">4.5.16 ä¿®æ”¹å·²æ¿€æ´»GameplayEffectçš„æŒç»­æ—¶é—´</a></li><li><a href="#4517-è¿è¡Œæ—¶åˆ›å»ºåŠ¨æ€gameplayeffect">4.5.17 è¿è¡Œæ—¶åˆ›å»ºåŠ¨æ€<code>GameplayEffect</code></a></li><li><a href="#4518-gameplayeffect-containers">4.5.18 GameplayEffect Containers</a></li></ul></li><li><a href="#46-gameplay-abilities">4.6 Gameplay Abilities</a><ul><li><a href="#461-gameplayabilityå®šä¹‰">4.6.1 GameplayAbilityå®šä¹‰</a><ul><li><a href="#4611-replication-policy">4.6.1.1 Replication Policy</a></li><li><a href="#4612-server-respects-remote-ability-cancellation">4.6.1.2 Server Respects Remote Ability Cancellation</a></li><li><a href="#4613-replicate-input-directly">4.6.1.3 Replicate Input Directly</a></li></ul></li><li><a href="#462-ç»‘å®šè¾“å…¥åˆ°asc">4.6.2 ç»‘å®šè¾“å…¥åˆ°ASC</a><ul><li><a href="#4621-ç»‘å®šè¾“å…¥æ—¶ä¸æ¿€æ´»ability">4.6.2.1 ç»‘å®šè¾“å…¥æ—¶ä¸æ¿€æ´»Ability</a></li></ul></li><li><a href="#463-æˆäºˆability">4.6.3 æˆäºˆAbility</a></li><li><a href="#464-æ¿€æ´»ability">4.6.4 æ¿€æ´»Ability</a><ul><li><a href="#4641-è¢«åŠ¨ability">4.6.4.1 è¢«åŠ¨Ability</a></li></ul></li><li><a href="#465-å–æ¶ˆability">4.6.5 å–æ¶ˆAbility</a></li><li><a href="#466-è·å–æ¿€æ´»çš„ability">4.6.6 è·å–æ¿€æ´»çš„Ability</a></li><li><a href="#467-å®ä¾‹åŒ–ç­–ç•¥">4.6.7 å®ä¾‹åŒ–ç­–ç•¥</a></li><li><a href="#468-ç½‘ç»œæ‰§è¡Œç­–ç•¥net-execution-policy">4.6.8 ç½‘ç»œæ‰§è¡Œç­–ç•¥(Net Execution Policy)</a></li><li><a href="#469-abilityæ ‡ç­¾">4.6.9 Abilityæ ‡ç­¾</a></li><li><a href="#4610-gameplay-ability-spec">4.6.10 Gameplay Ability Spec</a></li><li><a href="#4611-ä¼ é€’æ•°æ®åˆ°ability">4.6.11 ä¼ é€’æ•°æ®åˆ°Ability</a></li><li><a href="#4612-abilityèŠ±è´¹costå’Œå†·å´cooldown">4.6.12 AbilityèŠ±è´¹(Cost)å’Œå†·å´(Cooldown)</a></li><li><a href="#4613-å‡çº§ability">4.6.13 å‡çº§Ability</a></li><li><a href="#4614-abilityé›†åˆ">4.6.14 Abilityé›†åˆ</a></li><li><a href="#4615-abilityæ‰¹å¤„ç†">4.6.15 Abilityæ‰¹å¤„ç†</a></li><li><a href="#4616-ç½‘ç»œå®‰å…¨ç­–ç•¥net-security-policy">4.6.16 ç½‘ç»œå®‰å…¨ç­–ç•¥(Net Security Policy)</a></li></ul></li><li><a href="#47-ability-tasks">4.7 Ability Tasks</a><ul><li><a href="#471-abilitytaskå®šä¹‰">4.7.1 AbilityTaskå®šä¹‰</a></li><li><a href="#472-è‡ªå®šä¹‰abilitytask">4.7.2 è‡ªå®šä¹‰AbilityTask</a></li><li><a href="#473-ä½¿ç”¨abilitytask">4.7.3 ä½¿ç”¨AbilityTask</a></li><li><a href="#474-root-motion-source-ability-task">4.7.4 Root Motion Source Ability Task</a></li></ul></li><li><a href="#48-gameplay-cues">4.8 Gameplay Cues</a><ul><li><a href="#481-gameplaycueå®šä¹‰">4.8.1 GameplayCueå®šä¹‰</a></li><li><a href="#482-è§¦å‘gameplaycue">4.8.2 è§¦å‘GameplayCue</a><ul><li><a href="#gameplayeffect">GameplayEffect</a></li><li><a href="#æ‰‹åŠ¨è°ƒç”¨">æ‰‹åŠ¨è°ƒç”¨</a></li></ul></li><li><a href="#483-å®¢æˆ·ç«¯gameplaycue">4.8.3 å®¢æˆ·ç«¯GameplayCue</a></li><li><a href="#484-gameplaycueå‚æ•°">4.8.4 GameplayCueå‚æ•°</a></li><li><a href="#485-gameplay-cue-manager">4.8.5 Gameplay Cue Manager</a></li><li><a href="#486-é˜»æ­¢gameplaycueå“åº”">4.8.6 é˜»æ­¢GameplayCueå“åº”</a></li><li><a href="#487-gameplaycueæ‰¹å¤„ç†">4.8.7 GameplayCueæ‰¹å¤„ç†</a><ul><li><a href="#4871-æ‰‹åŠ¨rpc">4.8.7.1 æ‰‹åŠ¨RPC</a></li><li><a href="#4872-gameplayeffectä¸­çš„å¤šä¸ªgameplaycue">4.8.7.2 GameplayEffectä¸­çš„å¤šä¸ªGameplayCue</a></li></ul></li></ul></li><li><a href="#49-ability-system-globals">4.9 Ability System Globals</a><ul><li><a href="#491-initglobaldata">4.9.1 InitGlobalData()</a></li></ul></li><li><a href="#410-é¢„æµ‹prediction">4.10 é¢„æµ‹(Prediction)</a><ul><li><a href="#4101-prediction-key">4.10.1 Prediction Key</a></li><li><a href="#4102-åœ¨abilityä¸­åˆ›å»ºæ–°çš„é¢„æµ‹çª—å£prediction-window">4.10.2 åœ¨Abilityä¸­åˆ›å»ºæ–°çš„é¢„æµ‹çª—å£(Prediction Window)</a></li><li><a href="#4103-é¢„æµ‹æ€§åœ°ç”Ÿæˆactor">4.10.3 é¢„æµ‹æ€§åœ°ç”ŸæˆActor</a></li><li><a href="#4104-gasä¸­é¢„æµ‹çš„æœªæ¥">4.10.4 GASä¸­é¢„æµ‹çš„æœªæ¥</a></li><li><a href="#4105-ç½‘ç»œé¢„æµ‹æ’ä»¶network-prediction-plugin">4.10.5 ç½‘ç»œé¢„æµ‹æ’ä»¶(Network Prediction plugin)</a></li></ul></li><li><a href="#411-targeting">4.11 Targeting</a><ul><li><a href="#4111-target-data">4.11.1 Target Data</a></li><li><a href="#4112-target-actor">4.11.2 Target Actor</a></li><li><a href="#4113-targetdataè¿‡æ»¤å™¨">4.11.3 TargetDataè¿‡æ»¤å™¨</a></li><li><a href="#4114-gameplay-ability-world-reticles">4.11.4 Gameplay Ability World Reticles</a></li><li><a href="#4115-gameplay-effect-containers-targeting">4.11.5 Gameplay Effect Containers Targeting</a></li></ul></li></ul></li><li><a href="#5-å¸¸ç”¨çš„abiltyå’Œeffect">5. å¸¸ç”¨çš„Abiltyå’ŒEffect</a><ul><li><a href="#51-çœ©æ™•stun">5.1 çœ©æ™•(Stun)</a></li><li><a href="#52-å¥”è·‘sprint">5.2 å¥”è·‘(Sprint)</a></li><li><a href="#53-ç„å‡†aim-down-sight">5.3 ç„å‡†(Aim Down Sight)</a></li><li><a href="#54-ç”Ÿå‘½å·å–lifesteal">5.4 ç”Ÿå‘½å·å–(Lifesteal)</a></li><li><a href="#55-åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸­ç”Ÿæˆéšæœºæ•°">5.5 åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸­ç”Ÿæˆéšæœºæ•°</a></li><li><a href="#56-æš´å‡»critical-hits">5.6 æš´å‡»(Critical Hits)</a></li><li><a href="#57-éå †æ ˆgameplayeffect-ä½†æ˜¯åªæœ‰å…¶æœ€é«˜çº§greatest-magnitudeæ‰èƒ½å®é™…å½±å“target">5.7 éå †æ ˆGameplayEffect, ä½†æ˜¯åªæœ‰å…¶æœ€é«˜çº§(Greatest Magnitude)æ‰èƒ½å®é™…å½±å“Target</a></li><li><a href="#58-æ¸¸æˆæš‚åœæ—¶ç”Ÿæˆtargetdata">5.8 æ¸¸æˆæš‚åœæ—¶ç”Ÿæˆ<code>TargetData</code></a></li><li><a href="#59-æŒ‰é’®äº¤äº’ç³»ç»Ÿbutton-interaction-system">5.9 æŒ‰é’®äº¤äº’ç³»ç»Ÿ(Button Interaction System)</a></li></ul></li><li><a href="#6-è°ƒè¯•gas">6. è°ƒè¯•GAS</a><ul><li><a href="#61-showdebug-abilitysystem">6.1 showdebug abilitysystem</a></li><li><a href="#62-gameplay-debugger">6.2 Gameplay Debugger</a></li><li><a href="#63-gasæ—¥å¿—logging">6.3 GASæ—¥å¿—(Logging)</a></li></ul></li><li><a href="#7-ä¼˜åŒ–">7. ä¼˜åŒ–</a></li><li><a href="#71-abilityæ‰¹å¤„ç†">7.1 Abilityæ‰¹å¤„ç†</a></li><li><a href="#72-gameplaycueæ‰¹å¤„ç†">7.2 GameplayCueæ‰¹å¤„ç†</a></li><li><a href="#73-abilitysystemcomponentåŒæ­¥æ¨¡å¼replication-mode">7.3 AbilitySystemComponentåŒæ­¥æ¨¡å¼(Replication Mode)</a></li><li><a href="#74-attributeä»£ç†åŒæ­¥">7.4 Attributeä»£ç†åŒæ­¥</a></li><li><a href="#75-ascæ‡’åŠ è½½">7.5 ASCæ‡’åŠ è½½</a></li></ul></li><li><a href="#8-quality-of-life-suggestions">8. Quality of Life Suggestions</a><ul><li><a href="#81-gameplay-effect-containers">8.1 Gameplay Effect Containers</a></li><li><a href="#82-å°†è“å›¾asynctaskç»‘å®šåˆ°ascå§”æ‰˜">8.2 å°†è“å›¾AsyncTaskç»‘å®šåˆ°ASCå§”æ‰˜</a></li></ul></li><li><a href="#9-ç–‘éš¾è§£ç­”">9. ç–‘éš¾è§£ç­”</a><ul><li><a href="#91-logabilitysystem-warning-cant-activate-localonly-or-localpredicted-ability-s-when-not-local">9.1 LogAbilitySystem: Warning: Canâ€™t activate LocalOnly or LocalPredicted ability %s when not local!</a></li><li><a href="#92-scriptstructcacheé”™è¯¯">9.2 <code>ScriptStructCache</code>é”™è¯¯</a></li><li><a href="#93-åŠ¨ç”»è’™å¤ªå¥‡ä¸èƒ½åŒæ­¥åˆ°å®¢æˆ·ç«¯">9.3 åŠ¨ç”»è’™å¤ªå¥‡ä¸èƒ½åŒæ­¥åˆ°å®¢æˆ·ç«¯</a></li><li><a href="#94-å¤åˆ¶çš„è“å›¾actorä¼šå°†attributesetè®¾ç½®ä¸ºnullptr">9.4 å¤åˆ¶çš„è“å›¾Actorä¼šå°†AttributeSetè®¾ç½®ä¸ºnullptr</a></li></ul></li><li><a href="#10-ascå¸¸ç”¨æœ¯è¯­ç¼©ç•¥">10. ASCå¸¸ç”¨æœ¯è¯­ç¼©ç•¥</a></li><li><a href="#11-å…¶ä»–èµ„æº">11. å…¶ä»–èµ„æº</a></li><li><a href="#12-gasæ›´æ–°æ—¥å¿—">12. GASæ›´æ–°æ—¥å¿—</a><ul><li><a href="#426">4.26</a></li><li><a href="#4251">4.25.1</a></li><li><a href="#425">4.25</a></li><li><a href="#424">4.24</a></li></ul></li></ul><hr><p><a name="intro"></a></p><h2 id="1-æ­¥å…¥GameplayAbilitySystemæ’ä»¶"><a href="#1-æ­¥å…¥GameplayAbilitySystemæ’ä»¶" class="headerlink" title="1. æ­¥å…¥GameplayAbilitySystemæ’ä»¶"></a>1. æ­¥å…¥GameplayAbilitySystemæ’ä»¶</h2><p>æ‘˜è‡ª<a href="https://docs.unrealengine.com/en-US/Gameplay/GameplayAbilitySystem/index.html">å®˜æ–¹æ–‡æ¡£</a>:  </p><blockquote><p>GameplayæŠ€èƒ½ç³»ç»Ÿ æ˜¯ä¸€ä¸ªé«˜åº¦çµæ´»çš„æ¡†æ¶ï¼Œå¯ç”¨äºæ„å»ºä½ å¯èƒ½ä¼šåœ¨RPGæˆ–MOBAæ¸¸æˆä¸­çœ‹åˆ°çš„æŠ€èƒ½å’Œå±æ€§ç±»å‹ã€‚ä½ å¯ä»¥æ„å»ºå¯ä¾›æ¸¸æˆä¸­çš„è§’è‰²ä½¿ç”¨çš„åŠ¨ä½œæˆ–è¢«åŠ¨æŠ€èƒ½ï¼Œä½¿è¿™äº›åŠ¨ä½œå¯¼è‡´å„ç§å±æ€§ç´¯ç§¯æˆ–æŸè€—çš„çŠ¶æ€æ•ˆæœï¼Œå®ç°çº¦æŸè¿™äº›åŠ¨ä½œä½¿ç”¨çš„â€å†·å´â€è®¡æ—¶å™¨æˆ–èµ„æºæ¶ˆè€—ï¼Œæ›´æ”¹æŠ€èƒ½ç­‰çº§åŠæ¯ä¸ªæŠ€èƒ½ç­‰çº§çš„æŠ€èƒ½æ•ˆæœï¼Œæ¿€æ´»ç²’å­æˆ–éŸ³æ•ˆï¼Œç­‰ç­‰ã€‚ç®€å•æ¥è¯´ï¼Œæ­¤ç³»ç»Ÿå¯å¸®åŠ©ä½ åœ¨ä»»ä½•ç°ä»£RPGæˆ–MOBAæ¸¸æˆä¸­è®¾è®¡ã€å®ç°åŠé«˜æ•ˆå…³è”å„ç§æ¸¸æˆä¸­çš„æŠ€èƒ½ï¼Œæ—¢åŒ…æ‹¬è·³è·ƒç­‰ç®€å•æŠ€èƒ½ï¼Œä¹ŸåŒ…æ‹¬ä½ å–œæ¬¢çš„è§’è‰²çš„å¤æ‚æŠ€èƒ½é›†ã€‚</p></blockquote><p>GameplayAbilitySystemæ’ä»¶ç”±Epic Gameså¼€å‘, éšUnreal Engine 4 (UE4)å‘å¸ƒ. å®ƒå·²ç»ç”±3Aå•†ä¸šæ¸¸æˆçš„ä¸¥æ ¼æµ‹è¯•, ä¾‹å¦‚å¸•æ‹‰è´¡(Paragon)å’Œå ¡å’ä¹‹å¤œ(Fortnite)ç­‰ç­‰.  </p><p>è¯¥æ’ä»¶å¯¹äºå•äººå’Œå¤šäººæ¸¸æˆæä¾›äº†å¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆ:  </p><ul><li>æ‰§è¡ŒåŸºäºç­‰çº§çš„è§’è‰²èƒ½åŠ›(Ability)æˆ–æŠ€èƒ½(Skill), è¯¥èƒ½åŠ›æˆ–æŠ€èƒ½å¯é€‰èŠ±è´¹å’Œå†·å´æ—¶é—´. (<a href="#concepts-ga">GameplayAbility</a>)</li><li>ç®¡ç†å±äºActorçš„æ•°å€¼Attribute. (<a href="#concepts-a">Attribute</a>)</li><li>ä¸ºActoråº”ç”¨çŠ¶æ€æ•ˆæœ. (<a href="#concepts-ge">GameplayEffect</a>)</li><li>ä¸ºActoråº”ç”¨GameplayTag. (<a href="#concepts-gt">GameplayTag</a>)</li><li>ç”Ÿæˆè§†è§‰æˆ–å£°éŸ³æ•ˆæœ. (<a href="#concepts-gc">GameplayCue</a>)</li><li>ä¸ºä»¥ä¸Šæåˆ°çš„æ‰€æœ‰åº”ç”¨åŒæ­¥(Replication).</li></ul><p>åœ¨å¤šäººæ¸¸æˆä¸­, GASæä¾›å®¢æˆ·ç«¯é¢„æµ‹(<a href="#concepts-p">client-side prediction</a>)æ”¯æŒ:  </p><ul><li>èƒ½åŠ›æ¿€æ´».</li><li>æ’­æ”¾è’™å¤ªå¥‡.</li><li>å¯¹<code>Attribute</code>çš„ä¿®æ”¹.</li><li>åº”ç”¨<code>GameplayTag</code>.</li><li>ç”Ÿæˆ<code>GameplayCue</code>.</li><li>é€šè¿‡è¿æ¥äº<code>CharacterMovementComponent</code>çš„<code>RootMotionSource</code>å‡½æ•°å½¢æˆçš„ç§»åŠ¨.</li></ul><p><strong>GASå¿…é¡»ç”±C++åˆ›å»º</strong>, ä½†æ˜¯<code>GameplayAbility</code>å’Œ<code>GameplayEffect</code>å¯ç”±è®¾è®¡å¸ˆåœ¨è“å›¾ä¸­åˆ›å»º.  </p><p>GASä¸­çš„ç°å­˜é—®é¢˜:</p><ul><li><code>GameplayEffect</code>å»¶è¿Ÿè°ƒèŠ‚(Latency Reconciliation).(ä¸èƒ½é¢„æµ‹èƒ½åŠ›å†·å´æ—¶é—´, å¯¼è‡´é«˜å»¶è¿Ÿç©å®¶ç›¸æ¯”ä½å»¶è¿Ÿç©å®¶, å¯¹äºçŸ­å†·å´æ—¶é—´çš„èƒ½åŠ›æœ‰æ›´ä½çš„æ¿€æ´»é€Ÿç‡.)</li><li>ä¸èƒ½é¢„æµ‹æ€§åœ°ç§»é™¤<code>GameplayEffect</code>. ç„¶è€Œæˆ‘ä»¬å¯ä»¥åå‘é¢„æµ‹æ€§åœ°æ·»åŠ <code>GameplayEffect</code>, ä»è€Œé«˜æ•ˆçš„ç§»é™¤å®ƒ. ä½†æ˜¯è¿™ä¸æ€»æ˜¯åˆé€‚æˆ–è€…å¯è¡Œçš„, å› æ­¤è¿™ä»ç„¶æ˜¯ä¸ªé—®é¢˜.</li><li>ç¼ºä¹æ ·ä¾‹æ¨¡æ¿é¡¹ç›®, å¤šäººè”æœºæ ·ä¾‹å’Œæ–‡æ¡£. å¸Œæœ›è¿™ç¯‡æ–‡æ¡£ä¼šæœ‰æ‰€å¸®åŠ©.</li></ul><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="sp"></a></p><h2 id="2-æ ·ä¾‹é¡¹ç›®"><a href="#2-æ ·ä¾‹é¡¹ç›®" class="headerlink" title="2. æ ·ä¾‹é¡¹ç›®"></a>2. æ ·ä¾‹é¡¹ç›®</h2><p>è¯¥æ–‡æ¡£åŒ…å«ä¸€ä¸ªæ”¯æŒå¤šäººè”æœºçš„ç¬¬ä¸‰äººç§°å°„å‡»æ¸¸æˆæ¨¡æ¿é¡¹ç›®, å…¶ç›®æ ‡å—ä¼—ä¸ºåˆè¯†<code>GameplayAbilitySystem</code>æ’ä»¶, ä½†å¹¶ä¸æ˜¯Unreal Engine 4æ–°æ‰‹. ç”¨æˆ·åº”è¯¥äº†è§£C++, è“å›¾, UMG, Replicationå’Œå…¶ä»–UE4çš„ä¸­é—´ä»¶. è¯¥é¡¹ç›®æä¾›äº†ä¸€ä¸ªæ ·ä¾‹, å…¶å‘ä½ å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>GameplayAbilitySystem</code>æ’ä»¶å»ºç«‹ä¸€ä¸ªåŸºç¡€çš„æ”¯æŒå¤šäººè”æœºçš„ç¬¬ä¸‰äººç§°å°„å‡»æ¸¸æˆ, å…¶ä¸­<code>AbilitySystemComponent(ASC)</code>åˆ†åˆ«ä½äº<code>PlayerState</code>ç±»ä»£è¡¨ç©å®¶/AIæ§åˆ¶çš„äººç‰©å’Œä½äº<code>Character</code>ç±»ä»£è¡¨AIæ§åˆ¶çš„å°å…µ.<br>æˆ‘åœ¨ä¿è¯å±•ç°GASåŸºç¡€å’Œå¸¦æœ‰å®Œæ•´æ³¨é‡Šçš„ä»£ç æ‰€è¡¨ç¤ºçš„ä¸€äº›æ™®éæŠ€èƒ½çš„åŒæ—¶, å°½åŠ›ä½¿è¿™ä¸ªæ ·ä¾‹è¶³å¤Ÿç®€å•. ç”±äºè¯¥æ–‡æ¡£ä¸“æ³¨äºåˆå­¦è€…, å› æ­¤è¯¥æ ·ä¾‹ä¸åŒ…å«åƒ<a href="#concepts-p-spawn">Predicting Projectiles</a>è¿™æ ·çš„é«˜é˜¶æŠ€æœ¯.<br>æ¦‚å¿µè¯´æ˜:  </p><ul><li><code>ASC</code>ä½äº<code>PlayerState</code>è¿˜æ˜¯<code>Character</code>.</li><li>ç½‘ç»œåŒæ­¥çš„<code>Attribute</code>.</li><li>ç½‘ç»œåŒæ­¥çš„è’™å¤ªå¥‡(Animation Montages).</li><li><code>GameplayTag</code>.</li><li>åœ¨<code>GameplayAbility</code>å†…éƒ¨å’Œå¤–éƒ¨åº”ç”¨å’Œç§»é™¤<code>GameplayEffect</code>.</li><li>åº”ç”¨è¢«æŠ¤ç”²é˜²å¾¡åçš„ä¼¤å®³å€¼æ¥ä¿®æ”¹è§’è‰²ç”Ÿå‘½å€¼.</li><li><code>GameplayEffectExecutionCalculations</code>.</li><li>çœ©æ™•æ•ˆæœ.</li><li>æ­»äº¡å’Œé‡ç”Ÿ.</li><li>åœ¨æœåŠ¡ç«¯ä¸Šä½¿ç”¨èƒ½åŠ›(Ability)ç”ŸæˆæŠ›å°„ç‰©(Projectile).</li><li>åœ¨ç„å‡†å’Œå¥”è·‘æ—¶, é¢„æµ‹æ€§çš„ä¿®æ”¹æœ¬åœ°ç©å®¶é€Ÿåº¦.</li><li>ä¸æ–­æ¶ˆè€—è€åŠ›æ¥å¥”è·‘.</li><li>æ¶ˆè€—é­”æ³•å€¼æ¥ä½¿ç”¨èƒ½åŠ›(Ability).</li><li>è¢«åŠ¨èƒ½åŠ›(Ability).</li><li>å †æ ˆ<code>GameplayEffect</code>.</li><li>é”å®šActor.</li><li>åœ¨è“å›¾ä¸­åˆ›å»º<code>GameplayAbility</code>.</li><li>åœ¨C++ä¸­åˆ›å»º<code>GameplayAbility</code>.</li><li>å®ä¾‹åŒ–æ¯ä¸ªActorçš„<code>GameplayAbility</code>.</li><li>éå®ä¾‹åŒ–çš„<code>GameplayAbility</code>(Jump).</li><li>é™æ€<code>GameplayCue</code>(å­å¼¹æ’å‡»ç²’å­æ•ˆæœ).</li><li>Actor <code>GameplayCue</code>(å¥”è·‘å’Œçœ©æ™•ç²’å­æ•ˆæœ).</li></ul><p>è§’è‰²ç±»æœ‰å¦‚ä¸‹èƒ½åŠ›:<br>|èƒ½åŠ›|è¾“å…¥ç»‘å®š|æ˜¯å¦å¯é¢„æµ‹|C++/Blueprint|æè¿°|<br>|:-:|:-:|:-:|:-:|:-:|<br>|è·³è·ƒ|ç©ºæ ¼é”®|Yes|C++|ä½¿è§’è‰²è·³è·ƒ.|<br>|æª|é¼ æ ‡å·¦é”®|No|C++|ä»è§’è‰²çš„æªä¸­å‘å°„æŠ•æ·ç‰©, å‘å°„åŠ¨ç”»æ˜¯å¯é¢„æµ‹çš„, ä½†æ˜¯æŠ•æ·ç‰©ä¸èƒ½é¢„æµ‹.|<br>|ç„å‡†|é¼ æ ‡å³é”®|Yes|Blueprint|å½“æŒ‰ä½é¼ æ ‡å³é”®æ—¶, è§’è‰²ä¼šèµ°çš„æ›´æ…¢å¹¶ä¸”æ‘„åƒæœºä¼šæ‹‰è¿‘(zoom in)ä»¥è·å¾—æ›´é«˜çš„å°„å‡»ç²¾åº¦.|<br>|å¥”è·‘|å·¦Shift|Yes|Blueprint|å½“æŒ‰ä½å·¦Shiftæ—¶, è§’è‰²åœ¨æ¶ˆè€—ä½“åŠ›çš„åŒæ—¶è·‘å¾—æ›´å¿«.|<br>|å‘å‰çŒ›å†²|Q|Yes|Blueprint|è§’è‰²æ¶ˆè€—ä½“åŠ›çš„åŒæ—¶å‘å‰çŒ›å†².|<br>|è¢«åŠ¨æŠ¤ç›¾å åŠ |è¢«åŠ¨|No|Blueprint|æ¯è¿‡4sè§’è‰²è·å¾—ä¸€ä¸ªæœ€å¤§å±‚æ•°ä¸º4çš„æŠ¤ç›¾, æ¯æ¬¡å—åˆ°ä¼¤å®³æ—¶ç§»é™¤ä¸€å±‚æŠ¤ç›¾.|<br>|é™¨çŸ³å è½|R|No|Blueprint|è§’è‰²é”å®šä¸€ä¸ªæ•Œäººå¬å”¤ä¸€ä¸ªé™¨çŸ³, å¯¹å…¶é€ æˆä¼¤å®³å’Œçœ©æ™•æ•ˆæœ. å®šä½æ˜¯å¯ä»¥é¢„æµ‹çš„è€Œé™¨çŸ³ç”Ÿæˆæ˜¯ä¸å¯é¢„æµ‹çš„.|</p><p><code>GameplayAbility</code>æ— è®ºæ˜¯ç”±è“å›¾è¿˜æ˜¯C++åˆ›å»ºéƒ½æ²¡å…³ç³». è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨è“å›¾å’ŒC++æ··åˆåˆ›å»º, æ„åœ¨å±•ç¤ºæ¯ç§æ–¹å¼çš„ä½¿ç”¨æ–¹æ³•.<br>AIæ§åˆ¶çš„å°å…µæ²¡æœ‰é¢„å…ˆå®šä¹‰çš„<code>GameplayAbility</code>. çº¢æ–¹å°å…µæœ‰è¾ƒå¤šçš„ç”Ÿå‘½å›å¤, è“æ–¹å°å…µæœ‰è¾ƒå¤šçš„åˆå§‹ç”Ÿå‘½.<br>å¯¹äº<code>GameplayAbility</code>çš„å‘½å, æˆ‘ä½¿ç”¨<code>_BP</code>åç¼€è¡¨ç¤ºç”±è“å›¾åˆ›å»ºçš„<code>GameplayAbility</code>é€»è¾‘, æ²¡æœ‰åç¼€åˆ™è¡¨ç¤ºç”±C++åˆ›å»º.  </p><p><strong>è“å›¾èµ„æºå‘½åå‰ç¼€</strong><br>|Prefix|Asset Type|<br>|:-:|:-:|<br>|GA<em>|GameplayAbility|<br>|GC</em>|GameplayCue|<br>|GE_|GameplayEffect|</p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="setup"></a></p><h2 id="3-ä½¿ç”¨GASåˆ›å»ºä¸€ä¸ªé¡¹ç›®"><a href="#3-ä½¿ç”¨GASåˆ›å»ºä¸€ä¸ªé¡¹ç›®" class="headerlink" title="3. ä½¿ç”¨GASåˆ›å»ºä¸€ä¸ªé¡¹ç›®"></a>3. ä½¿ç”¨GASåˆ›å»ºä¸€ä¸ªé¡¹ç›®</h2><p>ä½¿ç”¨GASå»ºç«‹ä¸€ä¸ªé¡¹ç›®çš„åŸºæœ¬æ­¥éª¤:  </p><ol><li>åœ¨ç¼–è¾‘å™¨ä¸­å¯ç”¨GameplayAbilitySystemæ’ä»¶.</li><li>ç¼–è¾‘<code>YourProjectName.Build.cs</code>, æ·»åŠ <code>&quot;GameplayAbilities&quot;</code>, <code>&quot;GameplayTags&quot;</code>, <code>&quot;GameplayTasks&quot;</code>åˆ°ä½ çš„<code>PrivateDependencyModuleNames</code>.</li><li>åˆ·æ–°/é‡æ–°ç”ŸæˆVisual Studioé¡¹ç›®æ–‡ä»¶.</li><li>ä»4.24å¼€å§‹, éœ€è¦å¼ºåˆ¶è°ƒç”¨<code>UAbilitySystemGlobals::InitGlobalData()</code>æ¥ä½¿ç”¨<a href="#concepts-targeting-data"><code>TargetData</code></a>, æ ·ä¾‹é¡¹ç›®åœ¨<code>UEngineSubsystem::Initialize()</code>ä¸­è°ƒç”¨è¯¥å‡½æ•°. å‚é˜…<a href="#concepts-asg-initglobaldata"><code>InitGlobalData()</code></a>è·å–æ›´å¤šä¿¡æ¯.</li></ol><p>è¿™å°±æ˜¯ä½ å¯ç”¨GASæ‰€éœ€åšçš„å…¨éƒ¨äº†. ä»è¿™é‡Œå¼€å§‹, æ·»åŠ ä¸€ä¸ª<a href="#concepts-asc"><code>ASC</code></a>å’Œ<a href="#concepts-as"><code>AttributeSet</code></a>åˆ°ä½ çš„<code>Character</code>æˆ–<code>PlayerState</code>, å¹¶å¼€å§‹ç€æ‰‹<a href="#concepts-ga"><code>GameplayAbility</code></a>å’Œ<a href="#concepts-ge"><code>GameplayEffect</code></a>!</p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts"></a></p><h2 id="4-GASæ¦‚å¿µ"><a href="#4-GASæ¦‚å¿µ" class="headerlink" title="4. GASæ¦‚å¿µ"></a>4. GASæ¦‚å¿µ</h2><ul><li>4.1 <a href="#concepts-asc">Ability System Component</a>  </li><li>4.2 <a href="#concepts-gt">Gameplay Tags</a>  </li><li>4.3 <a href="#concepts-a">Attributes</a>  </li><li>4.4 <a href="#concepts-as">Attribute Set</a>  </li><li>4.5 <a href="#concepts-ge">Gameplay Effects</a>  </li><li>4.6 <a href="#concepts-ga">Gameplay Abilities</a>  </li><li>4.7 <a href="#concepts-at">Ability Tasks</a>  </li><li>4.8 <a href="#concepts-gc">Gameplay Cues</a>  </li><li>4.9 <a href="#concepts-asg">Ability System Globals</a>  </li><li>4.10 <a href="#concepts-p">Prediction</a></li></ul><p><a name="concepts-asc"></a></p><h3 id="4-1-Ability-System-Component"><a href="#4-1-Ability-System-Component" class="headerlink" title="4.1 Ability System Component"></a>4.1 Ability System Component</h3><p><code>AbilitySystemComponent(ASC)</code>æ˜¯GASçš„æ ¸å¿ƒ, å®ƒæ˜¯ä¸€ä¸ªå¤„ç†æ‰€æœ‰ä¸è¯¥ç³»ç»Ÿäº¤äº’çš„<code>UActorComponent</code>(<a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/UAbilitySystemComponent/index.html">UAbilitySystemComponent</a>), æ‰€æœ‰æœŸæœ›ä½¿ç”¨<a href="#concepts-ga">GameplayAbility</a>, åŒ…å«<a href="#concepts-a">Attribute</a>, æˆ–è€…æ¥å—<a href="#concepts-ge">GameplayEffect</a>çš„Actoréƒ½å¿…é¡»é™„åŠ <code>ASC</code>. è¿™äº›å¯¹è±¡éƒ½å­˜äº<code>ASC</code>å¹¶ç”±å…¶ç®¡ç†å’ŒåŒæ­¥(é™¤äº†ç”±<a href="#concepts-as">AttributeSet</a>åŒæ­¥çš„<code>Attribute</code>). å¼€å‘è€…æœ€å¥½ä½†ä¸å¼ºæ±‚ç»§æ‰¿è¯¥ç»„ä»¶.  </p><p><code>ASC</code>é™„åŠ çš„<code>Actor</code>è¢«å¼•ç”¨ä½œä¸ºè¯¥<code>ASC</code>çš„<code>OwnerActor</code>, è¯¥<code>ASC</code>çš„ç‰©ç†ä»£è¡¨<code>Actor</code>è¢«ç§°ä¸º<code>AvatarActor</code>. <code>OwnerActor</code>å’Œ<code>AvatarActor</code>å¯ä»¥æ˜¯åŒä¸€ä¸ª <code>Actor</code>, æ¯”å¦‚MOBAæ¸¸æˆä¸­çš„ä¸€ä¸ªç®€å•AIå°å…µ; å®ƒä»¬ä¹Ÿå¯ä»¥æ˜¯ä¸åŒçš„<code>Actor</code>, æ¯”å¦‚MOBAæ¸¸æˆä¸­ç©å®¶æ§åˆ¶çš„è‹±é›„, å…¶ä¸­<code>OwnerActor</code>æ˜¯<code>PlayerState</code>, <code>AvatarActor</code>æ˜¯è‹±é›„çš„<code>Character</code>ç±». ç»å¤§å¤šæ•°Actorçš„<code>ASC</code>éƒ½é™„åŠ åœ¨å…¶è‡ªèº«, å¦‚æœä½ çš„Actorä¼šé‡ç”Ÿå¹¶ä¸”é‡ç”Ÿæ—¶éœ€è¦æŒä¹…åŒ–<code>Attribute</code>æˆ–<code>GameplayEffect</code>(æ¯”å¦‚MOBAä¸­çš„è‹±é›„), é‚£ä¹ˆ<code>ASC</code>ç†æƒ³çš„ä½ç½®å°±æ˜¯<code>PlayerState</code>.  </p><p><strong>Note:</strong> å¦‚æœ<code>ASC</code>ä½äºPlayerState, é‚£ä¹ˆä½ éœ€è¦æé«˜PlayerStateçš„<code>NetUpdateFrequency</code>, å…¶é»˜è®¤æ˜¯ä¸€ä¸ªå¾ˆä½çš„å€¼, å› æ­¤åœ¨å®¢æˆ·ç«¯ä¸Šå‘ç”Ÿ<code>Attribute</code>å’Œ<code>GameplayTag</code>æ”¹å˜æ—¶ä¼šé€ æˆå»¶è¿Ÿæˆ–å¡é¡¿. ç¡®ä¿å¯ç”¨<a href="https://docs.unrealengine.com/en-US/Gameplay/Networking/Actors/Properties/index.html#adaptivenetworkupdatefrequency">Adaptive Network Update Frequency</a>, Fortniteå°±å¯ç”¨äº†è¯¥é¡¹.  </p><p>OwnerActoréœ€è¦ç»§æ‰¿å¹¶å®ç°<code>IAbilitySystemInterface</code>, å¦‚æœAvatarActorå’ŒOwnerActoræ˜¯ä¸åŒçš„Actor, é‚£ä¹ˆAvatarActorä¹Ÿåº”è¯¥ç»§æ‰¿å¹¶å®ç°<code>IAbilitySystemInterface</code>. è¯¥æ¥å£æœ‰ä¸€ä¸ªå¿…é¡»é‡å†™çš„å‡½æ•°, <code>UAbilitySystemComponent* GetAbilitySystemComponent() const</code>, å…¶è¿”å›ä¸€ä¸ªæŒ‡å‘<code>ASC</code>çš„æŒ‡é’ˆ, <code>ASC</code>é€šè¿‡å¯»æ‰¾è¯¥æ¥å£å‡½æ•°æ¥å’Œç³»ç»Ÿå†…éƒ¨è¿›è¡Œäº¤äº’.  </p><p><code>ASC</code>åœ¨<code>FActiveGameplayEffectContainer ActiveGameplayEffect</code>ä¸­ä¿å­˜å…¶å½“å‰æ´»è·ƒçš„<code>GameplayEffect</code>.  </p><p><code>ASC</code>åœ¨<code>FGameplayAbilitySpecContainer ActivatableAbility</code>ä¸­ä¿å­˜å…¶æˆäºˆçš„<code>GameplayAbility</code>. å½“ä½ æƒ³éå†<code>ActivatableAbility.Items</code>æ—¶, ç¡®ä¿åœ¨å¾ªç¯ä½“ä¹‹ä¸Šæ·»åŠ <code>ABILITYLIST_SCOPE_LOCK();</code>æ¥é”å®šåˆ—è¡¨ä»¥é˜²å…¶æ”¹å˜(æ¯”å¦‚ç§»é™¤ä¸€ä¸ªAbility). æ¯ä¸ªåŸŸä¸­çš„<code>ABILITYLIST_SCOPE_LOCK();</code>ä¼šå¢åŠ <code>AbilityScopeLockCount</code>, ä¹‹åå‡ºåŸŸæ—¶ä¼šå‡é‡. ä¸è¦å°è¯•åœ¨<code>ABILITYLIST_SCOPE_LOCK();</code>åŸŸä¸­ç§»é™¤æŸä¸ªAbility(Abilityåˆ é™¤å‡½æ•°ä¼šåœ¨å†…éƒ¨æ£€æŸ¥<code>AbilityScopeLockCount</code>ä»¥é˜²åœ¨åˆ—è¡¨é”å®šæ—¶ç§»é™¤Ability).  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-asc-rm"></a></p><h4 id="4-1-1-åŒæ­¥æ¨¡å¼"><a href="#4-1-1-åŒæ­¥æ¨¡å¼" class="headerlink" title="4.1.1 åŒæ­¥æ¨¡å¼"></a>4.1.1 åŒæ­¥æ¨¡å¼</h4><p><code>ASC</code>å®šä¹‰äº†ä¸‰ç§ä¸åŒçš„åŒæ­¥æ¨¡å¼ç”¨äºåŒæ­¥<code>GameplayEffect</code>, <code>GameplayTag</code>å’Œ<code>GameplayCue</code> - <code>Full</code>, <code>Mixed</code>å’Œ<code>Minimal</code>. <code>Attribute</code>ç”±å…¶<code>AttributeSet</code>åŒæ­¥.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">åŒæ­¥æ¨¡å¼</th><th style="text-align:center">ä½•æ—¶ä½¿ç”¨</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center"><code>Full</code></td><td style="text-align:center">å•äºº</td><td style="text-align:center">æ‰€æœ‰<code>GameplayEffect</code>éƒ½åŒæ­¥åˆ°å®¢æˆ·ç«¯.</td></tr><tr><td style="text-align:center"><code>Mixed</code></td><td style="text-align:center">å¤šäºº, ç©å®¶æ§åˆ¶çš„Actor</td><td style="text-align:center"><code>GameplayEffect</code>åªåŒæ­¥åˆ°å…¶æ‰€å±å®¢æˆ·ç«¯, åªæœ‰<code>GameplayTag</code>å’Œ<code>GameplayCue</code>åŒæ­¥åˆ°æ‰€æœ‰å®¢æˆ·ç«¯.</td></tr><tr><td style="text-align:center"><code>Minimal</code></td><td style="text-align:center">å¤šäºº, AIæ§åˆ¶çš„Actor</td><td style="text-align:center"><code>GameplayEffect</code>ä»ä¸åŒæ­¥åˆ°ä»»ä½•å®¢æˆ·ç«¯, åªæœ‰<code>GameplayTag</code>å’Œ<code>GameplayCue</code>åŒæ­¥åˆ°æ‰€æœ‰å®¢æˆ·ç«¯.</td></tr></tbody></table></div><p><strong>Note:</strong> <code>Mixed</code>åŒæ­¥æ¨¡å¼éœ€è¦<code>OwnerActor</code>çš„<code>Owner</code>æ˜¯<code>Controller</code>. <code>PlayerState</code>çš„<code>Owner</code>é»˜è®¤æ˜¯<code>Controller</code>ä½†æ˜¯<code>Character</code>ä¸æ˜¯. å¦‚æœ<code>OwnerActor</code>ä¸æ˜¯<code>PlayerState</code>æ—¶ä½¿ç”¨<code>Mixed</code>åŒæ­¥æ¨¡å¼, é‚£ä¹ˆéœ€è¦åœ¨<code>OwnerActor</code>ä¸­è°ƒç”¨<code>SetOwner()</code>è®¾ç½®<code>Controller</code>.  </p><p>ä»4.24å¼€å§‹, éœ€è¦ä½¿ç”¨<code>PossessedBy()</code>è®¾ç½®æ–°çš„<code>Controller</code>ä¸º<code>Pawn</code>çš„Owner.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-asc-setup"></a></p><h4 id="4-1-2-è®¾ç½®å’Œåˆå§‹åŒ–"><a href="#4-1-2-è®¾ç½®å’Œåˆå§‹åŒ–" class="headerlink" title="4.1.2 è®¾ç½®å’Œåˆå§‹åŒ–"></a>4.1.2 è®¾ç½®å’Œåˆå§‹åŒ–</h4><p><code>ASC</code>ä¸€èˆ¬åœ¨<code>OwnerActor</code>çš„æ„å»ºå‡½æ•°ä¸­åˆ›å»ºå¹¶ä¸”éœ€è¦æ˜ç¡®æ ‡è®°ä¸ºReplicated. <strong>è¿™å¿…é¡»åœ¨C++ä¸­å®Œæˆ.</strong>  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">AGDPlayerState::<span class="built_in">AGDPlayerState</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Create Ability system component, and set it to be explicitly replicated</span></span><br><span class="line">AbilitySystemComponent = <span class="built_in">CreateDefaultSubobject</span>&lt;UGDAbilitySystemComponent&gt;(<span class="built_in">TEXT</span>(<span class="string">&quot;AbilitySystemComponent&quot;</span>));</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">SetIsReplicated</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>OwnerActor</code>å’Œ<code>AvatarActor</code>çš„<code>ASC</code>åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸Šå‡éœ€åˆå§‹åŒ–, ä½ åº”è¯¥åœ¨<code>Pawn</code>çš„<code>Controller</code>è®¾ç½®ä¹‹ååˆå§‹åŒ–(Possessä¹‹å), å•äººæ¸¸æˆåªéœ€å‚è€ƒæœåŠ¡ç«¯çš„åšæ³•.  </p><p>å¯¹äºç©å®¶æ§åˆ¶çš„Characterä¸”<code>ASC</code>ä½äº<code>Pawn</code>, æˆ‘ä¸€èˆ¬åœ¨æœåŠ¡ç«¯<code>Pawn</code>çš„<code>PossessedBy()</code>å‡½æ•°ä¸­åˆå§‹åŒ–, åœ¨å®¢æˆ·ç«¯<code>PlayerController</code>çš„<code>AcknowledgePossession()</code>å‡½æ•°ä¸­åˆå§‹åŒ–.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">APACharacterBase::PossessedBy</span><span class="params">(AController * NewController)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">PossessedBy</span>(NewController);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (AbilitySystemComponent)</span><br><span class="line">&#123;</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">InitAbilityActorInfo</span>(<span class="keyword">this</span>, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ASC MixedMode replication requires that the ASC Owner&#x27;s Owner be the Controller.</span></span><br><span class="line"><span class="built_in">SetOwner</span>(NewController);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">APAPlayerControllerBase::AcknowledgePossession</span><span class="params">(APawn* P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">AcknowledgePossession</span>(P);</span><br><span class="line"></span><br><span class="line">APACharacterBase* CharacterBase = <span class="built_in">Cast</span>&lt;APACharacterBase&gt;(P);</span><br><span class="line"><span class="keyword">if</span> (CharacterBase)</span><br><span class="line">&#123;</span><br><span class="line">CharacterBase-&gt;<span class="built_in">GetAbilitySystemComponent</span>()-&gt;<span class="built_in">InitAbilityActorInfo</span>(CharacterBase, CharacterBase);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºç©å®¶æ§åˆ¶çš„Characterä¸”<code>ASC</code>ä½äº<code>PlayerState</code>, æˆ‘ä¸€èˆ¬åœ¨æœåŠ¡ç«¯<code>Pawn</code>çš„<code>PossessedBy()</code>å‡½æ•°ä¸­åˆå§‹åŒ–, åœ¨å®¢æˆ·ç«¯PlayerControllerçš„<code>OnRep_PlayerState()</code>å‡½æ•°ä¸­åˆå§‹åŒ–, è¿™ç¡®ä¿äº†<code>PlayerState</code>å­˜åœ¨äºå®¢æˆ·ç«¯ä¸Š.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AGDHeroCharacter::PossessedBy</span><span class="params">(AController * NewController)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">PossessedBy</span>(NewController);</span><br><span class="line"></span><br><span class="line">AGDPlayerState* PS = <span class="built_in">GetPlayerState</span>&lt;AGDPlayerState&gt;();</span><br><span class="line"><span class="keyword">if</span> (PS)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Set the ASC on the Server. Clients do this in OnRep_PlayerState()</span></span><br><span class="line">AbilitySystemComponent = <span class="built_in">Cast</span>&lt;UGDAbilitySystemComponent&gt;(PS-&gt;<span class="built_in">GetAbilitySystemComponent</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// AI won&#x27;t have PlayerControllers so we can init again here just to be sure. No harm in initing twice for heroes that have PlayerControllers.</span></span><br><span class="line">PS-&gt;<span class="built_in">GetAbilitySystemComponent</span>()-&gt;<span class="built_in">InitAbilityActorInfo</span>(PS, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AGDHeroCharacter::OnRep_PlayerState</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">OnRep_PlayerState</span>();</span><br><span class="line"></span><br><span class="line">AGDPlayerState* PS = <span class="built_in">GetPlayerState</span>&lt;AGDPlayerState&gt;();</span><br><span class="line"><span class="keyword">if</span> (PS)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Set the ASC for clients. Server does this in PossessedBy.</span></span><br><span class="line">AbilitySystemComponent = <span class="built_in">Cast</span>&lt;UGDAbilitySystemComponent&gt;(PS-&gt;<span class="built_in">GetAbilitySystemComponent</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Init ASC Actor Info for clients. Server will init its `ASC` when it possesses a new Actor.</span></span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">InitAbilityActorInfo</span>(PS, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ é‡åˆ°äº†é”™è¯¯æ¶ˆæ¯<code>LogAbilitySystem: Warning: Can&#39;t activate LocalOnly or LocalPredicted Ability %s when not local!</code>, é‚£ä¹ˆå°±è¡¨æ˜<code>ASC</code>æ²¡æœ‰åœ¨å®¢æˆ·ç«¯ä¸­åˆå§‹åŒ–.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gt"></a></p><h3 id="4-2-Gameplay-Tags"><a href="#4-2-Gameplay-Tags" class="headerlink" title="4.2 Gameplay Tags"></a>4.2 Gameplay Tags</h3><p><code>FGameplayTag</code>æ˜¯ç”±<code>GameplayTagManager</code>æ³¨å†Œçš„å½¢ä¼¼<code>Parent.Child.Grandchild...</code>çš„å±‚çº§Name, è¿™äº›æ ‡ç­¾å¯¹äºåˆ†ç±»å’Œæè¿°å¯¹è±¡çš„çŠ¶æ€éå¸¸æœ‰ç”¨, ä¾‹å¦‚, å¦‚æœæŸä¸ªCharacterå¤„äºçœ©æ™•çŠ¶æ€, æˆ‘ä»¬å¯ä»¥ç»™ä¸€ä¸ª<code>State.Debuff.Stun</code>çš„<code>GameplayTag</code>.  </p><p>ä½ ä¼šå‘ç°è‡ªå·±ä½¿ç”¨<code>GameplayTag</code>æ›¿æ¢äº†è¿‡å»ä½¿ç”¨å¸ƒå°”å€¼æˆ–æšä¸¾å€¼æ¥ç¼–ç¨‹, å¹¶ä¸”éœ€è¦å¯¹å¯¹è±¡æœ‰æ— ç‰¹å®šçš„<code>GameplayTag</code>åšå¸ƒå°”é€»è¾‘åˆ¤æ–­.  </p><p>å½“ç»™æŸä¸ªå¯¹è±¡è®¾ç½®æ ‡ç­¾æ—¶, å¦‚æœå®ƒæœ‰<code>ASC</code>çš„è¯, æˆ‘ä»¬ä¸€èˆ¬æ·»åŠ æ ‡ç­¾åˆ°<code>ASC</code>ä»¥ä¸å…¶äº¤äº’. UAbilitySystemComponentæ‰§è¡Œ<code>IGameplayTagAssetInterface</code>æ¥å£çš„å‡½æ•°æ¥è®¿é—®å…¶æ‹¥æœ‰çš„<code>GameplayTag</code>.  </p><p>å¤šä¸ª<code>GameplayTag</code>å¯è¢«ä¿å­˜äºä¸€ä¸ª<code>FGameplayTagContainer</code>ä¸­, ç›¸æ¯”<code>TArray&lt;FGameplayTag&gt;</code>, æœ€å¥½ä½¿ç”¨<code>GameplayTagContainer</code>, å› ä¸º<code>GameplayTagContainer</code>åšäº†ä¸€äº›å¾ˆæœ‰æ•ˆç‡çš„ä¼˜åŒ–. å› ä¸ºæ ‡ç­¾æ˜¯æ ‡å‡†çš„<code>FName</code>, æ‰€ä»¥å½“åœ¨é¡¹ç›®è®¾ç½®(Project Setting)ä¸­å¯ç”¨<code>Fast Replication</code>å, å®ƒä»¬å¯ä»¥é«˜æ•ˆåœ°æ‰“åŒ…è¿›<code>FGameplayTagContainer</code>ä»¥ç”¨äºåŒæ­¥. <code>Fast Replication</code>è¦æ±‚æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æœ‰ç›¸åŒçš„<code>GameplayTag</code>åˆ—è¡¨, è¿™é€šå¸¸ä¸æ˜¯é—®é¢˜, å› æ­¤ä½ åº”è¯¥å¯ç”¨è¯¥é€‰é¡¹. <code>GameplayTagContainer</code>ä¹Ÿå¯ä»¥è¿”å›<code>TArray&lt;FGameplayTag&gt;</code>ä»¥ç”¨äºéå†.  </p><p>ä¿å­˜äº<code>FGameplayTagCountContainer</code>ä¸­çš„<code>GameplayTag</code>æœ‰ä¿å­˜è¯¥<code>GameplayTag</code>å®ä¾‹æ•°çš„<code>TagMap</code>. FGameplayTagCountContainerå¯èƒ½å­˜æœ‰<code>TagMapCount</code>ä¸º0çš„<code>GameplayTag</code>, ä½ å¯èƒ½åœ¨Debugæ—¶é‡åˆ°è¿™ç§æƒ…å†µ. ä»»ä½•<code>HasTag()</code>æˆ–<code>HasMatchingTag()</code>æˆ–å…¶ä»–ç›¸ä¼¼çš„å‡½æ•°ä¼šæ£€æŸ¥<code>TagMapCount</code>, å¦‚æœ<code>GameplayTag</code>ä¸å­˜åœ¨æˆ–è€…å…¶<code>TagMapCount</code>ä¸º0å°±ä¼šè¿”å›false.  </p><p><code>GameplayTag</code>å¿…é¡»åœ¨<code>DefaultGameplayTag.ini</code>ä¸­æå‰å®šä¹‰, UE4ç¼–è¾‘å™¨åœ¨é¡¹ç›®è®¾ç½®ä¸­æä¾›äº†ä¸€ä¸ªç•Œé¢ä¾›å¼€å‘è€…ç®¡ç†<code>GameplayTag</code>è€Œæ— éœ€æ‰‹åŠ¨ç¼–è¾‘DefaultGameplayTag.ini, è¯¥<code>GameplayTag</code>ç¼–è¾‘å™¨å¯ä»¥åˆ›å»º, é‡å‘½å, æœç´¢å¼•ç”¨å’Œåˆ é™¤<code>GameplayTag</code>.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/gameplaytageditor.png" alt="GameplayTag Editor in Project Settings">  </p><p>æœç´¢<code>GameplayTag</code>ä¼šå¼¹å‡ºä¸€ä¸ªç±»ä¼¼Reference Viewerçš„çª—å£æ¥æ˜¾ç¤ºæ‰€æœ‰å¼•ç”¨è¯¥<code>GameplayTag</code>çš„èµ„æº, ä½†è¿™ä¸ä¼šæ˜¾ç¤ºä»»ä½•å¼•ç”¨è¯¥<code>GameplayTag</code>çš„C++ç±».  </p><p>é‡å‘½å<code>GameplayTag</code>ä¼šåˆ›å»ºé‡å®šå‘, å› æ­¤ä»å¼•ç”¨åŸæ¥<code>GameplayTag</code>çš„èµ„æºä¼šé‡å®šå‘åˆ°æ–°çš„<code>GameplayTag</code>. å¦‚æœå¯ä»¥çš„è¯, æˆ‘æ›´å€¾å‘äºåˆ›å»ºæ–°çš„<code>GameplayTag</code>, æ‰‹åŠ¨æ›´æ–°æ‰€æœ‰å¼•ç”¨åˆ°æ–°çš„<code>GameplayTag</code>, ä¹‹ååˆ é™¤æ—§çš„<code>GameplayTag</code>ä»¥é¿å…åˆ›å»ºæ–°çš„é‡å®šå‘.  </p><p>é™¤äº†<code>Fast Replication</code>, <code>GameplayTag</code>ç¼–è¾‘å™¨å¯ä»¥é€‰æ‹©å¡«å……æ™®ééœ€è¦åŒæ­¥çš„<code>GameplayTag</code>ä»¥å¯¹å…¶æ·±åº¦ä¼˜åŒ–.  </p><p>å¦‚æœ<code>GameplayTag</code>ç”±<code>GameplayEffect</code>æ·»åŠ , é‚£ä¹ˆå…¶å°±æ˜¯å¯åŒæ­¥çš„. <code>ASC</code>å…è®¸ä½ æ·»åŠ ä¸å¯åŒæ­¥çš„<code>LooseGameplayTag</code>ä¸”å¿…é¡»æ‰‹åŠ¨ç®¡ç†. æ ·ä¾‹é¡¹ç›®å¯¹<code>State.Dead</code>ä½¿ç”¨äº†<code>LooseGameplayTag</code>, å› æ­¤å½“ç”Ÿå‘½å€¼é™ä¸º0æ—¶, å…¶æ‰€å±å®¢æˆ·ç«¯ä¼šç«‹å³å“åº”. é‡ç”Ÿæ—¶éœ€è¦æ‰‹åŠ¨å°†<code>TagMapCount</code>è®¾ç½®å›0, å½“ä½¿ç”¨<code>LooseGameplayTag</code>æ—¶åªèƒ½æ‰‹åŠ¨è°ƒæ•´<code>TagMapCount</code>, ç›¸æ¯”çº¯æ‰‹åŠ¨è°ƒæ•´<code>TagMapCount</code>, æœ€å¥½ä½¿ç”¨<code>UAbilitySystemComponent::AddLooseGameplayTag()</code>å’Œ<code>UAbilitySystemComponent::RemoveLooseGameplayTag()</code>.  </p><p>C++ä¸­è·å–<code>GameplayTag</code>å¼•ç”¨:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="built_in">FName</span>(<span class="string">&quot;Your.GameplayTag.Name&quot;</span>))</span><br></pre></td></tr></table></figure><p>å¯¹äºåƒè·å–çˆ¶æˆ–å­<code>GameplayTag</code>çš„é«˜é˜¶æ“ä½œ, è¯·æŸ¥çœ‹<code>GameplayTagManager</code>æä¾›çš„å‡½æ•°. ä¸ºäº†è®¿é—®<code>GameplayTagManager</code>, è¯·å¼•ç”¨<code>GameplayTagManager.h</code>å¹¶ä½¿ç”¨<code>UGameplayTagManager::Get().FunctionName</code>è°ƒç”¨å‡½æ•°. ç›¸æ¯”ä½¿ç”¨å¸¸é‡å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œå’Œæ¯”è¾ƒ, <code>GameplayTagManager</code>å®é™…ä¸Šä½¿ç”¨å…³ç³»èŠ‚ç‚¹(çˆ¶, å­ç­‰ç­‰)ä¿å­˜<code>GameplayTag</code>ä»¥è·å¾—æ›´å¿«çš„å¤„ç†é€Ÿåº¦.  </p><p><code>GameplayTag</code>å’Œ<code>GameplayTagContainer</code>æœ‰å¯é€‰UPROPERTYå®<code>Meta = (Categories = &quot;GameplayCue&quot;)</code>ç”¨äºåœ¨è“å›¾ä¸­è¿‡æ»¤æ ‡ç­¾è€Œåªæ˜¾ç¤ºçˆ¶æ ‡ç­¾ä¸º<code>GameplayCue</code>çš„<code>GameplayTag</code>, å½“ä½ çŸ¥é“<code>GameplayTag</code>æˆ–<code>GameplayTagContainer</code>å˜é‡åº”è¯¥åªç”¨äº<code>GameplayCue</code>æ—¶, è¿™å°†æ˜¯éå¸¸æœ‰ç”¨çš„.  </p><p>ä½œä¸ºé€‰æ‹©, æœ‰ä¸€å•ç‹¬çš„<code>FGameplayCueTag</code>ç»“æ„ä½“å¯ä»¥åŒ…è£¹<code>FGameplayTag</code>å¹¶ä¸”å¯ä»¥åœ¨è“å›¾ä¸­è‡ªåŠ¨è¿‡æ»¤<code>GameplayTag</code>è€Œåªæ˜¾ç¤ºçˆ¶æ ‡ç­¾ä¸º<code>GameplayCue</code>çš„æ ‡ç­¾.  </p><p>å¦‚æœä½ æƒ³è¿‡æ»¤å‡½æ•°ä¸­çš„<code>GameplayTag</code>å‚æ•°, ä½¿ç”¨UFUNCTIONå®<code>Meta = (GameplayTagFilter = &quot;GameplayCue&quot;)</code>. <code>GameplayTagContainer</code>å‚æ•°ä¸èƒ½è¿‡æ»¤, å¦‚æœä½ æƒ³ç¼–è¾‘å¼•æ“æ¥å…è®¸è¿‡æ»¤<code>GameplayTagContainer</code>å‚æ•°, æŸ¥çœ‹<code>SGameplayTagGraphPin::ParseDefaultValueData()</code>æ˜¯å¦‚ä½•ä»<code>Engine\Plugins\Editor\GameplayTagEditor\Source\GameplayTagEditor\Private\SGameplayTagGraphPin.cpp</code>ä¸­è°ƒç”¨<code>FilterString = UGameplayTagManager::Get().GetCategoriesMetaFromField(PinStructType);</code>çš„, è¿˜æœ‰æ˜¯å¦‚ä½•åœ¨<code>SGameplayTagGraphPin::GetListContent()</code>ä¸­å°†<code>FilterString</code>ä¼ é€’ç»™<code>SGameplayTagWidget</code>çš„, <code>Engine\Plugins\Editor\GameplayTagEditor\Source\GameplayTagEditor\Private\S</code>GameplayTagContainer<code>GraphPin.cpp</code>ä¸­è¿™äº›å‡½æ•°çš„<code>GameplayTagContainer</code>ç‰ˆæœ¬å¹¶æ²¡æœ‰æ£€æŸ¥MetaåŸŸå±æ€§å’Œä¼ é€’è¿‡æ»¤å™¨.  </p><p>æ ·ä¾‹é¡¹ç›®å¹¿æ³›åœ°ä½¿ç”¨äº†<code>GameplayTag</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gt-change"></a></p><h4 id="4-2-1-å“åº”Gameplay-Tagsçš„å˜åŒ–"><a href="#4-2-1-å“åº”Gameplay-Tagsçš„å˜åŒ–" class="headerlink" title="4.2.1 å“åº”Gameplay Tagsçš„å˜åŒ–"></a>4.2.1 å“åº”Gameplay Tagsçš„å˜åŒ–</h4><p><code>ASC</code>æä¾›äº†ä¸€ä¸ªå§”æ‰˜(Delegate)ç”¨äºåœ¨<code>GameplayTag</code>æ·»åŠ æˆ–ç§»é™¤æ—¶è§¦å‘, å…¶ä¸­<code>EGameplayTagEventType</code>å‚æ•°å¯ä»¥æ˜ç¡®æ˜¯è¯¥<code>GameplayTag</code>æ·»åŠ /ç§»é™¤è¿˜æ˜¯å…¶<code>TagMapCount</code>å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AbilitySystemComponent-&gt;<span class="built_in">RegisterGameplayTagEvent</span>(FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="built_in">FName</span>(<span class="string">&quot;State.Debuff.Stun&quot;</span>)), EGameplayTagEventType::NewOrRemoved).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;AGDPlayerState::StunTagChanged);</span><br></pre></td></tr></table></figure><p>å›è°ƒå‡½æ•°æ‹¥æœ‰å˜åŒ–çš„<code>GameplayTag</code>å‚æ•°å’Œæ–°çš„<code>TagCount</code>å‚æ•°.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">StunTagChanged</span><span class="params">(<span class="type">const</span> FGameplayTag CallbackTag, int32 NewCount)</span></span>;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-a"></a></p><h3 id="4-3-Attribute"><a href="#4-3-Attribute" class="headerlink" title="4.3 Attribute"></a>4.3 Attribute</h3><p><a name="concepts-a-definition"></a></p><h4 id="4-3-1-Attributeå®šä¹‰"><a href="#4-3-1-Attributeå®šä¹‰" class="headerlink" title="4.3.1 Attributeå®šä¹‰"></a>4.3.1 Attributeå®šä¹‰</h4><p><code>Attribute</code>æ˜¯ç”±<a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/FGameplayAttributeData/index.html">FGameplayAttributeData</a>ç»“æ„ä½“å®šä¹‰çš„æµ®ç‚¹å€¼, å…¶å¯ä»¥è¡¨ç¤ºä»è§’è‰²ç”Ÿå‘½å€¼åˆ°è§’è‰²ç­‰çº§å†åˆ°ä¸€ç“¶è¯æ°´çš„å‰‚é‡çš„ä»»ä½•äº‹ç‰©, å¦‚æœæŸé¡¹æ•°å€¼æ˜¯å±äºæŸä¸ªActorä¸”æ¸¸æˆç›¸å…³çš„, ä½ å°±åº”è¯¥è€ƒè™‘ä½¿ç”¨<code>Attribute</code>. <code>Attribute</code>ä¸€èˆ¬åº”è¯¥åªèƒ½ç”±<a href="#concepts-ge">GameplayEffect</a>ä¿®æ”¹, è¿™æ ·<code>ASC</code>æ‰èƒ½<a href="#concepts-p">é¢„æµ‹(Predict)</a>å…¶æ”¹å˜.  </p><p><code>Attribute</code>ä¹Ÿå¯ä»¥ç”±<code>AttributeSet</code>å®šä¹‰å¹¶å­˜äºå…¶ä¸­. <a href="#concepts-as">AttributeSet</a>ç”¨äºåŒæ­¥é‚£äº›æ ‡è®°ä¸ºreplicationçš„<code>Attribute</code>. å‚é˜…<a href="#concepts-as">AttributeSet</a>éƒ¨åˆ†æ¥äº†è§£å¦‚ä½•å®šä¹‰<code>Attribute</code>.  </p><p><strong>Tip</strong>: å¦‚æœä½ ä¸æƒ³æŸä¸ª<code>Attribute</code>æ˜¾ç¤ºåœ¨ç¼–è¾‘å™¨çš„<code>Attribute</code>åˆ—è¡¨, å¯ä»¥ä½¿ç”¨<code>Meta = (HideInDetailsView)</code>å±æ€§å®.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-a-value"></a></p><h4 id="4-3-2-BaseValue-vs-CurrentValue"><a href="#4-3-2-BaseValue-vs-CurrentValue" class="headerlink" title="4.3.2 BaseValue vs. CurrentValue"></a>4.3.2 BaseValue vs. CurrentValue</h4><p>ä¸€ä¸ª<code>Attribute</code>æ˜¯ç”±ä¸¤ä¸ªå€¼ â€”â€” ä¸€ä¸ª<code>BaseValue</code>å’Œä¸€ä¸ª<code>CurrentValue</code>ç»„æˆçš„, <code>BaseValue</code>æ˜¯<code>Attribute</code>çš„æ°¸ä¹…å€¼è€Œ<code>CurrentValue</code>æ˜¯<code>BaseValue</code>åŠ ä¸Š<code>GameplayEffect</code>ç»™çš„ä¸´æ—¶ä¿®æ”¹å€¼åå¾—åˆ°çš„. ä¾‹å¦‚, ä½ çš„Characterå¯èƒ½æœ‰ä¸€ä¸ª<code>BaseValue</code>ä¸º600u/sçš„ç§»åŠ¨é€Ÿåº¦<code>Attribute</code>, å› ä¸ºè¿˜æ²¡æœ‰<code>GameplayEffect</code>ä¿®æ”¹ç§»åŠ¨é€Ÿåº¦, æ‰€ä»¥<code>CurrentValue</code>ä¹Ÿæ˜¯600u/s, å¦‚æœCharacterè·å¾—äº†ä¸€ä¸ªä¸´æ—¶50u/sçš„ç§»åŠ¨é€Ÿåº¦åŠ æˆ, é‚£ä¹ˆ<code>BaseValue</code>ä»ç„¶æ˜¯600u/sè€Œ<code>CurrentValue</code>æ˜¯600+50=650u/s, å½“è¯¥ç§»åŠ¨é€Ÿåº¦åŠ æˆæ¶ˆå¤±å, <code>CurrentValue</code>å°±ä¼šå˜å›<code>BaseValue</code>çš„600u/s.  </p><p>åˆè¯†GASçš„æ–°æ‰‹ç»å¸¸å°†<code>BaseValue</code>è¯¯è®¤ä¸º<code>Attribute</code>çš„æœ€å¤§å€¼å¹¶ä»¥è¿™æ ·çš„è®¤è¯†å»ç¼–ç¨‹, è¿™æ˜¯é”™è¯¯çš„, å¯ä»¥ä¿®æ”¹æˆ–å¼•ç”¨çš„Ability/UIä¸­çš„<code>Attribute</code>æœ€å¤§å€¼åº”è¯¥æ˜¯å¦å¤–å•ç‹¬çš„<code>Attribute</code>. å¯¹äºç¡¬ç¼–ç çš„æœ€å¤§å€¼å’Œæœ€å°å€¼, æœ‰ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨å¯ä»¥è®¾ç½®æœ€å¤§å€¼å’Œæœ€å°å€¼çš„<code>FAttributeMetaData</code>å®šä¹‰ä¸€ä¸ªDataTable, ä½†æ˜¯Epicåœ¨è¯¥ç»“æ„ä½“ä¸Šçš„æ³¨é‡Šç§°ä¹‹ä¸ºâ€work in progressâ€, è¯¦è§<code>AttributeSet.h</code>. ä¸ºäº†é¿å…è¿™ç§ç–‘æƒ‘, æˆ‘å»ºè®®å¼•ç”¨åœ¨Abilityæˆ–UIä¸­çš„æœ€å¤§å€¼åº”è¯¥å•ç‹¬å®šä¹‰<code>Attribute</code>, åªç”¨äºé™åˆ¶(Clamp)<code>Attribute</code>å¤§å°çš„ç¡¬ç¼–ç æœ€å¤§å€¼å’Œæœ€å°å€¼åº”è¯¥åœ¨<code>AttributeSet</code>ä¸­å®šä¹‰ä¸ºç¡¬ç¼–ç æµ®ç‚¹å€¼. å…³äºé™åˆ¶(Clamp)<code>Attribute</code>å€¼çš„é—®é¢˜åœ¨<a href="#concepts-as-preattributechange">PreAttributeChange()</a>ä¸­è®¨è®ºäº†CurrentValueçš„ä¿®æ”¹, åœ¨<a href="#concepts-as-postgameplayeffectexecute">PostGameplayEffectExecute()</a>ä¸­è®¨è®ºäº†<code>GameplayEffect</code>å¯¹<code>BaseValue</code>çš„ä¿®æ”¹.  </p><p><code>å³åˆ»(Instant)GameplayEffect</code>å¯ä»¥æ°¸ä¹…æ€§çš„ä¿®æ”¹<code>BaseValue</code>, è€Œ<code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)GameplayEffect</code>å¯ä»¥ä¿®æ”¹CurrentValue. å‘¨æœŸæ€§(Periodic)<code>GameplayEffect</code>è¢«è§†ä¸º<code>å³åˆ»(Instant)GameplayEffect</code>å¹¶ä¸”å¯ä»¥ä¿®æ”¹<code>BaseValue</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-a-meta"></a></p><h4 id="4-3-3-å…ƒ-Meta-Attribute"><a href="#4-3-3-å…ƒ-Meta-Attribute" class="headerlink" title="4.3.3 å…ƒ(Meta)Attribute"></a>4.3.3 å…ƒ(Meta)Attribute</h4><p>ä¸€äº›<code>Attribute</code>è¢«è§†ä¸ºå ä½ç¬¦, å…¶æ˜¯ç”¨äºé¢„è®¡å’Œ<code>Attribute</code>äº¤äº’çš„ä¸´æ—¶å€¼, è¿™äº›<code>Attribute</code>è¢«å«åš<code>Meta Attribute</code>. ä¾‹å¦‚, æˆ‘ä»¬é€šå¸¸å®šä¹‰ä¼¤å®³å€¼ä¸º<code>Meta Attribute</code>, ä½¿ç”¨ä¼¤å®³å€¼<code>Meta Attribute</code>ä½œä¸ºå ä½ç¬¦, è€Œä¸æ˜¯ä½¿ç”¨<code>GameplayEffect</code>ç›´æ¥ä¿®æ”¹ç”Ÿå‘½å€¼<code>Attribute</code>, ä½¿ç”¨è¿™ç§æ–¹æ³•, ä¼¤å®³å€¼å°±å¯ä»¥åœ¨<a href="#concepts-ge-ec">GameplayEffectExecutionCalculation</a>ä¸­ç”±buffå’Œdebuffä¿®æ”¹, å¹¶ä¸”å¯ä»¥åœ¨<code>AttributeSet</code>ä¸­è¿›ä¸€æ­¥æ“ä½œ, ä¾‹å¦‚, åœ¨æœ€ç»ˆå°†ç”Ÿå‘½å€¼å‡å»ä¼¤å®³å€¼ä¹‹å‰, è¦å°†ä¼¤å®³å€¼å‡å»å½“å‰çš„æŠ¤ç›¾å€¼. ä¼¤å®³å€¼<code>Meta Attribute</code>åœ¨<code>GameplayEffect</code>ä¹‹é—´ä¸æ˜¯æŒä¹…åŒ–çš„, å¹¶ä¸”å¯ä»¥è¢«ä»»ä½•ä¸€æ–¹é‡å†™. <code>Meta Attribute</code>ä¸€èˆ¬æ˜¯ä¸å¯åŒæ­¥çš„.  </p><p><code>Meta Attribute</code>å¯¹äºåœ¨â€æˆ‘ä»¬åº”è¯¥é€ æˆå¤šå°‘ä¼¤å®³?â€å’Œâ€æˆ‘ä»¬è¯¥å¦‚ä½•å¤„ç†ä¼¤å®³å€¼?â€è¿™ç§é—®é¢˜ä¹‹ä¸­çš„ä¼¤å®³å€¼å’Œæ²»ç–—å€¼åšäº†å¾ˆå¥½çš„è§£æ„, è¿™ç§è§£æ„æ„å‘³ç€<code>GameplayEffect</code>å’Œ<code>ExecutionCalculation</code>æ— éœ€äº†è§£ç›®æ ‡æ˜¯å¦‚ä½•å¤„ç†ä¼¤å®³å€¼çš„. ç»§ç»­çœ‹ä¼¤å®³å€¼çš„ä¾‹å­, <code>GameplayEffect</code>ç¡®å®šé€ æˆå¤šå°‘ä¼¤å®³, ä¹‹å<code>AttributeSet</code>å†³å®šå¦‚ä½•ä½¿ç”¨è¯¥ä¼¤å®³å€¼, ä¸æ˜¯æ‰€æœ‰çš„Characteréƒ½æœ‰ç›¸åŒçš„<code>Attribute</code>, ç‰¹åˆ«æ˜¯ä½¿ç”¨äº†<code>AttributeSet</code>å­ç±»çš„è¯, <code>AttributeSet</code>åŸºç±»å¯èƒ½åªæœ‰ä¸€ä¸ªç”Ÿå‘½å€¼<code>Attribute</code>, ä½†æ˜¯å®ƒçš„å­ç±»å¯èƒ½å¢åŠ äº†ä¸€ä¸ªæŠ¤ç›¾å€¼<code>Attribute</code>, æ‹¥æœ‰æŠ¤ç›¾å€¼<code>Attribute</code>çš„å­ç±»<code>AttributeSet</code>å¯èƒ½ä¼šä»¥ä¸åŒäº<code>AttributeSet</code>åŸºç±»çš„æ–¹å¼åˆ†é…æ”¶åˆ°çš„ä¼¤å®³.  </p><p>å°½ç®¡<code>Meta Attribute</code>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è®¾è®¡æ¨¡å¼, ä½†å…¶å¹¶ä¸æ˜¯å¼ºåˆ¶ä½¿ç”¨çš„. å¦‚æœä½ åªæœ‰ä¸€ä¸ªç”¨äºæ‰€æœ‰ä¼¤å®³å®ä¾‹çš„<code>Execution Calculation</code>å’Œä¸€ä¸ªæ‰€æœ‰Characterå…±ç”¨çš„<code>AttributeSet</code>ç±», é‚£ä¹ˆä½ å°±å¯ä»¥åœ¨<code>Exeuction Calculation</code>ä¸­åˆ†é…ä¼¤å®³åˆ°ç”Ÿå‘½, æŠ¤ç›¾ç­‰ç­‰, å¹¶ç›´æ¥ä¿®æ”¹é‚£äº›<code>Attribute</code>, è¿™ç§æ–¹å¼ä½ åªä¼šä¸¢å¤±çµæ´»æ€§, ä½†æ€»ä½“ä¸Šå¹¶æ— å¤§ç¢.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-a-changes"></a></p><h4 id="4-3-4-å“åº”Attributeå˜åŒ–"><a href="#4-3-4-å“åº”Attributeå˜åŒ–" class="headerlink" title="4.3.4 å“åº”Attributeå˜åŒ–"></a>4.3.4 å“åº”Attributeå˜åŒ–</h4><p>ä¸ºäº†ç›‘å¬<code>Attribute</code>ä½•æ—¶å˜åŒ–ä»¥ä¾¿æ›´æ–°UIå’Œå…¶ä»–æ¸¸æˆé€»è¾‘, å¯ä»¥ä½¿ç”¨<code>UAbilitySystemComponent::GetGameplayAttributeValueChangeDelegate(FGameplayAttribute</code>Attribute<code>)</code>, è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå§”æ‰˜(Delegate), ä½ å¯ä»¥å°†å…¶ç»‘å®šä¸€ä¸ªå½“<code>Attribute</code>å˜åŒ–æ—¶éœ€è¦è‡ªåŠ¨è°ƒç”¨çš„å‡½æ•°. è¯¥å§”æ‰˜æä¾›ä¸€ä¸ª<code>FOnAttributeChangeData</code>å‚æ•°, å…¶ä¸­æœ‰<code>NewValue</code>, <code>OldValue</code>å’Œ<code>FGameplayEffectModCallbackData</code>. <strong>Note</strong>: <code>FGameplayEffectModCallbackData</code>åªèƒ½åœ¨æœåŠ¡ç«¯ä¸Šè®¾ç½®.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(AttributeSetBase-&gt;<span class="built_in">GetHealthAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;AGDPlayerState::HealthChanged);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">HealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span></span>;</span><br></pre></td></tr></table></figure><p>æ ·ä¾‹é¡¹ç›®å°†å…¶ç»‘å®šåˆ°äº†<code>GDPlayerState</code>ç”¨äºæ›´æ–°HUD, å½“ç”Ÿå‘½å€¼ä¸‹é™ä¸º0æ—¶, ä¹Ÿå¯ä»¥å“åº”ç©å®¶æ­»äº¡.  </p><p>æ ·ä¾‹é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªå°†ä¸Šè¿°é€»è¾‘åŒ…è£¹è¿›<code>ASyncTask</code>çš„è‡ªå®šä¹‰è“å›¾èŠ‚ç‚¹, å…¶åœ¨<code>UI_HUD(UMG Widget)</code>ä¸­ç”¨äºæ›´æ–°ç”Ÿå‘½å€¼, é­”æ³•å€¼å’Œè€åŠ›å€¼. è¯¥AsyncTaskä¼šä¸€ç›´å“åº”ç›´åˆ°æ‰‹åŠ¨è°ƒç”¨<code>EndTask()</code>, å°±åƒåœ¨UMG Widgetçš„<code>Destruct</code>äº‹ä»¶ä¸­è°ƒç”¨é‚£æ ·. å‚é˜…<code>AsyncTaskAttributeChanged.h/cpp</code>.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/attributechange.png" alt="Listen for Attribute Change BP Node"> </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-a-derived"></a></p><h4 id="4-3-5-è‡ªåŠ¨æ¨å¯¼Attribute"><a href="#4-3-5-è‡ªåŠ¨æ¨å¯¼Attribute" class="headerlink" title="4.3.5 è‡ªåŠ¨æ¨å¯¼Attribute"></a>4.3.5 è‡ªåŠ¨æ¨å¯¼Attribute</h4><p>ä¸ºäº†ä½¿ä¸€ä¸ª<code>Attribute</code>çš„éƒ¨åˆ†æˆ–å…¨éƒ¨å€¼ç»§æ‰¿è‡ªä¸€ä¸ªæˆ–æ›´å¤š<code>Attribute</code>, å¯ä»¥ä½¿ç”¨åŸºäºä¸€ä¸ªæˆ–å¤šä¸ª<code>Attribute</code>æˆ–<a href="#concepts-ge-mmc">MMC</a> <a href="#concepts-ge-mods">Modifiers</a>çš„<code>æ— é™(Infinite)GameplayEffect</code>. å½“è‡ªåŠ¨æ¨å¯¼<code>Attribute</code>ä¾èµ–çš„æŸä¸ª<code>Attribute</code>æ›´æ–°æ—¶å®ƒä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°.  </p><p>åœ¨è‡ªåŠ¨æ¨å¯¼<code>Attribute</code>ä¸Šçš„æ‰€æœ‰<code>Modifier</code>å½¢æˆçš„æœ€ç»ˆå…¬å¼å’Œ<code>Modifier Aggregators</code>çš„å…¬å¼æ˜¯ä¸€æ ·çš„. å¦‚æœä½ éœ€è¦è®¡ç®—å¼è¦æŒ‰ä¸€å®šçš„é¡ºåºè¿›è¡Œ, åœ¨<code>MMC</code>ä¸­åšå°±æ˜¯äº†.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((CurrentValue + Additive) * Multiplicitive) / Division</span><br></pre></td></tr></table></figure><p><strong>Note</strong>: å¦‚æœåœ¨PIEä¸­æ‰“å¼€å¤šä¸ªçª—å£, ä½ éœ€è¦åœ¨ç¼–è¾‘å™¨é¦–é€‰é¡¹ä¸­ç¦ç”¨<code>Run Under One Process</code>, å¦åˆ™å½“è‡ªåŠ¨æ¨å¯¼<code>Attribute</code>æ‰€ä¾èµ–çš„<code>Attribute</code>æ›´æ–°æ—¶, é™¤äº†ç¬¬ä¸€ä¸ªçª—å£å¤–å…¶ä¸ä¼šæ›´æ–°.  </p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>æ— é™(Infinite)GameplayEffect</code>, å…¶ä»TestAttrBå’ŒTestAttrC <code>Attribute</code>ä»¥<code>TestAttrA = (TestAttrA + TestAttrB) * ( 2 * TestAttrC)</code>å…¬å¼ç»§æ‰¿å¾—åˆ°TestAttrA, æ¯æ¬¡TestAttrBå’ŒTestAttrCæ›´æ–°æ—¶, TestAttrAéƒ½ä¼šè‡ªåŠ¨é‡æ–°è®¡ç®—.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/derivedattribute.png" alt="Derived Attribute Example">  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as"></a></p><h3 id="4-4-AttributeSet"><a href="#4-4-AttributeSet" class="headerlink" title="4.4 AttributeSet"></a>4.4 AttributeSet</h3><p><a name="concepts-as-definition"></a></p><h4 id="4-4-1-å®šä¹‰AttributeSet"><a href="#4-4-1-å®šä¹‰AttributeSet" class="headerlink" title="4.4.1 å®šä¹‰AttributeSet"></a>4.4.1 å®šä¹‰AttributeSet</h4><p><code>AttributeSet</code>ç”¨äºå®šä¹‰, ä¿å­˜ä»¥åŠç®¡ç†å¯¹<code>Attribute</code>çš„ä¿®æ”¹. å¼€å‘è€…åº”è¯¥ç»§æ‰¿<a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/UAttributeSet/index.html">UAttributeSet</a>. åœ¨OwnerActorçš„æ„é€ å‡½æ•°ä¸­åˆ›å»º<code>AttributeSet</code>ä¼šè‡ªåŠ¨æ³¨å†Œåˆ°å…¶<code>ASC</code>. <strong>è¿™å¿…é¡»åœ¨C++ä¸­å®Œæˆ.</strong>  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-design"></a></p><h4 id="4-4-2-è®¾è®¡AttributeSet"><a href="#4-4-2-è®¾è®¡AttributeSet" class="headerlink" title="4.4.2 è®¾è®¡AttributeSet"></a>4.4.2 è®¾è®¡AttributeSet</h4><p>ä¸€ä¸ª<code>ASC</code>å¯èƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª<code>AttributeSet</code>, <code>AttributeSet</code>æ¶ˆè€—çš„å†…å­˜å¾®ä¸è¶³é“, ä½¿ç”¨å¤šå°‘<code>AttributeSet</code>æ˜¯ç•™ç»™å¼€å‘äººå‘˜å†³å®šçš„.  </p><p>æœ‰ç§æ–¹æ¡ˆæ˜¯è®¾ç½®ä¸€ä¸ªå•ä¸€ä¸”å·¨å¤§çš„<code>AttributeSet</code>, å…±äº«äºæ¸¸æˆä¸­çš„æ‰€æœ‰Actor, å¹¶ä¸”åªä½¿ç”¨éœ€è¦çš„<code>Attribute</code>, å¿½ç•¥ä¸ç”¨çš„<code>Attribute</code>.  </p><p>ä½œä¸ºé€‰æ‹©, ä½ å¯ä»¥ä½¿ç”¨å¤šä¸ª<code>AttributeSet</code>æ¥è¡¨ç¤ºæŒ‰éœ€æ·»åŠ åˆ°Actorçš„<code>Attribute</code>åˆ†ç»„, ä¾‹å¦‚, ä½ å¯ä»¥æœ‰ä¸€ä¸ªç”Ÿå‘½ç›¸å…³çš„<code>AttributeSet</code>, ä¸€ä¸ªé­”æ³•ç›¸å…³çš„<code>AttributeSet</code>ç­‰ç­‰. åœ¨MOBAæ¸¸æˆä¸­, è‹±é›„å¯èƒ½éœ€è¦é­”æ³•, ä½†æ˜¯å°å…µå¹¶ä¸éœ€è¦, å› æ­¤è‹±é›„å°±éœ€è¦é­”æ³•<code>AttributeSet</code>è€Œå°å…µåˆ™ä¸éœ€è¦.  </p><p>å¦å¤–, ç»§æ‰¿<code>AttributeSet</code>çš„å¦ä¸€ç§æ„ä¹‰æ˜¯å¯ä»¥é€‰æ‹©ä¸€ä¸ªActorå¯ä»¥æœ‰å“ªäº›<code>Attribute</code>. <code>Attribute</code>åœ¨å†…éƒ¨è¢«å¼•ç”¨ä¸º<code>AttributeSetClassName.AttributeName</code>, å½“ä½ ç»§æ‰¿<code>AttributeSet</code>æ—¶, æ‰€æœ‰çˆ¶ç±»çš„<code>Attribute</code>ä»å°†ä¿ç•™çˆ¶ç±»åä½œä¸ºå‰ç¼€.  </p><p>å°½ç®¡å¯ä»¥æ‹¥æœ‰å¤šä¸ª<code>AttributeSet</code>, ä½†æ˜¯ä¸åº”è¯¥åœ¨åŒä¸€<code>ASC</code>ä¸­æ‹¥æœ‰å¤šä¸ªåŒä¸€ç±»çš„<code>AttributeSet</code>, å¦‚æœåœ¨åŒä¸€<code>ASC</code>ä¸­æœ‰å¤šä¸ªåŒä¸€ç±»çš„<code>AttributeSet</code>, <code>ASC</code>å°±ä¸çŸ¥é“è¯¥ä½¿ç”¨å“ªä¸ª<code>AttributeSet</code>è€Œéšæœºé€‰æ‹©ä¸€ä¸ª.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-design-subcomponents"></a></p><h5 id="4-4-2-1-ä½¿ç”¨å•ç‹¬Attributeçš„å­ç»„ä»¶"><a href="#4-4-2-1-ä½¿ç”¨å•ç‹¬Attributeçš„å­ç»„ä»¶" class="headerlink" title="4.4.2.1 ä½¿ç”¨å•ç‹¬Attributeçš„å­ç»„ä»¶"></a>4.4.2.1 ä½¿ç”¨å•ç‹¬Attributeçš„å­ç»„ä»¶</h5><p>å‡è®¾ä½ åœ¨æŸä¸ªPawnä¸Šæœ‰å¤šä¸ªå¯è¢«æŸå®³çš„ç»„ä»¶, åƒå¯è¢«ç‹¬ç«‹æŸå®³çš„æŠ¤ç”²ç‰‡, å¦‚æœå¯ä»¥æ˜ç¡®å¯è¢«æŸå®³ç»„ä»¶çš„æœ€å¤§æ•°é‡, æˆ‘å»ºè®®æŠŠå¤šä¸ªç”Ÿå‘½å€¼<code>Attribute</code>æ”¾åˆ°ä¸€ä¸ª<code>AttributeSet</code>ä¸­ â€”â€” DamageableCompHealth0, DamageableCompHealth1, ç­‰ç­‰, ä»¥è¡¨ç¤ºè¿™äº›å¯è¢«æŸå®³ç»„ä»¶åœ¨é€»è¾‘ä¸Šçš„â€slotâ€, åœ¨å¯è¢«æŸå®³ç»„ä»¶çš„ç±»å®ä¾‹ä¸­, æŒ‡å®šå¯ä»¥è¢«<code>GameplayAbility</code>å’Œ<a href="#concepts-ge-ec">Execution</a>è¯»å–çš„å¸¦slotç¼–å·çš„<code>Attribute</code>æ¥è¡¨æ˜è¯¥åº”ç”¨ä¼¤å®³å€¼åˆ°å“ªä¸ª<code>Attribute</code>. å¦‚æœPawnå½“å‰æ‹¥æœ‰0ä¸ªæˆ–å°‘äºæœ€å¤§æ•°é‡çš„å¯æŸå®³ç»„ä»¶ä¹Ÿæ— å¦¨, å› ä¸º<code>AttributeSet</code>æ‹¥æœ‰ä¸€ä¸ª<code>Attribute</code>, å¹¶ä¸æ„å‘³ç€å¿…é¡»è¦ä½¿ç”¨å®ƒ, æœªä½¿ç”¨çš„<code>Attribute</code>åªå ç”¨å¾ˆå°‘çš„å†…å­˜.  </p><p>å¦‚æœæ¯ä¸ªå­ç»„ä»¶éƒ½éœ€è¦å¾ˆå¤š<code>Attribute</code>ä¸”å­ç»„ä»¶çš„æ•°é‡å¯ä»¥æ˜¯æ— é™çš„, æˆ–è€…å­ç»„ä»¶å¯ä»¥åˆ†ç¦»è¢«å…¶ä»–ç©å®¶ä½¿ç”¨(æ¯”å¦‚æ­¦å™¨), æˆ–è€…å‡ºäºå…¶ä»–åŸå› ä¸Šè¿°æ–¹æ³•ä¸é€‚ç”¨äºä½ , é‚£ä¹ˆæˆ‘å»ºè®®å°±ä¸è¦ä½¿ç”¨<code>Attribute</code>, è€Œæ˜¯åœ¨ç»„ä»¶ä¸­ä¿å­˜æ™®é€šçš„æµ®ç‚¹æ•°. å‚é˜…<a href="#concepts-as-design-itemattributes">Item Attribute</a>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-design-addremoveruntime"></a></p><h5 id="4-4-2-2-è¿è¡Œæ—¶æ·»åŠ å’Œç§»é™¤AttributeSet"><a href="#4-4-2-2-è¿è¡Œæ—¶æ·»åŠ å’Œç§»é™¤AttributeSet" class="headerlink" title="4.4.2.2 è¿è¡Œæ—¶æ·»åŠ å’Œç§»é™¤AttributeSet"></a>4.4.2.2 è¿è¡Œæ—¶æ·»åŠ å’Œç§»é™¤AttributeSet</h5><p><code>AttributeSet</code>å¯ä»¥åœ¨è¿è¡Œæ—¶ä»<code>ASC</code>ä¸Šæ·»åŠ å’Œç§»é™¤, ç„¶è€Œç§»é™¤<code>AttributeSet</code>æ˜¯å¾ˆå±é™©çš„, ä¾‹å¦‚, å¦‚æœæŸä¸ª<code>AttributeSet</code>åœ¨å®¢æˆ·ç«¯ä¸Šç§»é™¤æ—©äºæœåŠ¡ç«¯, è€ŒæŸä¸ª<code>Attribute</code>çš„å˜åŒ–åˆåŒæ­¥åˆ°äº†å®¢æˆ·ç«¯, é‚£ä¹ˆ<code>Attribute</code>å°±ä¼šå› ä¸ºæ‰¾ä¸åˆ°<code>AttributeSet</code>è€Œä½¿æ¸¸æˆå´©æºƒ.  </p><p>æ­¦å™¨æ·»åŠ åˆ°Inventory:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AbilitySystemComponent-&gt;SpawnedAttribute.<span class="built_in">AddUnique</span>(WeaponAttributeSetPointer);</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">ForceReplication</span>();</span><br></pre></td></tr></table></figure><p>æ­¦å™¨ä»Inventoryç§»é™¤:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AbilitySystemComponent-&gt;SpawnedAttribute.<span class="built_in">Remove</span>(WeaponAttributeSetPointer);</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">ForceReplication</span>();</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-design-itemattributes"></a></p><h5 id="4-4-2-3-Item-Attribute-æ­¦å™¨å¼¹è¯"><a href="#4-4-2-3-Item-Attribute-æ­¦å™¨å¼¹è¯" class="headerlink" title="4.4.2.3 Item Attribute(æ­¦å™¨å¼¹è¯)"></a>4.4.2.3 Item Attribute(æ­¦å™¨å¼¹è¯)</h5><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å®ç°å¸¦æœ‰<code>Attribute</code>(æ­¦å™¨å¼¹è¯, ç›”ç”²è€ä¹…ç­‰ç­‰)çš„å¯è£…å¤‡ç‰©å“, æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½ç›´æ¥åœ¨ç‰©å“ä¸­å­˜å‚¨æ•°æ®, è¿™å¯¹äºåœ¨ç”Ÿå‘½å‘¨æœŸä¸­å¯ä»¥è¢«å¤šä¸ªç©å®¶è£…å¤‡çš„ç‰©å“æ¥è¯´æ˜¯å¿…é¡»çš„.  </p><ol><li>åœ¨ç‰©å“ä¸­ä½¿ç”¨æ™®é€šçš„æµ®ç‚¹æ•°(æ¨è).</li><li>åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„<code>AttributeSet</code>.</li><li>åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„<code>ASC</code>.</li></ol><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-design-itemattributes-plainfloats"></a></p><h6 id="4-4-2-3-1-åœ¨ç‰©å“ä¸­ä½¿ç”¨æ™®é€šæµ®ç‚¹æ•°"><a href="#4-4-2-3-1-åœ¨ç‰©å“ä¸­ä½¿ç”¨æ™®é€šæµ®ç‚¹æ•°" class="headerlink" title="4.4.2.3.1 åœ¨ç‰©å“ä¸­ä½¿ç”¨æ™®é€šæµ®ç‚¹æ•°"></a>4.4.2.3.1 åœ¨ç‰©å“ä¸­ä½¿ç”¨æ™®é€šæµ®ç‚¹æ•°</h6><p>åœ¨ç‰©å“ç±»å®ä¾‹ä¸­å­˜å‚¨æ™®é€šæµ®ç‚¹æ•°è€Œä¸æ˜¯<code>Attribute</code>, Fortniteå’Œ<a href="https://github.com/tranek/GASShooter">GASShooter</a>å°±æ˜¯è¿™æ ·å¤„ç†æªæ¢°å­å¼¹çš„, å¯¹äºæªæ¢°, åœ¨å…¶å®ä¾‹ä¸­å­˜å‚¨å¯åŒæ­¥çš„æµ®ç‚¹æ•°(COND_OwnerOnly), æ¯”å¦‚æœ€å¤§å¼¹åŒ£é‡, å½“å‰å¼¹åŒ£ä¸­å¼¹è¯é‡, å‰©ä½™å¼¹è¯é‡ç­‰ç­‰, å¦‚æœæªæ¢°éœ€è¦å…±äº«å‰©ä½™å¼¹è¯é‡, é‚£ä¹ˆå°±å°†å‰©ä½™å¼¹è¯é‡ç§»åˆ°Characterä¸­å…±äº«çš„å¼¹è¯<code>AttributeSet</code>é‡Œä½œä¸ºä¸€ä¸ª<code>Attribute</code>(æ¢å¼¹Abilityå¯ä»¥ä½¿ç”¨ä¸€ä¸ª<code>Cost GE</code>ä»å‰©ä½™å¼¹è¯é‡ä¸­å¡«å……æªæ¢°çš„å¼¹åŒ£å¼¹è¯é‡æµ®ç‚¹). å› ä¸ºæ²¡æœ‰ä¸ºå½“å‰å¼¹åŒ£å¼¹è¯é‡ä½¿ç”¨<code>Attribute</code>, æ‰€ä»¥éœ€è¦é‡å†™<code>UGameplayAbility</code>ä¸­çš„ä¸€äº›å‡½æ•°æ¥æ£€æŸ¥å’Œåº”ç”¨æªæ¢°ä¸­æµ®ç‚¹æ•°çš„èŠ±é”€(cost). å½“æˆäºˆAbilityæ—¶å°†æªæ¢°åœ¨<a href="https://github.com/tranek/GASDocumentation#concepts-ga-spec">GameplayAbilitySpec</a>ä¸­è½¬æ¢ä¸º<code>SourceObject</code>, è¿™æ„å‘³ç€å¯ä»¥åœ¨Abilityä¸­è®¿é—®æˆäºˆAbilityçš„æªæ¢°.  </p><p>ä¸ºäº†é˜²æ­¢åœ¨å…¨è‡ªåŠ¨å°„å‡»è¿‡ç¨‹ä¸­æªæ¢°ä¼šåå‘åŒæ­¥å¼¹è¯é‡å¹¶æ‰°ä¹±æœ¬åœ°å¼¹è¯é‡(è¯‘è€…æ³¨: é€šä¿—è§£é‡Šå°±æ˜¯å› ä¸ºå­˜åœ¨åŒæ­¥å»¶è¿Ÿä¸”åœ¨è¿ç»­å°„å‡»è¿™ä¸€é«˜åŒæ­¥è¿‡ç¨‹ä¸­, æ‰€ä»¥å®¢æˆ·ç«¯çš„å¼¹è¯é‡ä¼šæ¥ä¸åŠå’ŒæœåŠ¡ç«¯åŒæ­¥, é€ æˆå¼¹è¯é‡å‡å°‘ååˆçªç„¶å˜å¤šçš„ç°è±¡.), å¦‚æœç©å®¶æ‹¥æœ‰<code>IsFiring</code>çš„<code>GameplayTag</code>, å°±åœ¨PreReplication()ä¸­ç¦ç”¨åŒæ­¥, æœ¬è´¨ä¸Šæ˜¯è¦åœ¨å…¶ä¸­åšè‡ªå·±çš„æœ¬åœ°é¢„æµ‹.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AGSWeapon::PreReplication</span><span class="params">(IRepChangedPropertyTracker&amp; ChangedPropertyTracker)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">PreReplication</span>(ChangedPropertyTracker);</span><br><span class="line"></span><br><span class="line"><span class="built_in">DOREPLIFETIME_ACTIVE_OVERRIDE</span>(AGSWeapon, PrimaryClipAmmo, (<span class="built_in">IsValid</span>(AbilitySystemComponent) &amp;&amp; !AbilitySystemComponent-&gt;<span class="built_in">HasMatchingGameplayTag</span>(WeaponIsFiringTag)));</span><br><span class="line"><span class="built_in">DOREPLIFETIME_ACTIVE_OVERRIDE</span>(AGSWeapon, SecondaryClipAmmo, (<span class="built_in">IsValid</span>(AbilitySystemComponent) &amp;&amp; !AbilitySystemComponent-&gt;<span class="built_in">HasMatchingGameplayTag</span>(WeaponIsFiringTag)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½å¤„:  </p><ol><li>é¿å…äº†ä½¿ç”¨<code>AttributeSet</code>çš„å±€é™(è§ä¸‹).</li></ol><p>å±€é™:  </p><ol><li>ä¸èƒ½ä½¿ç”¨ç°æœ‰çš„<code>GameplayEffect</code>å·¥ä½œæµ(å¼¹è¯ä½¿ç”¨çš„Cost GEsç­‰ç­‰).</li><li>è¦æ±‚é‡å†™UGameplayAbilityä¸­çš„å…³é”®å‡½æ•°æ¥æ£€æŸ¥å’Œåº”ç”¨æªæ¢°ä¸­æµ®ç‚¹æ•°çš„èŠ±é”€(Cost).</li></ol><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-design-itemattributes-attributeset"></a></p><h6 id="4-4-2-3-2-åœ¨ç‰©å“ä¸­ä½¿ç”¨AttributeSet"><a href="#4-4-2-3-2-åœ¨ç‰©å“ä¸­ä½¿ç”¨AttributeSet" class="headerlink" title="4.4.2.3.2 åœ¨ç‰©å“ä¸­ä½¿ç”¨AttributeSet"></a>4.4.2.3.2 åœ¨ç‰©å“ä¸­ä½¿ç”¨AttributeSet</h6><p>åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„<code>AttributeSet</code>å¯ä»¥å®ç°<a href="#concepts-as-design-addremoveruntime">å°†å…¶æ·»åŠ åˆ°ç©å®¶çš„Inventory</a>, ä½†è¿˜æ˜¯æœ‰ä¸€å®šçš„å±€é™æ€§. è¾ƒæ—©ç‰ˆæœ¬çš„<a href="https://github.com/tranek/GASShooter">GASShooter</a>ä¸­çš„æ­¦å™¨å¼¹è¯æ˜¯ä½¿ç”¨çš„è¿™ç§æ–¹æ³•, æ­¦å™¨ç±»åœ¨å…¶è‡ªèº«å­˜å‚¨è¯¸å¦‚æœ€å¤§å¼¹åŒ£é‡, å½“å‰å¼¹åŒ£å¼¹è¯é‡, å‰©ä½™å¼¹è¯é‡ç­‰ç­‰åˆ°ä¸€ä¸ª<code>AttributeSet</code>, å¦‚æœæªæ¢°éœ€è¦å…±äº«å‰©ä½™å¼¹è¯é‡, é‚£ä¹ˆå°±å°†å‰©ä½™å¼¹è¯é‡ç§»åˆ°Characterä¸­å…±äº«çš„å¼¹è¯<code>AttributeSet</code>é‡Œ. å½“æœåŠ¡ç«¯ä¸ŠæŸä¸ªæ­¦å™¨æ·»åŠ åˆ°ç©å®¶çš„Inventoryå, è¯¥æ­¦å™¨ä¼šå°†å®ƒçš„<code>AttributeSet</code>æ·»åŠ åˆ°ç©å®¶çš„<code>ASC::SpawnedAttribute</code>, ä¹‹åæœåŠ¡ç«¯ä¼šå°†å…¶åŒæ­¥ä¸‹å‘åˆ°å®¢æˆ·ç«¯, å¦‚æœè¯¥æ­¦å™¨ä»Inventoryä¸­ç§»é™¤, å®ƒä¹Ÿä¼šå°†å…¶<code>AttributeSet</code>ä»<code>ASC::SpawnedAttribute</code>ä¸­ç§»é™¤.  </p><p>å½“<code>AttributeSet</code>å­˜äºé™¤äº†OwnerActorä¹‹å¤–çš„å¯¹è±¡ä¸Šæ—¶(å¯¹äºæŸä¸ªæ­¦å™¨æ¥è¯´), ä¼šå¾—åˆ°ä¸€äº›å…³äº<code>AttributeSet</code>çš„ç¼–è¯‘é”™è¯¯, è§£å†³åŠæ³•æ˜¯åœ¨BeginPlay()ä¸­æ„å»º<code>AttributeSet</code>è€Œä¸æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­, å¹¶åœ¨æ­¦å™¨ç±»ä¸­å®ç°<code>IAbilitySystemInterface</code>(å½“ä½ æ·»åŠ æ­¦å™¨åˆ°ç©å®¶Inventoryæ—¶è®¾ç½®<code>ASC</code>çš„æŒ‡é’ˆ).  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AGSWeapon::BeginPlay</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!AttributeSet)</span><br><span class="line">&#123;</span><br><span class="line">AttributeSet = <span class="built_in">NewObject</span>&lt;UGSWeaponAttributeSet&gt;(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥æŸ¥çœ‹<a href="https://github.com/tranek/GASShooter/tree/df5949d0dd992bd3d76d4a728f370f2e2c827735">è¾ƒæ—©ç‰ˆæœ¬çš„GASShooter</a>æ¥å®é™…åœ°ä½“ä¼šè¿™ç§æ–¹æ¡ˆ.  </p><p>å¥½å¤„:  </p><ol><li>å¯ä»¥ä½¿ç”¨å·²æœ‰çš„<code>GameplayAbility</code>å’Œ<code>GameplayEffect</code>å·¥ä½œæµ(å¼¹è¯ä½¿ç”¨çš„Cost GEsç­‰ç­‰).</li><li>å¯¹äºå¾ˆå°çš„ç‰©å“é›†å¯ä»¥å¿«é€Ÿè®¾ç½®</li></ol><p>å±€é™:  </p><ol><li>å¿…é¡»ä¸ºæ¯ä¸ªæ­¦å™¨ç±»å‹åˆ›å»ºæ–°çš„<code>AttributeSet</code>ç±», <code>ASC</code>å®é™…ä¸Šåªèƒ½æœ‰ä¸€ä¸ªè¯¥ç±»çš„<code>AttributeSet</code>å®ä¾‹, å› ä¸ºå¯¹<code>Attribute</code>çš„ä¿®æ”¹ä¼šåœ¨<code>ASC</code>çš„SpawnedAttributeæ•°ç»„ä¸­å¯»æ‰¾å…¶ç¬¬ä¸€ä¸ª<code>AttributeSet</code>ç±»å®ä¾‹, å…¶ä»–ç›¸åŒçš„<code>AttributeSet</code>ç±»å®ä¾‹åˆ™ä¼šè¢«å¿½ç•¥.  </li><li>å’Œç¬¬1æ¡åŒæ ·çš„åŸå› (æ¯ä¸ª<code>AttributeSet</code>ç±»ä¸€ä¸ª<code>AttributeSet</code>å®ä¾‹), åœ¨ç©å®¶çš„Inventoryä¸­æ¯ç§æ­¦å™¨ç±»å‹åªèƒ½æœ‰ä¸€ä¸ª.</li><li>ç§»é™¤<code>AttributeSet</code>æ˜¯å¾ˆå±é™©çš„. åœ¨GASShooterä¸­, å¦‚æœç©å®¶å› ä¸ºç«ç®­å¼¹è€Œè‡ªæ€, ç©å®¶ä¼šç«‹å³ä»å…¶Inventoryä¸­ç§»é™¤ç«ç®­å¼¹å‘å°„å™¨(åŒ…æ‹¬å…¶åœ¨<code>ASC</code>ä¸­çš„<code>AttributeSet</code>), å½“æœåŠ¡ç«¯åŒæ­¥ç«ç®­å¼¹å‘å°„å™¨çš„å¼¹è¯<code>Attribute</code>æ”¹å˜æ—¶, ç”±äº<code>AttributeSet</code>åœ¨å®¢æˆ·ç«¯<code>ASC</code>ä¸Šä¸å¤å­˜åœ¨è€Œä½¿æ¸¸æˆå´©æºƒ.</li></ol><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-design-itemattributes-asc"></a></p><h6 id="4-4-2-3-3-åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„ASC"><a href="#4-4-2-3-3-åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„ASC" class="headerlink" title="4.4.2.3.3 åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„ASC"></a>4.4.2.3.3 åœ¨ç‰©å“ä¸­ä½¿ç”¨å•ç‹¬çš„ASC</h6><p>åœ¨æ¯ä¸ªç‰©å“ä¸Šéƒ½åˆ›å»ºä¸€ä¸ª<code>AbilitySystemComponent</code>æ˜¯ç§å¾ˆæç«¯çš„æ–¹æ¡ˆ. æˆ‘è¿˜æ²¡æœ‰äº²è‡ªåšè¿‡è¿™ç§æ–¹æ¡ˆ, åœ¨å…¶ä»–åœ°æ–¹ä¹Ÿæ²¡è§è¿‡. è¿™ç§æ–¹æ¡ˆåº”è¯¥ä¼šèŠ±è´¹ç›¸å½“çš„å¼€å‘æˆæœ¬æ‰èƒ½æ­£å¸¸ä½¿ç”¨.  </p><blockquote><p>Is it viable to have several AbilitySystemComponents which have the same owner but different avatars (e.g. on pawn and weapon/items/projectiles with Owner set to PlayerState)?</p><p>The first problem I see there would be implementing the IGameplayTagAssetInterface and IAbilitySystemInterface on the owning Actor. The former may be possible: just aggregate the tags from all all ASCs (but watch out -HasAlMatchingGameplayTag may be met only via cross ASC aggregation. It wouldnâ€™t be enough to just forward that calls to each ASC and OR the results together). But the later is even trickier: which ASC is the authoritative one? If someone wants to apply a GE -which one should receive it? Maybe you can work these out but this side of the problem will be the hardest: owners will multiple ASCs beneath them.</p><p>Separate ASCs on the pawn and the weapon can make sense on its own though. E.g, distinguishing between tags the describe the weapon vs those that describe the owning pawn. Maybe it does make sense that tags granted to the weapon also â€œapplyâ€ to the owner and nothing else (E.g, Attribute and GEs are independent but the owner will aggregate the owned tags like I describe above). This could work out, I am sure. But having multiple ASCs with the same owner may get dicey.</p></blockquote><p><em><a href="https://epicgames.ent.box.com/s/m1egifkxv3he3u3xezb9hzbgroxyhx89">community questions #6</a>ä¸­æ¥è‡ªEpicçš„Dave Rattiçš„å›ç­”.</em>  </p><p>å¥½å¤„: </p><ol><li>å¯ä»¥ä½¿ç”¨å·²æœ‰çš„<code>GameplayAbility</code>å’Œ<code>GameplayEffect</code>å·¥ä½œæµ(å¼¹è¯ä½¿ç”¨çš„Cost GEsç­‰ç­‰).</li><li>å¯ä»¥å¤ç”¨<code>AttributeSet</code>ç±»(æ¯ä¸ªæ­¦å™¨çš„<code>ASC</code>ä¸­å„ä¸€ä¸ª).</li></ol><p>å±€é™:  </p><ol><li>æœªçŸ¥çš„å¼€å‘æˆæœ¬.</li><li>ç”šè‡³æ–¹æ¡ˆå¯è¡Œä¹ˆ?</li></ol><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-attributes"></a></p><h4 id="4-4-3-å®šä¹‰Attribute"><a href="#4-4-3-å®šä¹‰Attribute" class="headerlink" title="4.4.3 å®šä¹‰Attribute"></a>4.4.3 å®šä¹‰Attribute</h4><p><strong>Attributeåªèƒ½ä½¿ç”¨C++åœ¨AttributeSetå¤´æ–‡ä»¶ä¸­å®šä¹‰.</strong> å»ºè®®æŠŠä¸‹é¢è¿™ä¸ªå®å—åŠ åˆ°æ¯ä¸ª<code>AttributeSet</code>å¤´æ–‡ä»¶çš„é¡¶éƒ¨, å…¶ä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ª<code>Attribute</code>ç”Ÿæˆgetterå’Œsetterå‡½æ•°.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Uses macros from AttributeSet.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ATTRIBUTE_ACCESSORS(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_PROPERTY_GETTER(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_GETTER(PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_SETTER(PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_INITTER(PropertyName)</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªå¯åŒæ­¥çš„ç”Ÿå‘½å€¼<code>Attribute</code>å¯èƒ½åƒä¸‹é¢è¿™æ ·å®šä¹‰:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category = <span class="string">&quot;Health&quot;</span>, ReplicatedUsing = OnRep_Health)</span><br><span class="line">FGameplayAttributeData Health;</span><br><span class="line"><span class="built_in">ATTRIBUTE_ACCESSORS</span>(UGDAttributeSetBase, Health)</span><br></pre></td></tr></table></figure><p>åŒæ ·åœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰OnRepå‡½æ•°:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UFUNCTION</span>()</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnRep_Health</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealth)</span></span>;</span><br></pre></td></tr></table></figure><p><code>AttributeSet</code>çš„.cppæ–‡ä»¶åº”è¯¥ç”¨é¢„æµ‹ç³»ç»Ÿ(Prediction System)ä½¿ç”¨çš„<code>GAMEPLAYATTRIBUTE_REPNOTIFY</code>å®å¡«å……OnRepå‡½æ•°:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UGDAttributeSetBase::OnRep_Health</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UGDAttributeSetBase, Health, OldHealth);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€å, <code>Attribute</code>éœ€è¦æ·»åŠ åˆ°<code>GetLifetimeReplicatedProps</code>:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UGDAttributeSetBase::GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">GetLifetimeReplicatedProps</span>(OutLifetimeProps);</span><br><span class="line"></span><br><span class="line"><span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UGDAttributeSetBase, Health, COND_None, REPNOTIFY_Always);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>REPTNOTIFY_Always</code>ç”¨äºè®¾ç½®OnRepå‡½æ•°åœ¨å®¢æˆ·ç«¯å€¼å·²ç»ä¸æœåŠ¡ç«¯åŒæ­¥çš„å€¼ç›¸åŒçš„æƒ…å†µä¸‹è§¦å‘(å› ä¸ºæœ‰é¢„æµ‹), é»˜è®¤è®¾ç½®ä¸‹, å®¢æˆ·ç«¯å€¼ä¸æœåŠ¡ç«¯åŒæ­¥çš„å€¼ç›¸åŒæ—¶, OnRepå‡½æ•°æ˜¯ä¸ä¼šè§¦å‘çš„.  </p><p>å¦‚æœ<code>Attribute</code>æ— éœ€åƒ<code>Meta Attribute</code>é‚£æ ·åŒæ­¥, é‚£ä¹ˆ<code>OnRep</code>å’Œ<code>GetLifetimeReplicatedProps</code>æ­¥éª¤å¯ä»¥è·³è¿‡.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-init"></a></p><h4 id="4-4-4-åˆå§‹åŒ–Attribute"><a href="#4-4-4-åˆå§‹åŒ–Attribute" class="headerlink" title="4.4.4 åˆå§‹åŒ–Attribute"></a>4.4.4 åˆå§‹åŒ–Attribute</h4><p>æœ‰å¤šç§æ–¹æ³•å¯ä»¥åˆå§‹åŒ–<code>Attribute</code>(å°†BaseValueå’ŒCurrentValueè®¾ç½®ä¸ºæŸåˆå§‹å€¼). Epicå»ºè®®ä½¿ç”¨<code>å³åˆ»(Instant)GameplayEffect</code>, è¿™ä¹Ÿæ˜¯æ ·ä¾‹é¡¹ç›®ä½¿ç”¨çš„æ–¹æ³•.  </p><p>æŸ¥çœ‹æ ·ä¾‹é¡¹ç›®çš„GE_HeroAttributeè“å›¾æ¥äº†è§£å¦‚ä½•åˆ›å»º<code>å³åˆ»(Instant)GameplayEffect</code>ä»¥åˆå§‹åŒ–<code>Attribute</code>, è¯¥<code>GameplayEffect</code>åº”ç”¨æ˜¯å†™åœ¨C++ä¸­çš„.  </p><p>å¦‚æœåœ¨å®šä¹‰<code>Attribute</code>æ—¶ä½¿ç”¨äº†ATTRIBUTE_ACCESSORSå®, é‚£ä¹ˆåœ¨<code>AttributeSet</code>ä¸­ä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ª<code>Attribute</code>ç”Ÿæˆä¸€ä¸ªåˆå§‹åŒ–å‡½æ•°.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// InitHealth(float InitialValue) is an automatically generated function for an Attribute &#x27;Health&#x27; defined with the `ATTRIBUTE_ACCESSORS` macro</span></span><br><span class="line">AttributeSet-&gt;<span class="built_in">InitHealth</span>(<span class="number">100.0f</span>);</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹<code>AttributeSet.h</code>è·å–æ›´å¤šåˆå§‹åŒ–<code>Attribute</code>çš„æ–¹æ³•.  </p><p><strong>Note</strong>: 4.24ä¹‹å‰, FAttributeSetInitterDiscreteLevelsä¸èƒ½å’ŒFGameplayAttributeDataååŒä½¿ç”¨, å®ƒåœ¨<code>Attribute</code>æ˜¯åŸç”Ÿæµ®ç‚¹æ•°æ—¶åˆ›å»º, å¹¶ä¸”ä¼šå’ŒFGameplayAttributeDataä¸æ˜¯Plain Old Data(POD)æ—¶å†²çª. è¯¥é—®é¢˜åœ¨4.24ä¸­ä¿®å¤(<a href="https://issues.unrealengine.com/issue/UE-76557">https://issues.unrealengine.com/issue/UE-76557.</a>).  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-preattributechange"></a></p><h4 id="4-4-5-PreAttributeChange"><a href="#4-4-5-PreAttributeChange" class="headerlink" title="4.4.5 PreAttributeChange()"></a>4.4.5 PreAttributeChange()</h4><p><code>PreAttributeChange(const FGameplayAttribute&amp; Attribute, float&amp; NewValue)</code>æ˜¯<code>AttributeSet</code>ä¸­çš„ä¸»è¦å‡½æ•°ä¹‹ä¸€, å…¶åœ¨ä¿®æ”¹å‘ç”Ÿå‰å“åº”<code>Attribute</code>çš„CurrentValueå˜åŒ–, å…¶æ˜¯é€šè¿‡å¼•ç”¨å‚æ•°NewValueé™åˆ¶(Clamp)CurrentValueå³å°†è¿›è¡Œçš„ä¿®æ”¹çš„ç†æƒ³ä½ç½®.  </p><p>ä¾‹å¦‚åƒæ ·ä¾‹é¡¹ç›®é‚£æ ·é™åˆ¶ç§»åŠ¨é€Ÿåº¦<code>Modifier</code>:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Attribute == <span class="built_in">GetMoveSpeedAttribute</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Cannot slow less than 150 units/s and cannot boost more than 1000 units/s</span></span><br><span class="line">NewValue = FMath::<span class="built_in">Clamp</span>&lt;<span class="type">float</span>&gt;(NewValue, <span class="number">150</span>, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>GetMoveSpeedAttribute()</code>å‡½æ•°æ˜¯ç”±æˆ‘ä»¬åœ¨<code>AttributeSet.h</code>ä¸­æ·»åŠ çš„å®å—åˆ›å»ºçš„(<a href="#concepts-as-attributes">å®šä¹‰Attribute</a>).  </p><p><code>PreAttributeChange()</code>å¯ä»¥è¢«<code>Attribute</code>çš„ä»»ä½•ä¿®æ”¹è§¦å‘, æ— è®ºæ˜¯ä½¿ç”¨<code>Attribute</code>çš„setter(ç”±<code>AttributeSet.h</code>ä¸­çš„å®å—å®šä¹‰(<a href="#concepts-as-attributes">å®šä¹‰Attribute</a>))è¿˜æ˜¯ä½¿ç”¨<a href="#concepts-ge">GameplayEffect</a>.  </p><p><strong>Note</strong>: åœ¨è¿™é‡Œåšçš„ä»»ä½•é™åˆ¶éƒ½ä¸ä¼šæ°¸ä¹…æ€§åœ°ä¿®æ”¹<code>ASC</code>ä¸­çš„<code>Modifier</code>, åªä¼šä¿®æ”¹æŸ¥è¯¢<code>Modifier</code>çš„è¿”å›å€¼, è¿™æ„å‘³ç€åƒ<a href="#concepts-ge-ec">GameplayEffectExecutionCalculations</a>å’Œ<a href="#concepts-ge-mmc">ModifierMagnitudeCalculations</a>è¿™ç§è‡ªæ‰€æœ‰<code>Modifier</code>é‡æ–°è®¡ç®—CurrentValueçš„å‡½æ•°éœ€è¦å†æ¬¡æ‰§è¡Œé™åˆ¶(Clamp)æ“ä½œ.  </p><p><strong>Note</strong>: Epicå¯¹äºPreAttributeChange()çš„æ³¨é‡Šè¯´æ˜ä¸è¦å°†è¯¥å‡½æ•°ç”¨äºæ¸¸æˆé€»è¾‘äº‹ä»¶, è€Œä¸»è¦åœ¨å…¶ä¸­åšé™åˆ¶æ“ä½œ. å¯¹äºä¿®æ”¹<code>Attribute</code>çš„æ¸¸æˆé€»è¾‘äº‹ä»¶çš„å»ºè®®ä½ç½®æ˜¯<code>UAbilitySystemComponent::GetGameplayAttributeValueChangeDelegate(FGameplayAttribute Attribute)</code>(<a href="#concepts-a-changes">å“åº”Attributeå˜åŒ–</a>).  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-postgameplayeffectexecute"></a></p><h4 id="4-4-6-PostGameplayEffectExecute"><a href="#4-4-6-PostGameplayEffectExecute" class="headerlink" title="4.4.6 PostGameplayEffectExecute()"></a>4.4.6 PostGameplayEffectExecute()</h4><p><code>PostGameplayEffectExecute(const FGameplayEffectModCallbackData &amp; Data)</code>ä»…åœ¨<code>å³åˆ»(Instant)GameplayEffect</code>å¯¹<code>Attribute</code>çš„BaseValueä¿®æ”¹ä¹‹åè§¦å‘, å½“<a href="#concepts-ge">GameplayEffect</a>å¯¹å…¶ä¿®æ”¹æ—¶, è¿™å°±æ˜¯ä¸€ä¸ªå¤„ç†æ›´å¤š<code>Attribute</code>æ“ä½œçš„æœ‰æ•ˆä½ç½®.  </p><p>ä¾‹å¦‚, åœ¨æ ·ä¾‹é¡¹ç›®ä¸­, æˆ‘ä»¬åœ¨è¿™é‡Œä»ç”Ÿå‘½å€¼<code>Attribute</code>ä¸­å‡å»äº†æœ€ç»ˆçš„ä¼¤å®³å€¼<code>Meta Attribute</code>, å¦‚æœæœ‰æŠ¤ç›¾å€¼<code>Attribute</code>çš„è¯, æˆ‘ä»¬ä¹Ÿä¼šåœ¨å‡é™¤ç”Ÿå‘½å€¼ä¹‹å‰ä»æŠ¤ç›¾å€¼ä¸­å‡é™¤ä¼¤å®³å€¼. æ ·ä¾‹é¡¹ç›®ä¹Ÿåœ¨è¿™é‡Œåº”ç”¨äº†è¢«å‡»æ‰“ååº”åŠ¨ç”», æ˜¾ç¤ºæµ®åŠ¨çš„ä¼¤å®³æ•°å€¼å’Œä¸ºå‡»æ€è€…åˆ†é…ç»éªŒå€¼å’Œèµé‡‘. é€šè¿‡è®¾è®¡, ä¼¤å®³å€¼<code>Meta Attribute</code>æ€»æ˜¯ä¼šä¼ é€’ç»™<code>å³åˆ»(Instant)GameplayEffect</code>è€Œä¸æ˜¯Attribute Setter.  </p><p>å…¶ä»–åªä¼šç”±<code>å³åˆ»(Instant)GameplayEffect</code>ä¿®æ”¹BaseValueçš„<code>Attribute</code>, åƒé­”æ³•å€¼å’Œè€åŠ›å€¼, ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œè¢«é™åˆ¶ä¸ºå…¶ç›¸åº”çš„æœ€å¤§å€¼<code>Attribute</code>.  </p><p><strong>Note</strong>: å½“PostGameplayEffectExecute()è¢«è°ƒç”¨æ—¶, å¯¹<code>Attribute</code>çš„ä¿®æ”¹å·²ç»å‘ç”Ÿ, ä½†æ˜¯è¿˜æ²¡æœ‰è¢«åŒæ­¥å›å®¢æˆ·ç«¯, å› æ­¤åœ¨è¿™é‡Œé™åˆ¶å€¼ä¸ä¼šé€ æˆå¯¹å®¢æˆ·ç«¯çš„äºŒæ¬¡åŒæ­¥, å®¢æˆ·ç«¯åªä¼šæ¥æ”¶åˆ°é™åˆ¶åçš„å€¼.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-as-onattributeaggregatorcreated"></a></p><h4 id="4-4-7-OnAttributeAggregatorCreated"><a href="#4-4-7-OnAttributeAggregatorCreated" class="headerlink" title="4.4.7 OnAttributeAggregatorCreated()"></a>4.4.7 OnAttributeAggregatorCreated()</h4><p><code>OnAttributeAggregatorCreated(const FGameplayAttribute&amp; Attribute, FAggregator* NewAggregator)</code>ä¼šåœ¨Aggregatorä¸ºé›†åˆä¸­çš„æŸä¸ª<code>Attribute</code>åˆ›å»ºæ—¶è§¦å‘, å®ƒå…è®¸<a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/FAggregatorEvaluateMetaData/index.html">FAggregatorEvaluateMetaData</a>çš„è‡ªå®šä¹‰è®¾ç½®, <code>AggregatorEvaluateMetaData</code>æ˜¯AggregatoråŸºäºæ‰€æœ‰åº”ç”¨çš„<code>Modifier(Modifier)</code>è¯„ä¼°<code>Attribute</code>çš„CurrentValueçš„. é»˜è®¤æƒ…å†µä¸‹, AggregatorEvaluateMetaDataåªç”±Aggregatorç”¨äºç¡®å®šå“ªäº›<a href="#concepts-ge-mods">Modifier</a>æ˜¯æ»¡è¶³æ¡ä»¶çš„, ä»¥MostNegativeMod_AllPositiveModsä¸ºä¾‹, å…¶å…è®¸æ‰€æœ‰æ­£(Positive)<code>Modifier</code>ä½†æ˜¯é™åˆ¶è´Ÿ(Negative)<code>Modifier</code>(ä»…æœ€è´Ÿçš„é‚£ä¸€ä¸ª), è¿™åœ¨Paragonä¸­åªå…è®¸å°†æœ€è´Ÿç§»åŠ¨é€Ÿåº¦å‡é€Ÿæ•ˆæœåº”ç”¨åˆ°ç©å®¶, è€Œä¸ç”¨ç®¡åº”ç”¨æ‰€æœ‰æ­£ç§»åŠ¨é€Ÿåº¦buffæ—¶æœ‰å¤šå°‘è´Ÿç§»åŠ¨æ•ˆæœ. ä¸æ»¡è¶³æ¡ä»¶çš„<code>Modifier</code>ä»å­˜äº<code>ASC</code>ä¸­, åªæ˜¯ä¸è¢«æ€»åˆè¿›æœ€ç»ˆçš„CurrentValue, ä¸€æ—¦æ¡ä»¶æ”¹å˜, å®ƒä»¬ä¹‹åå°±å¯èƒ½æ»¡è¶³æ¡ä»¶, å°±åƒå¦‚æœæœ€è´Ÿ<code>Modifier</code>è¿‡æœŸå, ä¸‹ä¸€ä¸ªæœ€è´Ÿ<code>Modifier</code>(å¦‚æœå­˜åœ¨çš„è¯)å°±æ˜¯æ»¡è¶³æ¡ä»¶çš„.  </p><p>ä¸ºäº†åœ¨åªå…è®¸æœ€è´Ÿ<code>Modifier</code>å’Œæ‰€æœ‰æ­£<code>Modifier</code>çš„ä¾‹å­ä¸­ä½¿ç”¨<code>AggregatorEvaluateMetaData</code>:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnAttributeAggregatorCreated</span><span class="params">(<span class="type">const</span> FGameplayAttribute&amp; Attribute, FAggregator* NewAggregator)</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UGSAttributeSetBase::OnAttributeAggregatorCreated</span><span class="params">(<span class="type">const</span> FGameplayAttribute&amp; Attribute, FAggregator* NewAggregator)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">OnAttributeAggregatorCreated</span>(Attribute, NewAggregator);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!NewAggregator)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Attribute == <span class="built_in">GetMoveSpeedAttribute</span>())</span><br><span class="line">&#123;</span><br><span class="line">NewAggregator-&gt;EvaluationMetaData = &amp;FAggregatorEvaluateMetaDataLibrary::MostNegativeMod_AllPositiveMods;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ çš„è‡ªå®šä¹‰<code>AggregatorEvaluateMetaData</code>åº”è¯¥ä½œä¸ºé™æ€å˜é‡æ·»åŠ åˆ°<code>FAggregatorEvaluateMetaDataLibrary</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge"></a></p><h3 id="4-5-Gameplay-Effects"><a href="#4-5-Gameplay-Effects" class="headerlink" title="4.5 Gameplay Effects"></a>4.5 Gameplay Effects</h3><p><a name="concepts-ge-definition"></a></p><h4 id="4-5-1-å®šä¹‰GameplayEffect"><a href="#4-5-1-å®šä¹‰GameplayEffect" class="headerlink" title="4.5.1 å®šä¹‰GameplayEffect"></a>4.5.1 å®šä¹‰GameplayEffect</h4><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/UGameplayEffect/index.html">GameplayEffect(GE)</a>æ˜¯Abilityä¿®æ”¹å…¶è‡ªèº«å’Œå…¶ä»–<a href="#concepts-a">Attribute</a>å’Œ<a href="#concepts-gt">GameplayTag</a>çš„å®¹å™¨, å…¶å¯ä»¥ç«‹å³ä¿®æ”¹<code>Attribute</code>(åƒä¼¤å®³æˆ–æ²»ç–—)æˆ–åº”ç”¨é•¿æœŸçš„çŠ¶æ€buff/debuff(åƒç§»åŠ¨é€Ÿåº¦åŠ é€Ÿæˆ–çœ©æ™•). UGameplayEffectåªæ˜¯ä¸€ä¸ªå®šä¹‰å•ä¸€æ¸¸æˆæ•ˆæœçš„æ•°æ®ç±», ä¸åº”è¯¥åœ¨å…¶ä¸­æ·»åŠ é¢å¤–çš„é€»è¾‘. è®¾è®¡å¸ˆä¸€èˆ¬ä¼šåˆ›å»ºå¾ˆå¤šUGameplayEffectçš„å­ç±»è“å›¾.  </p><p><code>GameplayEffect</code>é€šè¿‡<a href="#concepts-ge-mods">Modifier</a>å’Œ<a href="#concepts-ge-ec">Execution(GameplayEffectExecutionCalculation)</a>ä¿®æ”¹<code>Attribute</code>.  </p><p><code>GameplayEffect</code>æœ‰ä¸‰ç§æŒç»­ç±»å‹: <code>å³åˆ»(Instant)</code>, <code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)</code>.  </p><p>é¢å¤–åœ°, <code>GameplayEffect</code>å¯ä»¥æ·»åŠ /æ‰§è¡Œ<a href="#concepts-gc">GameplayCue</a>, <code>å³åˆ»(Instant)GameplayEffect</code>å¯ä»¥è°ƒç”¨<code>GameplayCue GameplayTag</code>çš„Executeè€Œ<code>æŒç»­(Duration)</code>æˆ–<code>æ— é™(Infinite)</code>å¯ä»¥è°ƒç”¨<code>GameplayCue GameplayTag</code>çš„Addå’ŒRemove.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">ç±»å‹</th><th style="text-align:center">GameplayCueäº‹ä»¶</th><th style="text-align:center">ä½•æ—¶ä½¿ç”¨</th></tr></thead><tbody><tr><td style="text-align:center">å³åˆ»(Instant)</td><td style="text-align:center">Execute</td><td style="text-align:center">å¯¹<code>Attribute</code>ä¸­BaseValueç«‹å³è¿›è¡Œçš„æ°¸ä¹…æ€§ä¿®æ”¹. å…¶ä¸ä¼šåº”ç”¨<code>GameplayTag</code>, å“ªæ€•æ˜¯ä¸€å¸§.</td></tr><tr><td style="text-align:center">æŒç»­(Duration)</td><td style="text-align:center">Add &amp; Remove</td><td style="text-align:center">å¯¹<code>Attribute</code>ä¸­CurrentValueçš„ä¸´æ—¶ä¿®æ”¹å’Œå½“<code>GameplayEffect</code>è¿‡æœŸæˆ–æ‰‹åŠ¨ç§»é™¤æ—¶, åº”ç”¨å°†è¦è¢«ç§»é™¤çš„<code>GameplayTag</code>. æŒç»­æ—¶é—´æ˜¯åœ¨UGameplayEffectç±»/è“å›¾ä¸­æ˜ç¡®çš„.</td></tr><tr><td style="text-align:center">æ— é™(Infinite)</td><td style="text-align:center">Add &amp; Remove</td><td style="text-align:center">å¯¹<code>Attribute</code>ä¸­CurrentValueçš„ä¸´æ—¶ä¿®æ”¹å’Œå½“<code>GameplayEffect</code>ç§»é™¤æ—¶, åº”ç”¨å°†è¦è¢«ç§»é™¤çš„<code>GameplayTag</code>. è¯¥ç±»å‹è‡ªèº«æ°¸ä¸è¿‡æœŸä¸”å¿…é¡»ç”±æŸä¸ªAbilityæˆ–<code>ASC</code>æ‰‹åŠ¨ç§»é™¤.</td></tr></tbody></table></div><p><code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)GameplayEffect</code>å¯ä»¥é€‰æ‹©åº”ç”¨å‘¨æœŸæ€§çš„Effect, å…¶æ¯è¿‡Xç§’(ç”±å‘¨æœŸå®šä¹‰)å°±åº”ç”¨ä¸€æ¬¡<code>Modifier</code>å’ŒExecution, å½“å‘¨æœŸæ€§çš„Effectä¿®æ”¹<code>Attribute</code>çš„BaseValueå’Œæ‰§è¡Œ<code>GameplayCue</code>æ—¶å°±è¢«è§†ä¸º<code>å³åˆ»(Instant)GameplayEffect</code>, è¿™ç§ç±»å‹çš„Effectå¯¹äºåƒéšæ—¶é—´æ¨ç§»çš„æŒç»­ä¼¤å®³(damage over time, DOT)å¾ˆæœ‰ç”¨. <strong>Note</strong>: å‘¨æœŸæ€§çš„Effectä¸èƒ½è¢«<a href="#concepts-p">é¢„æµ‹</a>.  </p><p>å¦‚æœ<code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)GameplayEffect</code>çš„Ongoing Tag Requirementsæœªæ»¡è¶³/æ»¡è¶³çš„è¯(<a href="#concepts-ge-tags">Gameplay Effect Tags</a>), é‚£ä¹ˆå®ƒä»¬åœ¨åº”ç”¨åå°±å¯ä»¥è¢«æš‚æ—¶çš„å…³é—­å’Œæ‰“å¼€, å…³é—­<code>GameplayEffect</code>ä¼šç§»é™¤å…¶<code>Modifier</code>å’Œå·²åº”ç”¨<code>GameplayTag</code>æ•ˆæœ, ä½†æ˜¯ä¸ä¼šç§»é™¤è¯¥<code>GameplayEffect</code>, é‡æ–°æ‰“å¼€<code>GameplayEffect</code>ä¼šé‡æ–°åº”ç”¨å…¶<code>Modifier</code>å’Œ<code>GameplayTag</code>.  </p><p>å¦‚æœä½ éœ€è¦æ‰‹åŠ¨é‡æ–°è®¡ç®—æŸä¸ª<code>æŒç»­(Duration)</code>æˆ–<code>æ— é™(Infinite)GameplayEffect</code>çš„<code>Modifier</code>(å‡è®¾æœ‰ä¸€ä¸ªä½¿ç”¨é<code>Attribute</code>æ•°æ®çš„<code>MMC</code>), å¯ä»¥ä½¿ç”¨å’Œ<code>UAbilitySystemComponent::ActiveGameplayEffect.GetActiveGameplayEffect(ActiveHandle).Spec.GetLevel()</code>ç›¸åŒçš„Levelè°ƒç”¨<code>UAbilitySystemComponent::ActiveGameplayEffect.SetActiveGameplayEffectLevel(FActiveGameplayEffectHandle ActiveHandle, int32 NewLevel)</code>. å½“<code>Backing Attribute</code>æ›´æ–°æ—¶, åŸºäº<code>Backing Attribute</code>çš„<code>Modifier</code>ä¼šè‡ªåŠ¨æ›´æ–°. SetActiveGameplayEffectLevel()æ›´æ–°<code>Modifier</code>çš„å…³é”®å‡½æ•°æ˜¯:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">MarkItemDirty</span>(Effect);</span><br><span class="line">Effect.Spec.<span class="built_in">CalculateModifierMagnitudes</span>();</span><br><span class="line"><span class="comment">// Private function otherwise we&#x27;d call these three functions without needing to set the level to what it already is</span></span><br><span class="line"><span class="built_in">UpdateAllAggregatorModMagnitudes</span>(Effect);</span><br></pre></td></tr></table></figure><p><code>GameplayEffect</code>ä¸€èˆ¬æ˜¯ä¸å®ä¾‹åŒ–çš„, å½“Abilityæˆ–<code>ASC</code>æƒ³è¦åº”ç”¨<code>GameplayEffect</code>æ—¶, å…¶ä¼šä»<code>GameplayEffect</code>çš„<code>ClassDefaultObject</code>åˆ›å»ºä¸€ä¸ª<code>GameplayEffectSpec</code>, ä¹‹åæˆåŠŸåº”ç”¨çš„<code>GameplayEffectSpec</code>ä¼šè¢«æ·»åŠ åˆ°ä¸€ä¸ªåä¸º<code>FActiveGameplayEffect</code>çš„æ–°ç»“æ„ä½“, å…¶æ˜¯<code>ASC</code>åœ¨åä¸º<code>ActiveGameplayEffect</code>çš„ç‰¹æ®Šç»“æ„ä½“å®¹å™¨ä¸­è¿½è¸ªçš„å†…å®¹.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-applying"></a></p><h4 id="4-5-2-åº”ç”¨GameplayEffect"><a href="#4-5-2-åº”ç”¨GameplayEffect" class="headerlink" title="4.5.2 åº”ç”¨GameplayEffect"></a>4.5.2 åº”ç”¨GameplayEffect</h4><p><code>GameplayEffect</code>å¯ä»¥è¢«<a href="#concepts-ga">GameplayAbility</a>å’Œ<code>ASC</code>ä¸­çš„å¤šä¸ªå‡½æ•°åº”ç”¨, å…¶é€šå¸¸æ˜¯<code>ApplyGameplayEffectTo</code>çš„å½¢å¼, ä¸åŒçš„å‡½æ•°æœ¬è´¨ä¸Šéƒ½æ˜¯æœ€ç»ˆåœ¨ç›®æ ‡ä¸Šè°ƒç”¨<code>UAbilitySystemComponent::ApplyGameplayEffectSpecToSelf()</code>çš„æ–¹ä¾¿å‡½æ•°.  </p><p>ä¸ºäº†åœ¨<code>GameplayAbility</code>ä¹‹å¤–åº”ç”¨<code>GameplayEffect</code>, ä¾‹å¦‚å¯¹äºæŸä¸ªæŠ•æ·ç‰©, ä½ å°±éœ€è¦è·å–åˆ°ç›®æ ‡çš„<code>ASC</code>å¹¶ä½¿ç”¨å®ƒçš„å‡½æ•°ä¹‹ä¸€æ¥<code>ApplyGameplayEffectToSelf</code>.  </p><p>ä½ å¯ä»¥ç»‘å®š<code>æŒç»­(Duration)</code>æˆ–<code>æ— é™(Infinite)GameplayEffect</code>çš„å§”æ‰˜æ¥ç›‘å¬å…¶åº”ç”¨åˆ°<code>ASC</code>:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AbilitySystemComponent-&gt;OnActiveGameplayEffectAddedDelegateToSelf.<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;APACharacterBase::OnActiveGameplayEffectAddedCallback);</span><br></pre></td></tr></table></figure><p>å›è°ƒå‡½æ•°:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnActiveGameplayEffectAddedCallback</span><span class="params">(UAbilitySystemComponent* Target, <span class="type">const</span> FGameplayEffectSpec&amp; SpecApplied, FActiveGameplayEffectHandle ActiveHandle)</span></span>;</span><br></pre></td></tr></table></figure><p>æœåŠ¡ç«¯æ€»æ˜¯ä¼šè°ƒç”¨è¯¥å‡½æ•°è€Œä¸ç®¡åŒæ­¥æ¨¡å¼æ˜¯ä»€ä¹ˆ, <code>Autonomous Proxy</code>åªä¼šåœ¨<code>Full</code>å’Œ<code>Mixed</code>åŒæ­¥æ¨¡å¼ä¸‹å¯¹äºåŒæ­¥çš„<code>GameplayEffect</code>è°ƒç”¨è¯¥å‡½æ•°, <code>Simulated Proxy</code>åªä¼šåœ¨<code>Full</code>åŒæ­¥æ¨¡å¼ä¸‹è°ƒç”¨è¯¥å‡½æ•°.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-removing"></a></p><h4 id="4-5-3-ç§»é™¤GameplayEffect"><a href="#4-5-3-ç§»é™¤GameplayEffect" class="headerlink" title="4.5.3 ç§»é™¤GameplayEffect"></a>4.5.3 ç§»é™¤GameplayEffect</h4><p><code>GameplayEffect</code>å¯ä»¥è¢«<a href="#concepts-ga">GameplayAbility</a>å’Œ<code>ASC</code>ä¸­çš„å¤šä¸ªå‡½æ•°ç§»é™¤, å…¶é€šå¸¸æ˜¯<code>RemoveActiveGameplayEffect</code>çš„å½¢å¼, ä¸åŒçš„å‡½æ•°æœ¬è´¨ä¸Šéƒ½æ˜¯æœ€ç»ˆåœ¨ç›®æ ‡ä¸Šè°ƒç”¨<code>FActiveGameplayEffectContainer::RemoveActiveEffects()</code>çš„æ–¹ä¾¿å‡½æ•°.  </p><p>ä¸ºäº†åœ¨<code>GameplayAbility</code>ä¹‹å¤–ç§»é™¤<code>GameplayEffect</code>, ä½ å°±éœ€è¦è·å–åˆ°è¯¥ç›®æ ‡çš„<code>ASC</code>å¹¶ä½¿ç”¨å®ƒçš„å‡½æ•°ä¹‹ä¸€æ¥<code>RemoveActiveGameplayEffect</code>.  </p><p>ä½ å¯ä»¥ç»‘å®š<code>æŒç»­(Duration)</code>æˆ–<code>æ— é™(Infinite)GameplayEffect</code>çš„å§”æ‰˜æ¥ç›‘å¬å…¶åº”ç”¨åˆ°<code>ASC</code>:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AbilitySystemComponent-&gt;<span class="built_in">OnAnyGameplayEffectRemovedDelegate</span>().<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;APACharacterBase::OnRemoveGameplayEffectCallback);</span><br></pre></td></tr></table></figure><p>å›è°ƒå‡½æ•°:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnRemoveGameplayEffectCallback</span><span class="params">(<span class="type">const</span> FActiveGameplayEffect&amp; EffectRemoved)</span></span>;</span><br></pre></td></tr></table></figure><p>æœåŠ¡ç«¯æ€»æ˜¯ä¼šè°ƒç”¨è¯¥å‡½æ•°è€Œä¸ç®¡åŒæ­¥æ¨¡å¼æ˜¯ä»€ä¹ˆ, <code>Autonomous Proxy</code>åªä¼šåœ¨Fullå’ŒMixedåŒæ­¥æ¨¡å¼ä¸‹å¯¹äºå¯åŒæ­¥çš„<code>GameplayEffect</code>è°ƒç”¨è¯¥å‡½æ•°, <code>Simulated Proxy</code>åªä¼šåœ¨FullåŒæ­¥æ¨¡å¼ä¸‹è°ƒç”¨è¯¥å‡½æ•°.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-mods"></a></p><h4 id="4-5-4-GameplayEffectModifier"><a href="#4-5-4-GameplayEffectModifier" class="headerlink" title="4.5.4 GameplayEffectModifier"></a>4.5.4 GameplayEffectModifier</h4><p><code>Modifier</code>å¯ä»¥ä¿®æ”¹<code>Attribute</code>å¹¶ä¸”æ˜¯å”¯ä¸€å¯ä»¥<a href="#concepts-p">é¢„æµ‹æ€§</a>ä¿®æ”¹<code>Attribute</code>çš„æ–¹æ³•. ä¸€ä¸ª<code>GameplayEffect</code>å¯ä»¥æœ‰0ä¸ªæˆ–å¤šä¸ª<code>Modifier</code>, æ¯ä¸ª<code>Modifier</code>é€šè¿‡æŸä¸ªæŒ‡å®šçš„æ“ä½œåªèƒ½ä¿®æ”¹ä¸€ä¸ª<code>Attribute</code>.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">æ“ä½œ</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">Add</td><td style="text-align:center">å°†<code>Modifier</code>æŒ‡å®šçš„<code>Attribute</code>åŠ ä¸Šè®¡ç®—ç»“æœ. ä½¿ç”¨è´Ÿæ•°ä»¥å®ç°å‡æ³•æ“ä½œ.</td></tr><tr><td style="text-align:center">Multiply</td><td style="text-align:center">å°†<code>Modifier</code>æŒ‡å®šçš„<code>Attribute</code>ä¹˜ä»¥è®¡ç®—ç»“æœ.</td></tr><tr><td style="text-align:center">Divide</td><td style="text-align:center">å°†<code>Modifier</code>æŒ‡å®šçš„<code>Attribute</code>é™¤ä»¥è®¡ç®—ç»“æœ.</td></tr><tr><td style="text-align:center">Override</td><td style="text-align:center">ä½¿ç”¨è®¡ç®—ç»“æœè¦†ç›–<code>Modifier</code>æŒ‡å®šçš„<code>Attribute</code>.</td></tr></tbody></table></div><p><code>Attribute</code>çš„CurrentValueæ˜¯å…¶æ‰€æœ‰<code>Modifier</code>ä¸å…¶BaseValueè®¡ç®—å¹¶æ€»åˆåçš„ç»“æœ, åƒä¸‹é¢è¿™æ ·çš„<code>Modifier</code>æ€»åˆå…¬å¼è¢«å®šä¹‰åœ¨<code>GameplayEffectAggregator.cpp</code>ä¸­çš„<code>FAggregatorModChannel::EvaluateWithBase</code>:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((InlineBaseValue + Additive) * Multiplicitive) / Division</span><br></pre></td></tr></table></figure><p>Override<code>Modifier</code>ä¼šä¼˜å…ˆè¦†ç›–æœ€ååº”ç”¨çš„<code>Modifier</code>å¾—å‡ºçš„æœ€ç»ˆå€¼.  </p><p><strong>Note</strong>: å¯¹äºåŸºäºç™¾åˆ†æ¯”çš„ä¿®æ”¹, ç¡®ä¿ä½¿ç”¨<code>Multiply</code>æ“ä½œä»¥ä½¿å…¶åœ¨åŠ æ³•æ“ä½œä¹‹å.  </p><p><strong>Note</strong>: <a href="#concepts-p">é¢„æµ‹(Prediction)</a>å¯¹äºç™¾åˆ†æ¯”ä¿®æ”¹æœ‰äº›é—®é¢˜.  </p><p>æœ‰å››ç§ç±»å‹çš„<code>Modifier</code>: <code>ScalableFloat</code>, <code>AttributeBased</code>, <code>CustomCalculationClass</code>, å’Œ <code>SetByCaller</code>, å®ƒä»¬å…¨éƒ½ç”Ÿæˆä¸€äº›æµ®ç‚¹æ•°, ç”¨äºä¹‹ååŸºäºå„è‡ªçš„æ“ä½œä¿®æ”¹æŒ‡å®š<code>Modifier</code>çš„<code>Attribute</code>.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">Modifierç±»å‹</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">Scalable Float</td><td style="text-align:center">FScalableFloatç»“æ„ä½“å¯ä»¥æŒ‡å‘æŸä¸ªæ¨ªå‘ä¸ºå˜é‡, çºµå‘ä¸ºç­‰çº§çš„Data Table, <code>Scalable Float</code>ä¼šä»¥Abilityçš„å½“å‰ç­‰çº§è‡ªåŠ¨è¯»å–æŒ‡å®šData Tableçš„æŸè¡Œå€¼(æˆ–è€…åœ¨<a href="#concepts-ge-spec">GameplayEffectSpec</a>ä¸­é‡å†™çš„ä¸åŒç­‰çº§), è¯¥å€¼è¿˜å¯ä»¥è¿›ä¸€æ­¥è¢«ç³»æ•°å¤„ç†, å¦‚æœæ²¡æœ‰æŒ‡å®šData Table/Row, é‚£ä¹ˆå°±ä¼šå°†å…¶è§†ä¸º1, å› æ­¤è¯¥ç³»æ•°å°±å¯ä»¥åœ¨æ‰€æœ‰ç­‰çº§éƒ½ç¡¬ç¼–ç ä¸ºä¸€ä¸ªå€¼.<img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/scalablefloats.png" alt="ScalableFloat"></td></tr><tr><td style="text-align:center">Attribute Based</td><td style="text-align:center"><code>Attribute Based Modifier</code>å°†Source(<code>GameplayEffectSpec</code>çš„åˆ›å»ºè€…)æˆ–Target(<code>GameplayEffectSpec</code>çš„æ¥æ”¶è€…)ä¸Šçš„CurrentValueæˆ–BaseValueè§†ä¸º<code>Backing Attribute</code>, å¯ä»¥ä½¿ç”¨ç³»æ•°å’ŒPreä¸Postç³»æ•°å’Œæ¥ä¿®æ”¹å®ƒ. <code>Snapshotting</code>æ„å‘³ç€å½“<code>GameplayEffectSpec</code>åˆ›å»ºæ—¶æ•è·è¯¥<code>Attribute</code>, è€Œ<code>No Snapshotting</code>æ„å‘³ç€å½“<code>GameplayEffectSpec</code>åº”ç”¨æ—¶æ•è·è¯¥<code>Attribute</code>.</td></tr><tr><td style="text-align:center">Custom Calculation Class</td><td style="text-align:center"><code>Custom Calculation Class</code>ä¸ºå¤æ‚çš„<code>Modifier</code>æä¾›äº†æœ€å¤§çš„çµæ´»æ€§, è¯¥<code>Modifier</code>ä½¿ç”¨äº†<a href="#concepts-ge-mmc">ModifierMagnitudeCalculation</a>ç±», ä¸”å¯ä»¥ä½¿ç”¨ç³»æ•°å’ŒPreä¸Postç³»æ•°å’Œæ¥å¤„ç†æµ®ç‚¹å€¼ç»“æœ.</td></tr><tr><td style="text-align:center">Set By Caller</td><td style="text-align:center"><code>SetByCaller</code>Modifieræ˜¯è¿è¡Œæ—¶ç”±Abilityæˆ–<code>GameplayEffectSpec</code>çš„åˆ›å»ºè€…äº<code>GameplayEffect</code>ä¹‹å¤–è®¾ç½®çš„å€¼, ä¾‹å¦‚, å¦‚æœä½ æƒ³è®©ä¼¤å®³å€¼éšç©å®¶è“„åŠ›æŠ€èƒ½çš„é•¿çŸ­è€Œå˜åŒ–, é‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨<code>SetByCaller</code>. <code>SetByCaller</code>æœ¬è´¨ä¸Šæ˜¯å­˜äº<code>GameplayEffectSpec</code>ä¸­çš„<code>TMap&lt;FGameplayTag, float&gt;</code>, <code>Modifier</code>åªæ˜¯å‘ŠçŸ¥<code>Aggregator</code>å»å¯»æ‰¾ä¸æä¾›çš„<code>GameplayTag</code>ç›¸å…³è”çš„<code>SetByCaller</code>å€¼. <code>Modifier</code>ä½¿ç”¨çš„<code>SetByCaller</code>åªèƒ½ä½¿ç”¨è¯¥æ¦‚å¿µçš„<code>GameplayTag</code>å½¢å¼, <code>FName</code>å½¢å¼åœ¨æ­¤å¤„ä¸é€‚ç”¨. å¦‚æœ<code>Modifier</code>è¢«è®¾ç½®ä¸º<code>SetByCaller</code>, ä½†æ˜¯å¸¦æœ‰æ­£ç¡®<code>GameplayTag</code>çš„<code>SetByCaller</code>åœ¨<code>GameplayEffectSpec</code>ä¸­ä¸å­˜åœ¨, é‚£ä¹ˆæ¸¸æˆä¼šæŠ›å‡ºä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯å¹¶è¿”å›0, è¿™å¯èƒ½åœ¨<code>Divide</code>æ“ä½œä¸­é€ æˆé—®é¢˜. å‚é˜…<a href="#concepts-ge-spec-setbycaller">SetByCallers</a>è·å–æ›´å¤šå…³äºå¦‚ä½•ä½¿ç”¨<code>SetByCaller</code>çš„ä¿¡æ¯.</td></tr></tbody></table></div><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-mods-multiplydivide"></a></p><h5 id="4-5-4-1-Multiplyå’ŒDivide-Modifier"><a href="#4-5-4-1-Multiplyå’ŒDivide-Modifier" class="headerlink" title="4.5.4.1 Multiplyå’ŒDivide Modifier"></a>4.5.4.1 Multiplyå’ŒDivide Modifier</h5><p>é»˜è®¤æƒ…å†µä¸‹, æ‰€æœ‰çš„<code>Multiply</code>å’Œ<code>Divide</code>Modifieråœ¨å¯¹<code>Attribute</code>çš„BaseValueä¹˜é™¤å‰éƒ½ä¼šå…ˆåŠ åˆ°ä¸€èµ·.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">FAggregatorModChannel::EvaluateWithBase</span><span class="params">(<span class="type">float</span> InlineBaseValue, <span class="type">const</span> FAggregatorEvaluateParameters&amp; Parameters)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">...</span><br><span class="line"><span class="type">float</span> Additive = <span class="built_in">SumMods</span>(Mods[EGameplayModOp::Additive], GameplayEffectUtilities::<span class="built_in">GetModifierBiasByModifierOp</span>(EGameplayModOp::Additive), Parameters);</span><br><span class="line"><span class="type">float</span> Multiplicitive = <span class="built_in">SumMods</span>(Mods[EGameplayModOp::Multiplicitive], GameplayEffectUtilities::<span class="built_in">GetModifierBiasByModifierOp</span>(EGameplayModOp::Multiplicitive), Parameters);</span><br><span class="line"><span class="type">float</span> Division = <span class="built_in">SumMods</span>(Mods[EGameplayModOp::Division], GameplayEffectUtilities::<span class="built_in">GetModifierBiasByModifierOp</span>(EGameplayModOp::Division), Parameters);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">return</span> ((InlineBaseValue + Additive) * Multiplicitive) / Division;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">FAggregatorModChannel::SumMods</span><span class="params">(<span class="type">const</span> TArray&lt;FAggregatorMod&gt;&amp; InMods, <span class="type">float</span> Bias, <span class="type">const</span> FAggregatorEvaluateParameters&amp; Parameters)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">float</span> Sum = Bias;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">const</span> FAggregatorMod&amp; Mod : InMods)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Mod.<span class="built_in">Qualifies</span>())</span><br><span class="line">&#123;</span><br><span class="line">Sum += (Mod.EvaluatedMagnitude - Bias);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>æ‘˜è‡ªGameplayEffectAggregator.cpp</em>  </p><p>åœ¨è¯¥å…¬å¼ä¸­<code>Multiply</code>å’Œ<code>Divide</code>Modifieréƒ½æœ‰ä¸€ä¸ªå€¼ä¸º1çš„<code>Bias</code>å€¼(åŠ æ³•çš„<code>Bias</code>å€¼ä¸º0), å› æ­¤å®ƒçœ‹èµ·æ¥åƒ:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> + (Mod1.Magnitude - <span class="number">1</span>) + (Mod2.Magnitude - <span class="number">1</span>) + ...</span><br></pre></td></tr></table></figure><p>è¯¥å…¬å¼ä¼šå¯¼è‡´ä¸€äº›æ„æ–™ä¹‹å¤–çš„ç»“æœ, é¦–å…ˆ, å®ƒåœ¨å¯¹BaseValueä¹˜é™¤ä¹‹å‰å°†æ‰€æœ‰çš„<code>Modifier</code>éƒ½åŠ åˆ°äº†ä¸€èµ·, å¤§éƒ¨åˆ†äººéƒ½æœŸæœ›å°†å…¶ä¹˜æˆ–é™¤åœ¨ä¸€èµ·, ä¾‹å¦‚, ä½ æœ‰ä¸¤ä¸ªå€¼ä¸º1.5çš„<code>Multiply</code>Modifier, å¤§éƒ¨åˆ†äººéƒ½æœŸæœ›å°†BaseValueä¹˜ä¸Š<code>1.5 x 1.5 = 2.25</code>, ç„¶è€Œ, è¿™é‡Œæ˜¯å°†ä¸¤ä¸ª1.5åŠ åœ¨ä¸€èµ·å†ä¹˜ä»¥BaseValue(50%å¢é‡ + å¦ä¸€ä¸ª50%å¢é‡ = 100%å¢é‡).æ‹¿<code>GameplayPrediction.h</code>ä¸­çš„ä¸€ä¸ªä¾‹å­æ¥è¯´, ç»™åŸºå€¼é€Ÿåº¦500åŠ ä¸Š10%çš„åŠ é€Ÿbuffå°±æ˜¯550, å†åŠ ä¸Šå¦ä¸€ä¸ª10%çš„åŠ é€Ÿbuffå°±æ˜¯600.  </p><p>å…¶æ¬¡, è¯¥å…¬å¼è¿˜æœ‰ä¸€äº›å¯¹äºå¯ä»¥ä½¿ç”¨å“ªäº›å€¼è€Œæœªè¯´æ˜çš„çš„è§„åˆ™, å› ä¸ºè¿™æ˜¯è€ƒè™‘Paragonçš„æƒ…å†µè€Œè®¾è®¡çš„.  </p><p><em>è¯‘è€…æ³¨: è¯´å®è¯, æˆ‘æ²¡æœ‰ææ‡‚ä¸‹æ–‡ä¸­åŸæ–‡æ¡£ä½œè€…çš„é€»è¾‘, å¯èƒ½æ˜¯æ²¡æœ‰å……åˆ†äº†è§£é¡¹ç›®çš„åŸå› ? æ¯”å¦‚åœ¨æ ·ä¾‹é¡¹ç›®ä¸­, åˆ é™¤BP_DamageVolumeçš„GameplayEffectä¸­çš„Executions, å¹¶æŒ‰ç…§ä¸‹æ–‡ä¾‹4æ·»åŠ ä¸¤ä¸ªMultiply Multipliers, Attributeå‡ä¸ºGDAttributeSetBase.XP, Modifier Magnitudeå‡ä¸ºScalable Float/5.0, å›åˆ°æ¸¸æˆ, å‡»æ€ä¸€ä¸ªå°å…µä½¿XPå¢åŠ åˆ°1, ç„¶åè¿›å…¥BP_DamageVolume, ä¼šå‘ç°XPä¾æ¬¡å˜ä¸º25, 625â€¦, è¿›è¡Œè°ƒè¯•ä¹Ÿä¼šå‘ç°æ˜¯Modifierä¾æ¬¡ç›¸ä¹˜çš„, å¹¶ä¸æ˜¯ä½œè€…æ‰€è¯´çš„ä¹˜æ³•åˆ†é…å¾‹é€»è¾‘. è¿˜æœ‰å°±æ˜¯ä¸ºä»€ä¹ˆç¬¦åˆå…¬å¼è§„åˆ™çš„<code>1 + (0.5 - 1) + (1.1 - 1) = 0.6</code>æ˜¯æ­£ç¡®çš„è€Œä¸ç¬¦åˆå…¬å¼è§„åˆ™çš„<code>1 + (0.5 - 1) + (0.5 - 1) = 0</code>å’Œ<code>1 + (5 - 1) + (5 - 1) = 9</code>å°±æ˜¯é”™è¯¯é¢„æœŸ? è¿™ä¸ªæ­£ç¡®å’Œé”™è¯¯é¢„æœŸæ˜¯ä»¥ä»€ä¹ˆä¸ºè¯„åˆ¤æ ‡å‡†çš„? æ˜¯å¦ç¬¦åˆå…¬å¼è§„åˆ™ä¹ˆ? å¦‚æœå„ä½æ˜ç™½å…¶ä¸­é“ç†, è¿˜è¯·ä¸åèµæ•™, åœ¨æ­¤æ„Ÿè°¢!</em>  </p><p>å¯¹äº<code>Multiply</code>å’Œ<code>Divide</code>ä¸­ä¹˜æ³•åŠ æ³•å…¬å¼çš„è§„åˆ™:  </p><ul><li>(æœ€å¤šä¸è¶…è¿‡1ä¸ªå€¼ &lt; 1) AND (ä»»æ„æ•°é‡å€¼ä½äº[1, 2))</li><li>OR (ä¸€ä¸ªå€¼ &gt;= 2)</li></ul><p>å…¬å¼ä¸­çš„BiasåŸºæœ¬ä¸Šéƒ½ä¼šå‡å»<code>[1, 2)</code>åŒºé—´ä¸­çš„æ•´æ•°ä½, ç¬¬ä¸€ä¸ªModifierçš„<code>Bias</code>ä¼šä»æœ€å¼€å§‹çš„<code>Sum</code>å€¼å‡å€¼(åœ¨å¾ªç¯ä½“å‰è®¾ç½®Bias), è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæŸä¸ªå€¼å®ƒæœ¬èº«èƒ½èµ·ä½œç”¨çš„åŸå› ä»¥åŠæŸä¸ªå°äº1çš„å€¼ä¸<code>[1, 2)</code>åŒºé—´ä¸­çš„å€¼èµ·ä½œç”¨çš„åŸå› .  </p><p><code>Multiply</code>çš„ä¸€äº›ä¾‹å­:<br>Multipliers: 0.5<br><code>1 + (0.5 - 1) = 0.5</code>, æ­£ç¡®.  </p><p>Multipliers: 0.5, 0.5<br><code>1 + (0.5 - 1) + (0.5 - 1) = 0</code>, é”™è¯¯é¢„æœŸ<code>1</code>? å¤šä¸ªå°äº1çš„å€¼åœ¨<code>Modifier</code>ç›¸åŠ ä¸­ä¸èµ·ä½œç”¨. Paragonè¿™æ ·è®¾è®¡åªæ˜¯ä¸ºäº†ä½¿ç”¨<a href="#cae-nonstackingge">Multiply Modifierçš„æœ€è´Ÿå€¼</a>, å› æ­¤æœ€å¤šåªä¼šæœ‰ä¸€ä¸ªå°äº1çš„å€¼ä¹˜åˆ°BaseValue.  </p><p>Multipliers: 1.1, 0.5<br><code>1 + (0.5 - 1) + (1.1 - 1) = 0.6</code>, æ­£ç¡®.  </p><p>Multipliers: 5, 5<br><code>1 + (5 - 1) + (5 - 1) = 9</code>, é”™è¯¯é¢„æœŸ<code>10</code>. å®ƒæ€»ä¼šæ˜¯<code>Modifierå€¼çš„å’Œ - Modifierä¸ªæ•° + 1</code>.  </p><p>å¾ˆå¤šæ¸¸æˆä¼šæƒ³è¦å®ƒä»¬çš„<code>Modify</code>å’Œ<code>Divide</code>Modifieråœ¨åº”ç”¨åˆ°BaseValueä¹‹å‰å…ˆä¹˜æˆ–é™¤åˆ°ä¸€èµ·, ä¸ºäº†å®ç°è¿™ç§éœ€æ±‚, ä½ éœ€è¦ä¿®æ”¹<code>FAggregatorModChannel::EvaluateWithBase()</code>çš„å¼•æ“ä»£ç .  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">FAggregatorModChannel::EvaluateWithBase</span><span class="params">(<span class="type">float</span> InlineBaseValue, <span class="type">const</span> FAggregatorEvaluateParameters&amp; Parameters)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">...</span><br><span class="line"><span class="type">float</span> Multiplicitive = <span class="built_in">MultiplyMods</span>(Mods[EGameplayModOp::Multiplicitive], Parameters);</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ((InlineBaseValue + Additive) * Multiplicitive) / Division;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">FAggregatorModChannel::MultiplyMods</span><span class="params">(<span class="type">const</span> TArray&lt;FAggregatorMod&gt;&amp; InMods, <span class="type">const</span> FAggregatorEvaluateParameters&amp; Parameters)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">float</span> Multiplier = <span class="number">1.0f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">const</span> FAggregatorMod&amp; Mod : InMods)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Mod.<span class="built_in">Qualifies</span>())</span><br><span class="line">&#123;</span><br><span class="line">Multiplier *= Mod.EvaluatedMagnitude;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Multiplier;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-mods-gameplaytags"></a></p><h5 id="4-5-4-2-Modifierçš„GameplayTag"><a href="#4-5-4-2-Modifierçš„GameplayTag" class="headerlink" title="4.5.4.2 Modifierçš„GameplayTag"></a>4.5.4.2 Modifierçš„GameplayTag</h5><p>æ¯ä¸ª<a href="#concepts-ge-mods">Modifier</a>éƒ½å¯ä»¥è®¾ç½®<code>SourceTag</code>å’Œ<code>TargetTag</code>, å®ƒä»¬çš„ä½œç”¨å°±åƒ<code>GameplayEffect</code>çš„<a href="#concepts-ge-tags">Application Tag requirements</a>, å› æ­¤åªæœ‰å½“Effectåº”ç”¨åæ‰ä¼šè€ƒè™‘æ ‡ç­¾, å¯¹äºå‘¨æœŸæ€§(Periodic)çš„<code>æ— é™(Infinite)</code>Effect, è¿™äº›æ ‡ç­¾åªä¼šåœ¨ç¬¬ä¸€æ¬¡åº”ç”¨Effectæ—¶æ‰ä¼šè¢«è€ƒè™‘, è€Œä¸æ˜¯åœ¨æ¯æ¬¡å‘¨æœŸæ‰§è¡Œæ—¶.  </p><p><code>Attribute Based Modifier</code>ä¹Ÿå¯ä»¥è®¾ç½®<code>SourceTagFilter</code>å’Œ<code>TargetTagFilter</code>. å½“ç¡®å®š<code>Attribute Based Modifier</code>çš„æº(Source)<code>Attribute</code>çš„Magnitudeæ—¶, è¿™äº›è¿‡æ»¤å™¨å°±ä¼šç”¨æ¥å°†æŸäº›<code>Modifier</code>æ’é™¤åœ¨è¯¥Attributeä¹‹å¤–, æº(Source)æˆ–ç›®æ ‡(Target)ä¸­æ²¡æœ‰è¿‡æ»¤å™¨æ‰€æœ‰æ ‡ç­¾çš„<code>Modifier</code>ä¹Ÿä¼šè¢«æ’é™¤åœ¨å¤–.  </p><p>è¿™æ›´è¯¦å°½çš„æ„æ€æ˜¯: æº(Source)<code>ASC</code>å’Œç›®æ ‡(Target)<code>ASC</code>çš„æ ‡ç­¾éƒ½è¢«<code>GameplayEffect</code>æ‰€æ•è·, å½“<code>GameplayEffectSpec</code>åˆ›å»ºæ—¶, æº(Source)<code>ASC</code>çš„æ ‡ç­¾è¢«æ•è·, å½“æ‰§è¡ŒEffectæ—¶, ç›®æ ‡(Target)<code>ASC</code>çš„æ ‡ç­¾è¢«æ•è·. å½“ç¡®å®š<code>æ— é™(Infinite)</code>æˆ–<code>æŒç»­(Duration)</code>Effectçš„<code>Modifier</code>æ˜¯å¦æ»¡è¶³æ¡ä»¶å¯ä»¥è¢«åº”ç”¨(ä¹Ÿå°±æ˜¯èšåˆå™¨æ¡ä»¶(Aggregator Qualify))å¹¶ä¸”è¿‡æ»¤å™¨å·²ç»è®¾ç½®æ—¶, è¢«æ•è·çš„æ ‡ç­¾å°±ä¼šå’Œè¿‡æ»¤å™¨è¿›è¡Œæ¯”å¯¹.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-stacking"></a></p><h4 id="4-5-5-GameplayEffectå †æ ˆ"><a href="#4-5-5-GameplayEffectå †æ ˆ" class="headerlink" title="4.5.5 GameplayEffectå †æ ˆ"></a>4.5.5 GameplayEffectå †æ ˆ</h4><p><code>GameplayEffect</code>é»˜è®¤ä¼šåº”ç”¨æ–°çš„<code>GameplayEffectSpec</code>å®ä¾‹, è€Œä¸æ˜ç¡®æˆ–ä¸å…³å¿ƒä¹‹å‰å·²ç»åº”ç”¨è¿‡çš„å°šä¸”å­˜åœ¨çš„<code>GameplayEffectSpec</code>å®ä¾‹. <code>GameplayEffect</code>å¯ä»¥è®¾ç½®åˆ°å †æ ˆä¸­, æ–°çš„<code>GameplayEffectSpec</code>å®ä¾‹ä¸ä¼šæ·»åŠ åˆ°å †æ ˆä¸­, è€Œæ˜¯ä¿®æ”¹å½“å‰å·²ç»å­˜åœ¨çš„<code>GameplayEffectSpec</code>å †æ ˆæ•°. å †æ ˆåªé€‚ç”¨äº<code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)GameplayEffect</code>.  </p><p>æœ‰ä¸¤ç§ç±»å‹çš„å †æ ˆ: Aggregate by Sourceå’ŒAggregate by Target.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">å †æ ˆç±»å‹</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">Aggregate by Source</td><td style="text-align:center">ç›®æ ‡(Target)ä¸Šçš„æ¯ä¸ªæº(Source)<code>ASC</code>éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„å †æ ˆå®ä¾‹, æ¯ä¸ªæº(Source)å¯ä»¥åº”ç”¨å †æ ˆä¸­çš„Xä¸ª<code>GameplayEffect</code>.</td></tr><tr><td style="text-align:center">Aggregate by Target</td><td style="text-align:center">ç›®æ ‡(Target)ä¸Šåªæœ‰ä¸€ä¸ªå †æ ˆå®ä¾‹è€Œä¸ç®¡æº(Source)å¦‚ä½•, æ¯ä¸ªæº(Source)éƒ½å¯ä»¥åœ¨å…±äº«å †æ ˆé™åˆ¶(Shared Stack Limit)å†…åº”ç”¨å †æ ˆ.</td></tr></tbody></table></div><p>å †æ ˆå¯¹è¿‡æœŸ, æŒç»­åˆ·æ–°å’Œå‘¨æœŸæ€§åˆ·æ–°ä¹Ÿæœ‰ä¸€äº›å¤„ç†ç­–ç•¥, è¿™äº›åœ¨<code>GameplayEffect</code>è“å›¾ä¸­éƒ½æœ‰å¾ˆå‹å¥½çš„æ‚¬æµ®æç¤ºå¸®åŠ©.  </p><p>æ ·ä¾‹é¡¹ç›®åŒ…å«ä¸€ä¸ªç”¨äºç›‘å¬<code>GameplayEffect</code>å †æ ˆå˜åŒ–çš„è‡ªå®šä¹‰è“å›¾èŠ‚ç‚¹, HUD UMG Widgetä½¿ç”¨å®ƒæ¥æ›´æ–°ç©å®¶æ‹¥æœ‰çš„è¢«åŠ¨æŠ¤ç›¾å †æ ˆ(å±‚æ•°). è¯¥<code>AsyncTask</code>å°†ä¼šä¸€ç›´å“åº”ç›´åˆ°æ‰‹åŠ¨è°ƒç”¨<code>EndTask()</code>, å°±åƒåœ¨UMG Widgetçš„<code>Destruct</code>äº‹ä»¶ä¸­è°ƒç”¨é‚£æ ·. å‚é˜…<code>AsyncTaskAttributeChanged.h/cpp</code>.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/gestackchange.png" alt="Listen for GameplayEffect Stack Change BP Node"></p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-ga"></a></p><h4 id="4-5-6-æˆäºˆAbility"><a href="#4-5-6-æˆäºˆAbility" class="headerlink" title="4.5.6 æˆäºˆAbility"></a>4.5.6 æˆäºˆAbility</h4><p><code>GameplayEffect</code>å¯ä»¥æˆäºˆ(Grant)æ–°çš„<a href="#concepts-ga">GameplayAbility</a>åˆ°<code>ASC</code>. åªæœ‰<code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)GameplayEffect</code>å¯ä»¥æˆäºˆAbility.  </p><p>ä¸€ä¸ªæ™®éç”¨æ³•æ˜¯å½“æƒ³è¦å¼ºåˆ¶å¦ä¸€ä¸ªç©å®¶åšæŸäº›äº‹çš„æ—¶å€™, åƒå‡»é€€æˆ–æ‹‰å–æ—¶ç§»åŠ¨ä»–ä»¬, å°±ä¼šå¯¹å®ƒä»¬åº”ç”¨ä¸€ä¸ª<code>GameplayEffect</code>æ¥æˆäºˆå…¶ä¸€ä¸ªè‡ªåŠ¨æ¿€æ´»çš„Ability(æŸ¥çœ‹<a href="#concepts-ga-activating-passive">è¢«åŠ¨Ability</a>æ¥äº†è§£å¦‚ä½•åœ¨Abilityè¢«æˆäºˆæ—¶è‡ªåŠ¨æ¿€æ´»å®ƒ), ä»è€Œä½¿å…¶åšå‡ºç›¸åº”çš„åŠ¨ä½œ.  </p><p>è®¾è®¡å¸ˆå¯ä»¥å†³å®šä¸€ä¸ª<code>GameplayEffect</code>èƒ½å¤Ÿæˆäºˆå“ªäº›Ability, æˆäºˆçš„Abilityç­‰çº§, å°†å…¶<a href="#concepts-ga-input">ç»‘å®š</a>åœ¨ä»€ä¹ˆè¾“å…¥é”®ä¸Šä»¥åŠè¯¥Abilityçš„ç§»é™¤ç­–ç•¥.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">ç§»é™¤ç­–ç•¥</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">ç«‹å³å–æ¶ˆAbility</td><td style="text-align:center">å½“æˆäºˆAbilityçš„<code>GameplayEffect</code>ä»ç›®æ ‡ç§»é™¤æ—¶, æˆäºˆçš„Abilityå°±ä¼šç«‹å³å–æ¶ˆå¹¶ç§»é™¤.</td></tr><tr><td style="text-align:center">ç»“æŸæ—¶ç§»é™¤Ability</td><td style="text-align:center">å…è®¸æˆäºˆçš„Abilityå®Œæˆ, ä¹‹åå°†å…¶ä»ç›®æ ‡ç§»é™¤.</td></tr><tr><td style="text-align:center">æ— </td><td style="text-align:center">æˆäºˆçš„Abilityä¸å—ä»ç›®æ ‡ç§»é™¤çš„æˆäºˆ<code>GameplayEffect</code>çš„å½±å“, ç›®æ ‡å°†ä¼šä¸€ç›´æ‹¥æœ‰è¯¥Abilityç›´åˆ°ä¹‹åè¢«æ‰‹åŠ¨ç§»é™¤.</td></tr></tbody></table></div><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-tags"></a></p><h4 id="4-5-7-GameplayEffectæ ‡ç­¾"><a href="#4-5-7-GameplayEffectæ ‡ç­¾" class="headerlink" title="4.5.7 GameplayEffectæ ‡ç­¾"></a>4.5.7 GameplayEffectæ ‡ç­¾</h4><p><code>GameplayEffect</code>å¯ä»¥å¸¦æœ‰å¤šä¸ª<a href="#concepts-gt">GameplayTagContainer</a>, è®¾è®¡å¸ˆå¯ä»¥ç¼–è¾‘æ¯ä¸ªç±»åˆ«çš„<code>Added</code>å’Œ<code>Removed</code>GameplayTagContainer, ç»“æœä¼šåœ¨ç¼–è¯‘åæ˜¾ç¤ºåœ¨<code>Combined GameplayTagContainer</code>ä¸­. <code>Added</code>æ ‡ç­¾æ˜¯è¯¥<code>GameplayEffect</code>æ–°å¢çš„ä¹‹å‰å…¶çˆ¶ç±»æ²¡æœ‰çš„æ ‡ç­¾, <code>Removed</code>æ ‡ç­¾æ˜¯å…¶çˆ¶ç±»æ‹¥æœ‰ä½†è¯¥ç±»æ²¡æœ‰çš„æ ‡ç­¾.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">åˆ†ç±»</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">Gameplay Effect Asset Tags</td><td style="text-align:center"><code>GameplayEffect</code>æ‹¥æœ‰çš„æ ‡ç­¾, å®ƒä»¬è‡ªèº«æ²¡æœ‰ä»»ä½•åŠŸèƒ½ä¸”åªç”¨äºæè¿°<code>GameplayEffect</code>.</td></tr><tr><td style="text-align:center">Granted Tags</td><td style="text-align:center">å­˜äº<code>GameplayEffect</code>ä¸­ä¸”åˆç”¨äº<code>GameplayEffect</code>æ‰€åº”ç”¨<code>ASC</code>çš„æ ‡ç­¾. å½“<code>GameplayEffect</code>ç§»é™¤æ—¶å®ƒä»¬ä¹Ÿä¼šä»<code>ASC</code>ä¸­ç§»é™¤. è¯¥æ ‡ç­¾åªä½œç”¨äº<code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)GameplayEffect</code>.</td></tr><tr><td style="text-align:center">Ongoing Tag Requirements</td><td style="text-align:center">ä¸€æ—¦<code>GameplayEffect</code>åº”ç”¨å, è¿™äº›æ ‡ç­¾å°†å†³å®š<code>GameplayEffect</code>æ˜¯å¼€å¯è¿˜æ˜¯å…³é—­. <code>GameplayEffect</code>å¯ä»¥æ˜¯å…³é—­ä½†ä»ç„¶æ˜¯åº”ç”¨çš„. å¦‚æœæŸä¸ª<code>GameplayEffect</code>ç”±äºä¸ç¬¦åˆ<code>Ongoing Tag Requirements</code>è€Œå…³é—­, ä½†æ˜¯ä¹‹ååˆæ»¡è¶³éœ€æ±‚äº†, é‚£ä¹ˆè¯¥<code>GameplayEffect</code>ä¼šé‡æ–°æ‰“å¼€å¹¶é‡æ–°åº”ç”¨å®ƒçš„<code>Modifier</code>. è¯¥æ ‡ç­¾åªä½œç”¨äº<code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)GameplayEffect</code>.</td></tr><tr><td style="text-align:center">Application Tag Requirements</td><td style="text-align:center">ä½äºç›®æ ‡ä¸Šå†³å®šæŸä¸ª<code>GameplayEffect</code>æ˜¯å¦å¯ä»¥åº”ç”¨åˆ°è¯¥ç›®æ ‡çš„æ ‡ç­¾, å¦‚æœä¸æ»¡è¶³è¿™äº›éœ€æ±‚, é‚£ä¹ˆ<code>GameplayEffect</code>å°±ä¸å¯åº”ç”¨.</td></tr><tr><td style="text-align:center">Remove Gameplay Effects with Tags</td><td style="text-align:center">å½“<code>GameplayEffect</code>æˆåŠŸåº”ç”¨å, å¦‚æœä½äºç›®æ ‡ä¸Šçš„è¯¥<code>GameplayEffect</code>åœ¨å…¶<code>Asset Tags</code>æˆ–<code>Granted Tags</code>ä¸­æœ‰ä»»æ„ä¸€ä¸ªæœ¬æ ‡ç­¾çš„è¯, å…¶å°±ä¼šè‡ªç›®æ ‡ä¸Šç§»é™¤.</td></tr></tbody></table></div><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-immunity"></a></p><h4 id="4-5-8-å…ç–«"><a href="#4-5-8-å…ç–«" class="headerlink" title="4.5.8 å…ç–«"></a>4.5.8 å…ç–«</h4><p><code>GameplayEffect</code>å¯ä»¥åŸºäº<a href="#concepts-gt">GameplayTag</a>å®ç°å…ç–«, æœ‰æ•ˆé˜»æ­¢å…¶ä»–<code>GameplayEffect</code>åº”ç”¨. å°½ç®¡å…ç–«å¯ä»¥ç”±<code>Application Tag Requirements</code>ç­‰æ–¹å¼æœ‰æ•ˆåœ°å®ç°, ä½†æ˜¯ä½¿ç”¨è¯¥ç³»ç»Ÿå¯ä»¥åœ¨<code>GameplayEffect</code>è¢«å…ç–«é˜»æ­¢æ—¶æä¾›<code>UAbilitySystemComponent::OnImmunityBlockGameplayEffectDelegate</code>å§”æ‰˜(Delegate).  </p><p><code>GrantedApplicationImmunityTags</code>ä¼šæ£€æŸ¥æº(Source)<code>ASC</code>(åŒ…æ‹¬æºAbilityçš„AbilityTag, å¦‚æœæœ‰çš„è¯)æ˜¯å¦åŒ…å«ç‰¹å®šçš„æ ‡ç­¾, è¿™æ˜¯ä¸€ç§åŸºäºç¡®å®šCharacteræˆ–æº(Source)çš„æ ‡ç­¾å¯¹å…¶æ‰€æœ‰<code>GameplayEffect</code>æä¾›å…ç–«çš„æ–¹æ³•.  </p><p><code>Granted Application Immunity Query</code>ä¼šæ£€æŸ¥ä¼ å…¥çš„<code>GameplayEffectSpec</code>æ˜¯å¦ä¸å…¶æŸ¥è¯¢æ¡ä»¶ç›¸åŒ¹é…, ä»è€Œé˜»æ­¢æˆ–å…è®¸å…¶åº”ç”¨.  </p><p><code>GameplayEffect</code>è“å›¾ä¸­çš„æŸ¥è¯¢æ¡ä»¶éƒ½æœ‰å‹å¥½çš„æ‚¬æµ®æç¤ºå¸®åŠ©.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-spec"></a></p><h4 id="4-5-9-GameplayEffectSpec"><a href="#4-5-9-GameplayEffectSpec" class="headerlink" title="4.5.9 GameplayEffectSpec"></a>4.5.9 GameplayEffectSpec</h4><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/FGameplayEffectSpec/index.html">GameplayEffectSpec(GESpec)</a>å¯ä»¥çœ‹ä½œæ˜¯<code>GameplayEffect</code>çš„å®ä¾‹, å®ƒä¿å­˜äº†ä¸€ä¸ªå…¶æ‰€ä»£è¡¨çš„<code>GameplayEffect</code>ç±»å¼•ç”¨, åˆ›å»ºæ—¶çš„ç­‰çº§å’Œåˆ›å»ºè€…, å®ƒåœ¨åº”ç”¨ä¹‹å‰å¯ä»¥åœ¨è¿è¡Œæ—¶(Runtime)è‡ªç”±çš„åˆ›å»ºå’Œä¿®æ”¹, ä¸åƒ<code>GameplayEffect</code>åº”è¯¥ç”±è®¾è®¡å¸ˆåœ¨è¿è¡Œå‰åˆ›å»º. å½“åº”ç”¨<code>GameplayEffect</code>æ—¶, <code>GameplayEffectSpec</code>ä¼šè‡ª<code>GameplayEffect</code>åˆ›å»ºå¹¶ä¸”ä¼šå®é™…åº”ç”¨åˆ°ç›®æ ‡(Target).  </p><p><code>GameplayEffectSpec</code>æ˜¯ç”±<code>UAbilitySystemComponent::MakeOutgoingSpec()(BlueprintCallable)</code>è‡ª<code>GameplayEffect</code>åˆ›å»ºçš„. <code>GameplayEffectSpec</code>ä¸å¿…ç«‹å³åº”ç”¨. é€šå¸¸æ˜¯å°†<code>GameplayEffectSpec</code>ä¼ é€’ç»™åˆ›å»ºè‡ªAbilityçš„æŠ•æ·ç‰©, è¯¥æŠ•æ·ç‰©å¯ä»¥åº”ç”¨åˆ°å®ƒä¹‹åå‡»ä¸­çš„ç›®æ ‡. å½“<code>GameplayEffectSpec</code>æˆåŠŸåº”ç”¨å, å°±ä¼šè¿”å›ä¸€ä¸ªåä¸º<code>FActiveGameplayEffect</code>çš„æ–°ç»“æ„ä½“.  </p><p><code>GameplayEffectSpec</code>çš„é‡è¦å†…å®¹:  </p><ul><li>åˆ›å»ºè¯¥<code>GameplayEffectSpec</code>çš„<code>GameplayEffect</code>ç±».</li><li>è¯¥<code>GameplayEffectSpec</code>çš„ç­‰çº§. é€šå¸¸å’Œåˆ›å»º<code>GameplayEffectSpec</code>çš„Abilityçš„ç­‰çº§ä¸€æ ·, ä½†æ˜¯å¯ä»¥æ˜¯ä¸åŒçš„.</li><li><code>GameplayEffectSpec</code>çš„æŒç»­æ—¶é—´. é»˜è®¤æ˜¯<code>GameplayEffect</code>çš„æŒç»­æ—¶é—´, ä½†æ˜¯å¯ä»¥æ˜¯ä¸åŒçš„.</li><li>å¯¹äºå‘¨æœŸæ€§Effectä¸­<code>GameplayEffectSpec</code>çš„å‘¨æœŸ, é»˜è®¤æ˜¯<code>GameplayEffect</code>çš„å‘¨æœŸ, ä½†æ˜¯å¯ä»¥æ˜¯ä¸åŒçš„.</li><li>è¯¥<code>GameplayEffectSpec</code>çš„å½“å‰å †æ ˆæ•°. å †æ ˆé™åˆ¶å–å†³äº<code>GameplayEffect</code>.</li><li><a href="#concepts-ge-context">GameplayEffectContextHandle</a>è¡¨æ˜è¯¥<code>GameplayEffectSpec</code>ç”±è°åˆ›å»º.</li><li><code>Attribute</code>åœ¨<code>GameplayEffectSpec</code>åˆ›å»ºæ—¶ç”±Snapshotæ•è·.</li><li>é™¤äº†<code>GameplayEffect</code>æˆäºˆçš„<code>GameplayTags</code>, <code>GameplayEffectSpec</code>è¿˜ä¼šæˆäºˆç›®æ ‡(Target)<code>DynamicGrantedTags</code>.</li><li>é™¤äº†<code>GameplayEffect</code>æ‹¥æœ‰çš„<code>AssetTags</code>, <code>GameplayEffectSpec</code>è¿˜ä¼šæ‹¥æœ‰<code>DynamicAssetTags</code>.</li><li><code>SetByCaller TMaps</code>.</li></ul><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-spec-setbycaller"></a></p><h5 id="4-5-9-1-SetByCaller"><a href="#4-5-9-1-SetByCaller" class="headerlink" title="4.5.9.1 SetByCaller"></a>4.5.9.1 SetByCaller</h5><p><code>SetByCaller</code>å…è®¸<code>GameplayEffectSpec</code>æ‹¥æœ‰å’Œ<code>GameplayTag</code>æˆ–<code>FName</code>ç›¸å…³è”çš„æµ®ç‚¹å€¼, å®ƒä»¬å­˜å‚¨åœ¨<code>GameplayEffectSpec</code>ä¸Šå…¶å„è‡ªçš„<code>TMaps: TMap&lt;FGameplayTag, float&gt;</code>å’Œ<code>TMap&lt;FName, float&gt;</code>ä¸­, å¯ä»¥ä½œä¸º<code>GameplayEffect</code>çš„<code>Modifier</code>æˆ–è€…ä¼ é€’æµ®ç‚¹å€¼çš„é€šç”¨æ–¹æ³•ä½¿ç”¨. å…¶æ™®éç”¨æ³•æ˜¯ç»ç”±<code>SetByCaller</code>ä¼ é€’æŸä¸ªAbilityå†…éƒ¨ç”Ÿæˆçš„æ•°å€¼æ•°æ®åˆ°<a href="#concepts-ge-ec">GameplayEffectExecutionCalculations</a>æˆ–<a href="#concepts-ge-mmc">ModifierMagnitudeCalculations</a>.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">SetByCallerä½¿ç”¨</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center"><code>Modifier</code></td><td style="text-align:center">å¿…é¡»æå‰åœ¨<code>GameplayEffect</code>ç±»ä¸­å®šä¹‰. åªèƒ½ä½¿ç”¨<code>GameplayTag</code>å½¢å¼. å¦‚æœåœ¨<code>GameplayEffect</code>ç±»ä¸­å®šä¹‰è€Œ<code>GameplayEffectSpec</code>ä¸­æ²¡æœ‰ç›¸åº”çš„æ ‡ç­¾/æµ®ç‚¹å€¼å¯¹, é‚£ä¹ˆæ¸¸æˆåœ¨<code>GameplayEffectSpec</code>åº”ç”¨æ—¶ä¼šæŠ›å‡ºè¿è¡Œæ—¶é”™è¯¯å¹¶è¿”å›0, è¿™å¯¹äº<code>Divide</code>æ“ä½œæ˜¯ä¸ªæ½œåœ¨é—®é¢˜, å‚é˜…<a href="#concepts-ge-mods">Modifier</a>.</td></tr><tr><td style="text-align:center">å…¶ä»–</td><td style="text-align:center">æ— éœ€æå‰å®šä¹‰. è¯»å–<code>GameplayEffectSpec</code>ä¸­ä¸å­˜åœ¨çš„<code>SetByCaller</code>ä¼šè¿”å›ä¸€ä¸ªç”±å¼€å‘è€…å®šä¹‰çš„å¯å¸¦æœ‰è­¦å‘Šä¿¡æ¯çš„é»˜è®¤å€¼.</td></tr></tbody></table></div><p>ä¸ºäº†åœ¨è“å›¾ä¸­æŒ‡å®š<code>SetByCaller</code>å€¼, è¯·ä½¿ç”¨ç›¸åº”å½¢å¼(<code>GameplayTag</code>æˆ–<code>FName</code>)çš„è“å›¾èŠ‚ç‚¹.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/setbycaller.png" alt="Assigning SetByCaller"></p><p>ä¸ºäº†åœ¨è“å›¾ä¸­è¯»å–<code>SetByCaller</code>å€¼, éœ€è¦åœ¨è“å›¾ä¸­åˆ›å»ºè‡ªå®šä¹‰èŠ‚ç‚¹.  </p><p>ä¸ºäº†åœ¨C++ä¸­æŒ‡å®š<code>SetByCaller</code>å€¼, éœ€è¦ä½¿ç”¨ç›¸åº”å½¢å¼çš„å‡½æ•°(<code>GameplayTag</code>æˆ–<code>FName</code>).  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FGameplayEffectSpec::SetSetByCallerMagnitude</span><span class="params">(FName DataName, <span class="type">float</span> Magnitude)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FGameplayEffectSpec::SetSetByCallerMagnitude</span><span class="params">(FGameplayTag DataTag, <span class="type">float</span> Magnitude)</span></span>;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†åœ¨C++ä¸­è¯»å–<code>SetByCaller</code>çš„å€¼, éœ€è¦ä½¿ç”¨ç›¸åº”å½¢å¼çš„å‡½æ•°(<code>GameplayTag</code>æˆ–<code>FName</code>).  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">GetSetByCallerMagnitude</span><span class="params">(FName DataName, <span class="type">bool</span> WarnIfNotFound = <span class="literal">true</span>, <span class="type">float</span> DefaultIfNotFound = <span class="number">0.f</span>)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">GetSetByCallerMagnitude</span><span class="params">(FGameplayTag DataTag, <span class="type">bool</span> WarnIfNotFound = <span class="literal">true</span>, <span class="type">float</span> DefaultIfNotFound = <span class="number">0.f</span>)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure><p>æˆ‘å»ºè®®ä½¿ç”¨<code>GameplayTag</code>å½¢å¼è€Œä¸æ˜¯<code>FName</code>å½¢å¼, è¿™å¯ä»¥é¿å…è“å›¾ä¸­çš„æ‹¼å†™é”™è¯¯, å¹¶ä¸”å½“<code>GameplayEffectSpec</code>åŒæ­¥æ—¶, <code>GameplayTag</code>æ¯”<code>FName</code>åœ¨ç½‘ç»œä¼ è¾“ä¸­æ›´æœ‰æ•ˆç‡, å› ä¸º<code>TMap</code>ä¹Ÿä¼šåŒæ­¥.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-context"></a></p><h4 id="4-5-10-GameplayEffectContext"><a href="#4-5-10-GameplayEffectContext" class="headerlink" title="4.5.10 GameplayEffectContext"></a>4.5.10 GameplayEffectContext</h4><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/FGameplayEffectContext/index.html">GameplayEffectContext</a>ç»“æ„ä½“å­˜æœ‰å…³äº<code>GameplayEffectSpec</code>åˆ›å»ºè€…(Instigator)å’Œ<a href="#concepts-targeting-data">TargetData</a>çš„ä¿¡æ¯, è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¯ç»§æ‰¿ç»“æ„ä½“ä»¥åœ¨<a href="#concepts-ge-mmc">ModifierMagnitudeCalculation</a>/<a href="#concepts-ge-ec">GameplayEffectExecutionCalculation</a>, <a href="#concepts-as">AttributeSet</a>å’Œ<a href="#concepts-gc">GameplayCue</a>ä¹‹é—´ä¼ é€’ä»»æ„æ•°æ®.  </p><p>ç»§æ‰¿<code>GameplayEffectContext</code>:  </p><ol><li>ç»§æ‰¿<code>FGameplayEffectContext</code>.</li><li>é‡å†™<code>FGameplayEffectContext::GetScriptStruct()</code>.</li><li>é‡å†™<code>FGameplayEffectContext::Duplicate()</code>.</li><li>å¦‚æœæ–°æ•°æ®éœ€è¦åŒæ­¥çš„è¯, é‡å†™<code>FGameplayEffectContext::NetSerialize()</code>.</li><li>å¯¹å­ç»“æ„ä½“å®ç°<code>TStructOpsTypeTraits</code>, å°±åƒçˆ¶ç»“æ„ä½“<code>FGameplayEffectContext</code>æœ‰çš„é‚£æ ·.</li><li>åœ¨<a href="#concepts-asg">AbilitySystemGlobals</a>ç±»ä¸­é‡å†™<code>AllocGameplayEffectContext()</code>ä»¥è¿”å›ä¸€ä¸ªæ–°çš„å­ç»“æ„ä½“å¯¹è±¡.</li></ol><p>GASShooterä½¿ç”¨äº†ä¸€ä¸ªå­ç»“æ„ä½“<code>GameplayEffectContext</code>æ¥æ·»åŠ å¯ä»¥åœ¨<code>GameplayCue</code>ä¸­è®¿é—®çš„<code>TargetData</code>, ç‰¹åˆ«æ˜¯å¯¹äºéœ°å¼¹æª, å› ä¸ºå®ƒå¯ä»¥å‡»æ‰“å¤šä¸ªæ•Œäºº.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-mmc"></a></p><h4 id="4-5-11-Modifier-Magnitude-Calculation"><a href="#4-5-11-Modifier-Magnitude-Calculation" class="headerlink" title="4.5.11 Modifier Magnitude Calculation"></a>4.5.11 Modifier Magnitude Calculation</h4><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/UGameplayModMagnitudeCalculation/index.html">ModifierMagnitudeCalculations</a>(<code>ModMagcCalc</code>æˆ–<code>MMC</code>)æ˜¯åœ¨<code>GameplayEffect</code>ä¸­ä½œä¸º<a href="#concepts-ge-mods">Modifier</a>ä½¿ç”¨çš„å¼ºæœ‰åŠ›çš„ç±», å®ƒçš„åŠŸèƒ½ç±»ä¼¼<a href="#concepts-ge-ec">GameplayEffectExecutionCalculation</a>ä½†æ˜¯è¦é€Šè‰²ä¸€äº›, æœ€é‡è¦çš„æ˜¯å®ƒæ˜¯å¯é¢„æµ‹çš„. å®ƒå”¯ä¸€è¦åšçš„å°±æ˜¯è‡ª<code>CalculateBaseMagnitude_Implementation()</code>è¿”å›æµ®ç‚¹å€¼, ä½ å¯ä»¥åœ¨C++å’Œè“å›¾ä¸­ç»§æ‰¿å¹¶é‡å†™è¯¥å‡½æ•°.  </p><p><code>MMC</code>å¯ä»¥ç”¨äºå„ç§æŒç»­æ—¶é—´çš„<code>GameplayEffect</code> - <code>å³åˆ»(Instant)</code>, <code>æŒç»­(Duration)</code>, <code>æ— é™(Infinite)</code>å’Œ<code>å‘¨æœŸæ€§(Periodic)</code>.  </p><p><code>MMC</code>çš„ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿå®Œå…¨è®¿é—®<code>GameplayEffectSpec</code>æ¥è¯»å–<code>GameplayTag</code>å’Œ<code>SetByCaller</code>ï¼Œä»è€Œèƒ½å¤Ÿæ•è·<code>GameplayEffect</code>çš„<code>æº(Source)</code>æˆ–<code>ç›®æ ‡(Target)</code>ä¸Šä»»æ„æ•°é‡çš„<code>Attribute</code>å€¼. <code>Attribute</code>å¯ä»¥è¢«Snapshotä¹Ÿå¯ä»¥ä¸è¢«Snapshot, <code>Snapshotted Attribute</code>åœ¨<code>GameplayEffectSpec</code>åˆ›å»ºæ—¶è¢«æ•è·è€Œé<code>Snapshotted Attribute</code>åœ¨<code>GameplayEffectSpec</code>åº”ç”¨æ—¶è¢«æ•è·å¹¶ä¸”è¯¥<code>Attribute</code>è¢«<code>æ— é™(Infinite)</code>æˆ–<code>æŒç»­(Duration)</code>GameplayEffectä¿®æ”¹æ—¶ä¼šè‡ªåŠ¨æ›´æ–°. æ•è·<code>Attribute</code>ä¼šè‡ª<code>ASC</code>ç°æœ‰çš„<code>Modifier</code>é‡æ–°è®¡ç®—å®ƒä»¬çš„<code>CurrentValue</code>, è¯¥é‡æ–°è®¡ç®—<strong>ä¸ä¼š</strong>æ‰§è¡Œ<code>AbilitySet</code>ä¸­çš„<a href="#concepts-as-preattributechange">PreAttributeChange()</a>, å› æ­¤æ‰€æœ‰çš„é™åˆ¶æ“ä½œ(Clamp)å¿…é¡»åœ¨è¿™é‡Œé‡æ–°å¤„ç†.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">Snapshot</th><th style="text-align:center">æº(Source)æˆ–ç›®æ ‡(Target)</th><th style="text-align:center">åœ¨GameplayEffectSpecä¸­æ•è·</th><th style="text-align:center">Attributeè¢«æ— é™(Infinite)æˆ–æŒç»­(Duration)GameplayEffectä¿®æ”¹æ—¶è‡ªåŠ¨æ›´æ–°</th></tr></thead><tbody><tr><td style="text-align:center">æ˜¯</td><td style="text-align:center">Source</td><td style="text-align:center">åˆ›å»º</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">æ˜¯</td><td style="text-align:center">Target</td><td style="text-align:center">åº”ç”¨</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">å¦</td><td style="text-align:center">Source</td><td style="text-align:center">åº”ç”¨</td><td style="text-align:center">æ˜¯</td></tr><tr><td style="text-align:center">å¦</td><td style="text-align:center">Target</td><td style="text-align:center">åº”ç”¨</td><td style="text-align:center">æ˜¯</td></tr></tbody></table></div><p><code>MMC</code>çš„ç»“æœæµ®ç‚¹å€¼å¯ä»¥è¿›ä¸€æ­¥ç”±ç³»æ•°å’Œå‰åç³»æ•°ä¹‹å’Œåœ¨<code>GameplayEffect</code>çš„<code>Modifier</code>ä¸­ä¿®æ”¹.  </p><p>ä¸¾ä¸€ä¸ª<code>MMC</code>çš„ä¾‹å­, è¯¥<code>MMC</code>ä¼šæ•è·ç›®æ ‡çš„é­”æ³•å€¼<code>Attribute</code>å¹¶å› ä¸ºæ¯’è¯Effectè€Œå°†å…¶å‡å°‘, å…¶å‡å°‘é‡çš„å˜åŒ–å–å†³äºç›®æ ‡æ‰€æ‹¥æœ‰çš„é­”æ³•å€¼å’Œå¯èƒ½æ‹¥æœ‰çš„æŸä¸ªæ ‡ç­¾:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">UPAMMC_PoisonMana::<span class="built_in">UPAMMC_PoisonMana</span>()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ManaDef defined in header FGameplayEffectAttributeCaptureDefinition ManaDef;</span></span><br><span class="line">ManaDef.AttributeToCapture = UPAAttributeSetBase::<span class="built_in">GetManaAttribute</span>();</span><br><span class="line">ManaDef.AttributeSource = EGameplayEffectAttributeCaptureSource::Target;</span><br><span class="line">ManaDef.bSnapshot = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//MaxManaDef defined in header FGameplayEffectAttributeCaptureDefinition MaxManaDef;</span></span><br><span class="line">MaxManaDef.AttributeToCapture = UPAAttributeSetBase::<span class="built_in">GetMaxManaAttribute</span>();</span><br><span class="line">MaxManaDef.AttributeSource = EGameplayEffectAttributeCaptureSource::Target;</span><br><span class="line">MaxManaDef.bSnapshot = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">RelevantAttributesToCapture.<span class="built_in">Add</span>(ManaDef);</span><br><span class="line">RelevantAttributesToCapture.<span class="built_in">Add</span>(MaxManaDef);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">float</span> <span class="title">UPAMMC_PoisonMana::CalculateBaseMagnitude_Implementation</span><span class="params">(<span class="type">const</span> FGameplayEffectSpec &amp; Spec)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// Gather the tags from the source and target as that can affect which buffs should be used</span></span><br><span class="line"><span class="type">const</span> FGameplayTagContainer* SourceTags = Spec.CapturedSourceTags.<span class="built_in">GetAggregatedTags</span>();</span><br><span class="line"><span class="type">const</span> FGameplayTagContainer* TargetTags = Spec.CapturedTargetTags.<span class="built_in">GetAggregatedTags</span>();</span><br><span class="line"></span><br><span class="line">FAggregatorEvaluateParameters EvaluationParameters;</span><br><span class="line">EvaluationParameters.SourceTags = SourceTags;</span><br><span class="line">EvaluationParameters.TargetTags = TargetTags;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Mana = <span class="number">0.f</span>;</span><br><span class="line"><span class="built_in">GetCapturedAttributeMagnitude</span>(ManaDef, Spec, EvaluationParameters, Mana);</span><br><span class="line">Mana = FMath::<span class="built_in">Max</span>&lt;<span class="type">float</span>&gt;(Mana, <span class="number">0.0f</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> MaxMana = <span class="number">0.f</span>;</span><br><span class="line"><span class="built_in">GetCapturedAttributeMagnitude</span>(MaxManaDef, Spec, EvaluationParameters, MaxMana);</span><br><span class="line">MaxMana = FMath::<span class="built_in">Max</span>&lt;<span class="type">float</span>&gt;(MaxMana, <span class="number">1.0f</span>); <span class="comment">// Avoid divide by zero</span></span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Reduction = <span class="number">-20.0f</span>;</span><br><span class="line"><span class="keyword">if</span> (Mana / MaxMana &gt; <span class="number">0.5f</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Double the effect if the target has more than half their mana</span></span><br><span class="line">Reduction *= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (TargetTags-&gt;<span class="built_in">HasTagExact</span>(FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="built_in">FName</span>(<span class="string">&quot;Status.WeakToPoisonMana&quot;</span>))))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Double the effect if the target is weak to PoisonMana</span></span><br><span class="line">Reduction *= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Reduction;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æ²¡æœ‰åœ¨<code>MMC</code>çš„æ„é€ å‡½æ•°ä¸­å°†<code>FGameplayEffectAttributeCaptureDefinition</code>æ·»åŠ åˆ°<code>RelevantAttributesToCapture</code>ä¸­å¹¶ä¸”å°è¯•æ•è·<code>Attribute</code>, é‚£ä¹ˆå°†ä¼šå¾—åˆ°ä¸€ä¸ªå…³äºæ•è·æ—¶ç¼ºå¤±Specçš„é”™è¯¯. å¦‚æœä¸éœ€è¦æ•è·<code>Attribute</code>, é‚£ä¹ˆå°±ä¸å¿…æ·»åŠ ä»€ä¹ˆåˆ°<code>RelevantAttributesToCapture</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-ec"></a></p><h4 id="4-5-12-Gameplay-Effect-Execution-Calculation"><a href="#4-5-12-Gameplay-Effect-Execution-Calculation" class="headerlink" title="4.5.12 Gameplay Effect Execution Calculation"></a>4.5.12 Gameplay Effect Execution Calculation</h4><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/UGameplayEffectExecutionCalculat-/index.html">GameplayEffectExecutionCalculation</a>(ExecutionCalculation, Execution(ä½ ä¼šåœ¨æ’ä»¶ä»£ç é‡Œç»å¸¸çœ‹åˆ°è¿™ä¸ªè¯)æˆ–ExecCalc)æ˜¯<code>GameplayEffect</code>å¯¹<code>ASC</code>è¿›è¡Œä¿®æ”¹æœ€å¼ºæœ‰åŠ›çš„æ–¹å¼. åƒ<a href="#concepts-ge-mmc">ModifierMagnitudeCalculation</a>ä¸€æ ·, å®ƒä¹Ÿå¯ä»¥æ•è·<code>Attribute</code>å¹¶é€‰æ‹©æ€§åœ°ä¸ºå…¶åˆ›å»ºSnapshot, å’Œ<code>MMC</code>ä¸åŒçš„æ˜¯, å®ƒå¯ä»¥ä¿®æ”¹å¤šä¸ª<code>Attribute</code>å¹¶ä¸”åŸºæœ¬ä¸Šå¯ä»¥å¤„ç†ç¨‹åºå‘˜æƒ³è¦åšçš„ä»»ä½•äº‹. è¿™ç§å¼ºæœ‰åŠ›å’Œçµæ´»æ€§çš„è´Ÿé¢å°±æ˜¯å®ƒæ˜¯ä¸å¯<a href="#concepts-p">é¢„æµ‹</a>çš„ä¸”å¿…é¡»åœ¨C++ä¸­å®ç°.  </p><p><code>ExecutionCalculation</code>åªèƒ½ç”±<code>å³åˆ»(Instant)</code>å’Œ<code>å‘¨æœŸæ€§(Periodic)</code>GameplayEffectä½¿ç”¨, æ’ä»¶ä¸­æ‰€æœ‰å’Œâ€Executeâ€ç›¸å…³çš„ä¸€èˆ¬éƒ½å¼•ç”¨åˆ°è¿™ä¸¤ç§ç±»å‹çš„<code>GameplayEffect</code>.  </p><p>å½“<code>GameplayEffectSpec</code>åˆ›å»ºæ—¶, Snapshotä¼šæ•è·<code>Attribute</code>, è€Œå½“<code>GameplayEffectSpec</code>åº”ç”¨æ—¶, éSnapshotä¼šæ•è·<code>Attribute</code>. æ•è·<code>Attribute</code>ä¼šè‡ª<code>ASC</code>ç°æœ‰çš„<code>Modifier</code>é‡æ–°è®¡ç®—å®ƒä»¬çš„<code>CurrentValue</code>, è¯¥é‡æ–°è®¡ç®—<strong>ä¸ä¼š</strong>æ‰§è¡Œ<code>AbilitySet</code>ä¸­çš„<a href="#concepts-as-preattributechange">PreAttributeChange()</a>, å› æ­¤æ‰€æœ‰çš„é™åˆ¶æ“ä½œ(Clamp)å¿…é¡»åœ¨è¿™é‡Œé‡æ–°å¤„ç†.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">å¿«ç…§</th><th style="text-align:center">Sourceæˆ–Target</th><th style="text-align:center">åœ¨GameplayEffectSpecä¸­æ•è·</th></tr></thead><tbody><tr><td style="text-align:center">æ˜¯</td><td style="text-align:center">Source</td><td style="text-align:center">åˆ›å»º</td></tr><tr><td style="text-align:center">æ˜¯</td><td style="text-align:center">Target</td><td style="text-align:center">åº”ç”¨</td></tr><tr><td style="text-align:center">å¦</td><td style="text-align:center">Source</td><td style="text-align:center">åº”ç”¨</td></tr><tr><td style="text-align:center">å¦</td><td style="text-align:center">Target</td><td style="text-align:center">åº”ç”¨</td></tr></tbody></table></div><p>ä¸ºäº†è®¾ç½®<code>Attribute</code>æ•è·, æˆ‘ä»¬é‡‡ç”¨Epicçš„ActionRPGæ ·ä¾‹é¡¹ç›®ä½¿ç”¨çš„æ–¹å¼, å®šä¹‰ä¸€ä¸ªä¿å­˜å’Œå£°æ˜å¦‚ä½•æ•è·<code>Attribute</code>çš„ç»“æ„ä½“, å¹¶åœ¨è¯¥ç»“æ„ä½“çš„æ„é€ å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ªå®ƒçš„å‰¯æœ¬(Copy). æ¯ä¸ª<code>ExecCalc</code>éƒ½éœ€è¦æœ‰ä¸€ä¸ªè¿™æ ·çš„ç»“æ„ä½“. <strong>Note</strong>: æ¯ä¸ªç»“æ„ä½“éœ€è¦ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„åå­—, å› ä¸ºå®ƒä»¬å…±äº«åŒä¸€ä¸ªå‘½åç©ºé—´, å¤šä¸ªç»“æ„ä½“ä½¿ç”¨ç›¸åŒåå­—åœ¨æ•è·<code>Attribute</code>æ—¶ä¼šé€ æˆé”™è¯¯(å¤§å¤šæ˜¯æ•è·åˆ°é”™è¯¯çš„<code>Attribute</code>å€¼).  </p><p>å¯¹äº<code>Local Predicted</code>, <code>Server Only</code>å’Œ<code>Server Initiated</code>çš„<a href="#concepts-ga">GameplayAbility</a>, <code>ExecCalc</code>åªåœ¨æœåŠ¡ç«¯è°ƒç”¨.  </p><p><code>ExecCalc</code>æœ€æ™®éçš„åº”ç”¨åœºæ™¯æ˜¯è®¡ç®—ä¸€ä¸ªæ¥è‡ªå¾ˆå¤š<code>æº(Source)</code>å’Œ<code>ç›®æ ‡(Target)</code>ä¸­<code>Attribute</code>ä¼¤å®³å€¼çš„å¤æ‚å…¬å¼. æ ·ä¾‹é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªç®€å•çš„<code>ExecCalc</code>ç”¨äºè®¡ç®—ä¼¤å®³å€¼, å…¶ä»<code>GameplayEffectSpec</code>çš„<a href="#concepts-ge-spec-setbycaller">SetByCaller</a>ä¸­è¯»å–ä¼¤å®³å€¼, ä¹‹ååŸºäºä»<code>ç›®æ ‡(Target)</code>æ•è·çš„æŠ¤ç›¾<code>Attribute</code>æ¥å‡å°‘è¯¥ä¼¤å®³å€¼. å‚é˜…<code>GDDamageExecCalculation.cpp/.h</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-ec-senddata"></a></p><h5 id="4-5-12-1-å‘é€æ•°æ®åˆ°Execution-Calculation"><a href="#4-5-12-1-å‘é€æ•°æ®åˆ°Execution-Calculation" class="headerlink" title="4.5.12.1 å‘é€æ•°æ®åˆ°Execution Calculation"></a>4.5.12.1 å‘é€æ•°æ®åˆ°Execution Calculation</h5><p>é™¤äº†æ•è·<code>Attribute</code>, è¿˜æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å‘é€æ•°æ®åˆ°<code>ExecutionCalculation</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-ec-senddata-setbycaller"></a></p><h6 id="4-5-12-1-1-SetByCaller"><a href="#4-5-12-1-1-SetByCaller" class="headerlink" title="4.5.12.1.1 SetByCaller"></a>4.5.12.1.1 SetByCaller</h6><p>ä»»ä½•<a href="#concepts-ge-spec-setbycaller">è®¾ç½®åœ¨<code>GameplayEffectSpec</code>ä¸­çš„<code>SetByCaller</code></a>éƒ½å¯ä»¥ç›´æ¥åœ¨<code>ExecutionCalculation</code>ä¸­è¯»å–.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> FGameplayEffectSpec&amp; Spec = ExecutionParams.<span class="built_in">GetOwningSpec</span>();</span><br><span class="line"><span class="type">float</span> Damage = FMath::<span class="built_in">Max</span>&lt;<span class="type">float</span>&gt;(Spec.<span class="built_in">GetSetByCallerMagnitude</span>(FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="built_in">FName</span>(<span class="string">&quot;Data.Damage&quot;</span>)), <span class="literal">false</span>, <span class="number">-1.0f</span>), <span class="number">0.0f</span>);</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-ec-senddata-backingdataattribute"></a></p><h6 id="4-5-12-1-2-Backingæ•°æ®Attributeè®¡ç®—Modifier"><a href="#4-5-12-1-2-Backingæ•°æ®Attributeè®¡ç®—Modifier" class="headerlink" title="4.5.12.1.2 Backingæ•°æ®Attributeè®¡ç®—Modifier"></a>4.5.12.1.2 Backingæ•°æ®Attributeè®¡ç®—Modifier</h6><p>å¦‚æœä½ æƒ³ç¡¬ç¼–ç å€¼åˆ°<code>GameplayEffect</code>, å¯ä»¥ä½¿ç”¨<code>CalculationModifier</code>ä¼ é€’, å…¶ä½¿ç”¨æ•è·çš„<code>Attribute</code>ä¹‹ä¸€ä½œä¸ºBackingæ•°æ®.  </p><p>åœ¨è¿™ä¸ªæˆªå›¾ä¾‹å­ä¸­, æˆ‘ä»¬ç»™æ•è·çš„ä¼¤å®³å€¼<code>Attribute</code>å¢åŠ äº†50, ä½ ä¹Ÿå¯ä»¥å°†å…¶è®¾ä¸º<code>Override</code>æ¥ç›´æ¥ä¼ å…¥ç¡¬ç¼–ç å€¼.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/calculationmodifierbackingdataattribute.png" alt="Backing Data Attribute Calculation Modifier"></p><p>å½“<code>ExecutionCalculation</code>æ•è·è¯¥<code>Attribute</code>æ—¶ä¼šè¯»å–è¿™ä¸ªå€¼.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> Damage = <span class="number">0.0f</span>;</span><br><span class="line"><span class="comment">// Capture optional damage value set on the damage GE as a CalculationModifier under the ExecutionCalculation</span></span><br><span class="line">ExecutionParams.<span class="built_in">AttemptCalculateCapturedAttributeMagnitude</span>(<span class="built_in">DamageStatics</span>().DamageDef, EvaluationParameters, Damage);</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-ec-senddata-backingdatatempvariable"></a></p><h6 id="4-5-12-1-3-Backingæ•°æ®ä¸´æ—¶å˜é‡è®¡ç®—Modifier"><a href="#4-5-12-1-3-Backingæ•°æ®ä¸´æ—¶å˜é‡è®¡ç®—Modifier" class="headerlink" title="4.5.12.1.3 Backingæ•°æ®ä¸´æ—¶å˜é‡è®¡ç®—Modifier"></a>4.5.12.1.3 Backingæ•°æ®ä¸´æ—¶å˜é‡è®¡ç®—Modifier</h6><p>å¦‚æœä½ æƒ³ç¡¬ç¼–ç å€¼åˆ°<code>GameplayEffect</code>, å¯ä»¥åœ¨C++ä¸­ä½¿ç”¨<code>CalculationModifier</code>ä¼ é€’, å…¶ä½¿ç”¨ä¸€ä¸ª<code>ä¸´æ—¶å˜é‡</code>æˆ–<code>æš‚æ—¶èšåˆå™¨(Transient Aggregator)</code>, è¯¥<code>ä¸´æ—¶å˜é‡</code>ä¸<code>GameplayTag</code>ç›¸å…³è”.  </p><p>åœ¨è¿™ä¸ªæˆªå›¾ä¾‹å­ä¸­, æˆ‘ä»¬ä½¿ç”¨<code>Data.Damage GameplayTag</code>å¢åŠ 50åˆ°ä¸€ä¸ªä¸´æ—¶å˜é‡.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/calculationmodifierbackingdatatempvariable.png" alt="Backing Data Temporary Variable Calculation Modifier"></p><p>æ·»åŠ Backingä¸´æ—¶å˜é‡åˆ°ä½ çš„<code>ExecutionCalculation</code>æ„é€ å‡½æ•°:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ValidTransientAggregatorIdentifiers.<span class="built_in">AddTag</span>(FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="string">&quot;Data.Damage&quot;</span>));</span><br></pre></td></tr></table></figure><p><code>ExecutionCalculation</code>ä¼šä½¿ç”¨å’Œ<code>Attribute</code>æ•è·å‡½æ•°ç›¸ä¼¼çš„ç‰¹æ®Šæ•è·å‡½æ•°æ¥è¯»å–è¿™ä¸ªå€¼.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> Damage = <span class="number">0.0f</span>;</span><br><span class="line">ExecutionParams.<span class="built_in">AttemptCalculateTransientAggregatorMagnitude</span>(FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="string">&quot;Data.Damage&quot;</span>), EvaluationParameters, Damage);</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-ec-senddata-effectcontext"></a></p><h6 id="4-5-12-1-4-GameplayEffectContext"><a href="#4-5-12-1-4-GameplayEffectContext" class="headerlink" title="4.5.12.1.4 GameplayEffectContext"></a>4.5.12.1.4 GameplayEffectContext</h6><p>ä½ å¯ä»¥é€šè¿‡<a href="#concepts-ge-context"><code>GameplayEffectSpec</code>ä¸­çš„è‡ªå®šä¹‰<code>GameplayEffectContext</code></a>å‘é€æ•°æ®åˆ°<code>ExecutionCalculation</code>.  </p><p>åœ¨<code>ExecutionCalculation</code>ä¸­, ä½ å¯ä»¥è‡ª<code>FGameplayEffectCustomExecutionParameters</code>è®¿é—®<code>EffectContext</code>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> FGameplayEffectSpec&amp; Spec = ExecutionParams.<span class="built_in">GetOwningSpec</span>();</span><br><span class="line">FGSGameplayEffectContext* ContextHandle = <span class="built_in">static_cast</span>&lt;FGSGameplayEffectContext*&gt;(Spec.<span class="built_in">GetContext</span>().<span class="built_in">Get</span>());</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ éœ€è¦ä¿®æ”¹<code>GameplayEffectSpec</code>ä¸­çš„ä»€ä¹ˆæˆ–è€…<code>EffectContext</code>:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FGameplayEffectSpec* MutableSpec = ExecutionParams.<span class="built_in">GetOwningSpecForPreExecuteMod</span>();</span><br><span class="line">FGSGameplayEffectContext* ContextHandle = <span class="built_in">static_cast</span>&lt;FGSGameplayEffectContext*&gt;(MutableSpec-&gt;<span class="built_in">GetContext</span>().<span class="built_in">Get</span>());</span><br></pre></td></tr></table></figure><p>åœ¨<code>ExecutionCalculation</code>ä¸­ä¿®æ”¹<code>GameplayEffectSpec</code>æ—¶è¦å°å¿ƒ. å‚çœ‹<code>GetOwningSpecForPreExecuteMod()</code>çš„æ³¨é‡Š.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Non const access. Be careful with this, especially when modifying a spec after attribute capture. */</span></span><br><span class="line"><span class="function">FGameplayEffectSpec* <span class="title">GetOwningSpecForPreExecuteMod</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-car"></a></p><h4 id="4-5-13-è‡ªå®šä¹‰åº”ç”¨éœ€æ±‚"><a href="#4-5-13-è‡ªå®šä¹‰åº”ç”¨éœ€æ±‚" class="headerlink" title="4.5.13 è‡ªå®šä¹‰åº”ç”¨éœ€æ±‚"></a>4.5.13 è‡ªå®šä¹‰åº”ç”¨éœ€æ±‚</h4><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/UGameplayEffectCustomApplication-/index.html">CustomApplicationRequirement(CAR)</a>ç±»ä¸ºè®¾è®¡å¸ˆæä¾›å¯¹äº<code>GameplayEffect</code>æ˜¯å¦å¯ä»¥åº”ç”¨çš„é«˜é˜¶æ§åˆ¶, è€Œä¸æ˜¯å¯¹<code>GameplayEffect</code>è¿›è¡Œç®€å•çš„<code>GameplayTag</code>æ£€æŸ¥. è¿™å¯ä»¥é€šè¿‡åœ¨è“å›¾ä¸­é‡å†™<code>CanApplyGameplayEffect()</code>å’Œåœ¨C++ä¸­é‡å†™<code>CanApplyGameplayEffect_Implementation()</code>å®ç°.  </p><p><code>CAR</code>çš„åº”ç”¨åœºæ™¯:  </p><ul><li>ç›®æ ‡éœ€è¦æœ‰ä¸€å®šæ•°é‡çš„<code>Attribute</code>.</li><li>ç›®æ ‡éœ€è¦æœ‰ä¸€å®šæ•°é‡çš„<code>GameplayEffect</code>å †æ ˆ.</li></ul><p><code>CAR</code>è¿˜æœ‰å¾ˆå¤šé«˜é˜¶åŠŸèƒ½, åƒæ£€æŸ¥<code>GameplayEffect</code>å®ä¾‹æ˜¯å¦å·²ç»ä½äºç›®æ ‡ä¸Š, ä¿®æ”¹å½“å‰å®ä¾‹çš„<a href="#concepts-ge-duration">æŒç»­æ—¶é—´</a>è€Œä¸æ˜¯åº”ç”¨ä¸€ä¸ªæ–°å®ä¾‹(å¯¹äº<code>CanApplyGameplayEffect()</code>è¿”å›false).</p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-cost"></a></p><h4 id="4-5-14-èŠ±è´¹-Cost-GameplayEffect"><a href="#4-5-14-èŠ±è´¹-Cost-GameplayEffect" class="headerlink" title="4.5.14 èŠ±è´¹(Cost)GameplayEffect"></a>4.5.14 èŠ±è´¹(Cost)GameplayEffect</h4><p><a href="#concepts-ga">GameplayAbility</a>æœ‰ä¸€ä¸ªç‰¹åˆ«è®¾è®¡ç”¨æ¥ä½œä¸ºAbilityèŠ±è´¹(Cost)çš„å¯é€‰<code>GameplayEffect</code>. èŠ±è´¹(Cost)æ˜¯æŒ‡<code>ASC</code>æ¿€æ´»<code>GameplayAbility</code>æ‰€å¿…éœ€çš„<code>Attribute</code>é‡. å¦‚æœæŸä¸ª<code>GA</code>ä¸èƒ½æä¾›<code>Cost GE</code>, é‚£ä¹ˆå®ƒå°±ä¸èƒ½è¢«æ¿€æ´». è¯¥<code>Cost GE</code>åº”è¯¥æ˜¯æŸä¸ªå¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè‡ª<code>Attribute</code>ä¸­å‡å€¼Modifierçš„<code>å³åˆ»(Instant)GameplayEffect</code>. é»˜è®¤æƒ…å†µä¸‹, <code>Cost GE</code>æ˜¯å¯ä»¥è¢«é¢„æµ‹çš„, å»ºè®®ä¿ç•™è¯¥åŠŸèƒ½, ä¹Ÿå°±æ˜¯ä¸è¦ä½¿ç”¨<code>ExecutionCalculations</code>, <code>MMC</code>å¯¹äºå¤æ‚çš„èŠ±è´¹è®¡ç®—æ˜¯å®Œç¾é€‚é…å¹¶ä¸”é¼“åŠ±ä½¿ç”¨çš„.  </p><p>å¼€å§‹çš„æ—¶å€™, ä½ é€šå¸¸ä¼šä¸ºæ¯ä¸ªæœ‰èŠ±è´¹çš„<code>GA</code>éƒ½è®¾ç½®ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„<code>Cost GE</code>, ä¸€ä¸ªæ›´é«˜é˜¶çš„æŠ€å·§æ˜¯å¯¹å¤šä¸ª<code>GA</code>å¤ç”¨ä¸€ä¸ª<code>Cost GE</code>, åªéœ€ä¿®æ”¹è‡ª<code>GA</code>çš„<code>Cost GE</code>åˆ›å»ºçš„<code>GameplayEffectSpec</code>ä¸­æŒ‡å®šçš„æ•°æ®(èŠ±è´¹å€¼æ˜¯åœ¨<code>GA</code>ä¸Šå®šä¹‰çš„), <strong>è¿™åªä½œç”¨äº<code>å®ä¾‹åŒ–(Instanced)</code>çš„Ability.</strong>  </p><p>å¤ç”¨<code>Cost GE</code>çš„ä¸¤ç§æŠ€å·§:  </p><ol><li>ä½¿ç”¨<code>MMC</code>. è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼. åˆ›å»ºä¸€ä¸ªä»<code>GameplayAbility</code>å®ä¾‹è¯»å–èŠ±è´¹å€¼çš„<a href="#concepts-ge-mmc">MMC</a>, ä½ å¯ä»¥ä»<code>GameplayEffectSpec</code>ä¸­è·å–åˆ°è¯¥å®ä¾‹.  </li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">UPGMMC_HeroAbilityCost::CalculateBaseMagnitude_Implementation</span><span class="params">(<span class="type">const</span> FGameplayEffectSpec &amp; Spec)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">const</span> UPGGameplayAbility* Ability = <span class="built_in">Cast</span>&lt;UPGGameplayAbility&gt;(Spec.<span class="built_in">GetContext</span>().<span class="built_in">GetAbilityInstance_NotReplicated</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!Ability)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0.0f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Ability-&gt;Cost.<span class="built_in">GetValueAtLevel</span>(Ability-&gt;<span class="built_in">GetAbilityLevel</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­, èŠ±è´¹å€¼æ˜¯ä¸€ä¸ªæˆ‘æ·»åŠ åˆ°<code>GameplayAbility</code>å­ç±»ä¸Šçš„<code>FScalableFloat</code>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(BlueprintReadOnly, EditAnywhere, Category = <span class="string">&quot;Cost&quot;</span>)</span><br><span class="line">FScalableFloat Cost;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/costmmc.png" alt="Cost GE With MMC"></p><ol><li><strong>é‡å†™<code>UGameplayAbility::GetCostGameplayEffect()</code>.</strong> é‡å†™è¯¥å‡½æ•°å¹¶åœ¨<a href="#concepts-ge-dynamic">è¿è¡Œæ—¶</a>åˆ›å»ºä¸€ä¸ªç”¨æ¥è¯»å–<code>GameplayAbility</code>ä¸­èŠ±è´¹å€¼çš„<code>GameplayEffect</code>.  </li></ol><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-cooldown"></a></p><h4 id="4-5-15-å†·å´-Cooldown-GameplayEffect"><a href="#4-5-15-å†·å´-Cooldown-GameplayEffect" class="headerlink" title="4.5.15 å†·å´(Cooldown)GameplayEffect"></a>4.5.15 å†·å´(Cooldown)GameplayEffect</h4><p><a href="#concepts-ga">GameplayAbility</a>æœ‰ä¸€ä¸ªç‰¹åˆ«è®¾è®¡ç”¨æ¥ä½œä¸ºAbilityå†·å´(Cooldown)çš„å¯é€‰<code>GameplayEffect</code>. å†·å´æ—¶é—´å†³å®šäº†æ¿€æ´»Abilityä¹‹åå¤šä¹…å¯ä»¥å†æ¬¡æ¿€æ´». å¦‚æœæŸä¸ª<code>GA</code>åœ¨å†·å´ä¸­, é‚£ä¹ˆå®ƒå°±ä¸èƒ½è¢«æ¿€æ´». è¯¥<code>Cooldown GE</code>åº”è¯¥æ˜¯ä¸€ä¸ªä¸å¸¦æœ‰<code>Modifier</code>çš„<code>æŒç»­(Duration)GameplayEffect</code>, å¹¶ä¸”åœ¨<code>GameplayEffect</code>çš„<code>GrantedTags</code>ä¸­æ¯ä¸ª<code>GameplayAbility</code>æˆ–Abilityæ’æ§½(Slot)(å¦‚æœä½ çš„æ¸¸æˆæœ‰åˆ†é…åˆ°æ’æ§½çš„å¯äº¤æ¢Abilityä¸”å…±äº«åŒä¸€ä¸ªå†·å´)éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„<code>GameplayTag</code>(<code>Cooldown Tag</code>). <code>GA</code>å®é™…ä¸Šä¼šæ£€æŸ¥<code>Cooldown Tag</code>çš„å­˜åœ¨è€Œä¸æ˜¯<code>Cooldown GE</code>çš„å­˜åœ¨, é»˜è®¤æƒ…å†µä¸‹, <code>Cooldown GE</code>æ˜¯å¯ä»¥è¢«é¢„æµ‹çš„, å»ºè®®ä¿ç•™è¯¥åŠŸèƒ½, ä¹Ÿå°±æ˜¯ä¸è¦ä½¿ç”¨<code>ExecutionCalculations</code>, <code>MMC</code>å¯¹äºå¤æ‚çš„å†·å´è®¡ç®—æ˜¯å®Œç¾é€‚é…å¹¶ä¸”é¼“åŠ±ä½¿ç”¨çš„.  </p><p>å¼€å§‹çš„æ—¶å€™, ä½ é€šå¸¸ä¼šä¸ºæ¯ä¸ªæœ‰å†·å´çš„<code>GA</code>éƒ½è®¾ç½®ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„<code>Cooldown GE</code>, ä¸€ä¸ªæ›´é«˜é˜¶çš„æŠ€å·§æ˜¯å¯¹å¤šä¸ª<code>GA</code>å¤ç”¨ä¸€ä¸ª<code>Cooldown GE</code>, åªéœ€ä¿®æ”¹è‡ª<code>GA</code>çš„<code>Cooldown GE</code>åˆ›å»ºçš„<code>GameplayEffectSpec</code>ä¸­æŒ‡å®šçš„æ•°æ®(å†·å´æ—¶é—´å’Œ<code>Cooldown Tag</code>æ˜¯åœ¨<code>GA</code>ä¸Šå®šä¹‰çš„), <strong>è¿™åªä½œç”¨äº<code>å®ä¾‹åŒ–(Instanced)</code>çš„Ability.</strong>  </p><p>å¤ç”¨<code>Cooldown GE</code>çš„ä¸¤ç§æŠ€å·§:  </p><ol><li>ä½¿ç”¨<a href="#concepts-ge-spec-setbycaller">SetByCaller</a>. è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼. ä½¿ç”¨<code>GameplayTag</code>è®¾ç½®<code>SetByCaller</code>ä¸ºå…±äº«<code>Cooldown GE</code>çš„æŒç»­æ—¶é—´. åœ¨<code>GameplayAbility</code>å­ç±»ä¸­, ä¸ºæŒç»­æ—¶é—´å®šä¹‰ä¸€ä¸ªæµ®ç‚¹/<code>FScalableFloat</code>å˜é‡, ä¸ºç‹¬ä¸€æ— äºŒçš„<code>Cooldown Tag</code>å®šä¹‰ä¸€ä¸ª<code>FGameplayTagContainer</code>, é™¤æ­¤ä¹‹å¤–è¿˜è¦å®šä¹‰ä¸€ä¸ªä¸´æ—¶<code>FGameplayTagContainer</code>, å…¶ç”¨æ¥ä½œä¸º<code>Cooldown Tag</code>ä¸<code>Cooldown GE</code>æ ‡ç­¾å¹¶é›†çš„è¿”å›æŒ‡é’ˆ.  </li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(BlueprintReadOnly, EditAnywhere, Category = <span class="string">&quot;Cooldown&quot;</span>)</span><br><span class="line">FScalableFloat CooldownDuration;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UPROPERTY</span>(BlueprintReadOnly, EditAnywhere, Category = <span class="string">&quot;Cooldown&quot;</span>)</span><br><span class="line">FGameplayTagContainer CooldownTags;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Temp container that we will return the pointer to in GetCooldownTags().</span></span><br><span class="line"><span class="comment">// This will be a union of our CooldownTags and the Cooldown GE&#x27;s cooldown tags.</span></span><br><span class="line"><span class="built_in">UPROPERTY</span>()</span><br><span class="line">FGameplayTagContainer TempCooldownTags;</span><br></pre></td></tr></table></figure><p>ä¹‹åé‡å†™<code>UGameplayAbility::GetCooldownTags()</code>ä»¥è¿”å›<code>Cooldown Tag</code>å’Œæ‰€æœ‰ç°æœ‰<code>Cooldown GE</code>æ ‡ç­¾çš„å¹¶é›†.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">const</span> FGameplayTagContainer * <span class="title">UPGGameplayAbility::GetCooldownTags</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FGameplayTagContainer* MutableTags = <span class="built_in">const_cast</span>&lt;FGameplayTagContainer*&gt;(&amp;TempCooldownTags);</span><br><span class="line"><span class="type">const</span> FGameplayTagContainer* ParentTags = Super::<span class="built_in">GetCooldownTags</span>();</span><br><span class="line"><span class="keyword">if</span> (ParentTags)</span><br><span class="line">&#123;</span><br><span class="line">MutableTags-&gt;<span class="built_in">AppendTags</span>(*ParentTags);</span><br><span class="line">&#125;</span><br><span class="line">MutableTags-&gt;<span class="built_in">AppendTags</span>(CooldownTags);</span><br><span class="line"><span class="keyword">return</span> MutableTags;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€å, é‡å†™<code>UGameplayAbility::ApplyCooldown()</code>ä»¥æ³¨å…¥æˆ‘ä»¬è‡ªå·±çš„<code>Cooldown Tag</code>, å¹¶å°†<code>SetByCaller</code>æ·»åŠ åˆ°<code>Cooldown GameplayEffectSpec</code>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UPGGameplayAbility::ApplyCooldown</span><span class="params">(<span class="type">const</span> FGameplayAbilitySpecHandle Handle, <span class="type">const</span> FGameplayAbilityActorInfo * ActorInfo, <span class="type">const</span> FGameplayAbilityActivationInfo ActivationInfo)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">UGameplayEffect* CooldownGE = <span class="built_in">GetCooldownGameplayEffect</span>();</span><br><span class="line"><span class="keyword">if</span> (CooldownGE)</span><br><span class="line">&#123;</span><br><span class="line">FGameplayEffectSpecHandle SpecHandle = <span class="built_in">MakeOutgoingGameplayEffectSpec</span>(CooldownGE-&gt;<span class="built_in">GetClass</span>(), <span class="built_in">GetAbilityLevel</span>());</span><br><span class="line">SpecHandle.Data.<span class="built_in">Get</span>()-&gt;DynamicGrantedTags.<span class="built_in">AppendTags</span>(CooldownTags);</span><br><span class="line">SpecHandle.Data.<span class="built_in">Get</span>()-&gt;<span class="built_in">SetSetByCallerMagnitude</span>(FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="built_in">FName</span>(  OurSetByCallerTag  )), CooldownDuration.<span class="built_in">GetValueAtLevel</span>(<span class="built_in">GetAbilityLevel</span>()));</span><br><span class="line"><span class="built_in">ApplyGameplayEffectSpecToOwner</span>(Handle, ActorInfo, ActivationInfo, SpecHandle);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å›¾ç‰‡ä¸­, å†·å´æ—¶é—´<code>Modifier</code>è¢«è®¾ç½®ä¸º<code>SetByCaller</code>, å…¶<code>Data Tag</code>ä¸º<code>Data.Cooldown</code>. <code>Data.Cooldown</code>å°±æ˜¯ä¸Šé¢ä»£ç ä¸­çš„<code>OurSetByCallerTag</code>.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/cooldownsbc.png" alt="Cooldown GE with SetByCaller">  </p><ol><li>ä½¿ç”¨<a href="#concepts-ge-mmc">MMC</a>. å®ƒçš„è®¾ç½®ä¸ä¸Šæ–‡æ‰€æçš„ä¸€è‡´, é™¤äº†ä¸éœ€è¦åœ¨<code>Cooldown GE</code>å’Œ<code>ApplyCost</code>ä¸­è®¾ç½®<code>SetByCaller</code>ä½œä¸ºæŒç»­æ—¶é—´, ç›¸å, æˆ‘ä»¬éœ€è¦å°†æŒç»­æ—¶é—´è®¾ç½®ä¸º<code>Custom Calculationç±»</code>å¹¶å°†å…¶æŒ‡å‘æ–°åˆ›å»ºçš„<code>MMC</code>.  </li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(BlueprintReadOnly, EditAnywhere, Category = <span class="string">&quot;Cooldown&quot;</span>)</span><br><span class="line">FScalableFloat CooldownDuration;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UPROPERTY</span>(BlueprintReadOnly, EditAnywhere, Category = <span class="string">&quot;Cooldown&quot;</span>)</span><br><span class="line">FGameplayTagContainer CooldownTags;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Temp container that we will return the pointer to in GetCooldownTags().</span></span><br><span class="line"><span class="comment">// This will be a union of our CooldownTags and the Cooldown GE&#x27;s cooldown tags.</span></span><br><span class="line"><span class="built_in">UPROPERTY</span>()</span><br><span class="line">FGameplayTagContainer TempCooldownTags;</span><br></pre></td></tr></table></figure><p>ä¹‹åé‡å†™<code>UGameplayAbility::GetCooldownTags()</code>ä»¥è¿”å›<code>Cooldown Tag</code>å’Œæ‰€æœ‰ç°æœ‰<code>Cooldown GE</code>æ ‡ç­¾çš„å¹¶é›†.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">const</span> FGameplayTagContainer * <span class="title">UPGGameplayAbility::GetCooldownTags</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FGameplayTagContainer* MutableTags = <span class="built_in">const_cast</span>&lt;FGameplayTagContainer*&gt;(&amp;TempCooldownTags);</span><br><span class="line"><span class="type">const</span> FGameplayTagContainer* ParentTags = Super::<span class="built_in">GetCooldownTags</span>();</span><br><span class="line"><span class="keyword">if</span> (ParentTags)</span><br><span class="line">&#123;</span><br><span class="line">MutableTags-&gt;<span class="built_in">AppendTags</span>(*ParentTags);</span><br><span class="line">&#125;</span><br><span class="line">MutableTags-&gt;<span class="built_in">AppendTags</span>(CooldownTags);</span><br><span class="line"><span class="keyword">return</span> MutableTags;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€å, é‡å†™<code>UGameplayAbility::ApplyCooldown()</code>ä»¥å°†æˆ‘ä»¬çš„<code>Cooldown Tag</code>æ³¨å…¥<code>Cooldown GameplayEffectSpec</code>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UPGGameplayAbility::ApplyCooldown</span><span class="params">(<span class="type">const</span> FGameplayAbilitySpecHandle Handle, <span class="type">const</span> FGameplayAbilityActorInfo * ActorInfo, <span class="type">const</span> FGameplayAbilityActivationInfo ActivationInfo)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">UGameplayEffect* CooldownGE = <span class="built_in">GetCooldownGameplayEffect</span>();</span><br><span class="line"><span class="keyword">if</span> (CooldownGE)</span><br><span class="line">&#123;</span><br><span class="line">FGameplayEffectSpecHandle SpecHandle = <span class="built_in">MakeOutgoingGameplayEffectSpec</span>(CooldownGE-&gt;<span class="built_in">GetClass</span>(), <span class="built_in">GetAbilityLevel</span>());</span><br><span class="line">SpecHandle.Data.<span class="built_in">Get</span>()-&gt;DynamicGrantedTags.<span class="built_in">AppendTags</span>(CooldownTags);</span><br><span class="line"><span class="built_in">ApplyGameplayEffectSpecToOwner</span>(Handle, ActorInfo, ActivationInfo, SpecHandle);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">UPGMMC_HeroAbilityCooldown::CalculateBaseMagnitude_Implementation</span><span class="params">(<span class="type">const</span> FGameplayEffectSpec &amp; Spec)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">const</span> UPGGameplayAbility* Ability = <span class="built_in">Cast</span>&lt;UPGGameplayAbility&gt;(Spec.<span class="built_in">GetContext</span>().<span class="built_in">GetAbilityInstance_NotReplicated</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!Ability)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0.0f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Ability-&gt;CooldownDuration.<span class="built_in">GetValueAtLevel</span>(Ability-&gt;<span class="built_in">GetAbilityLevel</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/cooldownmmc.png" alt="Cooldown GE with MMC">  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-cooldown-tr"></a></p><h5 id="4-5-15-1-è·å–Cooldown-GameplayEffectçš„å‰©ä½™æ—¶é—´"><a href="#4-5-15-1-è·å–Cooldown-GameplayEffectçš„å‰©ä½™æ—¶é—´" class="headerlink" title="4.5.15.1 è·å–Cooldown GameplayEffectçš„å‰©ä½™æ—¶é—´"></a>4.5.15.1 è·å–Cooldown GameplayEffectçš„å‰©ä½™æ—¶é—´</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">APGPlayerState::GetCooldownRemainingForTag</span><span class="params">(FGameplayTagContainer CooldownTags, <span class="type">float</span> &amp; TimeRemaining, <span class="type">float</span> &amp; CooldownDuration)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (AbilitySystemComponent &amp;&amp; CooldownTags.<span class="built_in">Num</span>() &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">TimeRemaining = <span class="number">0.f</span>;</span><br><span class="line">CooldownDuration = <span class="number">0.f</span>;</span><br><span class="line"></span><br><span class="line">FGameplayEffectQuery <span class="type">const</span> Query = FGameplayEffectQuery::<span class="built_in">MakeQuery_MatchAnyOwningTags</span>(CooldownTags);</span><br><span class="line">TArray&lt; TPair&lt;<span class="type">float</span>, <span class="type">float</span>&gt; &gt; DurationAndTimeRemaining = AbilitySystemComponent-&gt;<span class="built_in">GetActiveEffectsTimeRemainingAndDuration</span>(Query);</span><br><span class="line"><span class="keyword">if</span> (DurationAndTimeRemaining.<span class="built_in">Num</span>() &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">int32 BestIdx = <span class="number">0</span>;</span><br><span class="line"><span class="type">float</span> LongestTime = DurationAndTimeRemaining[<span class="number">0</span>].Key;</span><br><span class="line"><span class="keyword">for</span> (int32 Idx = <span class="number">1</span>; Idx &lt; DurationAndTimeRemaining.<span class="built_in">Num</span>(); ++Idx)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (DurationAndTimeRemaining[Idx].Key &gt; LongestTime)</span><br><span class="line">&#123;</span><br><span class="line">LongestTime = DurationAndTimeRemaining[Idx].Key;</span><br><span class="line">BestIdx = Idx;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">TimeRemaining = DurationAndTimeRemaining[BestIdx].Key;</span><br><span class="line">CooldownDuration = DurationAndTimeRemaining[BestIdx].Value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Note:</strong> åœ¨å®¢æˆ·ç«¯ä¸ŠæŸ¥è¯¢å‰©ä½™å†·å´æ—¶é—´è¦æ±‚å…¶å¯ä»¥æ¥æ”¶åŒæ­¥çš„<code>GameplayEffect</code>, è¿™ä¾èµ–äºå®ƒä»¬<code>ASC</code>çš„<a href="#concepts-asc-rm">åŒæ­¥æ¨¡å¼</a>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p> <a name="concepts-ge-cooldown-listen"></a></p><h5 id="4-5-15-2-ç›‘å¬å†·å´å¼€å§‹å’Œç»“æŸ"><a href="#4-5-15-2-ç›‘å¬å†·å´å¼€å§‹å’Œç»“æŸ" class="headerlink" title="4.5.15.2 ç›‘å¬å†·å´å¼€å§‹å’Œç»“æŸ"></a>4.5.15.2 ç›‘å¬å†·å´å¼€å§‹å’Œç»“æŸ</h5><p>ä¸ºäº†ç›‘å¬æŸä¸ªå†·å´ä½•æ—¶å¼€å§‹, ä½ å¯ä»¥é€šè¿‡ç»‘å®š<code>AbilitySystemComponent-&gt;OnActiveGameplayEffectAddedDelegateToSelf</code>æˆ–è€…<code>AbilitySystemComponent-&gt;RegisterGameplayTagEvent(CooldownTag, EGameplayTagEventType::NewOrRemoved)</code>åˆ†åˆ«åœ¨<code>Cooldown GE</code>åº”ç”¨å’Œ<code>Cooldown Tag</code>æ·»åŠ æ—¶ä½œå‡ºå“åº”. æˆ‘å»ºè®®ç›‘å¬<code>Cooldown GE</code>ä½•æ—¶åº”ç”¨, å› ä¸ºè¿™æ—¶è¿˜å¯ä»¥è®¿é—®åº”ç”¨å®ƒçš„<code>GameplayEffectSpec</code>. ç”±æ­¤ä½ å¯ä»¥ç¡®å®šå½“å‰<code>Cooldown GE</code>æ˜¯å®¢æˆ·ç«¯é¢„æµ‹çš„è¿˜æ˜¯ç”±æœåŠ¡ç«¯æ ¡æ­£çš„.  </p><p>ä¸ºäº†ç›‘å¬æŸä¸ªå†·å´ä½•æ—¶ç»“æŸ, ä½ å¯ä»¥é€šè¿‡ç»‘å®š<code>AbilitySystemComponent-&gt;OnAnyGameplayEffectRemovedDelegate()</code>æˆ–è€…<code>AbilitySystemComponent-&gt;RegisterGameplayTagEvent(CooldownTag, EGameplayTagEventType::NewOrRemoved)</code>åˆ†åˆ«åœ¨<code>Cooldown GE</code>ç§»é™¤å’Œ<code>Cooldown Tag</code>ç§»é™¤æ—¶ä½œå‡ºå“åº”. æˆ‘å»ºè®®ç›‘å¬<code>Cooldown Tag</code>ä½•æ—¶ç§»é™¤, å› ä¸ºå½“æœåŠ¡ç«¯æ ¡æ­£çš„<code>Cooldown GE</code>åˆ°æ¥æ—¶, ä¼šç§»é™¤å®¢æˆ·ç«¯é¢„æµ‹çš„<code>Cooldown GE</code>, è¿™ä¼šå“åº”<code>OnAnyGameplayEffectRemovedDelegate()</code>, å³ä½¿ä»å¤„äºå†·å´è¿‡ç¨‹ä¸­. é¢„æµ‹çš„<code>Cooldown GE</code>åœ¨ç§»é™¤æ—¶å’ŒæœåŠ¡ç«¯æ ¡æ­£çš„<code>Cooldown GE</code>åœ¨åº”ç”¨æ—¶<code>Cooldown Tag</code>éƒ½ä¸ä¼šæ”¹å˜.  </p><p><strong>Note:</strong> åœ¨å®¢æˆ·ç«¯ä¸Šç›‘å¬æŸä¸ª<code>GameplayEffect</code>æ·»åŠ æˆ–ç§»é™¤è¦æ±‚å…¶å¯ä»¥æ¥æ”¶åŒæ­¥çš„<code>GameplayEffect</code>, è¿™ä¾èµ–äºå®ƒä»¬<code>ASC</code>çš„<a href="#concepts-asc-rm">åŒæ­¥æ¨¡å¼</a>.  </p><p>æ ·ä¾‹é¡¹ç›®åŒ…å«ä¸€ä¸ªç”¨äºç›‘å¬å†·å´å¼€å§‹å’Œç»“æŸçš„è‡ªå®šä¹‰è“å›¾èŠ‚ç‚¹, HUD UMG Widgetä½¿ç”¨å®ƒæ¥æ›´æ–°é™¨çŸ³æŠ€èƒ½çš„å‰©ä½™å†·å´æ—¶é—´, è¯¥<code>AsyncTask</code>ä¼šä¸€ç›´å“åº”ç›´åˆ°æ‰‹åŠ¨è°ƒç”¨<code>EndTask()</code>, å°±åƒåœ¨UMG Widgetçš„<code>Destruct</code>äº‹ä»¶ä¸­è°ƒç”¨é‚£æ ·. å‚é˜…<code>AsyncTaskAttributeChanged.h/cpp</code>.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/cooldownchange.png" alt="Listen for Cooldown Change BP Node">  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-cooldown-prediction"></a></p><h5 id="4-5-15-3-é¢„æµ‹å†·å´æ—¶é—´"><a href="#4-5-15-3-é¢„æµ‹å†·å´æ—¶é—´" class="headerlink" title="4.5.15.3 é¢„æµ‹å†·å´æ—¶é—´"></a>4.5.15.3 é¢„æµ‹å†·å´æ—¶é—´</h5><p>ç›®å‰å†·å´æ—¶é—´ä¸æ˜¯çœŸæ­£å¯é¢„æµ‹çš„. æˆ‘ä»¬å¯ä»¥åœ¨å®¢æˆ·ç«¯é¢„æµ‹çš„<code>Cooldown GE</code>åº”ç”¨æ—¶å¯åŠ¨UIçš„å†·å´æ—¶é—´è®¡æ—¶å™¨, ä½†æ˜¯<code>GameplayAbility</code>çš„å®é™…å†·å´æ—¶é—´æ˜¯ç”±æœåŠ¡ç«¯çš„å†·å´æ—¶é—´å‰©ä½™å†³å®šçš„. å–å†³äºç©å®¶çš„å»¶è¿Ÿæƒ…å†µ, å¯èƒ½å®¢æˆ·ç«¯é¢„æµ‹çš„å†·å´å·²ç»ç»“æŸ, ä½†æ˜¯æœåŠ¡ç«¯ä¸Šçš„<code>GameplayAbility</code>ä»å¤„äºå†·å´è¿‡ç¨‹, è¿™ä¼šé˜»æ­¢<code>GameplayAbility</code>çš„ç«‹åˆ»å†æ¿€æ´»ç›´åˆ°æœåŠ¡ç«¯å†·å´ç»“æŸ.  </p><p>æ ·ä¾‹é¡¹ç›®é€šè¿‡åœ¨å®¢æˆ·ç«¯é¢„æµ‹çš„å†·å´å¼€å§‹æ—¶ç°åŒ–é™¨çŸ³æŠ€èƒ½çš„å›¾æ ‡, ä¹‹ååœ¨æœåŠ¡ç«¯æ ¡æ­£çš„<code>Cooldown GE</code>åˆ°æ¥æ—¶å¯åŠ¨å†·å´è®¡æ—¶å™¨å¤„ç†è¯¥é—®é¢˜.  </p><p>åœ¨å®é™…æ¸¸æˆä¸­å¯¼è‡´çš„ç»“æœå°±æ˜¯é«˜å»¶è¿Ÿçš„ç©å®¶ç›¸æ¯”ä½å»¶è¿Ÿçš„ç©å®¶å¯¹å†·å´æ—¶é—´çŸ­çš„æŠ€èƒ½æœ‰æ›´ä½çš„è§¦å‘ç‡, ä»è€Œå¤„äºåŠ£åŠ¿, Fortniteé€šè¿‡ä½¿å…¶æ­¦å™¨ä½¿ç”¨æ— éœ€å†·å´<code>GameplayEffect</code>çš„è‡ªå®šä¹‰Bookkeepingè€Œé¿å…è¯¥ç°è±¡.  </p><p>Epicå¸Œæœ›åœ¨æœªæ¥çš„<a href="#concepts-p-future">GASè¿­ä»£ç‰ˆæœ¬</a>ä¸­å®ç°çœŸæ­£çš„å†·å´é¢„æµ‹(ç©å®¶å¯ä»¥æ¿€æ´»ä¸€ä¸ªåœ¨å®¢æˆ·ç«¯å†·å´å®Œæˆä½†æœåŠ¡ç«¯ä»å¤„äºå†·å´è¿‡ç¨‹çš„<code>GameplayAbility</code>).  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-duration"></a></p><h4 id="4-5-16-ä¿®æ”¹å·²æ¿€æ´»GameplayEffectçš„æŒç»­æ—¶é—´"><a href="#4-5-16-ä¿®æ”¹å·²æ¿€æ´»GameplayEffectçš„æŒç»­æ—¶é—´" class="headerlink" title="4.5.16 ä¿®æ”¹å·²æ¿€æ´»GameplayEffectçš„æŒç»­æ—¶é—´"></a>4.5.16 ä¿®æ”¹å·²æ¿€æ´»GameplayEffectçš„æŒç»­æ—¶é—´</h4><p>ä¸ºäº†ä¿®æ”¹<code>Cooldown GE</code>æˆ–å…¶ä»–ä»»ä½•<code>æŒç»­(Duration)</code>GameplayEffectçš„å‰©ä½™æ—¶é—´, æˆ‘ä»¬éœ€è¦ä¿®æ”¹<code>GameplayEffectSpec</code>çš„æŒç»­æ—¶é—´, æ›´æ–°å®ƒçš„<code>StartServerWorldTime</code>, <code>CachedStartServerWorldTime</code>, <code>StartWorldTime</code>, å¹¶ä¸”ä½¿ç”¨<code>CheckDuration()</code>é‡æ–°æ£€æŸ¥æŒç»­æ—¶é—´. åœ¨æœåŠ¡ç«¯ä¸Šå®Œæˆè¿™äº›æ“ä½œå¹¶å°†<code>FActiveGameplayEffect</code>æ ‡è®°ä¸ºdirty, å…¶ä¼šå°†è¿™äº›ä¿®æ”¹åŒæ­¥åˆ°å®¢æˆ·ç«¯. <strong>Note:</strong> è¯¥æ“ä½œåŒ…å«ä¸€ä¸ª<code>const_cast</code>, è¿™å¯èƒ½ä¸æ˜¯<code>Epic</code>å¸Œæœ›çš„ä¿®æ”¹æŒç»­æ—¶é—´çš„æ–¹æ³•, ä½†æ˜¯è¿„ä»Šä¸ºæ­¢å®ƒçœ‹èµ·æ¥è¿è¡Œå¾—å¾ˆå¥½.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UPAAbilitySystemComponent::SetGameplayEffectDurationHandle</span><span class="params">(FActiveGameplayEffectHandle Handle, <span class="type">float</span> NewDuration)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!Handle.<span class="built_in">IsValid</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> FActiveGameplayEffect* ActiveGameplayEffect = <span class="built_in">GetActiveGameplayEffect</span>(Handle);</span><br><span class="line"><span class="keyword">if</span> (!ActiveGameplayEffect)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FActiveGameplayEffect* AGE = <span class="built_in">const_cast</span>&lt;FActiveGameplayEffect*&gt;(ActiveGameplayEffect);</span><br><span class="line"><span class="keyword">if</span> (NewDuration &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">AGE-&gt;Spec.Duration = NewDuration;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">AGE-&gt;Spec.Duration = <span class="number">0.01f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">AGE-&gt;StartServerWorldTime = ActiveGameplayEffects.<span class="built_in">GetServerWorldTime</span>();</span><br><span class="line">AGE-&gt;CachedStartServerWorldTime = AGE-&gt;StartServerWorldTime;</span><br><span class="line">AGE-&gt;StartWorldTime = ActiveGameplayEffects.<span class="built_in">GetWorldTime</span>();</span><br><span class="line">ActiveGameplayEffects.<span class="built_in">MarkItemDirty</span>(*AGE);</span><br><span class="line">ActiveGameplayEffects.<span class="built_in">CheckDuration</span>(Handle);</span><br><span class="line"></span><br><span class="line">AGE-&gt;EventSet.OnTimeChanged.<span class="built_in">Broadcast</span>(AGE-&gt;Handle, AGE-&gt;StartWorldTime, AGE-&gt;<span class="built_in">GetDuration</span>());</span><br><span class="line"><span class="built_in">OnGameplayEffectDurationChange</span>(*AGE);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-dynamic"></a></p><h4 id="4-5-17-è¿è¡Œæ—¶åˆ›å»ºåŠ¨æ€GameplayEffect"><a href="#4-5-17-è¿è¡Œæ—¶åˆ›å»ºåŠ¨æ€GameplayEffect" class="headerlink" title="4.5.17 è¿è¡Œæ—¶åˆ›å»ºåŠ¨æ€GameplayEffect"></a>4.5.17 è¿è¡Œæ—¶åˆ›å»ºåŠ¨æ€<code>GameplayEffect</code></h4><p>åœ¨è¿è¡Œæ—¶åˆ›å»ºåŠ¨æ€<code>GameplayEffect</code>æ˜¯ä¸€ä¸ªé«˜é˜¶æŠ€æœ¯, ä½ ä¸å¿…ç»å¸¸ä½¿ç”¨å®ƒ.  </p><p>åªæœ‰<code>å³åˆ»(Instant)GameplayEffect</code>å¯ä»¥åœ¨è¿è¡Œæ—¶ç”±C++åˆ›å»º, <code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)</code>GameplayEffectä¸èƒ½åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»º, å› ä¸ºå®ƒä»¬åœ¨åŒæ­¥æ—¶ä¼šå¯»æ‰¾å¹¶ä¸å­˜åœ¨çš„<code>GameplayEffect</code>ç±»å®šä¹‰. ä¸ºäº†å®ç°è¯¥åŠŸèƒ½, ä½ åº”è¯¥åˆ›å»ºä¸€ä¸ªåŸå‹<code>GameplayEffect</code>ç±», å°±åƒå¹³æ—¶åœ¨ç¼–è¾‘å™¨ä¸­åšçš„é‚£æ ·, ä¹‹åæ ¹æ®è¿è¡Œæ—¶æ‰€éœ€æ¥å®šåˆ¶åŒ–<code>GameplayEffectSpec</code>.  </p><p>è¿è¡Œæ—¶åˆ›å»ºçš„<code>å³åˆ»(Instant)GameplayEffect</code>ä¹Ÿå¯ä»¥åœ¨å®¢æˆ·ç«¯<a href="#concepts-p">é¢„æµ‹</a>çš„<code>GameplayAbility</code>ä¸­è°ƒç”¨. ç„¶è€Œ, ç›®å‰è¿˜ä¸æ˜ç¡®åŠ¨æ€åˆ›å»ºæ˜¯å¦æœ‰å‰¯ä½œç”¨.  </p><p>æ ·ä¾‹é¡¹ç›®ä¼šåœ¨è§’è‰²<code>AttributeSet</code>ä¸­çš„å€¼å—åˆ°è‡´å‘½ä¸€å‡»æ—¶åˆ›å»ºè¯¥<code>GameplayEffect</code>æ¥å°†é‡‘å¸å’Œç»éªŒç‚¹æ•°è¿”è¿˜ç»™å‡»æ€è€….  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create a dynamic instant Gameplay Effect to give the bounties</span></span><br><span class="line">UGameplayEffect* GEBounty = <span class="built_in">NewObject</span>&lt;UGameplayEffect&gt;(<span class="built_in">GetTransientPackage</span>(), <span class="built_in">FName</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;Bounty&quot;</span>)));</span><br><span class="line">GEBounty-&gt;DurationPolicy = EGameplayEffectDurationType::Instant;</span><br><span class="line"></span><br><span class="line">int32 Idx = GEBounty-&gt;Modifiers.<span class="built_in">Num</span>();</span><br><span class="line">GEBounty-&gt;Modifiers.<span class="built_in">SetNum</span>(Idx + <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">FGameplayModifierInfo&amp; InfoXP = GEBounty-&gt;Modifiers[Idx];</span><br><span class="line">InfoXP.ModifierMagnitude = <span class="built_in">FScalableFloat</span>(<span class="built_in">GetXPBounty</span>());</span><br><span class="line">InfoXP.ModifierOp = EGameplayModOp::Additive;</span><br><span class="line">InfoXP.Attribute = UGDAttributeSetBase::<span class="built_in">GetXPAttribute</span>();</span><br><span class="line"></span><br><span class="line">FGameplayModifierInfo&amp; InfoGold = GEBounty-&gt;Modifiers[Idx + <span class="number">1</span>];</span><br><span class="line">InfoGold.ModifierMagnitude = <span class="built_in">FScalableFloat</span>(<span class="built_in">GetGoldBounty</span>());</span><br><span class="line">InfoGold.ModifierOp = EGameplayModOp::Additive;</span><br><span class="line">InfoGold.Attribute = UGDAttributeSetBase::<span class="built_in">GetGoldAttribute</span>();</span><br><span class="line"></span><br><span class="line">Source-&gt;<span class="built_in">ApplyGameplayEffectToSelf</span>(GEBounty, <span class="number">1.0f</span>, Source-&gt;<span class="built_in">MakeEffectContext</span>());</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªæ ·ä¾‹å±•ç¤ºäº†åœ¨ä¸€ä¸ªå®¢æˆ·ç«¯é¢„æµ‹çš„<code>GameplayAbility</code>ä¸­åˆ›å»ºè¿è¡Œæ—¶<code>GameplayEffect</code>, ä½¿ç”¨é£é™©è‡ªè´Ÿ(æŸ¥çœ‹ä»£ç ä¸­çš„æ³¨é‡Š)!</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">UGameplayAbilityRuntimeGE::<span class="built_in">UGameplayAbilityRuntimeGE</span>()</span><br><span class="line">&#123;</span><br><span class="line">NetExecutionPolicy = EGameplayAbilityNetExecutionPolicy::LocalPredicted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UGameplayAbilityRuntimeGE::ActivateAbility</span><span class="params">(<span class="type">const</span> FGameplayAbilitySpecHandle Handle, <span class="type">const</span> FGameplayAbilityActorInfo* ActorInfo, <span class="type">const</span> FGameplayAbilityActivationInfo ActivationInfo, <span class="type">const</span> FGameplayEventData* TriggerEventData)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">HasAuthorityOrPredictionKey</span>(ActorInfo, &amp;ActivationInfo))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">CommitAbility</span>(Handle, ActorInfo, ActivationInfo))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">EndAbility</span>(Handle, ActorInfo, ActivationInfo, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create the GE at runtime.</span></span><br><span class="line">UGameplayEffect* GameplayEffect = <span class="built_in">NewObject</span>&lt;UGameplayEffect&gt;(<span class="built_in">GetTransientPackage</span>(), <span class="built_in">TEXT</span>(<span class="string">&quot;RuntimeInstantGE&quot;</span>));</span><br><span class="line">GameplayEffect-&gt;DurationPolicy = EGameplayEffectDurationType::Instant; <span class="comment">// Only instant works with runtime GE.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Add a simple scalable float modifier, which overrides MyAttribute with 42.</span></span><br><span class="line"><span class="comment">// In real world applications, consume information passed via TriggerEventData.</span></span><br><span class="line"><span class="type">const</span> int32 Idx = GameplayEffect-&gt;Modifiers.<span class="built_in">Num</span>();</span><br><span class="line">GameplayEffect-&gt;Modifiers.<span class="built_in">SetNum</span>(Idx + <span class="number">1</span>);</span><br><span class="line">FGameplayModifierInfo&amp; ModifierInfo = GameplayEffect-&gt;Modifiers[Idx];</span><br><span class="line">ModifierInfo.Attribute.<span class="built_in">SetUProperty</span>(UMyAttributeSet::<span class="built_in">GetMyModifiedAttribute</span>());</span><br><span class="line">ModifierInfo.ModifierMagnitude = <span class="built_in">FScalableFloat</span>(<span class="number">42.f</span>);</span><br><span class="line">ModifierInfo.ModifierOp = EGameplayModOp::Override;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apply the GE.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Create the GESpec here to avoid the behavior of ASC to create GESpecs from the GE class default object.</span></span><br><span class="line"><span class="comment">// Since we have a dynamic GE here, this would create a GESpec with the base GameplayEffect class, so we</span></span><br><span class="line"><span class="comment">// would lose our modifiers. Attention: It is unknown, if this &quot;hack&quot; done here can have drawbacks!</span></span><br><span class="line"><span class="comment">// The spec prevents the GE object being collected by the GarbageCollector, since the GE is a UPROPERTY on the spec.</span></span><br><span class="line">FGameplayEffectSpec* GESpec = <span class="keyword">new</span> <span class="built_in">FGameplayEffectSpec</span>(GameplayEffect, &#123;&#125;, <span class="number">0.f</span>); <span class="comment">// &quot;new&quot;, since lifetime is managed by a shared ptr within the handle</span></span><br><span class="line"><span class="built_in">ApplyGameplayEffectSpecToOwner</span>(Handle, ActorInfo, ActivationInfo, <span class="built_in">FGameplayEffectSpecHandle</span>(GESpec));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">EndAbility</span>(Handle, ActorInfo, ActivationInfo, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ge-containers"></a></p><h4 id="4-5-18-GameplayEffect-Containers"><a href="#4-5-18-GameplayEffect-Containers" class="headerlink" title="4.5.18 GameplayEffect Containers"></a>4.5.18 GameplayEffect Containers</h4><p>Epicçš„<a href="https://www.unrealengine.com/marketplace/en-US/slug/action-rpg">Action RPG</a>æ ·ä¾‹é¡¹ç›®å®ç°äº†ä¸€ä¸ªåä¸º<code>FGameplayEffectContainer</code>çš„ç»“æ„ä½“, å®ƒä¸å±äºåŸç”ŸGAS, ä½†æ˜¯å¯¹äºåŒ…å«<code>GameplayEffect</code>å’Œ<a href="#concepts-targeting-data">TargetData</a>æå…¶å¥½ç”¨, å®ƒä¼šä½¿ä¸€äº›è¿‡ç¨‹è‡ªåŠ¨åŒ–, æ¯”å¦‚ä»<code>GameplayEffect</code>ä¸­åˆ›å»º<code>GameplayEffectSpec</code>å¹¶åœ¨å…¶<code>GameplayEffectContext</code>ä¸­è®¾ç½®é»˜è®¤å€¼. åœ¨<code>GameplayAbility</code>ä¸­åˆ›å»º<code>GameplayEffectContainer</code>å¹¶å°†å…¶ä¼ é€’ç»™å·²ç”Ÿæˆçš„æŠ•æ·ç‰©æ˜¯éå¸¸ç®€å•å’Œæ˜¾è€Œæ˜“è§çš„, ç„¶è€Œæˆ‘æ²¡æœ‰é€‰æ‹©åœ¨æ ·ä¾‹é¡¹ç›®ä¸­å®ç°<code>GameplayEffectContainer</code>, å› ä¸ºæˆ‘æƒ³å‘ä½ å±•ç¤ºçš„æ˜¯æ²¡æœ‰å®ƒçš„åŸç”ŸGAS, ä½†æ˜¯æˆ‘é«˜åº¦å»ºè®®ä½ ç ”ç©¶ä¸€ä¸‹å®ƒå¹¶å°†å…¶çº³å…¥åˆ°ä½ çš„é¡¹ç›®ä¸­.  </p><p>ä¸ºäº†è®¿é—®<code>GameplayEffectContainer</code>ä¸­çš„<code>GESpec</code>ä»¥æ±‚åšä¸€äº›è¯¸å¦‚æ·»åŠ <code>SetByCaller</code>çš„æ“ä½œ, è¯·ä½¿ç”¨<code>FGameplayEffectContainer</code>ç»“æ„ä½“ä¸­çš„<code>GESpec</code>æ•°ç»„ç´¢å¼•è®¿é—®<code>GESpec</code>å¼•ç”¨, è¿™è¦æ±‚ä½ éœ€è¦æå‰çŸ¥é“æƒ³è¦è®¿é—®çš„<code>GESpec</code>çš„ç´¢å¼•.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/gecontainersetbycaller.png" alt="SetByCaller with a GameplayEffectContainer">  </p><p><code>GameplayEffectContainer</code>è¿˜åŒ…å«ä¸€ä¸ªå¯é€‰çš„ç”¨äº<a href="#concepts-targeting-containers">å®šä½(Target)</a>çš„é«˜æ•ˆæ–¹æ³•.</p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga"></a></p><h3 id="4-6-Gameplay-Abilities"><a href="#4-6-Gameplay-Abilities" class="headerlink" title="4.6 Gameplay Abilities"></a>4.6 Gameplay Abilities</h3><p><a name="concepts-ga-definition"></a></p><h4 id="4-6-1-GameplayAbilityå®šä¹‰"><a href="#4-6-1-GameplayAbilityå®šä¹‰" class="headerlink" title="4.6.1 GameplayAbilityå®šä¹‰"></a>4.6.1 GameplayAbilityå®šä¹‰</h4><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/Abilities/UGameplayAbility/index.html">GameplayAbility(GA)</a>æ˜¯Actoråœ¨æ¸¸æˆä¸­å¯ä»¥è§¦å‘çš„ä¸€åˆ‡è¡Œä¸ºå’ŒæŠ€èƒ½. å¤šä¸ª<code>GameplayAbility</code>å¯ä»¥åœ¨åŒä¸€æ—¶åˆ»æ¿€æ´», ä¾‹å¦‚å¥”è·‘å’Œå°„å‡». å…¶å¯ç”±è“å›¾æˆ–C++å®Œæˆ.  </p><p><code>GameplayAbility</code>ç¤ºä¾‹:  </p><ul><li>è·³è·ƒ</li><li>å¥”è·‘</li><li>å°„å‡»</li><li>æ¯Xç§’è¢«åŠ¨åœ°é˜»æŒ¡ä¸€æ¬¡æ”»å‡»</li><li>ä½¿ç”¨è¯å‰‚</li><li>å¼€é—¨</li><li>æ”¶é›†èµ„æº</li><li>å»ºé€ </li></ul><p>ä¸åº”è¯¥ä½¿ç”¨<code>GameplayAbility</code>çš„åœºæ™¯:  </p><ul><li>åŸºç¡€ç§»åŠ¨è¾“å…¥</li><li>ä¸€äº›ä¸UIçš„äº¤äº’ - ä¸è¦ä½¿ç”¨<code>GameplayAbility</code>ä»å•†åº—ä¸­è´­ä¹°ç‰©å“</li></ul><p>è¿™äº›ä¸æ˜¯è§„å®š, åªæ˜¯æˆ‘çš„å»ºè®®è€Œå·², ä½ çš„è®¾è®¡å’Œå®ç°å¯èƒ½æ˜¯å¤šæ ·çš„.  </p><p><code>GameplayAbility</code>è‡ªå¸¦æœ‰æ ¹æ®ç­‰çº§ä¿®æ”¹Attributeå˜åŒ–é‡æˆ–è€…<code>GameplayAbility</code>ä½œç”¨çš„é»˜è®¤åŠŸèƒ½.  </p><p><code>GameplayAbility</code>è¿è¡Œåœ¨æ‰€å±(Owning)å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯å–å†³äº<a href="#concepts-ga-net">ç½‘ç»œæ‰§è¡Œç­–ç•¥(Net Execution Policy)</a>è€Œä¸æ˜¯Simulated Proxy. <code>ç½‘ç»œæ‰§è¡Œç­–ç•¥(Net Execution Policy)</code>å†³å®šæŸä¸ª<code>GameplayAbility</code>æ˜¯å¦æ˜¯å®¢æˆ·ç«¯å¯<a href="#concepts-p">é¢„æµ‹</a>çš„, å…¶å¯¹äº<a href="#concepts-ga-commit">å¯é€‰çš„Costå’Œ<code>Cooldown GameplayEffect</code></a>åŒ…å«æœ‰é»˜è®¤è¡Œä¸º. <code>GameplayAbility</code>ä½¿ç”¨<a href="#concepts-at">AbilityTask</a>ç”¨äºéšæ—¶é—´æ¨ç§»è€Œå‘ç”Ÿçš„è¡Œä¸º, ä¾‹å¦‚ç­‰å¾…æŸä¸ªäº‹ä»¶, ç­‰å¾…æŸä¸ªAttributeæ”¹å˜, ç­‰å¾…ç©å®¶é€‰æ‹©ä¸€ä¸ªç›®æ ‡æˆ–è€…ä½¿ç”¨<code>Root Motion Source</code>ç§»åŠ¨æŸä¸ª<code>Character</code>. <strong>Simulated Clientä¸ä¼šè¿è¡Œ<code>GameplayAbility</code>,</strong> è€Œæ˜¯å½“æœåŠ¡ç«¯æ‰§è¡Œ<code>Ability</code>æ—¶, ä»»ä½•éœ€è¦åœ¨Simulated Proxyä¸Šå±•ç°çš„è§†è§‰æ•ˆæœ(åƒåŠ¨ç”»è’™å¤ªå¥‡)å°†ä¼šè¢«åŒæ­¥(Replicate)æˆ–è€…é€šè¿‡<code>AbilityTask</code>è¿›è¡ŒRPCæˆ–è€…å¯¹äºåƒå£°éŸ³å’Œç²’å­è¿™æ ·çš„è£…é¥°æ•ˆæœä½¿ç”¨<a href="#concepts-gc">GameplayCue</a>.  </p><p>æ‰€æœ‰çš„<code>GameplayAbility</code>éƒ½ä¼šæœ‰å®ƒä»¬å„è‡ªç”±ä½ çš„æ¸¸æˆé€»è¾‘é‡å†™çš„<code>ActivateAbility()</code>å‡½æ•°, é™„åŠ çš„é€»è¾‘å¯ä»¥æ·»åŠ åˆ°<code>EndAbility()</code>, å…¶ä¼šåœ¨<code>GameplayAbility</code>å®Œæˆæˆ–å–æ¶ˆæ—¶æ‰§è¡Œ.  </p><p>ä¸€ä¸ªç®€å•çš„<code>GameplayAbility</code>æµç¨‹å›¾: <img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/abilityflowchartsimple.png" alt="Simple GameplayAbility Flowchart">  </p><p>ä¸€ä¸ªæ›´å¤æ‚<code>GameplayAbility</code>æµç¨‹å›¾: <img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/abilityflowchartcomplex.png" alt="Complex GameplayAbility Flowchart">  </p><p>å¤æ‚çš„Abilityå¯ä»¥ä½¿ç”¨å¤šä¸ªç›¸äº’äº¤äº’(æ¿€æ´», å–æ¶ˆç­‰ç­‰)çš„<code>GameplayAbility</code>å®ç°.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-definition-reppolicy"></a></p><h5 id="4-6-1-1-Replication-Policy"><a href="#4-6-1-1-Replication-Policy" class="headerlink" title="4.6.1.1 Replication Policy"></a>4.6.1.1 Replication Policy</h5><p>ä¸è¦ä½¿ç”¨è¯¥é€‰é¡¹. è¿™ä¸ªåå­—ä¼šè¯¯å¯¼ä½ å¹¶ä¸”ä½ å¹¶ä¸éœ€è¦å®ƒ. <a href="#concepts-ga-spec">GameplayAbilitySpec</a>é»˜è®¤ä¼šä»æœåŠ¡ç«¯å‘æ‰€å±(Owning)å®¢æˆ·ç«¯åŒæ­¥, ä¸Šæ–‡æåˆ°è¿‡, <strong><code>GameplayAbility</code>ä¸ä¼šè¿è¡Œåœ¨Simulated Proxyä¸Š,</strong> å…¶ä½¿ç”¨<code>AbilityTask</code>å’Œ<code>GameplayCue</code>æ¥åŒæ­¥æˆ–è€…RPCè§†è§‰å˜åŒ–åˆ°Simulated Proxy. Epicçš„Dave Rattiå·²ç»è¡¨æ˜è¦åœ¨æœªæ¥<a href="https://epicgames.ent.box.com/s/m1egifkxv3he3u3xezb9hzbgroxyhx89">ç§»é™¤è¯¥é€‰é¡¹</a>çš„æ„æ„¿.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-definition-remotecancel"></a></p><h5 id="4-6-1-2-Server-Respects-Remote-Ability-Cancellation"><a href="#4-6-1-2-Server-Respects-Remote-Ability-Cancellation" class="headerlink" title="4.6.1.2 Server Respects Remote Ability Cancellation"></a>4.6.1.2 Server Respects Remote Ability Cancellation</h5><p>è¿™ä¸ªé€‰é¡¹å¾€å¾€ä¼šå¼•èµ·éº»çƒ¦. å®ƒçš„æ„æ€æ˜¯å¦‚æœå®¢æˆ·ç«¯çš„<code>GameplayAbility</code>ç”±äºç©å®¶å–æ¶ˆæˆ–è€…è‡ªç„¶å®Œæˆæ—¶, å°±ä¼šå¼ºåˆ¶å®ƒçš„æœåŠ¡ç«¯ç‰ˆæœ¬ç»“æŸè€Œä¸ç®¡å…¶æ˜¯å¦å®Œæˆ. æœ€é‡è¦çš„æ˜¯ä¹‹åçš„é—®é¢˜, ç‰¹åˆ«æ˜¯å¯¹äºé«˜å»¶è¿Ÿç©å®¶æ‰€ä½¿ç”¨çš„å®¢æˆ·ç«¯é¢„æµ‹çš„<code>GameplayAbility</code>. ä¸€èˆ¬æƒ…å†µä¸‹ç¦ç”¨è¯¥é€‰é¡¹.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-definition-repinputdirectly"></a></p><h5 id="4-6-1-3-Replicate-Input-Directly"><a href="#4-6-1-3-Replicate-Input-Directly" class="headerlink" title="4.6.1.3 Replicate Input Directly"></a>4.6.1.3 Replicate Input Directly</h5><p>è®¾ç½®è¯¥é€‰é¡¹å°±ä¼šä¸€ç›´å‘æœåŠ¡ç«¯åŒæ­¥è¾“å…¥çš„æŒ‰ä¸‹(Press)å’ŒæŠ¬èµ·(Release)äº‹ä»¶. Epicä¸å»ºè®®ä½¿ç”¨è¯¥é€‰é¡¹è€Œæ˜¯ä¾é åˆ›å»ºåœ¨å·²æœ‰è¾“å…¥ç›¸å…³çš„<a href="#concepts-at">AbilityTask</a>ä¸­çš„<code>Generic Replicated Event</code>(å¦‚æœä½ çš„<a href="#concepts-ga-input">è¾“å…¥ç»‘å®šåœ¨ASC</a>).  </p><p>Epicçš„æ³¨é‡Š:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Direct Input state replication. These will be called if bReplicateInputDirectly is true on the ability and is generally not a good thing to use. (Instead, prefer to use Generic Replicated Events). */</span></span><br><span class="line">UAbilitySystemComponent::<span class="built_in">ServerSetInputPressed</span>()</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-input"></a></p><h4 id="4-6-2-ç»‘å®šè¾“å…¥åˆ°ASC"><a href="#4-6-2-ç»‘å®šè¾“å…¥åˆ°ASC" class="headerlink" title="4.6.2 ç»‘å®šè¾“å…¥åˆ°ASC"></a>4.6.2 ç»‘å®šè¾“å…¥åˆ°ASC</h4><p><code>ASC</code>å…è®¸ä½ ç›´æ¥ç»‘å®šè¾“å…¥äº‹ä»¶å¹¶å½“ä½ æˆäºˆ<code>GameplayAbility</code>æ—¶åˆ†é…è¿™äº›è¾“å…¥åˆ°<code>GameplayAbility</code>, å¦‚æœ<code>GameplayTag</code>åˆä¹è¦æ±‚, å½“æŒ‰ä¸‹æŒ‰é”®æ—¶, åˆ†é…åˆ°<code>GameplayAbility</code>çš„è¾“å…¥äº‹ä»¶ä¼šè‡ªåŠ¨æ¿€æ´»å„è‡ªçš„<code>GameplayAbility</code>. åˆ†é…çš„è¾“å…¥äº‹ä»¶è¦æ±‚ä½¿ç”¨å“åº”è¾“å…¥çš„å†…å»º<code>AbilityTask</code>.  </p><p>é™¤äº†åˆ†é…çš„è¾“å…¥äº‹ä»¶å¯ä»¥æ¿€æ´»<code>GameplayAbility</code>, <code>ASC</code>ä¹Ÿæ¥å—ä¸€èˆ¬çš„<code>Confirm</code>å’Œ<code>Cancel</code>è¾“å…¥, è¿™äº›ç‰¹æ®Šè¾“å…¥è¢«<code>AbilityTask</code>ç”¨æ¥ç¡®å®šåƒ<a href="#concepts-targeting-actors">Target Actor</a>çš„å¯¹è±¡æˆ–å–æ¶ˆå®ƒä»¬.  </p><p>ä¸ºäº†ç»‘å®šè¾“å…¥åˆ°<code>ASC</code>, ä½ å¿…é¡»é¦–å…ˆåˆ›å»ºä¸€ä¸ªæšä¸¾æ¥å°†è¾“å…¥äº‹ä»¶åç§°è½¬æ¢ä¸ºbyte, æšä¸¾åå¿…é¡»å‡†ç¡®åŒ¹é…é¡¹ç›®è®¾ç½®ä¸­ç”¨äºè¾“å…¥äº‹ä»¶çš„åç§°, <code>DisplayName</code>å°±æ— æ‰€è°“äº†.  </p><p>æ ·ä¾‹é¡¹ç›®ä¸­:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UENUM</span>(BlueprintType)</span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">EGDAbilityInputID</span> : uint8</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// 0 None</span></span><br><span class="line"><span class="function">None<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;None&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 1 Confirm</span></span></span><br><span class="line"><span class="function">Confirm<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Confirm&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 2 Cancel</span></span></span><br><span class="line"><span class="function">Cancel<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Cancel&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 3 LMB</span></span></span><br><span class="line"><span class="function">Ability1<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Ability1&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 4 RMB</span></span></span><br><span class="line"><span class="function">Ability2<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Ability2&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 5 Q</span></span></span><br><span class="line"><span class="function">Ability3<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Ability3&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 6 E</span></span></span><br><span class="line"><span class="function">Ability4<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Ability4&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 7 R</span></span></span><br><span class="line"><span class="function">Ability5<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Ability5&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 8 Sprint</span></span></span><br><span class="line"><span class="function">Sprint<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Sprint&quot;</span>)</span>,</span></span><br><span class="line"><span class="function"><span class="comment">// 9 Jump</span></span></span><br><span class="line"><span class="function">Jump<span class="title">UMETA</span><span class="params">(DisplayName = <span class="string">&quot;Jump&quot;</span>)</span></span></span><br><span class="line"><span class="function">&#125;</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„<code>ASC</code>ä½äº<code>Character</code>, é‚£ä¹ˆå°±åœ¨<code>SetupPlayerInputComponent()</code>ä¸­åŒ…å«ç”¨äºç»‘å®šåˆ°<code>ASC</code>çš„å‡½æ•°.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bind to AbilitySystemComponent</span></span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">BindAbilityActivationToInputComponent</span>(PlayerInputComponent, <span class="built_in">FGameplayAbilityInputBinds</span>(<span class="built_in">FString</span>(<span class="string">&quot;ConfirmTarget&quot;</span>), <span class="built_in">FString</span>(<span class="string">&quot;CancelTarget&quot;</span>), <span class="built_in">FString</span>(<span class="string">&quot;EGDAbilityInputID&quot;</span>), <span class="built_in">static_cast</span>&lt;int32&gt;(EGDAbilityInputID::Confirm), <span class="built_in">static_cast</span>&lt;int32&gt;(EGDAbilityInputID::Cancel)));</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„<code>ASC</code>ä½äº<code>PlayerState</code>, <code>SetupPlayerInputComponent()</code>ä¸­æœ‰ä¸€ä¸ªæ½œåœ¨çš„ç«äº‰æƒ…å†µå°±æ˜¯<code>PlayerState</code>è¿˜æ²¡æœ‰åŒæ­¥åˆ°å®¢æˆ·ç«¯, å› æ­¤, æˆ‘å»ºè®®å°è¯•åœ¨<code>SetupPlayerInputComponent()</code>å’Œ<code>OnRep_PlayerState()</code>ä¸­ç»‘å®šè¾“å…¥, åªæœ‰<code>OnRep_PlayerState()</code>è‡ªèº«æ˜¯ä¸å……åˆ†çš„, å› ä¸ºå¯èƒ½æœ‰ç§æƒ…å†µæ˜¯å½“<code>PlayerState</code>åœ¨<code>PlayerController</code>å‘ŠçŸ¥å®¢æˆ·ç«¯è°ƒç”¨ç”¨äºåˆ›å»º<code>InputComponent</code>çš„<code>ClientRestart()</code>å‰åŒæ­¥æ—¶, Actorçš„<code>InputComponent</code>å¯èƒ½ä¸ºNULL. æ ·ä¾‹é¡¹ç›®æ¼”ç¤ºäº†å°è¯•ä½¿ç”¨ä¸€ä¸ªå¸ƒå°”å€¼æ§åˆ¶æµç¨‹ä»è€Œåœ¨ä¸¤ä¸ªä½ç½®ç»‘å®š, è¿™æ ·å®é™…ä¸Šåªç»‘å®šäº†ä¸€æ¬¡.  </p><p><strong>Note:</strong> æ ·ä¾‹é¡¹ç›®æšä¸¾ä¸­çš„<code>Confirm</code>å’Œ<code>Cancel</code>æ²¡æœ‰åŒ¹é…é¡¹ç›®è®¾ç½®ä¸­çš„è¾“å…¥äº‹ä»¶åç§°(<code>ConfirmTarget</code>å’Œ<code>CancelTarget</code>), ä½†æ˜¯æˆ‘ä»¬åœ¨<code>BindAbilityActivationToInputComponent()</code>ä¸­æä¾›äº†å®ƒä»¬ä¹‹é—´çš„æ˜ å°„, è¿™æ˜¯ç‰¹æ®Šçš„, å› ä¸ºæˆ‘ä»¬æä¾›äº†æ˜ å°„å¹¶ä¸”å®ƒä»¬æ— éœ€åŒ¹é…, ä½†æ˜¯å®ƒä»¬æ˜¯å¯ä»¥åŒ¹é…çš„. æšä¸¾ä¸­çš„å…¶ä»–è¾“å…¥éƒ½å¿…é¡»åŒ¹é…é¡¹ç›®è®¾ç½®ä¸­çš„è¾“å…¥äº‹ä»¶åç§°.  </p><p>å¯¹äºåªèƒ½ç”¨ä¸€æ¬¡è¾“å…¥æ¿€æ´»çš„<code>GameplayAbility</code>(å®ƒä»¬æ€»æ˜¯åƒMOBAæ¸¸æˆä¸€æ ·å­˜åœ¨äºç›¸åŒçš„â€æ§½â€ä¸­), æˆ‘å€¾å‘åœ¨<code>UGameplayAbility</code>å­ç±»ä¸­æ·»åŠ ä¸€ä¸ªå˜é‡, è¿™æ ·æˆ‘å°±å¯ä»¥å®šä¹‰ä»–ä»¬çš„è¾“å…¥, ä¹‹ååœ¨æˆäºˆAbilityçš„æ—¶å€™å¯ä»¥ä»<code>ClassDefaultObject</code>ä¸­è¯»å–è¿™ä¸ªå€¼.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-input-noactivate"></a></p><h5 id="4-6-2-1-ç»‘å®šè¾“å…¥æ—¶ä¸æ¿€æ´»Ability"><a href="#4-6-2-1-ç»‘å®šè¾“å…¥æ—¶ä¸æ¿€æ´»Ability" class="headerlink" title="4.6.2.1 ç»‘å®šè¾“å…¥æ—¶ä¸æ¿€æ´»Ability"></a>4.6.2.1 ç»‘å®šè¾“å…¥æ—¶ä¸æ¿€æ´»Ability</h5><p>å¦‚æœä½ ä¸æƒ³ä½ çš„<code>GameplayAbility</code>åœ¨æŒ‰é”®æŒ‰ä¸‹æ—¶è‡ªåŠ¨æ¿€æ´», ä½†æ˜¯ä»æƒ³å°†å®ƒä»¬ç»‘å®šåˆ°è¾“å…¥ä»¥ä¸<code>AbilityTask</code>ä¸€èµ·ä½¿ç”¨, ä½ å¯ä»¥åœ¨<code>UGameplayAbility</code>å­ç±»ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„å¸ƒå°”å˜é‡, <code>bActivateOnInput</code>, å…¶é»˜è®¤å€¼ä¸º<code>true</code>å¹¶é‡å†™<code>UAbilitySystemComponent::AbilityLocalInputPressed()</code>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UGSAbilitySystemComponent::AbilityLocalInputPressed</span><span class="params">(int32 InputID)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// Consume the input if this InputID is overloaded with GenericConfirm/Cancel and the GenericConfim/Cancel callback is bound</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">IsGenericConfirmInputBound</span>(InputID))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">LocalInputConfirm</span>();</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">IsGenericCancelInputBound</span>(InputID))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">LocalInputCancel</span>();</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">ABILITYLIST_SCOPE_LOCK</span>();</span><br><span class="line"><span class="keyword">for</span> (FGameplayAbilitySpec&amp; Spec : ActivatableAbilities.Items)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Spec.InputID == InputID)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Spec.Ability)</span><br><span class="line">&#123;</span><br><span class="line">Spec.InputPressed = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (Spec.<span class="built_in">IsActive</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Spec.Ability-&gt;bReplicateInputDirectly &amp;&amp; <span class="built_in">IsOwnerActorAuthoritative</span>() == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">ServerSetInputPressed</span>(Spec.Handle);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">AbilitySpecInputPressed</span>(Spec);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Invoke the InputPressed event. This is not replicated here. If someone is listening, they may replicate the InputPressed event to the server.</span></span><br><span class="line"><span class="built_in">InvokeReplicatedEvent</span>(EAbilityGenericReplicatedEvent::InputPressed, Spec.Handle, Spec.ActivationInfo.<span class="built_in">GetActivationPredictionKey</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">UGSGameplayAbility* GA = <span class="built_in">Cast</span>&lt;UGSGameplayAbility&gt;(Spec.Ability);</span><br><span class="line"><span class="keyword">if</span> (GA &amp;&amp; GA-&gt;bActivateOnInput)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Ability is not active, so try to activate it</span></span><br><span class="line"><span class="built_in">TryActivateAbility</span>(Spec.Handle);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-granting"></a></p><h4 id="4-6-3-æˆäºˆAbility"><a href="#4-6-3-æˆäºˆAbility" class="headerlink" title="4.6.3 æˆäºˆAbility"></a>4.6.3 æˆäºˆAbility</h4><p>å‘<code>ASC</code>æˆäºˆ<code>GameplayAbility</code>ä¼šå°†å…¶æ·»åŠ åˆ°<code>ASC</code>çš„<code>ActivatableAbilities</code>åˆ—è¡¨, ä»è€Œå…è®¸å…¶åœ¨æ»¡è¶³<a href="#concepts-ga-tags"><code>GameplayTag</code>éœ€æ±‚</a>æ—¶æ¿€æ´»è¯¥<code>GameplayAbility</code>.  </p><p>æˆ‘ä»¬åœ¨æœåŠ¡ç«¯æˆäºˆ<code>GameplayAbility</code>, ä¹‹åå…¶ä¼šè‡ªåŠ¨åŒæ­¥<a href="#concepts-ga-spec">GameplayAbilitySpec</a>åˆ°æ‰€å±(Owning)å®¢æˆ·ç«¯, å…¶ä»–å®¢æˆ·ç«¯/Simulated proxyä¸ä¼šæ¥å—åˆ°<code>GameplayAbilitySpec</code>.  </p><p>æ ·ä¾‹é¡¹ç›®åœ¨æ¸¸æˆå¼€å§‹æ—¶å°†<code>TArray&lt;TSubclassOf&lt;UGDGameplayAbility&gt;&gt;</code>ä¿å­˜åœ¨å®ƒè¯»å–å’Œæˆäºˆçš„<code>Character</code>ç±»ä¸­.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AGDCharacterBase::AddCharacterAbilities</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// Grant abilities, but only on the server</span></span><br><span class="line"><span class="keyword">if</span> (Role != ROLE_Authority || !AbilitySystemComponent.<span class="built_in">IsValid</span>() || AbilitySystemComponent-&gt;CharacterAbilitiesGiven)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (TSubclassOf&lt;UGDGameplayAbility&gt;&amp; StartupAbility : CharacterAbilities)</span><br><span class="line">&#123;</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">GiveAbility</span>(</span><br><span class="line"><span class="built_in">FGameplayAbilitySpec</span>(StartupAbility, <span class="built_in">GetAbilityLevel</span>(StartupAbility.<span class="built_in">GetDefaultObject</span>()-&gt;AbilityID), <span class="built_in">static_cast</span>&lt;int32&gt;(StartupAbility.<span class="built_in">GetDefaultObject</span>()-&gt;AbilityInputID), <span class="keyword">this</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">AbilitySystemComponent-&gt;CharacterAbilitiesGiven = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“æˆäºˆè¿™äº›<code>GameplayAbility</code>æ—¶, æˆ‘ä»¬å°±åœ¨ä½¿ç”¨<code>UGameplayAbility</code>ç±», Abilityç­‰çº§, å…¶ç»‘å®šçš„è¾“å…¥å’Œ<code>SourceObject</code>æˆ–å°†è¯¥<code>GameplayAbility</code>è®¾ç½®åˆ°è¯¥<code>ASC</code>çš„æº(Source)åˆ›å»º<code>GameplayAbilitySpec</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-activating"></a></p><h4 id="4-6-4-æ¿€æ´»Ability"><a href="#4-6-4-æ¿€æ´»Ability" class="headerlink" title="4.6.4 æ¿€æ´»Ability"></a>4.6.4 æ¿€æ´»Ability</h4><p>å¦‚æœæŸä¸ª<code>GameplayAbility</code>è¢«åˆ†é…ç»™äº†ä¸€ä¸ªè¾“å…¥äº‹ä»¶, é‚£ä¹ˆå½“è¾“å…¥æŒ‰é”®æŒ‰ä¸‹å¹¶ä¸”å®ƒçš„<code>GameplayTag</code>éœ€æ±‚æ»¡è¶³æ—¶, å®ƒå°†ä¼šè‡ªåŠ¨æ¿€æ´», è¿™å¯èƒ½å¹¶éæ€»æ˜¯æ¿€æ´»<code>GameplayAbility</code>çš„æœŸæœ›æ–¹å¼. <code>ASC</code>æä¾›äº†å¦å¤–å››ç§æ¿€æ´»<code>GameplayAbility</code>çš„æ–¹æ³•: é€šè¿‡<code>GameplayTag</code>, <code>GameplayAbility</code>ç±», <code>GameplayAbilitySpecHandle</code>å’ŒEvent, é€šè¿‡Eventæ¿€æ´»<code>GameplayAbility</code>å…è®¸ä½ <a href="#concepts-ga-data">ä¼ é€’ä¸€ä¸ªè¯¥äº‹ä»¶çš„æ•°æ®è´Ÿè½½(Payload)</a>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable, Category = <span class="string">&quot;Abilities&quot;</span>)</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">TryActivateAbilitiesByTag</span><span class="params">(<span class="type">const</span> FGameplayTagContainer&amp; GameplayTagContainer, <span class="type">bool</span> bAllowRemoteActivation = <span class="literal">true</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable, Category = <span class="string">&quot;Abilities&quot;</span>)</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">TryActivateAbilityByClass</span><span class="params">(TSubclassOf&lt;UGameplayAbility&gt; InAbilityToActivate, <span class="type">bool</span> bAllowRemoteActivation = <span class="literal">true</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">TryActivateAbility</span><span class="params">(FGameplayAbilitySpecHandle AbilityToActivate, <span class="type">bool</span> bAllowRemoteActivation = <span class="literal">true</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">TriggerAbilityFromGameplayEvent</span><span class="params">(FGameplayAbilitySpecHandle AbilityToTrigger, FGameplayAbilityActorInfo* ActorInfo, FGameplayTag Tag, <span class="type">const</span> FGameplayEventData* Payload, UAbilitySystemComponent&amp; Component)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">FGameplayAbilitySpecHandle <span class="title">GiveAbilityAndActivateOnce</span><span class="params">(<span class="type">const</span> FGameplayAbilitySpec&amp; AbilitySpec)</span></span>;</span><br></pre></td></tr></table></figure><p>æƒ³è¦é€šè¿‡Eventæ¿€æ´»<code>GameplayAbility</code>, <code>GameplayAbility</code>å¿…é¡»è®¾ç½®å®ƒçš„<code>Trigger</code>, åˆ†é…ä¸€ä¸ª<code>GameplayTag</code>å¹¶ä¸º<code>GameplayEvent</code>é€‰æ‹©ä¸€ä¸ªé€‰é¡¹. æƒ³è¦å‘é€Event, å°±å¾—ä½¿ç”¨<code>UAbilitySystemBlueprintLibrary::SendGameplayEventToActor(AActor* Actor, FGameplayTag EventTag, FGameplayEventData Payload)</code>å‡½æ•°. é€šè¿‡Eventæ¿€æ´»<code>GameplayAbility</code>å…è®¸ä½ ä¼ é€’ä¸€ä¸ªæ•°æ®è´Ÿè½½(Payload).  </p><p><code>GameplayAbility Trigger</code>ä¹Ÿå…è®¸ä½ åœ¨æŸä¸ª<code>GameplayTag</code>æ·»åŠ æˆ–ç§»é™¤æ—¶æ¿€æ´»è¯¥<code>GameplayAbility</code>.  </p><p><strong>Note:</strong> å½“ä»è“å›¾ä¸­çš„Eventæ¿€æ´»<code>GameplayAbility</code>æ—¶, ä½ å¿…é¡»ä½¿ç”¨<code>ActivateAbilityFromEvent</code>èŠ‚ç‚¹, å¹¶ä¸”æ ‡å‡†çš„<code>ActivateAbility</code>èŠ‚ç‚¹ä¸èƒ½å‡ºç°åœ¨å›¾è¡¨ä¸­, å¦‚æœ<code>ActivateAbility</code>èŠ‚ç‚¹å­˜åœ¨, å®ƒå°±ä¼šä¸€ç›´è¢«è°ƒç”¨è€Œä¸è°ƒç”¨<code>ActivateAbilityFromEvent</code>èŠ‚ç‚¹.  </p><p><strong>Note:</strong> ä¸è¦å¿˜è®°åº”è¯¥åœ¨<code>GameplayAbility</code>ç»ˆæ­¢æ—¶è°ƒç”¨<code>EndAbility()</code>, é™¤éä½ çš„<code>GameplayAbility</code>æ˜¯åƒè¢«åŠ¨æŠ€èƒ½é‚£æ ·ä¸€ç›´è¿è¡Œçš„<code>GameplayAbility</code>.  </p><p>å¯¹äº<strong>å®¢æˆ·ç«¯é¢„æµ‹</strong><code>GameplayAbility</code>çš„æ¿€æ´»åºåˆ—:  </p><ol><li><strong>æ‰€å±(Owning)å®¢æˆ·ç«¯</strong>è°ƒç”¨<code>TryActivateAbility()</code></li><li>è°ƒç”¨<code>InternalTryActivateAbility()</code></li><li>è°ƒç”¨<code>CanActivateAbility()</code>å¹¶è¿”å›æ˜¯å¦æ»¡è¶³<code>GameplayTag</code>éœ€æ±‚, <code>ASC</code>æ˜¯å¦æ»¡è¶³æŠ€èƒ½èŠ±è´¹, <code>GameplayAbility</code>æ˜¯å¦ä¸åœ¨å†·å´æœŸå’Œå½“å‰æ˜¯å¦æ²¡æœ‰å…¶ä»–å®ä¾‹è¢«æ¿€æ´»</li><li>è°ƒç”¨<code>CallServerTryActivateAbility()</code>å¹¶ä¼ å…¥å…¶ç”Ÿæˆçš„<code>Prediction Key</code></li><li>è°ƒç”¨<code>CallActivateAbility()</code></li><li>è°ƒç”¨<code>PreActivate()</code>, Epicç§°ä¹‹ä¸ºâ€boilerplate init stuffâ€</li><li>è°ƒç”¨<code>ActivateAbility()</code>æœ€ç»ˆæ¿€æ´»Ability</li></ol><p><strong>æœåŠ¡ç«¯</strong>æ¥æ”¶åˆ°<code>CallServerTryActivateAbility()</code>  </p><ol><li>è°ƒç”¨<code>ServerTryActivateAbility()</code></li><li>è°ƒç”¨<code>InternalServerTryActivateAbility()</code></li><li>è°ƒç”¨<code>InternalTryActivateAbility()</code></li><li>è°ƒç”¨<code>CanActivateAbility()</code>å¹¶è¿”å›æ˜¯å¦æ»¡è¶³<code>GameplayTag</code>éœ€æ±‚, <code>ASC</code>æ˜¯å¦æ»¡è¶³æŠ€èƒ½èŠ±è´¹, <code>GameplayAbility</code>æ˜¯å¦ä¸åœ¨å†·å´æœŸå’Œå½“å‰æ˜¯å¦æ²¡æœ‰å…¶ä»–å®ä¾‹è¢«æ¿€æ´»</li><li>å¦‚æœæˆåŠŸåˆ™è°ƒç”¨<code>ClientActivateAbilitySucceed()</code>å‘ŠçŸ¥å®¢æˆ·ç«¯æ›´æ–°å®ƒçš„<code>ActivationInfo</code>(å³è¯¥æ¿€æ´»å·²ç”±æœåŠ¡ç«¯ç¡®è®¤)å¹¶å¹¿æ’­<code>OnConfirmDelegate</code>ä»£ç†. è¿™å’Œè¾“å…¥ç¡®è®¤(Input Confirmation)ä¸ä¸€æ ·.</li><li>è°ƒç”¨<code>CallActivateAbility()</code></li><li>è°ƒç”¨<code>PreActivate()</code>, Epicç§°ä¹‹ä¸ºâ€boilerplate init stuffâ€</li><li>è°ƒç”¨<code>ActivateAbility()</code>æœ€ç»ˆæ¿€æ´»Ability</li></ol><p>å¦‚æœæœåŠ¡ç«¯åœ¨ä»»æ„æ—¶åˆ»æ¿€æ´»å¤±è´¥, å°±ä¼šè°ƒç”¨<code>ClientActivateAbilityFailed()</code>, ç«‹å³ç»ˆæ­¢å®¢æˆ·ç«¯çš„<code>GameplayAbility</code>å¹¶æ’¤é”€æ‰€æœ‰é¢„æµ‹çš„ä¿®æ”¹.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-activating-passive"></a></p><h5 id="4-6-4-1-è¢«åŠ¨Ability"><a href="#4-6-4-1-è¢«åŠ¨Ability" class="headerlink" title="4.6.4.1 è¢«åŠ¨Ability"></a>4.6.4.1 è¢«åŠ¨Ability</h5><p>ä¸ºäº†å®ç°è‡ªåŠ¨æ¿€æ´»å’ŒæŒç»­è¿è¡Œçš„è¢«åŠ¨<code>GameplayAbility</code>, éœ€è¦é‡å†™<code>UGameplayAbility::OnAvatarSet()</code>, è¯¥å‡½æ•°åœ¨æˆäºˆ<code>GameplayAbility</code>å¹¶è®¾ç½®<code>AvatarActor</code>ä¸”è°ƒç”¨<code>TryActivateAbility()</code>æ—¶è‡ªåŠ¨è°ƒç”¨.  </p><p>æˆ‘å»ºè®®æ·»åŠ ä¸€ä¸ª<code>å¸ƒå°”å€¼</code>åˆ°ä½ çš„è‡ªå®šä¹‰<code>UGameplayAbility</code>ç±»æ¥è¡¨æ˜å…¶åœ¨æˆäºˆæ—¶æ˜¯å¦åº”è¯¥è¢«æ¿€æ´». æ ·ä¾‹é¡¹ç›®ä¸­çš„è¢«åŠ¨æŠ¤ç”²å å±‚Abilityæ˜¯è¿™æ ·åšçš„.  </p><p>è¢«åŠ¨<code>GameplayAbility</code>ä¸€èˆ¬æœ‰ä¸€ä¸ª<code>ä»…æœåŠ¡å™¨(Server Only)</code>çš„<a href="#concepts-ga-net">ç½‘ç»œæ‰§è¡Œç­–ç•¥(Net Execution Policy)</a>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UGDGameplayAbility::OnAvatarSet</span><span class="params">(<span class="type">const</span> FGameplayAbilityActorInfo * ActorInfo, <span class="type">const</span> FGameplayAbilitySpec &amp; Spec)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">OnAvatarSet</span>(ActorInfo, Spec);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ActivateAbilityOnGranted)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">bool</span> ActivatedAbility = ActorInfo-&gt;AbilitySystemComponent-&gt;<span class="built_in">TryActivateAbility</span>(Spec.Handle, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Epicæè¿°è¯¥å‡½æ•°ä¸ºåˆå§‹åŒ–è¢«åŠ¨Abilityçš„æ­£ç¡®ä½ç½®å’Œåº”è¯¥åšä¸€äº›ç±»ä¼¼<code>BeginPlay</code>çš„äº‹æƒ….  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-cancelabilities"></a></p><h4 id="4-6-5-å–æ¶ˆAbility"><a href="#4-6-5-å–æ¶ˆAbility" class="headerlink" title="4.6.5 å–æ¶ˆAbility"></a>4.6.5 å–æ¶ˆAbility</h4><p>ä¸ºäº†ä»å†…éƒ¨å–æ¶ˆ<code>GameplayAbility</code>, å¯ä»¥è°ƒç”¨<code>CancelAbility()</code>, å…¶ä¼šè°ƒç”¨<code>EndAbility()</code>å¹¶è®¾ç½®å®ƒçš„<code>WasCancelled</code>å‚æ•°ä¸º<code>true</code>.  </p><p>ä¸ºäº†ä»å¤–éƒ¨å–æ¶ˆ<code>GameplayAbility</code>, <code>ASC</code>æä¾›äº†ä¸€äº›å‡½æ•°:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Cancels the specified ability CDO. */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CancelAbility</span><span class="params">(UGameplayAbility* Ability)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Cancels the ability indicated by passed in spec handle. If handle is not found among reactivated abilities nothing happens. */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CancelAbilityHandle</span><span class="params">(<span class="type">const</span> FGameplayAbilitySpecHandle&amp; AbilityHandle)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Cancel all abilities with the specified tags. Will not cancel the Ignore instance */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CancelAbilities</span><span class="params">(<span class="type">const</span> FGameplayTagContainer* WithTags=<span class="literal">nullptr</span>, <span class="type">const</span> FGameplayTagContainer* WithoutTags=<span class="literal">nullptr</span>, UGameplayAbility* Ignore=<span class="literal">nullptr</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Cancels all abilities regardless of tags. Will not cancel the ignore instance */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CancelAllAbilities</span><span class="params">(UGameplayAbility* Ignore=<span class="literal">nullptr</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Cancels all abilities and kills any remaining instanced abilities */</span></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">DestroyActiveState</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p><strong>Note:</strong> æˆ‘å‘ç°å¦‚æœå­˜åœ¨ä¸€ä¸ª<code>éå®ä¾‹(Non-Instanced)GameplayAbility</code>æ—¶, <code>CancelAllAbilities</code>ä¼¼ä¹ä¸èƒ½æ­£å¸¸è¿è¡Œ, å®ƒä¼¼ä¹ä¼šå‘½ä¸­è¿™ä¸ª<code>éå®ä¾‹(Non-Instanced)GameplayAbility</code>å¹¶æ”¾å¼ƒç»§ç»­å¤„ç†. <code>CancelAbility</code>å¯ä»¥æ›´å¥½åœ°å¤„ç†<code>éå®ä¾‹(Non-Instanced)GameplayAbility</code>, æ ·ä¾‹é¡¹ç›®å°±æ˜¯è¿™æ ·ä½¿ç”¨çš„(è·³è·ƒæ˜¯ä¸€ä¸ªéå®ä¾‹(Non-Instanced)GameplayAbility), å› äººè€Œå¼‚.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-definition-activeability"></a></p><h4 id="4-6-6-è·å–æ¿€æ´»çš„Ability"><a href="#4-6-6-è·å–æ¿€æ´»çš„Ability" class="headerlink" title="4.6.6 è·å–æ¿€æ´»çš„Ability"></a>4.6.6 è·å–æ¿€æ´»çš„Ability</h4><p>åˆå­¦è€…ç»å¸¸ä¼šé—®â€æˆ‘æ€æ ·æ‰èƒ½è·å–æ¿€æ´»çš„Ability?â€, ä¹Ÿè®¸æ˜¯ç”¨æ¥è®¾ç½®å˜é‡æˆ–å–æ¶ˆå®ƒ. å¤šä¸ª<code>GameplayAbility</code>å¯ä»¥åœ¨åŒä¸€æ—¶åˆ»æ¿€æ´», å› æ­¤æ²¡æœ‰â€ä¸€ä¸ªæ¿€æ´»çš„Abilityâ€, ç›¸å, ä½ å¿…é¡»æœç´¢<code>ASC</code>çš„<code>ActivatableAbility</code>åˆ—è¡¨(<code>ASC</code>æ‹¥æœ‰çš„å·²æˆäºˆ<code>GameplayAbility</code>)å¹¶æ‰¾åˆ°ä¸€ä¸ªä¸ä½ æ­£åœ¨å¯»æ‰¾çš„<a href="#concepts-ga-tags">èµ„æºæˆ–æˆäºˆçš„GameplayTag</a>ç›¸åŒ¹é…çš„Ability.  </p><p><code>UAbilitySystemComponent::GetActivatableAbilities()</code>ä¼šè¿”å›ä¸€ä¸ªç”¨äºéå†çš„<code>TArray&lt;FGameplayAbilitySpec&gt;</code>.  </p><p><code>ASC</code>è¿˜æœ‰å¦ä¸€ä¸ªæœ‰ç”¨çš„å‡½æ•°, å®ƒå°†ä¸€ä¸ª<code>GameplayTagContainer</code>ä½œä¸ºå‚æ•°æ¥ååŠ©æœç´¢, è€Œæ— éœ€æ‰‹åŠ¨éå†<code>GameplayAbilitySpec</code>åˆ—è¡¨. <code>bOnlyAbilitiesThatSatisfyTagRequirements</code>å‚æ•°åªä¼šè¿”å›é‚£äº›<code>GameplayTag</code>æ»¡è¶³éœ€æ±‚ä¸”å¯ä»¥ç«‹åˆ»æ¿€æ´»çš„<code>GameplayAbilitySpecs</code>, ä¾‹å¦‚, ä½ å¯èƒ½æœ‰ä¸¤ä¸ªåŸºæœ¬çš„æ”»å‡»<code>GameplayAbility</code>, ä¸€ä¸ªä½¿ç”¨æ­¦å™¨, å¦ä¸€ä¸ªä½¿ç”¨æ‹³å¤´, æ­£ç¡®çš„æ¿€æ´»å–å†³äºæ­¦å™¨æ˜¯å¦è£…å¤‡å¹¶è®¾ç½®äº†<code>GameplayTag</code>éœ€æ±‚. è¯¦è§Epicå…³äºå‡½æ•°çš„æ³¨é‡Š.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UAbilitySystemComponent::<span class="built_in">GetActivatableGameplayAbilitySpecsByAllMatchingTags</span>(<span class="type">const</span> FGameplayTagContainer&amp; GameplayTagContainer, TArray &lt; <span class="keyword">struct</span> FGameplayAbilitySpec* &gt;&amp; MatchingGameplayAbilities, <span class="type">bool</span> bOnlyAbilitiesThatSatisfyTagRequirements = <span class="literal">true</span>)</span><br></pre></td></tr></table></figure><p>ä¸€æ—¦ä½ è·å–åˆ°äº†å¯»æ‰¾çš„<code>FGameplayAbilitySpec</code>, é‚£ä¹ˆå°±å¯ä»¥è°ƒç”¨å®ƒçš„<code>IsActive()</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-instancing"></a></p><h4 id="4-6-7-å®ä¾‹åŒ–ç­–ç•¥"><a href="#4-6-7-å®ä¾‹åŒ–ç­–ç•¥" class="headerlink" title="4.6.7 å®ä¾‹åŒ–ç­–ç•¥"></a>4.6.7 å®ä¾‹åŒ–ç­–ç•¥</h4><p><code>GameplayAbility</code>çš„å®ä¾‹åŒ–ç­–ç•¥å†³å®šäº†å½“<code>GameplayAbility</code>æ¿€æ´»æ—¶æ˜¯å¦å’Œå¦‚ä½•å®ä¾‹åŒ–.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">å®ä¾‹åŒ–ç­–ç•¥</th><th style="text-align:center">æè¿°</th><th style="text-align:center">ä½•æ—¶ä½¿ç”¨çš„ä¾‹å­</th></tr></thead><tbody><tr><td style="text-align:center">æŒ‰Actorå®ä¾‹åŒ–(Instanced Per Actor)</td><td style="text-align:center">æ¯ä¸ª<code>ASC</code>åªèƒ½æœ‰ä¸€ä¸ªåœ¨æ¿€æ´»ä¹‹é—´å¤ç”¨çš„<code>GameplayAbility</code>å®ä¾‹.</td><td style="text-align:center">è¿™å¯èƒ½æ˜¯ä½ ä½¿ç”¨æœ€é¢‘ç¹çš„å®ä¾‹åŒ–ç­–ç•¥. ä½ å¯ä»¥å¯¹ä»»ä¸€<code>Ability</code>ä½¿ç”¨å¹¶åœ¨æ¿€æ´»ä¹‹é—´æä¾›æŒä¹…åŒ–. è®¾è®¡è€…å¯ä»¥åœ¨æ¿€æ´»ä¹‹é—´æ‰‹åŠ¨é‡è®¾ä»»æ„å˜é‡.</td></tr><tr><td style="text-align:center">æŒ‰æ“ä½œå®ä¾‹åŒ–(Instanced Per Execution)</td><td style="text-align:center">æ¯æœ‰ä¸€ä¸ª<code>GameplayAbility</code>æ¿€æ´», å°±æœ‰ä¸€ä¸ªæ–°çš„<code>GameplayAbility</code>å®ä¾‹åˆ›å»º.</td><td style="text-align:center">è¿™äº›<code>GameplayAbility</code>çš„å¥½å¤„æ˜¯æ¯æ¬¡æ¿€æ´»æ—¶å˜é‡éƒ½ä¼šé‡ç½®, å…¶æ€§èƒ½è¦æ¯”<code>Instanced Per Actor</code>å·®, å› ä¸ºæ¯æ¬¡æ¿€æ´»æ—¶éƒ½ä¼šç”Ÿæˆæ–°çš„<code>GameplayAbility</code>. æ ·ä¾‹é¡¹ç›®æ²¡æœ‰ä½¿ç”¨è¯¥æ–¹å¼.</td></tr><tr><td style="text-align:center">éå®ä¾‹åŒ–(Non-Instanced)</td><td style="text-align:center"><code>GameplayAbility</code>æ“ä½œå…¶<code>ClassDefaultObject</code>, æ²¡æœ‰å®ä¾‹åˆ›å»º.</td><td style="text-align:center">å®ƒæ˜¯ä¸‰ç§æ–¹å¼ä¸­æ€§èƒ½æœ€å¥½çš„, ä½†æ˜¯ä½¿ç”¨å®ƒæ˜¯æœ€å—é™åˆ¶çš„. <code>éå®ä¾‹åŒ–(Non-Instanced)GameplayAbility</code>ä¸èƒ½å­˜å‚¨çŠ¶æ€, è¿™æ„å‘³ç€æ²¡æœ‰åŠ¨æ€å˜é‡å’Œä¸èƒ½ç»‘å®šåˆ°<code>AbilityTask</code>å§”æ‰˜. ä½¿ç”¨å®ƒçš„æœ€ä½³åœºæ™¯å°±æ˜¯éœ€è¦é¢‘ç¹ä½¿ç”¨çš„ç®€å•Ability, åƒMOBAæˆ–RTSæ¸¸æˆä¸­å°å…µçš„åŸºç¡€æ”»å‡». æ ·ä¾‹é¡¹ç›®ä¸­çš„è·³è·ƒ<code>GameplayAbility</code>å°±æ˜¯<code>éå®ä¾‹åŒ–(Non-Instanced)</code>çš„.</td></tr></tbody></table></div><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-net"></a></p><h4 id="4-6-8-ç½‘ç»œæ‰§è¡Œç­–ç•¥-Net-Execution-Policy"><a href="#4-6-8-ç½‘ç»œæ‰§è¡Œç­–ç•¥-Net-Execution-Policy" class="headerlink" title="4.6.8 ç½‘ç»œæ‰§è¡Œç­–ç•¥(Net Execution Policy)"></a>4.6.8 ç½‘ç»œæ‰§è¡Œç­–ç•¥(Net Execution Policy)</h4><p><code>GameplayAbility</code>çš„<code>ç½‘ç»œæ‰§è¡Œç­–ç•¥(Net Execution Policy)</code>å†³å®šäº†è°è¯¥ä»¥ä»€ä¹ˆé¡ºåºè¿è¡Œè¯¥<code>GameplayAbility</code>.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">ç½‘ç»œæ‰§è¡Œç­–ç•¥(Net Execution Policy)</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">Local Only</td><td style="text-align:center"><code>GameplayAbility</code>åªè¿è¡Œåœ¨æ‰€å±(Owning)å®¢æˆ·ç«¯. è¿™å¯¹é‚£äº›åªéœ€åšæœ¬åœ°è§†è§‰å˜åŒ–çš„Abilityå¾ˆæœ‰ç”¨. å•äººæ¸¸æˆåº”è¯¥ä½¿ç”¨<code>Server Only</code>.</td></tr><tr><td style="text-align:center">Local Predicted</td><td style="text-align:center"><code>Local Predicted GameplayAbility</code>é¦–å…ˆåœ¨æ‰€å±(Owning)å®¢æˆ·ç«¯æ¿€æ´», ä¹‹ååœ¨æœåŠ¡ç«¯æ¿€æ´». æœåŠ¡ç«¯ç‰ˆæœ¬ä¼šçº æ­£å®¢æˆ·ç«¯é¢„æµ‹çš„æ‰€æœ‰ä¸æ­£ç¡®çš„åœ°æ–¹. å‚è§Prediction.</td></tr><tr><td style="text-align:center">Server Only</td><td style="text-align:center"><code>GameplayAbility</code>åªè¿è¡Œåœ¨æœåŠ¡ç«¯. è¢«åŠ¨<code>GameplayAbility</code>ä¸€èˆ¬æ˜¯<code>Server Only</code>. å•äººæ¸¸æˆåº”è¯¥ä½¿ç”¨è¯¥é¡¹.</td></tr><tr><td style="text-align:center">Server Initiated</td><td style="text-align:center"><code>Server Initiated GameplayAbility</code>é¦–å…ˆåœ¨æœåŠ¡ç«¯æ¿€æ´», ä¹‹ååœ¨æ‰€å±(Owning)å®¢æˆ·ç«¯æ¿€æ´». æˆ‘ä¸ªäººä½¿ç”¨çš„ä¸å¤š(å¦‚æœæœ‰çš„è¯).</td></tr></tbody></table></div><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-tags"></a></p><h4 id="4-6-9-Abilityæ ‡ç­¾"><a href="#4-6-9-Abilityæ ‡ç­¾" class="headerlink" title="4.6.9 Abilityæ ‡ç­¾"></a>4.6.9 Abilityæ ‡ç­¾</h4><p><code>GameplayAbility</code>è‡ªå¸¦æœ‰å†…å»ºé€»è¾‘çš„<code>GameplayTagContainer</code>. è¿™äº›<code>GameplayTag</code>éƒ½ä¸è¿›è¡ŒåŒæ­¥.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">GameplayTagContainer</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">Ability Tags</td><td style="text-align:center"><code>GameplayAbility</code>æ‹¥æœ‰çš„<code>GameplayTag</code>, è¿™åªæ˜¯ç”¨æ¥æè¿°<code>GameplayAbility</code>çš„<code>GameplayTag</code>.</td></tr><tr><td style="text-align:center">Cancel Abilities with Tag</td><td style="text-align:center">å½“è¯¥<code>GameplayAbility</code>æ¿€æ´»æ—¶, å…¶ä»–<code>Ability Tags</code>ä¸­æ‹¥æœ‰è¿™äº›<code>GameplayTag</code>çš„<code>GameplayAbility</code>å°†ä¼šè¢«å–æ¶ˆ.</td></tr><tr><td style="text-align:center">Block Abilities with Tag</td><td style="text-align:center">å½“è¯¥<code>GameplayAbility</code>æ¿€æ´»æ—¶, å…¶ä»–<code>Ability Tags</code>ä¸­æ‹¥æœ‰è¿™äº›<code>GameplayTag</code>çš„<code>GameplayAbility</code>å°†ä¼šé˜»å¡æ¿€æ´».</td></tr><tr><td style="text-align:center">Activation Owned Tags</td><td style="text-align:center">å½“è¯¥<code>GameplayAbility</code>æ¿€æ´»æ—¶, è¿™äº›<code>GameplayTag</code>ä¼šäº¤ç»™è¯¥<code>GameplayAbility</code>çš„æ‹¥æœ‰è€….</td></tr><tr><td style="text-align:center">Activation Required Tags</td><td style="text-align:center">è¯¥<code>GameplayAbility</code>åªæœ‰åœ¨å…¶æ‹¥æœ‰è€…æ‹¥æœ‰æ‰€æœ‰è¿™äº›<code>GameplayTag</code>æ—¶æ‰ä¼šæ¿€æ´».</td></tr><tr><td style="text-align:center">Activation Blocked Tags</td><td style="text-align:center">è¯¥<code>GameplayAbility</code>åœ¨å…¶æ‹¥æœ‰è€…æ‹¥æœ‰ä»»æ„è¿™äº›æ ‡ç­¾æ—¶ä¸èƒ½è¢«æ¿€æ´».</td></tr><tr><td style="text-align:center">Source Required Tags</td><td style="text-align:center">è¯¥<code>GameplayAbility</code>åªæœ‰åœ¨<code>Source</code>æ‹¥æœ‰æ‰€æœ‰è¿™äº›<code>GameplayTag</code>æ—¶æ‰ä¼šæ¿€æ´». <code>Source GameplayTag</code>åªæœ‰åœ¨è¯¥<code>GameplayAbility</code>ç”±Eventè§¦å‘æ—¶è®¾ç½®.</td></tr><tr><td style="text-align:center">Source Blocked Tags</td><td style="text-align:center">è¯¥<code>GameplayAbility</code>åœ¨<code>Source</code>æ‹¥æœ‰ä»»æ„è¿™äº›æ ‡ç­¾æ—¶ä¸èƒ½è¢«æ¿€æ´». <code>Source GameplayTag</code>åªæœ‰åœ¨è¯¥<code>GameplayAbility</code>ç”±Eventè§¦å‘æ—¶è®¾ç½®.</td></tr><tr><td style="text-align:center">Target Required Tags</td><td style="text-align:center">è¯¥<code>GameplayAbility</code>åªæœ‰åœ¨<code>Target</code>æ‹¥æœ‰æ‰€æœ‰è¿™äº›<code>GameplayTag</code>æ—¶æ‰ä¼šæ¿€æ´». <code>Target GameplayTag</code>åªæœ‰åœ¨è¯¥<code>GameplayAbility</code>ç”±Eventè§¦å‘æ—¶è®¾ç½®.</td></tr><tr><td style="text-align:center">Target Blocked Tags</td><td style="text-align:center">è¯¥<code>GameplayAbility</code>åœ¨<code>Target</code>æ‹¥æœ‰ä»»æ„è¿™äº›æ ‡ç­¾æ—¶ä¸èƒ½è¢«æ¿€æ´». <code>Target GameplayTag</code>åªæœ‰åœ¨è¯¥<code>GameplayAbility</code>ç”±Eventè§¦å‘æ—¶è®¾ç½®.</td></tr></tbody></table></div><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-spec"></a></p><h4 id="4-6-10-Gameplay-Ability-Spec"><a href="#4-6-10-Gameplay-Ability-Spec" class="headerlink" title="4.6.10 Gameplay Ability Spec"></a>4.6.10 Gameplay Ability Spec</h4><p><code>GameplayAbilitySpec</code>ä¼šåœ¨<code>GameplayAbility</code>æˆäºˆåå­˜åœ¨äº<code>ASC</code>ä¸­å¹¶å®šä¹‰å¯æ¿€æ´»<code>GameplayAbility</code> - <code>GameplayAbility</code>ç±», ç­‰çº§, è¾“å…¥ç»‘å®šå’Œå¿…é¡»ä¸<code>GameplayAbility</code>ç±»åˆ†å¼€ä¿å­˜çš„è¿è¡Œæ—¶çŠ¶æ€.  </p><p>å½“<code>GameplayAbility</code>åœ¨æœåŠ¡ç«¯æˆäºˆæ—¶, æœåŠ¡ç«¯ä¼šåŒæ­¥<code>GameplayAbilitySpec</code>åˆ°æ‰€å±(Owning)å®¢æˆ·ç«¯, å› æ­¤å¯ä»¥æ¿€æ´»å®ƒ.  </p><p>æ¿€æ´»<code>GameplayAbilitySpec</code>ä¼šæ ¹æ®å®ƒçš„<code>å®ä¾‹åŒ–ç­–ç•¥(Instancing Policy)</code>åˆ›å»ºä¸€ä¸ª<code>GameplayAbility</code>å®ä¾‹(<code>Non-Instanced GameplayAbility</code>é™¤å¤–).  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-data"></a></p><h4 id="4-6-11-ä¼ é€’æ•°æ®åˆ°Ability"><a href="#4-6-11-ä¼ é€’æ•°æ®åˆ°Ability" class="headerlink" title="4.6.11 ä¼ é€’æ•°æ®åˆ°Ability"></a>4.6.11 ä¼ é€’æ•°æ®åˆ°Ability</h4><p><code>GameplayAbility</code>çš„ä¸€èˆ¬èŒƒå¼æ˜¯<code>Activate-&gt;Generate Data-&gt;Apply-&gt;End</code>. æœ‰æ—¶ä½ éœ€è¦è°ƒæ•´ç°æœ‰æ•°æ®, GASæä¾›äº†ä¸€äº›é€‰é¡¹æ¥è·å–å¤–éƒ¨æ•°æ®åˆ°ä½ çš„<code>GameplayAbility</code>.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">é€šè¿‡Eventæ¿€æ´»<code>GameplayAbility</code></td><td style="text-align:center">ä½¿ç”¨å«æœ‰æ•°æ®è´Ÿè½½(Payload)çš„Eventæ¿€æ´»<code>GameplayAbility</code>. å¯¹äºå®¢æˆ·ç«¯é¢„æµ‹çš„<code>GameplayAbility</code>, Eventçš„è´Ÿè½½(Payload)æ˜¯ç”±å®¢æˆ·ç«¯åŒæ­¥åˆ°æœåŠ¡ç«¯çš„. å¯¹äºé‚£äº›ä¸é€‚åˆä»»æ„ç°æœ‰å˜é‡çš„æ•°æ®å¯ä»¥ä½¿ç”¨ä¸¤ä¸ª<code>Optional Object</code>æˆ–<a href="#concepts-targeting-data">TargetData</a>å˜é‡. è¯¥æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ä¸èƒ½ä½¿ç”¨è¾“å…¥ç»‘å®šæ¿€æ´»Ability. ä¸ºäº†é€šè¿‡Eventæ¿€æ´»<code>GameplayAbility</code>, è¯¥<code>GameplayAbility</code>å¿…é¡»è®¾ç½®å…¶Trigger, åˆ†é…ä¸€ä¸ª<code>GameplayTag</code>å¹¶é€‰æ‹©ä¸€ä¸ª<code>GameplayEvent</code>é€‰é¡¹. æƒ³è¦å‘é€äº‹ä»¶, å°±å¾—ä½¿ç”¨<code>UAbilitySystemBlueprintLibrary::SendGameplayEventToActor(AActor* Actor, FGameplayTag EventTag, FGameplayEventData Payload)</code>å‡½æ•°.</td></tr><tr><td style="text-align:center">ä½¿ç”¨<code>WaitGameplayEvent AbilityTask</code></td><td style="text-align:center">åœ¨<code>GameplayAbility</code>æ¿€æ´»å, ä½¿ç”¨<code>WaitGameplayEvent AbilityTask</code>æ¥å‘ŠçŸ¥å…¶ç›‘å¬å¸¦æœ‰è´Ÿè½½(Payload)çš„äº‹ä»¶. Eventè´Ÿè½½(Payload)åŠå…¶å‘é€è¿‡ç¨‹ä¸é€šè¿‡Eventæ¿€æ´»<code>GameplayAbility</code>æ˜¯ä¸€æ ·çš„. è¯¥æ–¹æ³•çš„ç¼ºç‚¹æ˜¯Eventä¸èƒ½é€šè¿‡<code>AbilityTask</code>åŒæ­¥ä¸”åªèƒ½ç”¨äº<code>Local Only</code>å’Œ<code>Server Only</code>çš„<code>GameplayAbility</code>. ä½ å¯ä»¥ç¼–å†™è‡ªå·±çš„<code>AbilityTask</code>ä»¥æ”¯æŒåŒæ­¥Eventè´Ÿè½½(Payload).</td></tr><tr><td style="text-align:center">ä½¿ç”¨<code>TargetData</code></td><td style="text-align:center">è‡ªå®šä¹‰<code>TargetData</code>ç»“æ„ä½“æ˜¯ä¸€ç§åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¼ é€’ä»»æ„æ•°æ®çš„å¥½æ–¹æ³•.</td></tr><tr><td style="text-align:center">ä¿å­˜æ•°æ®åœ¨<code>OwnerActor</code>æˆ–è€…<code>AvatarActor</code></td><td style="text-align:center">ä½¿ç”¨ä¿å­˜äº<code>OwnerActor</code>, <code>AvatarActor</code>æˆ–è€…å…¶ä»–ä»»æ„ä½ å¯ä»¥è·å–åˆ°å¼•ç”¨çš„å¯¹è±¡ä¸­çš„å¯åŒæ­¥å˜é‡. è¿™ç§æ–¹æ³•æœ€çµæ´»ä¸”å¯ä»¥ç”¨äºç”±è¾“å…¥ç»‘å®šæ¿€æ´»çš„<code>GameplayAbility</code>, ç„¶è€Œ, å®ƒä¸èƒ½ä¿è¯åœ¨ä½¿ç”¨æ—¶æ•°æ®åŒæ­¥, ä½ å¿…é¡»æå‰åšå¥½å‡†å¤‡ - è¿™æ„å‘³ç€å¦‚æœä½ è®¾ç½®äº†ä¸€ä¸ªå¯åŒæ­¥çš„å˜é‡, ä¹‹åç«‹å³æ¿€æ´»è¯¥<code>GameplayAbility</code>, é‚£ä¹ˆå› ä¸ºå­˜åœ¨æ½œåœ¨çš„ä¸¢åŒ…æƒ…å†µ, ä¸èƒ½ä¿è¯æ¥æ”¶è€…ä¸Šå‘ç”Ÿçš„é¡ºåº.</td></tr></tbody></table></div><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-commit"></a></p><h4 id="4-6-12-AbilityèŠ±è´¹-Cost-å’Œå†·å´-Cooldown"><a href="#4-6-12-AbilityèŠ±è´¹-Cost-å’Œå†·å´-Cooldown" class="headerlink" title="4.6.12 AbilityèŠ±è´¹(Cost)å’Œå†·å´(Cooldown)"></a>4.6.12 AbilityèŠ±è´¹(Cost)å’Œå†·å´(Cooldown)</h4><p><code>GameplayAbility</code>é»˜è®¤å¸¦æœ‰å¯¹å¯é€‰Costå’ŒCooldownçš„åŠŸèƒ½. Costæ˜¯<code>ASC</code>ä¸ºäº†æ¿€æ´»ä½¿ç”¨<code>å³åˆ»(Instant)GameplayEffect</code>(<a href="#concepts-ge-cost">Cost GE</a>)å®ç°çš„GameplayAbilityæ‰€å¿…é¡»å…·æœ‰çš„é¢„å…ˆå®šä¹‰çš„å¤§é‡Attribute. Cooldownæ˜¯ç”¨äºé˜»æ­¢<code>GameplayAbility</code>å†æ¬¡æ¿€æ´»(ç›´åˆ°å†·å´å®Œæˆ)çš„è®¡æ—¶å™¨, å…¶ç”±<code>æŒç»­(Duration)GameplayEffect</code>(<a href="#concepts-ge-cooldown">Cooldown GE</a>)å®ç°.  </p><p>åœ¨<code>GameplayAbility</code>è°ƒç”¨<code>UGameplayAbility::Activate()</code>ä¹‹å‰, å…¶ä¼šè°ƒç”¨<code>UGameplayAbility::CanActivateAbility()</code>, è¯¥å‡½æ•°ä¼šæ£€æŸ¥æ‰€å±<code>ASC</code>æ˜¯å¦æ»¡è¶³Cost(<code>UGameplayAbility::CheckCost()</code>)å¹¶ç¡®ä¿è¯¥<code>GameplayAbility</code>ä¸åœ¨å†·å´æœŸ(<code>UGameplayAbility::CheckCooldown()</code>).  </p><p>åœ¨<code>GameplayAbility</code>è°ƒç”¨<code>Activate()</code>ä¹‹å, å…¶å¯ä»¥é€‰æ‹©æ€§ä½¿ç”¨<code>UGameplayAbility::CommitAbility()</code>éšæ—¶æäº¤Costå’ŒCooldown, <code>UGameplayAbility::CommitAbility()</code>ä¼šè°ƒç”¨<code>UGameplayAbility::CommitCost()</code>å’Œ<code>UGameplayAbility::CommitCooldown()</code>, å¦‚æœå®ƒä»¬ä¸éœ€è¦åŒæ—¶æäº¤, è®¾è®¡å¸ˆå¯ä»¥é€‰æ‹©åˆ†åˆ«è°ƒç”¨<code>CommitCost()</code>æˆ–<code>CommitCooldown()</code>. æäº¤Costå’ŒCooldownä¼šå¤šæ¬¡è°ƒç”¨<code>CheckCost()</code>å’Œ<code>CheckCooldown()</code>. æ‰€å±(Owning)<code>ASC</code>çš„Attributeåœ¨<code>GameplayAbility</code>æ¿€æ´»åå¯èƒ½æ”¹å˜, ä»è€Œå¯¼è‡´æäº¤æ—¶æ— æ³•æ»¡è¶³Cost. å¦‚æœ<a href="#concepts-p-key">prediction key</a>åœ¨æäº¤æ—¶æœ‰æ•ˆçš„è¯, æäº¤Costå’ŒCooldownæ˜¯å¯ä»¥<a href="#concepts-p">å®¢æˆ·ç«¯é¢„æµ‹</a>çš„.  </p><p>è¯¦è§<a href="#concepts-ge-cost">CostGE</a>å’Œ<a href="#concepts-ge-cooldown">CooldownGE</a>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-leveling"></a></p><h4 id="4-6-13-å‡çº§Ability"><a href="#4-6-13-å‡çº§Ability" class="headerlink" title="4.6.13 å‡çº§Ability"></a>4.6.13 å‡çº§Ability</h4><p>æœ‰ä¸¤ä¸ªå¸¸è§çš„æ–¹æ³•ç”¨äºå‡çº§Ability:  </p><div class="table-container"><table><thead><tr><th style="text-align:center">å‡çº§æ–¹æ³•</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">å‡çº§æ—¶å–æ¶ˆæˆäºˆå’Œé‡æ–°æˆäºˆ</td><td style="text-align:center">è‡ª<code>ASC</code>å–æ¶ˆæˆäºˆ(ç§»é™¤)<code>GameplayAbility</code>, å¹¶åœ¨ä¸‹ä¸€ç­‰çº§äºæœåŠ¡ç«¯ä¸Šé‡æ–°æˆäºˆ. å¦‚æœæ­¤æ—¶<code>GameplayAbility</code>æ˜¯æ¿€æ´»çš„, é‚£ä¹ˆå°±ä¼šç»ˆæ­¢å®ƒ.</td></tr><tr><td style="text-align:center">å¢åŠ <code>GameplayAbilitySpec</code>çš„ç­‰çº§</td><td style="text-align:center">åœ¨æœåŠ¡ç«¯ä¸Šæ‰¾åˆ°<code>GameplayAbilitySpec</code>, å¢åŠ å®ƒçš„ç­‰çº§, å¹¶å°†å…¶æ ‡è®°ä¸ºDirtyä»¥åŒæ­¥åˆ°æ‰€å±(Owning)å®¢æˆ·ç«¯. è¯¥æ–¹æ³•ä¸ä¼šåœ¨<code>GameplayAbility</code>æ¿€æ´»æ—¶å°†å…¶ç»ˆæ­¢.</td></tr></tbody></table></div><p>ä¸¤ç§æ–¹æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºä½ æ˜¯å¦æƒ³è¦åœ¨å‡çº§æ—¶å–æ¶ˆæ¿€æ´»çš„<code>GameplayAbility</code>. åŸºäºä½ çš„<code>GameplayAbility</code>, ä½ å¾ˆå¯èƒ½éœ€è¦åŒæ—¶ä½¿ç”¨ä¸¤ç§æ–¹æ³•. æˆ‘å»ºè®®åœ¨<code>UGameplayAbility</code>å­ç±»ä¸­å¢åŠ ä¸€ä¸ªå¸ƒå°”å€¼ä»¥æ˜ç¡®ä½¿ç”¨å“ªç§æ–¹æ³•.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-sets"></a></p><h4 id="4-6-14-Abilityé›†åˆ"><a href="#4-6-14-Abilityé›†åˆ" class="headerlink" title="4.6.14 Abilityé›†åˆ"></a>4.6.14 Abilityé›†åˆ</h4><p><code>GameplayAbilitySet</code>æ˜¯å¾ˆæ–¹ä¾¿çš„<code>UDataAsset</code>ç±», å…¶ç”¨äºä¿å­˜è¾“å…¥ç»‘å®šå’Œåˆå§‹<code>GameplayAbility</code>åˆ—è¡¨, è¯¥<code>GameplayAbility</code>åˆ—è¡¨ç”¨äºæ‹¥æœ‰æˆäºˆ<code>GameplayAbility</code>é€»è¾‘çš„Character. å­ç±»ä¹Ÿå¯ä»¥åŒ…å«é¢å¤–çš„é€»è¾‘å’Œå±æ€§. Paragonä¸­çš„æ¯ä¸ªè‹±é›„éƒ½æ‹¥æœ‰ä¸€ä¸ª<code>GameplayAbilitySet</code>ä»¥åŒ…å«å…¶æˆäºˆçš„æ‰€æœ‰<code>GameplayAbility</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-batching"></a></p><h4 id="4-6-15-Abilityæ‰¹å¤„ç†"><a href="#4-6-15-Abilityæ‰¹å¤„ç†" class="headerlink" title="4.6.15 Abilityæ‰¹å¤„ç†"></a>4.6.15 Abilityæ‰¹å¤„ç†</h4><p>ä¸€èˆ¬<code>GameplayAbility</code>çš„ç”Ÿå‘½å‘¨æœŸæœ€å°‘æ¶‰åŠ2åˆ°3ä¸ªè‡ªå®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„RPC.  </p><ol><li>CallServerTryActivateAbility()</li><li>ServerSetReplicatedTargetData() (å¯é€‰)</li><li>ServerEndAbility()</li></ol><p>å¦‚æœ<code>GameplayAbility</code>åœ¨ä¸€å¸§åŒä¸€åŸå­(Atomic)ç»„ä¸­æ‰§è¡Œè¿™äº›æ“ä½œ, æˆ‘ä»¬å°±å¯ä»¥ä¼˜åŒ–è¯¥å·¥ä½œæµ, å°†æ‰€æœ‰2ä¸ªæˆ–3ä¸ªRPCæ‰¹å¤„ç†(æ•´åˆ)ä¸º1ä¸ªRPC. <code>GAS</code>ç§°è¿™ç§RPCä¼˜åŒ–ä¸º<code>Abilityæ‰¹å¤„ç†</code>. å¸¸è§çš„ä½¿ç”¨<code>Abilityæ‰¹å¤„ç†</code>æ—¶æœºçš„ä¾‹å­æ˜¯æªæ”¯å‘½ä¸­åˆ¤æ–­. æªæ”¯å‘½ä¸­åˆ¤æ–­æ—¶, ä¼šåœ¨ä¸€å¸§åŒä¸€åŸå­(Atomic)ç»„ä¸­åšå°„çº¿æ£€æµ‹, å‘é€<a href="#concepts-targeting-data">TargetData</a>åˆ°æœåŠ¡ç«¯å¹¶ç»“æŸAbility. GASShooteræ ·ä¾‹é¡¹ç›®å¯¹å…¶æªæ”¯å‘½ä¸­åˆ¤æ–­ä½¿ç”¨äº†è¯¥æŠ€æœ¯.  </p><p>åŠè‡ªåŠ¨æªæ”¯æ˜¯æœ€å¥½çš„æ¡ˆä¾‹, å…¶å°†<code>CallServerTryActivateAbility()</code>, <code>ServerSetReplicatedTargetData()</code>(å­å¼¹å‘½ä¸­ç»“æœ)å’Œ<code>ServerEndAbility()</code>æ‰¹å¤„ç†æˆä¸€ä¸ªè€Œä¸æ˜¯ä¸‰ä¸ª<code>RPC</code>.  </p><p>å…¨è‡ªåŠ¨/çˆ†ç‚¸å¼€ç«æªæ”¯ä¼šå¯¹ç¬¬ä¸€å‘å­å¼¹å°†<code>CallServerTryActivateAbility()</code>å’Œ<code>ServerSetReplicatedTargetData()</code>æ‰¹å¤„ç†æˆä¸€ä¸ªè€Œä¸æ˜¯ä¸¤ä¸ªRPC, æ¥ä¸‹æ¥çš„æ¯ä¸€å‘å­å¼¹éƒ½æ˜¯å®ƒè‡ªå·±çš„<code>ServerSetReplicatedTargetData()</code>RPC, æœ€å, å½“åœæ­¢å°„å‡»æ—¶, <code>ServerEndAbility()</code>ä¼šä½œä¸ºå•ç‹¬çš„RPCå‘é€. è¿™æ˜¯æœ€åçš„æƒ…å†µ, æˆ‘ä»¬åªä¿å­˜äº†ç¬¬ä¸€å‘å­å¼¹çš„ä¸€ä¸ªRPCè€Œä¸æ˜¯ä¸¤ä¸ª. è¿™ç§æƒ…å†µä¹Ÿå¯ä»¥é€šè¿‡<a href="#concepts-ga-data">GameplayEvent</a>æ¿€æ´»Abilityæ¥å®ç°, è¯¥<code>GameplayEvent</code>ä¼šè‡ªå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¸¦æœ‰<code>EventPayload</code>çš„å­å¼¹<code>TargetData</code>. åè€…çš„ç¼ºç‚¹æ˜¯<code>TargetData</code>å¿…é¡»åœ¨Abilityå¤–éƒ¨ç”Ÿæˆ, å°½ç®¡æ‰¹å¤„ç†æ–¹æ³•åœ¨Abilityå†…éƒ¨ç”Ÿæˆ<code>TargetData</code>.  </p><p>Abilityæ‰¹å¤„ç†åœ¨<a href="#concepts-asc">ASC</a>ä¸­æ˜¯é»˜è®¤ç¦æ­¢çš„. ä¸ºäº†å¯ç”¨Abilityæ‰¹å¤„ç†, éœ€è¦é‡å†™<code>ShouldDoServerAbilityRPCBatch()</code>ä»¥è¿”å›true:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">ShouldDoServerAbilityRPCBatch</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span> </span>&#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨Abilityæ‰¹å¤„ç†å·²ç»å¯ç”¨, åœ¨æ¿€æ´»ä½ æƒ³ä½¿ç”¨æ‰¹å¤„ç†çš„Abilityä¹‹å‰, å¿…é¡»æå‰åˆ›å»ºä¸€ä¸ª<code>FScopedServerAbilityRPCBatcher</code>ç»“æ„ä½“, è¿™ä¸ªç‰¹æ®Šçš„ç»“æ„ä½“ä¼šåœ¨å…¶åŸŸå†…å°è¯•æ‰¹å¤„ç†æ‰€æœ‰è·Ÿéšå®ƒçš„Ability, ä¸€æ—¦å‡ºäº†<code>FScopedServerAbilityRPCBatcher</code>åŸŸ, æ‰€æœ‰å·²æ¿€æ´»çš„Abilityå°†ä¸å†å°è¯•æ‰¹å¤„ç†. <code>FScopedServerAbilityRPCBatcher</code>é€šè¿‡åœ¨æ¯ä¸ªå¯ä»¥æ‰¹å¤„ç†çš„å‡½æ•°ä¸­è®¾ç½®ç‰¹æ®Šä»£ç æ¥è¿è¡Œ, å…¶ä¼šæ‹¦æˆªRPCçš„å‘é€å¹¶å°†æ¶ˆæ¯æ‰“åŒ…è¿›ä¸€ä¸ªæ‰¹å¤„ç†ç»“æ„ä½“, å½“å‡ºäº†<code>FScopedServerAbilityRPCBatcher</code>å, å®ƒä¼šåœ¨<code>UAbilitySystemComponent::EndServerAbilityRPCBatch()</code>ä¸­è‡ªåŠ¨å°†è¯¥æ‰¹å¤„ç†ç»“æ„ä½“RPCåˆ°æœåŠ¡ç«¯, æœåŠ¡ç«¯åœ¨<code>UAbilitySystemComponent::ServerAbilityRPCBatch_Internal(FServerAbilityRPCBatch&amp; BatchInfo)</code>ä¸­æ¥æ”¶è¯¥æ‰¹å¤„ç†ç»“æ„ä½“, <code>BatchInfo</code>å‚æ•°ä¼šåŒ…å«å‡ ä¸ªflag, å…¶åŒ…æ‹¬è¯¥Abilityæ˜¯å¦åº”è¯¥ç»“æŸ, æ¿€æ´»æ—¶è¾“å…¥æ˜¯å¦æŒ‰ä¸‹å’Œæ˜¯å¦åŒ…å«<code>TargetData</code>. è¿™æ˜¯ä¸ªå¯ä»¥è®¾ç½®æ–­ç‚¹ä»¥ç¡®è®¤æ‰¹å¤„ç†æ˜¯å¦æ­£ç¡®è¿è¡Œçš„å¥½å‡½æ•°. ä½œä¸ºé€‰æ‹©, å¯ä»¥ä½¿ç”¨<code>AbilitySystem.ServerRPCBatching.Log 1</code>æ¥å¯ç”¨ç‰¹åˆ«çš„Abilityæ‰¹å¤„ç†æ—¥å¿—.  </p><p>è¿™ä¸ªæ–¹æ³•åªèƒ½åœ¨C++ä¸­å®Œæˆ, å¹¶ä¸”åªèƒ½é€šè¿‡<code>FGameplayAbilitySpecHandle</code>æ¥æ¿€æ´»Ability.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UGSAbilitySystemComponent::BatchRPCTryActivateAbility</span><span class="params">(FGameplayAbilitySpecHandle InAbilityHandle, <span class="type">bool</span> EndAbilityImmediately)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">bool</span> AbilityActivated = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (InAbilityHandle.<span class="built_in">IsValid</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="function">FScopedServerAbilityRPCBatcher <span class="title">GSAbilityRPCBatcher</span><span class="params">(<span class="keyword">this</span>, InAbilityHandle)</span></span>;</span><br><span class="line">AbilityActivated = <span class="built_in">TryActivateAbility</span>(InAbilityHandle, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (EndAbilityImmediately)</span><br><span class="line">&#123;</span><br><span class="line">FGameplayAbilitySpec* AbilitySpec = <span class="built_in">FindAbilitySpecFromHandle</span>(InAbilityHandle);</span><br><span class="line"><span class="keyword">if</span> (AbilitySpec)</span><br><span class="line">&#123;</span><br><span class="line">UGSGameplayAbility* GSAbility = <span class="built_in">Cast</span>&lt;UGSGameplayAbility&gt;(AbilitySpec-&gt;<span class="built_in">GetPrimaryInstance</span>());</span><br><span class="line">GSAbility-&gt;<span class="built_in">ExternalEndAbility</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> AbilityActivated;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> AbilityActivated;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GASShooterå¯¹åŠè‡ªåŠ¨å’Œå…¨è‡ªåŠ¨æªæ”¯ä½¿ç”¨äº†ç›¸åŒçš„æ‰¹å¤„ç†<code>GameplayAbility</code>, å¹¶æ²¡æœ‰ç›´æ¥è°ƒç”¨<code>EndAbility()</code>(å®ƒé€šè¿‡ä¸€ä¸ªåªèƒ½ç”±å®¢æˆ·ç«¯è°ƒç”¨çš„Abilityåœ¨è¯¥Abilityå¤–å¤„ç†, è¯¥åªèƒ½ç”±å®¢æˆ·ç«¯è°ƒç”¨çš„Abilityç”¨äºç®¡ç†ç©å®¶è¾“å…¥å’ŒåŸºäºå½“å‰å¼€ç«æ¨¡å¼å¯¹æ‰¹å¤„ç†Abilityçš„è°ƒç”¨). å› ä¸ºæ‰€æœ‰çš„RPCå¿…é¡»åœ¨<code>FScopedServerAbilityRPCBatcher</code>åŸŸä¸­, æ‰€ä»¥æˆ‘æä¾›äº†<code>EndAbilityImmediately</code>å‚æ•°ä»¥ä½¿ä»…å®¢æˆ·ç«¯çš„æ§åˆ¶/ç®¡ç†å¯ä»¥æ˜ç¡®è¯¥Abilityæ˜¯å¦å¯ä»¥æ‰¹å¤„ç†<code>EndAbility()</code>(åŠè‡ªåŠ¨)æˆ–ä¸æ‰¹å¤„ç†<code>EndAbility()</code>(å…¨è‡ªåŠ¨)ä»¥åŠä¹‹å<code>EndAbility()</code>æ˜¯å¦å¯ä»¥åœ¨å…¶è‡ªå·±çš„RPCä¸­è°ƒç”¨.  </p><p>GASShooteræš´éœ²äº†ä¸€ä¸ªè“å›¾èŠ‚ç‚¹ä»¥å…è®¸ä¸Šæ–‡æåˆ°çš„ä»…å®¢æˆ·ç«¯è°ƒç”¨çš„Abilityæ‰€ä½¿ç”¨çš„æ‰¹å¤„ç†Abilityæ¥è§¦å‘æ‰¹å¤„ç†Ability. (è¯‘è€…æ³¨: æ­¤å¤„ç›¸å½“æ‹—å£, ä½†åŸæ–‡ç¿»è¯‘ç¡®å®å¦‚æ­¤, é…åˆé¡¹ç›®æµè§ˆä¹Ÿè®¸ä¼šæ›´å®¹æ˜“æ˜ç™½äº›.)  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/batchabilityactivate.png" alt="Activate Batched Ability">  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-ga-netsecuritypolicy"></a></p><h4 id="4-6-16-ç½‘ç»œå®‰å…¨ç­–ç•¥-Net-Security-Policy"><a href="#4-6-16-ç½‘ç»œå®‰å…¨ç­–ç•¥-Net-Security-Policy" class="headerlink" title="4.6.16 ç½‘ç»œå®‰å…¨ç­–ç•¥(Net Security Policy)"></a>4.6.16 ç½‘ç»œå®‰å…¨ç­–ç•¥(Net Security Policy)</h4><p><code>GameplayAbility</code>çš„ç½‘ç»œå®‰å…¨ç­–ç•¥å†³å®šäº†Abilityåº”è¯¥åœ¨ç½‘ç»œçš„ä½•å¤„æ‰§è¡Œ. å®ƒä¸ºå°è¯•æ‰§è¡Œé™åˆ¶Abilityçš„å®¢æˆ·ç«¯æä¾›äº†ä¿æŠ¤.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">ç½‘ç»œå®‰å…¨ç­–ç•¥</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">ClientOrServer</td><td style="text-align:center">æ²¡æœ‰å®‰å…¨éœ€æ±‚. å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯å¯ä»¥è‡ªç”±åœ°è§¦å‘è¯¥Abilityçš„æ‰§è¡Œå’Œç»ˆæ­¢.</td></tr><tr><td style="text-align:center">ServerOnlyExecution</td><td style="text-align:center">å®¢æˆ·ç«¯å¯¹è¯¥Abilityè¯·æ±‚çš„æ‰§è¡Œä¼šè¢«æœåŠ¡ç«¯å¿½ç•¥, ä½†å®¢æˆ·ç«¯ä»å¯ä»¥è¯·æ±‚æœåŠ¡ç«¯å–æ¶ˆæˆ–ç»“æŸè¯¥Ability.</td></tr><tr><td style="text-align:center">ServerOnlyTermination</td><td style="text-align:center">å®¢æˆ·ç«¯å¯¹è¯¥Abilityè¯·æ±‚çš„å–æ¶ˆæˆ–ç»“æŸä¼šè¢«æœåŠ¡ç«¯å¿½ç•¥, ä½†å®¢æˆ·ç«¯ä»å¯ä»¥è¯·æ±‚æ‰§è¡Œè¯¥Ability.</td></tr><tr><td style="text-align:center">ServerOnly</td><td style="text-align:center">æœåŠ¡ç«¯æ§åˆ¶è¯¥Abilityçš„æ‰§è¡Œå’Œç»ˆæ­¢, å®¢æˆ·ç«¯çš„ä»»ä½•è¯·æ±‚éƒ½ä¼šè¢«å¿½ç•¥.</td></tr></tbody></table></div><p><a name="concepts-at"></a></p><h3 id="4-7-Ability-Tasks"><a href="#4-7-Ability-Tasks" class="headerlink" title="4.7 Ability Tasks"></a>4.7 Ability Tasks</h3><p><a name="concepts-at-definition"></a></p><h4 id="4-7-1-AbilityTaskå®šä¹‰"><a href="#4-7-1-AbilityTaskå®šä¹‰" class="headerlink" title="4.7.1 AbilityTaskå®šä¹‰"></a>4.7.1 AbilityTaskå®šä¹‰</h4><p><code>GameplayAbility</code>åªèƒ½åœ¨ä¸€å¸§ä¸­æ‰§è¡Œ, è¿™æœ¬èº«å¹¶ä¸èƒ½æä¾›å¤ªå¤šçµæ´»æ€§, ä¸ºäº†å®ç°éšæ—¶é—´æ¨ç§»è€Œè§¦å‘æˆ–å“åº”ä¸€æ®µæ—¶é—´åè§¦å‘çš„å§”æ‰˜æ“ä½œ, æˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>AbilityTask</code>.  </p><p>GASè‡ªå¸¦å¾ˆå¤š<code>AbilityTask</code>:  </p><ul><li>ä½¿ç”¨<code>RootMotionSource</code>ç§»åŠ¨Characterçš„Task</li><li>æ’­æ”¾åŠ¨ç”»è’™å¤ªå¥‡çš„Task</li><li>å“åº”<code>Attribute</code>å˜åŒ–çš„Task</li><li>å“åº”<code>GameplayEffect</code>å˜åŒ–çš„Task</li><li>å“åº”ç©å®¶è¾“å…¥çš„Task</li><li>æ›´å¤š</li></ul><p><code>UAbilityTask</code>çš„æ„é€ å‡½æ•°ä¸­å¼ºåˆ¶ç¡¬ç¼–ç å…è®¸æœ€å¤š1000ä¸ªåŒæ—¶è¿è¡Œçš„<code>AbilityTask</code>, å½“è®¾è®¡é‚£äº›åŒæ—¶æ‹¥æœ‰æ•°ç™¾ä¸ªCharacterçš„æ¸¸æˆ(åƒRTS)çš„<code>GameplayAbility</code>æ—¶è¦æ³¨æ„è¿™ä¸€ç‚¹.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-at-definition"></a></p><h4 id="4-7-2-è‡ªå®šä¹‰AbilityTask"><a href="#4-7-2-è‡ªå®šä¹‰AbilityTask" class="headerlink" title="4.7.2 è‡ªå®šä¹‰AbilityTask"></a>4.7.2 è‡ªå®šä¹‰AbilityTask</h4><p>é€šå¸¸ä½ éœ€è¦åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰<code>AbilityTask</code>(C++ä¸­). æ ·ä¾‹é¡¹ç›®å¸¦æœ‰ä¸¤ä¸ªè‡ªå®šä¹‰<code>AbilityTask</code>:  </p><ol><li><code>PlayMontageAndWaitForEvent</code>æ˜¯é»˜è®¤<code>PlayMontageAndWait</code>å’Œ<code>WaitGameplayEvent</code>AbilityTaskçš„ç»“åˆä½“, å…¶å…è®¸åŠ¨ç”»è’™å¤ªå¥‡è‡ª<code>AnimNotify</code>å‘é€GameplayEventå›åˆ°å¯åŠ¨å®ƒçš„<code>GameplayAbility</code>, å¯ä»¥ä½¿ç”¨è¯¥Taskåœ¨åŠ¨ç”»è’™å¤ªå¥‡çš„æŸä¸ªç‰¹å®šæ—¶åˆ»æ¥è§¦å‘æ“ä½œ.</li><li><code>WaitReceiveDamage</code>å¯ä»¥ç›‘å¬<code>OwnerActor</code>æ¥æ”¶ä¼¤å®³. å½“è‹±é›„æ¥æ”¶åˆ°ä¸€ä¸ªä¼¤å®³å®ä¾‹æ—¶, è¢«åŠ¨æŠ¤ç”²å±‚<code>GameplayAbility</code>å°±ä¼šç§»é™¤ä¸€å±‚æŠ¤ç”².  </li></ol><p><code>AbilityTask</code>çš„ç»„æˆ:  </p><ul><li>åˆ›å»ºæ–°çš„<code>AbilityTask</code>å®ä¾‹çš„é™æ€å‡½æ•°</li><li>å½“<code>AbilityTask</code>å®Œæˆç›®çš„æ—¶åˆ†å‘çš„å§”æ‰˜(Delegate)</li><li>è¿›è¡Œä¸»è¦å·¥ä½œçš„<code>Activate()</code>å‡½æ•°, ç»‘å®šåˆ°å¤–éƒ¨çš„å§”æ‰˜ç­‰ç­‰</li><li>è¿›è¡Œæ¸…ç†å·¥ä½œçš„<code>OnDestroy()</code>å‡½æ•°, åŒ…æ‹¬å…¶ç»‘å®šåˆ°å¤–éƒ¨çš„å§”æ‰˜</li><li>æ‰€æœ‰ç»‘å®šåˆ°å¤–éƒ¨å§”æ‰˜çš„å›è°ƒå‡½æ•°</li><li>æˆå‘˜å˜é‡å’Œæ‰€æœ‰å†…éƒ¨è¾…åŠ©å‡½æ•°</li></ul><p><strong>Note:</strong> <code>AbilityTask</code>åªèƒ½å£°æ˜ä¸€ç§ç±»å‹çš„è¾“å‡ºå§”æ‰˜, æ‰€æœ‰çš„è¾“å‡ºå§”æ‰˜éƒ½å¿…é¡»æ˜¯è¯¥ç§ç±»å‹, ä¸ç®¡å®ƒä»¬æ˜¯å¦ä½¿ç”¨å‚æ•°. å¯¹äºæœªä½¿ç”¨çš„å§”æ‰˜å‚æ•°ä¼šä¼ é€’é»˜è®¤å€¼.  </p><p><code>AbilityTask</code>åªèƒ½è¿è¡Œåœ¨é‚£äº›è¿è¡Œæ‰€å±<code>GameplayAbility</code>çš„å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯, ç„¶è€Œ, å¯ä»¥é€šè¿‡è®¾ç½®<code>bSimulatedTask = true</code>ä½¿<code>AbilityTask</code>è¿è¡Œåœ¨Simulated Clientä¸Š, åœ¨<code>AbilityTask</code>çš„æ„é€ å‡½æ•°ä¸­, é‡å†™<code>virtual void InitSimulatedTask(UGameplayTasksComponent&amp; InGameplayTasksComponent);</code>å¹¶å°†æ‰€æœ‰æˆå‘˜å˜é‡è®¾ç½®ä¸ºåŒæ­¥çš„, è¿™åªåœ¨æå°‘çš„æƒ…å†µä¸‹æœ‰ç”¨, æ¯”å¦‚åœ¨ç§»åŠ¨<code>AbilityTask</code>ä¸­, ä¸æƒ³åŒæ­¥æ¯æ¬¡ç§»åŠ¨å˜åŒ–, ä½†æ˜¯åˆéœ€è¦æ¨¡æ‹Ÿæ•´ä¸ªç§»åŠ¨<code>AbilityTask</code>, æ‰€æœ‰çš„<code>RootMotionSource AbilityTask</code>éƒ½æ˜¯è¿™æ ·åšçš„, æŸ¥çœ‹<code>AbilityTask_MoveToLocation.h/.cpp</code>ä»¥ä½œä¸ºå‚è€ƒèŒƒä¾‹.  </p><p>å¦‚æœä½ åœ¨<code>AbilityTask</code>çš„æ„é€ å‡½æ•°ä¸­è®¾ç½®äº†<code>bTickingTask = true;</code>å¹¶é‡å†™äº†<code>virtual void TickTask(float DeltaTime);</code>, <code>AbilityTask</code>å°±å¯ä»¥ä½¿ç”¨<code>Tick</code>, è¿™åœ¨ä½ éœ€è¦æ ¹æ®å¸§ç‡å¹³æ»‘çº¿æ€§æ’å€¼çš„æ—¶å€™å¾ˆæœ‰ç”¨. æŸ¥çœ‹<code>AbilityTask_MoveToLocation.h/.cpp</code>ä»¥ä½œä¸ºå‚è€ƒèŒƒä¾‹.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-at-using"></a></p><h4 id="4-7-3-ä½¿ç”¨AbilityTask"><a href="#4-7-3-ä½¿ç”¨AbilityTask" class="headerlink" title="4.7.3 ä½¿ç”¨AbilityTask"></a>4.7.3 ä½¿ç”¨AbilityTask</h4><p>åœ¨C++ä¸­åˆ›å»ºå¹¶æ¿€æ´»<code>AbilityTask</code>(GDGA_FireGun.cpp):  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UGDAT_PlayMontageAndWaitForEvent* Task = UGDAT_PlayMontageAndWaitForEvent::<span class="built_in">PlayMontageAndWaitForEvent</span>(<span class="keyword">this</span>, NAME_None, MontageToPlay, <span class="built_in">FGameplayTagContainer</span>(), <span class="number">1.0f</span>, NAME_None, <span class="literal">false</span>, <span class="number">1.0f</span>);</span><br><span class="line">Task-&gt;OnBlendOut.<span class="built_in">AddDynamic</span>(<span class="keyword">this</span>, &amp;UGDGA_FireGun::OnCompleted);</span><br><span class="line">Task-&gt;OnCompleted.<span class="built_in">AddDynamic</span>(<span class="keyword">this</span>, &amp;UGDGA_FireGun::OnCompleted);</span><br><span class="line">Task-&gt;OnInterrupted.<span class="built_in">AddDynamic</span>(<span class="keyword">this</span>, &amp;UGDGA_FireGun::OnCancelled);</span><br><span class="line">Task-&gt;OnCancelled.<span class="built_in">AddDynamic</span>(<span class="keyword">this</span>, &amp;UGDGA_FireGun::OnCancelled);</span><br><span class="line">Task-&gt;EventReceived.<span class="built_in">AddDynamic</span>(<span class="keyword">this</span>, &amp;UGDGA_FireGun::EventReceived);</span><br><span class="line">Task-&gt;<span class="built_in">ReadyForActivation</span>();</span><br></pre></td></tr></table></figure><p>åœ¨è“å›¾ä¸­, æˆ‘ä»¬åªéœ€ä½¿ç”¨ä¸º<code>AbilityTask</code>åˆ›å»ºçš„è“å›¾èŠ‚ç‚¹, ä¸å¿…è°ƒç”¨<code>ReadyForActivate()</code>, å…¶ç”±<code>Engine/Source/Editor/GameplayTasksEditor/Private/K2Node_LatentGameplayTaskCall.cpp</code>è‡ªåŠ¨è°ƒç”¨. <code>K2Node_LatentGameplayTaskCall</code>ä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨<code>BeginSpawningActor()</code>å’Œ<code>FinishSpawningActor()</code>(å¦‚æœå®ƒä»¬å­˜åœ¨äºä½ çš„<code>AbilityTask</code>ç±»ä¸­, æŸ¥çœ‹<code>AbilityTask_WaitTargetData</code>), å†å¼ºè°ƒä¸€é, <code>K2Node_LatentGameplayTaskCall</code>åªä¼šå¯¹è“å›¾åšè¿™äº›è‡ªåŠ¨æ“ä½œ, åœ¨C++ä¸­, æˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨è°ƒç”¨<code>ReadyForActivation()</code>, <code>BeginSpawningActor()</code>å’Œ<code>FinishSpawningActor()</code>.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/abilitytask.png" alt="Blueprint WaitTargetData AbilityTask">  </p><p>å¦‚æœæƒ³è¦æ‰‹åŠ¨å–æ¶ˆ<code>AbilityTask</code>, åªéœ€åœ¨è“å›¾(Async Task Proxy)æˆ–C++ä¸­å¯¹<code>AbilityTask</code>å¯¹è±¡è°ƒç”¨<code>EndTask()</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-at-rms"></a></p><h4 id="4-7-4-Root-Motion-Source-Ability-Task"><a href="#4-7-4-Root-Motion-Source-Ability-Task" class="headerlink" title="4.7.4 Root Motion Source Ability Task"></a>4.7.4 Root Motion Source Ability Task</h4><p>GASè‡ªå¸¦çš„<code>AbilityTask</code>å¯ä»¥ä½¿ç”¨æŒ‚è½½åœ¨<code>CharacterMovementComponent</code>ä¸­çš„<code>Root Motion Source</code>éšæ—¶é—´æ¨ç§»è€Œç§»åŠ¨<code>Character</code>, åƒå‡»é€€, å¤æ‚è·³è·ƒ, å¸å¼•å’ŒçŒ›å†².  </p><p><strong>Note:</strong> <code>RootMotionSource AbilityTask</code>é¢„æµ‹æ”¯æŒçš„å¼•æ“ç‰ˆæœ¬æ˜¯4.19å’Œ4.25+, è¯¥é¢„æµ‹åœ¨å¼•æ“ç‰ˆæœ¬4.20-4.24ä¸­å­˜åœ¨bug, ç„¶è€Œ, <code>AbilityTask</code>ä»ç„¶å¯ä»¥ä½¿ç”¨è¾ƒå°çš„ç½‘ç»œä¿®æ­£åœ¨å¤šäººæ¸¸æˆä¸­æ‰§è¡ŒåŠŸèƒ½, å¹¶ä¸”åœ¨å•äººæ¸¸æˆä¸­å®Œç¾è¿è¡Œ. å¯ä»¥å°†4.25ä¸­å¯¹é¢„æµ‹çš„ä¿®å¤è‡ªå®šä¹‰åˆ°4.20~4.24å¼•æ“ä¸­.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc"></a></p><h3 id="4-8-Gameplay-Cues"><a href="#4-8-Gameplay-Cues" class="headerlink" title="4.8 Gameplay Cues"></a>4.8 Gameplay Cues</h3><p><a name="concepts-gc-definition"></a></p><h4 id="4-8-1-GameplayCueå®šä¹‰"><a href="#4-8-1-GameplayCueå®šä¹‰" class="headerlink" title="4.8.1 GameplayCueå®šä¹‰"></a>4.8.1 GameplayCueå®šä¹‰</h4><p><code>GameplayCue(GC)</code>æ‰§è¡Œéæ¸¸æˆé€»è¾‘ç›¸å…³çš„åŠŸèƒ½, åƒéŸ³æ•ˆ, ç²’å­æ•ˆæœ, é•œå¤´æŠ–åŠ¨ç­‰ç­‰. <code>GameplayCue</code>ä¸€èˆ¬æ˜¯å¯åŒæ­¥(é™¤éåœ¨å®¢æˆ·ç«¯æ˜ç¡®<code>æ‰§è¡Œ(Executed)</code>, <code>æ·»åŠ (Added)</code>å’Œ<code>ç§»é™¤(Removed)</code>)å’Œå¯é¢„æµ‹çš„.  </p><p>æˆ‘ä»¬å¯ä»¥åœ¨<code>ASC</code>ä¸­é€šè¿‡å‘é€ä¸€ä¸ª<strong>å¼ºåˆ¶å¸¦æœ‰â€GameplayCueâ€çˆ¶å</strong>çš„ç›¸åº”<code>GameplayTag</code>å’Œ<code>GameplayCueManager</code>çš„äº‹ä»¶ç±»å‹(Execute, Addæˆ–Remove)æ¥è§¦å‘<code>GameplayCue</code>. <code>GameplayCueNotify</code>å¯¹è±¡å’Œå…¶ä»–å®ç°<code>IGameplayCueInterface</code>çš„<code>Actor</code>å¯ä»¥åŸºäº<code>GameplayCue</code>çš„<code>GameplayTag(GameplayCueTag)</code>æ¥è®¢é˜…(Subscribe)è¿™äº›äº‹ä»¶.  </p><p><strong>Note:</strong> å†æ¬¡å¼ºè°ƒ, <code>GameplayCue</code>çš„<code>GameplayTag</code>éœ€è¦ä»¥<code>GameplayCue</code>ä¸ºå¼€å¤´, ä¸¾ä¾‹æ¥è¯´, ä¸€ä¸ªæœ‰æ•ˆçš„<code>GameplayCue</code>çš„<code>GameplayTag</code>å¯èƒ½æ˜¯<code>GameplayCue.A.B.C</code>.  </p><p>æœ‰ä¸¤ä¸ª<code>GameplayCueNotify</code>ç±», <code>Static</code>å’Œ<code>Actor</code>. å®ƒä»¬å„è‡ªå“åº”ä¸åŒçš„äº‹ä»¶, å¹¶ä¸”ä¸åŒçš„<code>GameplayEffect</code>ç±»å‹å¯ä»¥è§¦å‘å®ƒä»¬. æ ¹æ®ä½ çš„é€»è¾‘é‡å†™ç›¸å…³çš„äº‹ä»¶.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">GameplayCueç±»</th><th style="text-align:center">äº‹ä»¶</th><th style="text-align:center">GameplayEffectç±»å‹</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/UGameplayCueNotify_Static/index.html">GameplayCueNotify_Static</a></td><td style="text-align:center">Execute</td><td style="text-align:center">Instantæˆ–Periodic</td><td style="text-align:center"><code>Static GameplayCueNotify</code>ç›´æ¥æ“ä½œ<code>ClassDefaultObject</code>(æ„å‘³ç€æ²¡æœ‰å®ä¾‹)å¹¶ä¸”å¯¹äºä¸€æ¬¡æ€§æ•ˆæœ(åƒå‡»æ‰“ä¼¤å®³)æ˜¯æå¥½çš„.</td></tr><tr><td style="text-align:center"><a href="https://docs.unrealengine.com/en-US/BlueprintAPI/GameplayCueNotify/index.html">GameplayCueNotify_Actor</a></td><td style="text-align:center">Addæˆ–Remove</td><td style="text-align:center">Durationæˆ–Infinite</td><td style="text-align:center"><code>Actor GameplayCueNotify</code>ä¼šåœ¨æ·»åŠ (Added)æ—¶ç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹, å› ä¸ºå…¶æ˜¯å®ä¾‹åŒ–çš„, æ‰€ä»¥å¯ä»¥éšæ—¶é—´æ¨ç§»æ‰§è¡Œæ“ä½œç›´åˆ°è¢«ç§»é™¤(Removed). è¿™å¯¹å¾ªç¯çš„å£°éŸ³å’Œç²’å­æ•ˆæœæ˜¯å¾ˆå¥½çš„, å…¶ä¼šåœ¨<code>æŒç»­(Duration)</code>æˆ–<code>æ— é™(Infinite)</code>GameplayEffectè¢«ç§»é™¤æˆ–æ‰‹åŠ¨è°ƒç”¨ç§»é™¤æ—¶ç§»é™¤. å…¶ä¹Ÿè‡ªå¸¦é€‰é¡¹æ¥ç®¡ç†å…è®¸åŒæ—¶æ·»åŠ (Added)å¤šå°‘ä¸ª, å› æ­¤å¤šä¸ªç›¸åŒæ•ˆæœçš„åº”ç”¨åªå¯ç”¨ä¸€æ¬¡å£°éŸ³æˆ–ç²’å­æ•ˆæœ.</td></tr></tbody></table></div><p><code>GameplayCueNotify</code>æŠ€æœ¯ä¸Šå¯ä»¥å“åº”ä»»ä½•äº‹ä»¶, ä½†æ˜¯è¿™æ˜¯æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨å®ƒçš„æ–¹å¼.  </p><p><strong>Note:</strong> å½“ä½¿ç”¨<code>GameplayCueNotify_Actor</code>æ—¶, è¦å‹¾é€‰<code>Auto Destroy on Remove</code>, å¦åˆ™ä¹‹åå¯¹<code>GameplayCueTag</code>çš„<code>æ·»åŠ (Add)</code>è°ƒç”¨å°†æ— æ³•è¿›è¡Œ.  </p><p>å½“ä½¿ç”¨é™¤<code>Full</code>ä¹‹å¤–çš„<code>ASC</code><a href="#concepts-asc-rm">åŒæ­¥æ¨¡å¼</a>æ—¶, <code>Add</code>å’Œ<code>Remove</code>GCäº‹ä»¶ä¼šåœ¨æœåŠ¡ç«¯ç©å®¶ä¸­è§¦å‘ä¸¤æ¬¡(Listen Server) - ä¸€æ¬¡æ˜¯åº”ç”¨<code>GE</code>, å†ä¸€æ¬¡æ˜¯ä»â€Minimalâ€<code>NetMultiCast</code>åˆ°å®¢æˆ·ç«¯. ç„¶è€Œ, <code>WhileActive</code>äº‹ä»¶ä»ä¼šè§¦å‘ä¸€æ¬¡. æ‰€æœ‰çš„äº‹ä»¶åœ¨å®¢æˆ·ç«¯ä¸­åªè§¦å‘ä¸€æ¬¡.  </p><p>æ ·ä¾‹é¡¹ç›®åŒ…å«äº†ä¸€ä¸ª<code>GameplayCueNotify_Actor</code>ç”¨äºçœ©æ™•å’Œå¥”è·‘æ•ˆæœ. å…¶è¿˜å«æœ‰ä¸€ä¸ª<code>GameplayCueNotify_Static</code>ç”¨äºæªæ”¯å¼¹è¯ä¼¤å®³. è¿™äº›<code>GC</code>å¯ä»¥é€šè¿‡<a href="#concepts-gc-local">å®¢æˆ·ç«¯è§¦å‘</a>æ¥è¿›è¡Œä¼˜åŒ–, è€Œä¸æ˜¯é€šè¿‡<code>GE</code>åŒæ­¥. æˆ‘é€‰æ‹©äº†åœ¨æ ·ä¾‹é¡¹ç›®ä¸­å±•ç¤ºä½¿ç”¨å®ƒä»¬çš„åŸºæœ¬æ–¹æ³•.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc-trigger"></a></p><h4 id="4-8-2-è§¦å‘GameplayCue"><a href="#4-8-2-è§¦å‘GameplayCue" class="headerlink" title="4.8.2 è§¦å‘GameplayCue"></a>4.8.2 è§¦å‘GameplayCue</h4><h5 id="GameplayEffect"><a href="#GameplayEffect" class="headerlink" title="GameplayEffect"></a>GameplayEffect</h5><p>åœ¨æˆåŠŸåº”ç”¨(æœªè¢«Tagæˆ–Immunityé˜»å¡)çš„<code>GameplayEffect</code>ä¸­å¡«å†™æ‰€æœ‰åº”è¯¥è§¦å‘çš„<code>GameplayCue</code>çš„<code>GameplayTag</code>.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/gcfromge.png" alt="GameplayCue Triggered from a GameplayEffect">  </p><h5 id="æ‰‹åŠ¨è°ƒç”¨"><a href="#æ‰‹åŠ¨è°ƒç”¨" class="headerlink" title="æ‰‹åŠ¨è°ƒç”¨"></a>æ‰‹åŠ¨è°ƒç”¨</h5><p><code>UGameplayAbility</code>æä¾›äº†è“å›¾èŠ‚ç‚¹æ¥<code>Execute</code>, <code>Add</code>æˆ–<code>Remove</code> GameplayCue.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/gcfromga.png" alt="GameplayCue Triggered from a GameplayAbility">  </p><p>åœ¨C++ä¸­, ä½ å¯ä»¥åœ¨<code>ASC</code>ä¸­ç›´æ¥è°ƒç”¨å‡½æ•°(æˆ–è€…åœ¨ä½ çš„<code>ASC</code>å­ç±»ä¸­æš´éœ²å®ƒä»¬åˆ°è“å›¾):  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** GameplayCues can also come on their own. These take an optional effect context to pass through hit result, etc */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ExecuteGameplayCue</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, FGameplayEffectContextHandle EffectContext = FGameplayEffectContextHandle())</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ExecuteGameplayCue</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, <span class="type">const</span> FGameplayCueParameters&amp; GameplayCueParameters)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Add a persistent gameplay cue */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AddGameplayCue</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, FGameplayEffectContextHandle EffectContext = FGameplayEffectContextHandle())</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AddGameplayCue</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, <span class="type">const</span> FGameplayCueParameters&amp; GameplayCueParameters)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Remove a persistent gameplay cue */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RemoveGameplayCue</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Removes any GameplayCue added on its own, i.e. not as part of a GameplayEffect. */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RemoveAllGameplayCues</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc-local"></a></p><h4 id="4-8-3-å®¢æˆ·ç«¯GameplayCue"><a href="#4-8-3-å®¢æˆ·ç«¯GameplayCue" class="headerlink" title="4.8.3 å®¢æˆ·ç«¯GameplayCue"></a>4.8.3 å®¢æˆ·ç«¯GameplayCue</h4><p>ä»<code>GameplayAbility</code>å’Œ<code>ASC</code>ä¸­æš´éœ²çš„ç”¨äºè§¦å‘<code>GameplayCue</code>çš„å‡½æ•°é»˜è®¤æ˜¯å¯åŒæ­¥çš„. æ¯ä¸ª<code>GameplayCue</code>äº‹ä»¶éƒ½æ˜¯ä¸€ä¸ªå¤šæ’­(Multicast)RPC. è¿™ä¼šå¯¼è‡´å¤§é‡RPC. GASä¹Ÿå¼ºåˆ¶åœ¨æ¯æ¬¡ç½‘ç»œæ›´æ–°ä¸­æœ€å¤šèƒ½æœ‰ä¸¤ä¸ªç›¸åŒçš„<code>GameplayCue</code>RPC. æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨å®¢æˆ·ç«¯<code>GameplayCue</code>æ¥é¿å…è¿™ä¸ªé—®é¢˜. å®¢æˆ·ç«¯<code>GameplayCue</code>åªèƒ½åœ¨å•ç‹¬çš„å®¢æˆ·ç«¯ä¸Š<code>Execute</code>, <code>Add</code>æˆ–<code>Remove</code>.  </p><p>å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯<code>GameplayCue</code>çš„åœºæ™¯:  </p><ul><li>æŠ›å°„ç‰©ä¼¤å®³</li><li>è¿‘æˆ˜ç¢°æ’ä¼¤å®³</li><li>åŠ¨ç”»è’™å¤ªå¥‡è§¦å‘çš„<code>GameplayCue</code></li></ul><p>ä½ åº”è¯¥æ·»åŠ åˆ°<code>ASC</code>å­ç±»ä¸­çš„å®¢æˆ·ç«¯<code>GameplayCue</code>å‡½æ•°:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable, Category = <span class="string">&quot;GameplayCue&quot;</span>, Meta = (AutoCreateRefTerm = <span class="string">&quot;GameplayCueParameters&quot;</span>, GameplayTagFilter = <span class="string">&quot;GameplayCue&quot;</span>))</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ExecuteGameplayCueLocal</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, <span class="type">const</span> FGameplayCueParameters&amp; GameplayCueParameters)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable, Category = <span class="string">&quot;GameplayCue&quot;</span>, Meta = (AutoCreateRefTerm = <span class="string">&quot;GameplayCueParameters&quot;</span>, GameplayTagFilter = <span class="string">&quot;GameplayCue&quot;</span>))</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AddGameplayCueLocal</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, <span class="type">const</span> FGameplayCueParameters&amp; GameplayCueParameters)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable, Category = <span class="string">&quot;GameplayCue&quot;</span>, Meta = (AutoCreateRefTerm = <span class="string">&quot;GameplayCueParameters&quot;</span>, GameplayTagFilter = <span class="string">&quot;GameplayCue&quot;</span>))</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RemoveGameplayCueLocal</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, <span class="type">const</span> FGameplayCueParameters&amp; GameplayCueParameters)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UPAAbilitySystemComponent::ExecuteGameplayCueLocal</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, <span class="type">const</span> FGameplayCueParameters &amp; GameplayCueParameters)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">UAbilitySystemGlobals::<span class="built_in">Get</span>().<span class="built_in">GetGameplayCueManager</span>()-&gt;<span class="built_in">HandleGameplayCue</span>(<span class="built_in">GetOwner</span>(), GameplayCueTag, EGameplayCueEvent::Type::Executed, GameplayCueParameters);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UPAAbilitySystemComponent::AddGameplayCueLocal</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, <span class="type">const</span> FGameplayCueParameters &amp; GameplayCueParameters)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">UAbilitySystemGlobals::<span class="built_in">Get</span>().<span class="built_in">GetGameplayCueManager</span>()-&gt;<span class="built_in">HandleGameplayCue</span>(<span class="built_in">GetOwner</span>(), GameplayCueTag, EGameplayCueEvent::Type::OnActive, GameplayCueParameters);</span><br><span class="line">UAbilitySystemGlobals::<span class="built_in">Get</span>().<span class="built_in">GetGameplayCueManager</span>()-&gt;<span class="built_in">HandleGameplayCue</span>(<span class="built_in">GetOwner</span>(), GameplayCueTag, EGameplayCueEvent::Type::WhileActive, GameplayCueParameters);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UPAAbilitySystemComponent::RemoveGameplayCueLocal</span><span class="params">(<span class="type">const</span> FGameplayTag GameplayCueTag, <span class="type">const</span> FGameplayCueParameters &amp; GameplayCueParameters)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">UAbilitySystemGlobals::<span class="built_in">Get</span>().<span class="built_in">GetGameplayCueManager</span>()-&gt;<span class="built_in">HandleGameplayCue</span>(<span class="built_in">GetOwner</span>(), GameplayCueTag, EGameplayCueEvent::Type::Removed, GameplayCueParameters);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæŸä¸ª<code>GameplayCue</code>æ˜¯å®¢æˆ·ç«¯æ·»åŠ çš„, é‚£ä¹ˆå®ƒä¹Ÿåº”è¯¥è‡ªå®¢æˆ·ç«¯ç§»é™¤. å¦‚æœå®ƒæ˜¯é€šè¿‡åŒæ­¥æ·»åŠ çš„, é‚£ä¹ˆå®ƒä¹Ÿåº”è¯¥é€šè¿‡åŒæ­¥ç§»é™¤.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc-parameters"></a></p><h4 id="4-8-4-GameplayCueå‚æ•°"><a href="#4-8-4-GameplayCueå‚æ•°" class="headerlink" title="4.8.4 GameplayCueå‚æ•°"></a>4.8.4 GameplayCueå‚æ•°</h4><p><code>GameplayCue</code>æ¥å—ä¸€ä¸ªåŒ…å«é¢å¤–<code>GameplayCue</code>ä¿¡æ¯çš„<code>FGameplayCueParameters</code>ç»“æ„ä½“ä½œä¸ºå‚æ•°. å¦‚æœä½ åœ¨<code>GameplayAbility</code>æˆ–<code>ASC</code>ä¸­ä½¿ç”¨å‡½æ•°æ‰‹åŠ¨è§¦å‘<code>GameplayCue</code>, é‚£ä¹ˆå°±å¿…é¡»æ‰‹åŠ¨å¡«å……ä¼ é€’ç»™<code>GameplayCue</code>çš„<code>GameplayCueParameters</code>ç»“æ„ä½“. å¦‚æœ<code>GameplayCue</code>ç”±<code>GameplayEffect</code>è§¦å‘, é‚£ä¹ˆä¸‹åˆ—çš„å˜é‡ä¼šè‡ªåŠ¨å¡«å……åˆ°<code>FGameplayCueParameters</code>ç»“æ„ä½“ä¸­:  </p><ul><li>AggregatedSourceTags</li><li>AggregatedTargetTags</li><li>GameplayEffectLevel</li><li>AbilityLevel</li><li><a href="#concepts-ge-context">EffectContext</a></li><li>Magnitude(å¦‚æœ<code>GameplayEffect</code>å…·æœ‰åœ¨<code>GameplayCue</code>æ ‡ç­¾å®¹å™¨(TagContainer)ä¸Šæ–¹çš„ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©çš„<code>Magnitude Attribute</code>å’Œå½±å“è¯¥<code>Attribute</code>çš„ç›¸åº”<code>Modifier</code>)</li></ul><p>å½“æ‰‹åŠ¨è§¦å‘<code>GameplayCue</code>æ—¶, <code>GameplayCueParameters</code>ä¸­çš„<code>SourceObject</code>å˜é‡ä¼¼ä¹æ˜¯ä¸€ä¸ªä¼ é€’ä»»æ„æ•°æ®åˆ°<code>GameplayCue</code>çš„å¥½åœ°æ–¹.  </p><p><strong>Note:</strong> å‚æ•°ç»“æ„ä½“ä¸­çš„æŸäº›å˜é‡, åƒ<code>Instigator</code>, å¯èƒ½å·²ç»å­˜åœ¨äº<code>EffectContext</code>ä¸­. <code>EffectContext</code>ä¹Ÿå¯ä»¥åŒ…å«<code>FHitResult</code>ç”¨äºå­˜å‚¨<code>GameplayCue</code>åœ¨ä¸–ç•Œä¸­ç”Ÿæˆçš„ä½ç½®. å­ç±»åŒ–<code>EffectContext</code>ä¼¼ä¹æ˜¯ä¸€ä¸ªä¼ é€’æ›´å¤šæ•°æ®åˆ°<code>GameplayCue</code>çš„å¥½æ–¹æ³•, ç‰¹åˆ«æ˜¯å¯¹äºé‚£äº›ç”±<code>GameplayEffect</code>è§¦å‘çš„<code>GameplayCue</code>.  </p><p>æŸ¥çœ‹<a href="#concepts-asg">UAbilitySystemGlobals</a>ä¸­ç”¨äºå¡«å……<code>GameplayCueParameters</code>ç»“æ„ä½“çš„ä¸‰ä¸ªå‡½æ•°ä»¥è·å¾—æ›´å¤šä¿¡æ¯. å®ƒä»¬æ˜¯è™šå‡½æ•°, å› æ­¤ä½ å¯ä»¥é‡å†™å®ƒä»¬ä»¥è‡ªåŠ¨å¡«å……æ›´å¤šä¿¡æ¯.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Initialize GameplayCue Parameters */</span></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">InitGameplayCueParameters</span><span class="params">(FGameplayCueParameters&amp; CueParameters, <span class="type">const</span> FGameplayEffectSpecForRPC &amp;Spec)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">InitGameplayCueParameters_GESpec</span><span class="params">(FGameplayCueParameters&amp; CueParameters, <span class="type">const</span> FGameplayEffectSpec &amp;Spec)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">InitGameplayCueParameters</span><span class="params">(FGameplayCueParameters&amp; CueParameters, <span class="type">const</span> FGameplayEffectContextHandle&amp; EffectContext)</span></span>;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc-manager"></a></p><h4 id="4-8-5-Gameplay-Cue-Manager"><a href="#4-8-5-Gameplay-Cue-Manager" class="headerlink" title="4.8.5 Gameplay Cue Manager"></a>4.8.5 Gameplay Cue Manager</h4><p>é»˜è®¤æƒ…å†µä¸‹, æ¸¸æˆå¼€å§‹æ—¶<code>GameplayCueManager</code>ä¼šæ‰«ææ¸¸æˆçš„å…¨éƒ¨ç›®å½•ä»¥å¯»æ‰¾<code>GameplayCueNotify</code>å¹¶å°†å…¶åŠ è½½è¿›å†…å­˜. æˆ‘ä»¬å¯ä»¥è®¾ç½®<code>DefaultGame.ini</code>æ¥ä¿®æ”¹<code>GameplayCueManager</code>çš„æ‰«æè·¯å¾„.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[/Script/GameplayAbilities.AbilitySystemGlobals]</span><br><span class="line">GameplayCueNotifyPaths=<span class="string">&quot;/Game/GASDocumentation/Characters&quot;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç¡®å®æƒ³è¦<code>GameplayCueManager</code>æ‰«æå¹¶æ‰¾åˆ°æ‰€æœ‰çš„<code>GameplayCueNotify</code>, ç„¶è€Œ, æˆ‘ä»¬ä¸æƒ³è¦å®ƒå¼‚æ­¥åŠ è½½æ¯ä¸€ä¸ª, å› ä¸ºè¿™ä¼šå°†æ¯ä¸ª<code>GameplayCueNotify</code>å’Œå®ƒä»¬æ‰€å¼•ç”¨çš„éŸ³æ•ˆå’Œç²’å­ç‰¹æ•ˆæ”¾å…¥å†…å­˜è€Œä¸ç®¡å®ƒä»¬æ˜¯å¦åœ¨å…³å¡ä¸­ä½¿ç”¨. åœ¨åƒParagonè¿™æ ·çš„å¤§å‹æ¸¸æˆä¸­, å†…å­˜ä¸­ä¼šæ”¾å…¥æ•°ç™¾å…†çš„æ— ç”¨èµ„æºå¹¶é€ æˆå¡é¡¿å’Œå¯åŠ¨æ—¶æ— å“åº”.  </p><p>åœ¨å¯åŠ¨æ—¶å¼‚æ­¥åŠ è½½æ¯ä¸ª<code>GameplayCue</code>çš„ä¸€ç§å¯é€‰æ–¹æ³•æ˜¯åªå¼‚æ­¥åŠ è½½é‚£äº›ä¼šåœ¨æ¸¸æˆä¸­è§¦å‘çš„<code>GameplayCue</code>, è¿™ä¼šåœ¨å¼‚æ­¥åŠ è½½æ¯ä¸ª<code>GameplayCue</code>æ—¶å‡å°‘ä¸å¿…è¦çš„å†…å­˜å ç”¨å’Œæ½œåœ¨çš„æ¸¸æˆæ— å“åº”å‡ ç‡, ä»è€Œé¿å…ç‰¹å®š<code>GameplayCue</code>åœ¨æ¸¸æˆä¸­ç¬¬ä¸€æ¬¡è§¦å‘æ—¶å¯èƒ½å‡ºç°çš„å»¶è¿Ÿæ•ˆæœ. SSDä¸å­˜åœ¨è¿™ç§æ½œåœ¨çš„å»¶è¿Ÿ, æˆ‘è¿˜æ²¡æœ‰åœ¨HDDä¸Šæµ‹è¯•è¿‡, å¦‚æœåœ¨UEç¼–è¾‘å™¨ä¸­ä½¿ç”¨è¯¥é€‰é¡¹å¹¶ä¸”ç¼–è¾‘å™¨éœ€è¦ç¼–è¯‘ç²’å­ç³»ç»Ÿçš„è¯, å°±å¯èƒ½ä¼šåœ¨GameplayCueé¦–æ¬¡åŠ è½½æ—¶æœ‰è½»å¾®çš„å¡é¡¿æˆ–æ— å“åº”, è¿™åœ¨æ„å»ºç‰ˆæœ¬ä¸­ä¸æ˜¯é—®é¢˜, å› ä¸ºç²’å­ç³»ç»Ÿè‚¯å®šæ˜¯ç¼–è¯‘å¥½çš„.  </p><p>é¦–å…ˆæˆ‘ä»¬å¿…é¡»ç»§æ‰¿<code>UGameplayCueManager</code>å¹¶å‘ŠçŸ¥<code>AbilitySystemGlobals</code>ç±»åœ¨<code>DefaultGame.ini</code>ä¸­ä½¿ç”¨æˆ‘ä»¬çš„<code>UGameplayCueManager</code>å­ç±».  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[/Script/GameplayAbilities.AbilitySystemGlobals]</span><br><span class="line">GlobalGameplayCueManagerClass=<span class="string">&quot;/Script/ParagonAssets.PBGameplayCueManager&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘ä»¬çš„<code>UGameplayCueManager</code>å­ç±»ä¸­, é‡å†™<code>ShouldAsyncLoadRuntimeObjectLibraries()</code>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">ShouldAsyncLoadRuntimeObjectLibraries</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc-prevention"></a></p><h4 id="4-8-6-é˜»æ­¢GameplayCueå“åº”"><a href="#4-8-6-é˜»æ­¢GameplayCueå“åº”" class="headerlink" title="4.8.6 é˜»æ­¢GameplayCueå“åº”"></a>4.8.6 é˜»æ­¢GameplayCueå“åº”</h4><p>æœ‰æ—¶æˆ‘ä»¬ä¸æƒ³å“åº”<code>GameplayCue</code>, ä¾‹å¦‚æˆ‘ä»¬é˜»æ­¢äº†ä¸€æ¬¡æ”»å‡», å¯èƒ½å°±ä¸æƒ³æ’­æ”¾é™„åŠ åœ¨ä¼¤å®³<code>GameplayEffect</code>ä¸Šçš„å‡»æ‰“æ•ˆæœæˆ–è€…è‡ªå®šä¹‰çš„æ•ˆæœ. æˆ‘ä»¬å¯ä»¥åœ¨<a href="#concepts-ge-ec">GameplayEffectExecutionCalculations</a>ä¸­è°ƒç”¨<code>OutExecutionOutput.MarkGameplayCuesHandledManually()</code>, ä¹‹åæ‰‹åŠ¨å‘é€æˆ‘ä»¬çš„<code>GameplayCue</code>äº‹ä»¶åˆ°<code>Target</code>æˆ–<code>Source</code>çš„<code>ASC</code>ä¸­.  </p><p>å¦‚æœä½ æƒ³æŸä¸ªç‰¹åˆ«æŒ‡å®š<code>ASC</code>ä¸­çš„<code>GameplayCue</code>æ°¸ä¸è§¦å‘, å¯ä»¥è®¾ç½®<code>AbilitySystemComponent-&gt;bSuppressGameplayCues = true;</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc-batching"></a></p><h4 id="4-8-7-GameplayCueæ‰¹å¤„ç†"><a href="#4-8-7-GameplayCueæ‰¹å¤„ç†" class="headerlink" title="4.8.7 GameplayCueæ‰¹å¤„ç†"></a>4.8.7 GameplayCueæ‰¹å¤„ç†</h4><p>æ¯æ¬¡<code>GameplayCue</code>è§¦å‘éƒ½æ˜¯ä¸€æ¬¡ä¸å¯é çš„å¤šæ’­(NetMulticast)RPC. åœ¨åŒä¸€æ—¶åˆ»è§¦å‘å¤šä¸ª<code>GameplayCue</code>çš„æƒ…å†µä¸‹, æœ‰ä¸€äº›ä¼˜åŒ–æ–¹æ³•æ¥å°†å®ƒä»¬å‹ç¼©æˆä¸€ä¸ªRPCæˆ–è€…é€šè¿‡å‘é€æ›´å°‘çš„æ•°æ®æ¥èŠ‚çœå¸¦å®½.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc-batching-manualrpc"></a></p><h5 id="4-8-7-1-æ‰‹åŠ¨RPC"><a href="#4-8-7-1-æ‰‹åŠ¨RPC" class="headerlink" title="4.8.7.1 æ‰‹åŠ¨RPC"></a>4.8.7.1 æ‰‹åŠ¨RPC</h5><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå¯ä»¥å‘å°„8æšå¼¹ä¸¸çš„éœ°å¼¹æª, å°±ä¼šæœ‰8ä¸ªè½¨è¿¹å’Œç¢°æ’<code>GameplayCue</code>. GASShooteré‡‡ç”¨å°†å®ƒä»¬è”åˆæˆä¸€ä¸ªRPCçš„å»¶è¿Ÿ(Lazy)æ–¹æ³•, å…¶å°†æ‰€æœ‰çš„è½¨è¿¹ä¿¡æ¯ä¿å­˜åˆ°<a href="#concepts-ge-ec">EffectContext</a>ä½œä¸º<a href="#concepts-targeting-data">TargetData</a>. å°½ç®¡å…¶å°†RPCæ•°é‡ä»8é™ä¸º1, ç„¶è€Œè¿˜æ˜¯åœ¨è¿™ä¸€ä¸ªRPCä¸­é€šè¿‡ç½‘ç»œå‘é€å¤§é‡æ•°æ®(~500 bytes). ä¸€ä¸ªè¿›ä¸€æ­¥ä¼˜åŒ–çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰ç»“æ„ä½“å‘é€RPC, åœ¨è¯¥è‡ªå®šä¹‰RPCä¸­ä½ éœ€è¦é«˜æ•ˆç¼–ç å‘½ä¸­ä½ç½®(Hit Location)æˆ–è€…ç»™ä¸€ä¸ªéšæœºç§å­ä»¥åœ¨æ¥æ”¶ç«¯é‡ç°/è¿‘ä¼¼è®¡ç®—ç¢°æ’ä½ç½®, å®¢æˆ·ç«¯ä¹‹åéœ€è¦è§£åŒ…è¯¥è‡ªå®šä¹‰ç»“æ„ä½“å¹¶é‡ç°<a href="#concepts-gc-local">å®¢æˆ·ç«¯æ‰§è¡Œçš„<code>GameplayCue</code></a>.  </p><p>è¿è¡Œæœºåˆ¶:  </p><ol><li>å£°æ˜ä¸€ä¸ª<code>FScopedGameplayCueSendContext</code>. å…¶ä¼šé˜»å¡<code>UGameplayCueManager::FlushPendingCues()</code>ç›´åˆ°å…¶å‡ºåŸŸ, æ„å‘³ç€æ‰€æœ‰<code>GameplayCue</code>éƒ½å°†ä¼šæ’é˜Ÿç­‰å€™ç›´åˆ°è¯¥<code>FScopedGameplayCueSendContext</code>å‡ºåŸŸ.</li><li>é‡å†™<code>UGameplayCueManager::FlushPendingCues()</code>ä»¥å°†é‚£äº›å¯ä»¥åŸºäºä¸€äº›è‡ªå®šä¹‰<code>GameplayTag</code>æ‰¹å¤„ç†çš„<code>GameplayCue</code>åˆå¹¶è¿›è‡ªå®šä¹‰çš„ç»“æ„ä½“å¹¶å°†å…¶RPCåˆ°å®¢æˆ·ç«¯.</li><li>å®¢æˆ·ç«¯æ¥æ”¶è‡ªå®šä¹‰ç»“æ„ä½“å¹¶å°†å…¶è§£åŒ…è¿›å®¢æˆ·ç«¯æ‰§è¡Œçš„<code>GameplayCue</code>.</li></ol><p>è¯¥æ–¹æ³•ä¹Ÿå¯ä»¥åœ¨ä½ çš„<code>GameplayCue</code>éœ€è¦ç‰¹åˆ«æŒ‡å®šçš„å‚æ•°æ—¶ä½¿ç”¨, è¿™äº›éœ€è¦ç‰¹åˆ«æŒ‡å®šçš„å‚æ•°ä¸èƒ½ç”±<code>GameplayCueParameter</code>æä¾›, å¹¶ä¸”ä½ ä¸æƒ³å°†å®ƒä»¬æ·»åŠ åˆ°<code>EffectContext</code>, åƒä¼¤å®³æ•°å€¼, æš´å‡»æ ‡è¯†, ç ´ç›¾æ ‡è¯†, å¤„å†³æ ‡è¯†ç­‰ç­‰.  </p><p><a href="https://forums.unrealengine.com/development-discussion/c-gameplay-programming/1711546-fscopedgameplaycuesendcontext-gameplaycuemanager">https://forums.unrealengine.com/development-discussion/c-gameplay-programming/1711546-fscopedgameplaycuesendcontext-gameplaycuemanager</a>  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-gc-batching-gcsonge"></a></p><h5 id="4-8-7-2-GameplayEffectä¸­çš„å¤šä¸ªGameplayCue"><a href="#4-8-7-2-GameplayEffectä¸­çš„å¤šä¸ªGameplayCue" class="headerlink" title="4.8.7.2 GameplayEffectä¸­çš„å¤šä¸ªGameplayCue"></a>4.8.7.2 GameplayEffectä¸­çš„å¤šä¸ªGameplayCue</h5><p>ä¸€ä¸ª<code>GameplayEffect</code>ä¸­çš„æ‰€æœ‰<code>GameplayCue</code>å·²ç»ç”±ä¸€ä¸ªRPCå‘é€äº†. é»˜è®¤æƒ…å†µä¸‹, <code>UGameplayCueManager::InvokeGameplayCueAddedAndWhileActive_FromSpec()</code>ä¼šåœ¨ä¸å¯é çš„å¤šæ’­(NetMulticast)RPCä¸­å‘é€æ•´ä¸ª<code>GameplayEffectSpec</code>(é™¤äº†è½¬æ¢ä¸º<code>FGameplayEffectSpecForRPC</code>)è€Œä¸ç®¡<code>ASC</code>çš„åŒæ­¥æ¨¡å¼, å–å†³äº<code>GameplayEffectSpec</code>çš„å†…å®¹, è¿™å¯èƒ½ä¼šä½¿ç”¨å¤§é‡å¸¦å®½, æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<code>AbilitySystem.AlwaysConvertGESpecToGCParams 1</code>æ¥å°†å…¶ä¼˜åŒ–, è¿™ä¼šå°†<code>GameplayEffectSpec</code>è½¬æ¢ä¸º<code>FGameplayCueParameter</code>ç»“æ„ä½“å¹¶ä¸”RPCå®ƒè€Œä¸æ˜¯æ•´ä¸ª<code>FGameplayEffectSpecForRPC</code>, è¿™ä¼šèŠ‚çœå¸¦å®½ä½†æ˜¯åªæœ‰è¾ƒå°‘çš„ä¿¡æ¯, å–å†³äº<code>GESpec</code>å¦‚ä½•è½¬æ¢ä¸º<code>GameplayCueParameters</code>å’Œä½ çš„<code>GameplayCue</code>éœ€è¦çŸ¥é“ä»€ä¹ˆ.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-asg"></a></p><h3 id="4-9-Ability-System-Globals"><a href="#4-9-Ability-System-Globals" class="headerlink" title="4.9 Ability System Globals"></a>4.9 Ability System Globals</h3><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/UAbilitySystemGlobals/index.html">AbilitySystemGlobals</a>ç±»ä¿å­˜æœ‰å…³GASçš„å…¨å±€ä¿¡æ¯. å¤§å¤šæ•°å˜é‡å¯ä»¥åœ¨<code>DefaultGame.ini</code>ä¸­è®¾ç½®. ä¸€èˆ¬ä½ ä¸éœ€è¦å’Œè¯¥ç±»äº’åŠ¨, ä½†æ˜¯åº”è¯¥çŸ¥é“å®ƒçš„å­˜åœ¨. å¦‚æœä½ éœ€è¦ç»§æ‰¿åƒ<a href="#concepts-gc-manager">GameplayCueManager</a>æˆ–<a href="#concepts-ge-context">GameplayEffectContext</a>è¿™æ ·çš„å¯¹è±¡, å°±å¿…é¡»é€šè¿‡<code>AbilitySystemGlobals</code>æ¥åš.  </p><p>æƒ³è¦ç»§æ‰¿<code>AbilitySystemGlobals</code>, éœ€è¦åœ¨<code>DefaultGame.ini</code>ä¸­è®¾ç½®ç±»å:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[/Script/GameplayAbilities.AbilitySystemGlobals]</span><br><span class="line">AbilitySystemGlobalsClassName=<span class="string">&quot;/Script/ParagonAssets.PAAbilitySystemGlobals&quot;</span></span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-asg-initglobaldata"></a></p><h4 id="4-9-1-InitGlobalData"><a href="#4-9-1-InitGlobalData" class="headerlink" title="4.9.1 InitGlobalData()"></a>4.9.1 InitGlobalData()</h4><p>ä»UE 4.24å¼€å§‹, å¿…é¡»è°ƒç”¨<code>UAbilitySystemGlobals::InitGlobalData()</code>æ¥ä½¿ç”¨<a href="#concepts-targeting-data">TargetData</a>, å¦åˆ™ä½ ä¼šé‡åˆ°å…³äº<code>ScriptStructCache</code>çš„é”™è¯¯, å¹¶ä¸”å®¢æˆ·ç«¯ä¼šä»æœåŠ¡ç«¯æ–­å¼€è¿æ¥, è¯¥å‡½æ•°åªéœ€è¦åœ¨é¡¹ç›®ä¸­è°ƒç”¨ä¸€æ¬¡. Fortniteä»AssetManagerç±»çš„èµ·å§‹åŠ è½½å‡½æ•°ä¸­è°ƒç”¨è¯¥å‡½æ•°, Paragonæ˜¯ä»UEngine::Init()ä¸­è°ƒç”¨çš„. æˆ‘å‘ç°å°†å…¶æ”¾åˆ°<code>UEngineSubsystem::Initialize()</code>æ˜¯ä¸ªå¥½ä½ç½®, è¿™ä¹Ÿæ˜¯æ ·ä¾‹é¡¹ç›®ä¸­ä½¿ç”¨çš„. æˆ‘è§‰å¾—ä½ åº”è¯¥å¤åˆ¶è¿™æ®µæ¨¡æ¿ä»£ç åˆ°ä½ è‡ªå·±çš„é¡¹ç›®ä¸­ä»¥é¿å…å‡ºç°<code>TargetData</code>çš„ä½¿ç”¨é—®é¢˜.  </p><p>å¦‚æœä½ åœ¨ä½¿ç”¨<code>AbilitySystemGlobals GlobalAttributeSetDefaultsTableNames</code>æ—¶å‘ç”Ÿå´©æºƒ, å¯èƒ½ä¹‹åéœ€è¦åƒFortniteä¸€æ ·åœ¨<code>AssetManager</code>æˆ–<code>GameInstance</code>ä¸­è°ƒç”¨<code>UAbilitySystemGlobals::InitGlobalData()</code>è€Œä¸æ˜¯åœ¨<code>UEngineSubsystem::Initialize()</code>ä¸­. è¯¥å´©æºƒå¯èƒ½æ˜¯ç”±äº<code>Subsystem</code>çš„åŠ è½½é¡ºåºå¼•å‘çš„, <code>GlobalAttributeDefaultsTables</code>éœ€è¦åŠ è½½<code>EditorSubsystem</code>æ¥ç»‘å®š<code>UAbilitySystemGlobals::InitGlobalData()</code>ä¸­çš„å§”æ‰˜.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-p"></a></p><h3 id="4-10-é¢„æµ‹-Prediction"><a href="#4-10-é¢„æµ‹-Prediction" class="headerlink" title="4.10 é¢„æµ‹(Prediction)"></a>4.10 é¢„æµ‹(Prediction)</h3><p>GASå¸¦æœ‰å¼€ç®±å³ç”¨çš„å®¢æˆ·ç«¯é¢„æµ‹åŠŸèƒ½, ç„¶è€Œ, å®ƒä¸èƒ½é¢„æµ‹æ‰€æœ‰. GASä¸­å®¢æˆ·ç«¯é¢„æµ‹çš„æ„æ€æ˜¯å®¢æˆ·ç«¯æ— éœ€ç­‰å¾…æœåŠ¡ç«¯çš„è®¸å¯è€Œæ¿€æ´»<code>GameplayAbility</code>å’Œåº”ç”¨<code>GameplayEffect</code>. å®ƒå¯ä»¥â€é¢„æµ‹â€è®¸å¯å…¶å¯ä»¥è¿™æ ·åšçš„æœåŠ¡ç«¯å’Œå…¶åº”ç”¨<code>GameplayEffect</code>çš„ç›®æ ‡. æœåŠ¡ç«¯åœ¨å®¢æˆ·ç«¯æ¿€æ´»ä¹‹åè¿è¡Œ<code>GameplayAbility</code>(ç½‘ç»œå»¶è¿Ÿ)å¹¶å‘ŠçŸ¥å®¢æˆ·ç«¯å®ƒçš„é¢„æµ‹æ˜¯å¦æ­£ç¡®, å¦‚æœå®¢æˆ·ç«¯çš„é¢„æµ‹å‡ºé”™, é‚£ä¹ˆå®ƒå°±ä¼šâ€å›æ»šâ€å…¶â€é”™è¯¯é¢„æµ‹â€çš„ä¿®æ”¹ä»¥åŒ¹é…æœåŠ¡ç«¯.  </p><p>GASç›¸å…³é¢„æµ‹çš„æœ€ä½³æºç æ˜¯æ’ä»¶æºç ä¸­çš„<code>GameplayPrediction.h</code>.  </p><p>Epicçš„ç†å¿µæ˜¯åªèƒ½é¢„æµ‹â€ä¸å—ä¼¤å®³(get away with)â€çš„äº‹æƒ…. ä¾‹å¦‚, Paragonå’ŒFortniteä¸èƒ½é¢„æµ‹ä¼¤å®³å€¼, å®ƒä»¬å¾ˆå¯èƒ½å¯¹ä¼¤å®³å€¼ä½¿ç”¨äº†<a href="#concepts-ge-ec">ExecutionCalculations</a>, è€Œè¿™æ— è®ºå¦‚ä½•æ˜¯ä¸èƒ½é¢„æµ‹çš„. è¿™å¹¶ä¸æ˜¯è¯´ä½ ä¸èƒ½è¯•ç€é¢„æµ‹åƒä¼¤å®³å€¼è¿™æ ·çš„äº‹æƒ…, æ— è®ºå¦‚ä½•, å¦‚æœä½ è¿™æ ·åšäº†å¹¶ä¸”æ•ˆæœå¾ˆå¥½, é‚£å°±æ˜¯æå¥½çš„.  </p><blockquote><p>â€¦ we are also not all in on a â€œpredict everything: seamlessly and automaticallyâ€ solution. We still feel player prediction is best kept to a minimum (meaning: predict the minimum amount of stuff you can get away with).</p></blockquote><p><em>æ¥è‡ªEpicçš„Dave Rattiåœ¨æ–°çš„<a href="#concepts-p-npp">ç½‘ç»œé¢„æµ‹æ’ä»¶</a>ä¸­çš„æ³¨é‡Š.</em>  </p><p><strong>ä»€ä¹ˆæ˜¯å¯é¢„æµ‹çš„:</strong>  </p><ul><li>Abilityæ¿€æ´»</li><li>è§¦å‘äº‹ä»¶</li><li>GameplayEffectåº”ç”¨<ul><li>Attributeä¿®æ”¹(ä¾‹å¤–: æ‰§è¡Œ(Execution)ç›®å‰æ— æ³•é¢„æµ‹, åªèƒ½æ˜¯Attribute Modifiy)</li><li>GameplayTagä¿®æ”¹</li></ul></li><li>GameplayCueäº‹ä»¶(å¯é¢„æµ‹GameplayEffectä¸­çš„å’Œå®ƒä»¬è‡ªå·±)</li><li>è’™å¤ªå¥‡</li><li>ç§»åŠ¨(å†…å»ºåœ¨UE4 UCharacterMovementä¸­)</li></ul><p><strong>ä»€ä¹ˆæ˜¯ä¸å¯é¢„æµ‹çš„:</strong>  </p><ul><li>GameplayEffectç§»é™¤</li><li>GameplayEffectå‘¨æœŸæ•ˆæœ(dots ticking)</li></ul><p><em>æºè‡ª<code>GameplayPrediction.h</code></em>  </p><p>å°½ç®¡æˆ‘ä»¬å¯ä»¥é¢„æµ‹<code>GameplayEffect</code>çš„åº”ç”¨, ä½†æ˜¯ä¸èƒ½é¢„æµ‹<code>GameplayEffect</code>çš„ç§»é™¤. ç»•è¿‡è¿™æ¡é™åˆ¶çš„ä¸€ä¸ªæ–¹æ³•æ˜¯å½“æƒ³è¦ç§»é™¤<code>GameplayEffect</code>æ—¶, å¯ä»¥é¢„æµ‹æ€§åœ°æ‰§è¡Œç›¸åçš„æ•ˆæœ, å‡è®¾æˆ‘ä»¬è¦é™ä½40%ç§»åŠ¨é€Ÿåº¦, å¯ä»¥é€šè¿‡åº”ç”¨å¢åŠ 40%ç§»åŠ¨é€Ÿåº¦çš„buffæ¥é¢„æµ‹æ€§åœ°å°†å…¶ç§»é™¤, ä¹‹ååŒæ—¶ç§»é™¤è¿™ä¸¤ä¸ª<code>GameplayEffect</code>. è¿™å¹¶ä¸æ˜¯å¯¹æ¯ä¸ªåœºæ™¯éƒ½é€‚ç”¨, å› æ­¤ä»ç„¶éœ€è¦å¯¹é¢„æµ‹æ€§åœ°ç§»é™¤<code>GameplayEffect</code>çš„æ”¯æŒ. æ¥è‡ªEpicçš„Dave Rattiå·²ç»è¡¨è¾¾è¿‡åœ¨<a href="https://epicgames.ent.box.com/s/m1egifkxv3he3u3xezb9hzbgroxyhx89">GASçš„è¿­ä»£ç‰ˆæœ¬ä¸­</a>å¢åŠ å®ƒçš„æœŸæœ›.  </p><p>å› ä¸ºæˆ‘ä»¬ä¸èƒ½é¢„æµ‹<code>GameplayEffect</code>çš„ç§»é™¤, æ‰€ä»¥å°±ä¸èƒ½å®Œå…¨é¢„æµ‹<code>GameplayAbility</code>çš„å†·å´æ—¶é—´, å¹¶ä¸”ä¹Ÿæ²¡æœ‰ç›¸åçš„<code>GameplayEffect</code>è¿™ç§å˜é€šæ–¹æ¡ˆå¯ä¾›ä½¿ç”¨. æœåŠ¡ç«¯åŒæ­¥çš„<code>Cooldown GE</code>å°†ä¼šå­˜äºå®¢æˆ·ç«¯ä¸Š, å¹¶ä¸”ä»»ä½•å¯¹å…¶ç»•è¿‡çš„å°è¯•(ä¾‹å¦‚ä½¿ç”¨<code>Minimal</code>åŒæ­¥æ¨¡å¼)éƒ½ä¼šè¢«æœåŠ¡ç«¯æ‹’ç». è¿™æ„å‘³ç€é«˜å»¶è¿Ÿçš„å®¢æˆ·ç«¯ä¼šèŠ±è´¹è¾ƒé•¿äº‹ä»¶æ¥å‘ŠçŸ¥æœåŠ¡ç«¯å¼€å§‹å†·å´å’Œæ¥æ”¶åˆ°æœåŠ¡ç«¯<code>Cooldown GE</code>çš„ç§»é™¤. è¿™æ„å‘³ç€é«˜å»¶è¿Ÿçš„ç©å®¶ä¼šæ¯”ä½å»¶è¿Ÿçš„ç©å®¶æœ‰æ›´ä½çš„è§¦å‘ç‡, ä»è€ŒåŠ£åŠ¿äºä½å»¶è¿Ÿç©å®¶. Fortniteé€šè¿‡ä½¿ç”¨è‡ªå®šä¹‰Bookkeepingè€Œä¸æ˜¯<code>Cooldown GE</code>çš„æ–¹æ³•é¿å…äº†è¯¥é—®é¢˜.  </p><p>å…³äºé¢„æµ‹ä¼¤å®³å€¼, æˆ‘ä¸ªäººä¸å»ºè®®ä½¿ç”¨, å°½ç®¡å®ƒæ˜¯å¤§å¤šæ•°åˆšæ¥è§¦GASçš„äººæœ€å…ˆåšçš„äº‹æƒ…ä¹‹ä¸€, æˆ‘ç‰¹åˆ«ä¸å»ºè®®å°è¯•é¢„æµ‹æ­»äº¡, è™½ç„¶ä½ å¯ä»¥é¢„æµ‹ä¼¤å®³å€¼, ä½†æ˜¯è¿™æ ·åšå¾ˆæ£˜æ‰‹. å¦‚æœä½ é”™è¯¯é¢„æµ‹åœ°åº”ç”¨äº†ä¼¤å®³, é‚£ä¹ˆç©å®¶å°†ä¼šçœ‹åˆ°æ•Œäººçš„ç”Ÿå‘½å€¼ä¼šè·³åŠ¨, å¦‚æœä½ å°è¯•é¢„æµ‹æ­»äº¡, é‚£ä¹ˆè¿™å°†ä¼šæ˜¯ç‰¹åˆ«å°´å°¬å’Œä»¤äººæ²®ä¸§çš„, å‡è®¾ä½ é”™è¯¯é¢„æµ‹äº†æŸä¸ª<code>Character</code>çš„æ­»äº¡, é‚£ä¹ˆå®ƒå°±ä¼šå¼€å¯å¸ƒå¨ƒå¨ƒæ¨¡æ‹Ÿ, åªæœ‰å½“æœåŠ¡ç«¯çº æ­£åæ‰ä¼šåœæ­¢å¸ƒå¨ƒå¨ƒæ¨¡æ‹Ÿå¹¶ç»§ç»­å‘ä½ å°„å‡».</p><p><strong>Note:</strong> ä¿®æ”¹<code>Attribute</code>çš„<code>å³åˆ»(Instant)GameplayEffect</code>(åƒ<code>Cost GE</code>)åœ¨ä½ è‡ªèº«å¯ä»¥æ— ç¼é¢„æµ‹, é¢„æµ‹ä¿®æ”¹å…¶ä»–Characterçš„<code>å³åˆ»(Instant)Attribute</code>ä¼šæ˜¾ç¤ºçŸ­æš‚çš„å¼‚å¸¸æˆ–è€…<code>Attribute</code>ä¸­çš„æš‚æ—¶æ€§é—®é¢˜. é¢„æµ‹çš„<code>å³åˆ»(Instant)GameplayEffect</code>å®é™…ä¸Šè¢«è§†ä¸º<code>æ— é™(Infinite)GameplayEffect</code>, å› æ­¤å¦‚æœé”™è¯¯é¢„æµ‹çš„è¯è¿˜å¯ä»¥å›æ»š. å½“æœåŠ¡ç«¯çš„<code>GameplayEffect</code>è¢«åº”ç”¨æ—¶, å…¶å®æ˜¯å­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„<code>GameplayEffect</code>çš„, ä¼šåœ¨çŸ­æ—¶é—´å†…é€ æˆ<code>Modifier</code>åº”ç”¨ä¸¤æ¬¡æˆ–è€…ä¸åº”ç”¨, å…¶æœ€ç»ˆä¼šçº æ­£è‡ªèº«, ä½†æ˜¯æœ‰æ—¶å€™è¿™ä¸ªå¼‚å¸¸ç°è±¡å¯¹ç©å®¶æ¥è¯´æ˜¯æ˜¾è‘—çš„.  </p><p>GASçš„é¢„æµ‹å®ç°å°è¯•è§£å†³çš„é—®é¢˜:  </p><blockquote><ol><li>â€œæˆ‘èƒ½è¿™æ ·åšå—?â€(Can I do this?) é¢„æµ‹çš„åŸºæœ¬åè®®.</li><li>â€œæ’¤é”€â€(Undo) å½“é¢„æµ‹é”™è¯¯æ—¶å¦‚ä½•æ¶ˆé™¤å…¶å‰¯ä½œç”¨.</li><li>â€œé‡ç°â€(Redo) å¦‚ä½•é¿å…å·²ç»åœ¨å®¢æˆ·ç«¯é¢„æµ‹ä½†è¿˜æ˜¯ä»æœåŠ¡ç«¯åŒæ­¥çš„é‡æ’­å‰¯ä½œç”¨.</li><li>â€œå®Œæ•´â€(Completeness) å¦‚ä½•ç¡®è®¤æˆ‘ä»¬çœŸçš„é¢„æµ‹äº†æ‰€æœ‰å‰¯ä½œç”¨.</li><li>â€œä¾èµ–â€(Dependencies) å¦‚ä½•ç®¡ç†ä¾èµ–é¢„æµ‹å’Œé¢„æµ‹äº‹ä»¶é“¾.</li><li>â€œé‡å†™â€(Override) å¦‚ä½•é¢„æµ‹åœ°é‡å†™ç”±æœåŠ¡ç«¯åŒæ­¥/æ‹¥æœ‰çš„çŠ¶æ€.</li></ol></blockquote><p>æºè‡ª<code>GameplayPrediction.h</code>  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-p-key"></a></p><h4 id="4-10-1-Prediction-Key"><a href="#4-10-1-Prediction-Key" class="headerlink" title="4.10.1 Prediction Key"></a>4.10.1 Prediction Key</h4><p>GASçš„é¢„æµ‹å»ºç«‹åœ¨<code>Prediction Key</code>çš„æ¦‚å¿µä¸Š, å…¶æ˜¯ä¸€ä¸ªç”±å®¢æˆ·ç«¯æ¿€æ´»<code>GameplayAbility</code>æ—¶ç”Ÿæˆçš„æ•´å‹æ ‡è¯†ç¬¦.  </p><ul><li>å®¢æˆ·ç«¯æ¿€æ´»<code>GameplayAbility</code>æ—¶ç”Ÿæˆ<code>Prediction Key</code>, è¿™æ˜¯<code>Activation Prediction Key</code>.  </li><li>å®¢æˆ·ç«¯ä½¿ç”¨<code>CallServerTryActivateAbility()</code>å°†è¯¥<code>Prediction Key</code>å‘é€åˆ°æœåŠ¡ç«¯.</li><li>å®¢æˆ·ç«¯åœ¨<code>Prediction Key</code>æœ‰æ•ˆæ—¶å°†å…¶æ·»åŠ åˆ°åº”ç”¨çš„æ‰€æœ‰<code>GameplayEffect</code>.</li><li>å®¢æˆ·ç«¯çš„<code>Prediction Key</code>å‡ºåŸŸ. ä¹‹åè¯¥<code>GameplayAbility</code>ä¸­çš„é¢„æµ‹æ•ˆæœ(Effect)éœ€è¦ä¸€ä¸ªæ–°çš„<a href="#concepts-p-windows">Scoped Prediction Window</a>.</li><li>æœåŠ¡ç«¯ä»å®¢æˆ·ç«¯æ¥æ”¶<code>Prediction Key</code>.</li><li>æœåŠ¡ç«¯å°†<code>Prediction Key</code>æ·»åŠ åˆ°å…¶åº”ç”¨çš„æ‰€æœ‰<code>GameplayEffect</code>.</li><li>æœåŠ¡ç«¯åŒæ­¥è¯¥<code>Prediction Key</code>å›å®¢æˆ·ç«¯.</li><li>å®¢æˆ·ç«¯ä½¿ç”¨<code>Prediction Key</code>ä»æœåŠ¡ç«¯æ¥æ”¶åŒæ­¥çš„<code>GameplayEffect</code>, è¯¥<code>Prediction Key</code>ç”¨äºåº”ç”¨<code>GameplayEffect</code>. å¦‚æœä»»ä½•åŒæ­¥çš„<code>GameplayEffect</code>ä¸å®¢æˆ·ç«¯ä½¿ç”¨ç›¸åŒ<code>Prediction Key</code>åº”ç”¨çš„<code>GameplayEffect</code>ç›¸åŒ¹é…, é‚£ä¹ˆå…¶å°±æ˜¯æ­£ç¡®é¢„æµ‹çš„. ç›®æ ‡ä¸Šæš‚æ—¶ä¼šæœ‰<code>GameplayEffect</code>çš„ä¸¤ä»½æ‹·è´ç›´åˆ°å®¢æˆ·ç«¯ç§»é™¤å®ƒé¢„æµ‹çš„é‚£ä¸€ä¸ª.</li><li>å®¢æˆ·ç«¯ä»æœåŠ¡ç«¯ä¸Šæ¥æ”¶å›<code>Prediction Key</code>, è¿™æ˜¯åŒæ­¥çš„<code>Prediction Key</code>, è¯¥<code>Prediction Key</code>ç°åœ¨è¢«æ ‡è®°ä¸ºé™ˆæ—§(Stale).</li><li>å®¢æˆ·ç«¯ç§»é™¤æ‰€æœ‰ç”±åŒæ­¥çš„é™ˆæ—§(Stale)<code>Prediction Key</code>åˆ›å»ºçš„<code>GameplayEffect</code>. ç”±æœåŠ¡ç«¯åŒæ­¥çš„<code>GameplayEffect</code>ä¼šæŒç»­å­˜åœ¨. ä»»ä½•å®¢æˆ·ç«¯æ·»åŠ çš„å’Œæ²¡æœ‰ä»æœåŠ¡ç«¯æ¥æ”¶åˆ°ä¸€ä¸ªåŒ¹é…çš„åŒæ­¥ç‰ˆæœ¬çš„éƒ½è¢«è§†ä¸ºé”™è¯¯é¢„æµ‹.</li></ul><p>åœ¨æºäº<code>Activation Prediction Key</code>æ¿€æ´»çš„<code>GameplayAbility</code>ä¸­çš„ä¸€ä¸ª<code>instruction &quot;window&quot;</code>åŸå­(Atomic)ç»„æœŸé—´, <code>Prediction Key</code>æ˜¯ä¿è¯æœ‰æ•ˆçš„, ä½ å¯ä»¥ç†è§£ä¸º<code>Prediction Key</code>åªåœ¨ä¸€å¸§æœŸé—´æ˜¯æœ‰æ•ˆçš„. ä»»ä½•æ½œåœ¨è¡Œä¸º<code>AbilityTask</code>çš„å›è°ƒå‡½æ•°å°†ä¸å†æ‹¥æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„<code>Prediction Key</code>, é™¤éè¯¥<code>AbilityTask</code>æœ‰å†…å»ºçš„å¯ä»¥ç”Ÿæˆæ–°<a href="#concepts-p-windows">Scoped Prediction Window</a>çš„åŒæ­¥ç‚¹(Sync Point).  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-p-windows"></a></p><h4 id="4-10-2-åœ¨Abilityä¸­åˆ›å»ºæ–°çš„é¢„æµ‹çª—å£-Prediction-Window"><a href="#4-10-2-åœ¨Abilityä¸­åˆ›å»ºæ–°çš„é¢„æµ‹çª—å£-Prediction-Window" class="headerlink" title="4.10.2 åœ¨Abilityä¸­åˆ›å»ºæ–°çš„é¢„æµ‹çª—å£(Prediction Window)"></a>4.10.2 åœ¨Abilityä¸­åˆ›å»ºæ–°çš„é¢„æµ‹çª—å£(Prediction Window)</h4><p>ä¸ºäº†åœ¨<code>AbilityTask</code>çš„å›è°ƒå‡½æ•°ä¸­é¢„æµ‹æ›´å¤šçš„è¡Œä¸º, æˆ‘ä»¬éœ€è¦ä½¿ç”¨æ–°çš„<code>Scoped Prediction Key</code>åˆ›å»º<code>Scoped Prediction Window</code>, æœ‰æ—¶è¿™è¢«è§†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é—´çš„åŒæ­¥ç‚¹(Sync Point). ä¸€äº›<code>AbilityTask</code>, åƒæ‰€æœ‰è¾“å…¥ç›¸å…³çš„<code>AbilityTask</code>, å¸¦æœ‰åˆ›å»ºæ–°<code>Scoped Prediction Window</code>çš„å†…å»ºåŠŸèƒ½, æ„å‘³ç€<code>AbilityTask</code>å›è°ƒå‡½æ•°ä¸­çš„åŸå­(Atomic)ä»£ç æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„<code>Scoped Prediction Key</code>å¯ä¾›ä½¿ç”¨. åƒ<code>WaitDelay</code>çš„å…¶ä»–Taskæ²¡æœ‰åˆ›å»ºæ–°<code>Scoped Prediction Window</code>ä»¥ç”¨äºå›è°ƒå‡½æ•°çš„å†…å»ºä»£ç , å¦‚æœä½ éœ€è¦åœ¨<code>WaitDelay</code>è¿™æ ·çš„<code>AbilityTask</code>åé¢„æµ‹è¡Œä¸º, å°±å¿…é¡»ä½¿ç”¨<code>OnlyServerWait</code>é€‰é¡¹çš„<code>WaitNetSync AbilityTask</code>æ‰‹åŠ¨æ¥åš, å½“å®¢æˆ·ç«¯è§¦å‘<code>OnlyServerWait</code>é€‰é¡¹çš„<code>WaitNetSync</code>æ—¶, å®ƒä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„åŸºäº<code>GameplayAbility</code>çš„<code>Activation Prediction Key</code>çš„<code>Scoped Prediction Key</code>, RPCå…¶åˆ°æœåŠ¡ç«¯, å¹¶å°†å…¶æ·»åŠ åˆ°æ‰€æœ‰æ–°åº”ç”¨çš„<code>GameplayEffect</code>. å½“æœåŠ¡ç«¯è§¦å‘<code>OnlyServerWait</code>é€‰é¡¹çš„<code>WaitNetSync</code>æ—¶, å®ƒä¼šåœ¨ç»§ç»­å‰ç­‰å¾…ç›´åˆ°æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ–°çš„<code>Scoped Prediction Key</code>, è¯¥<code>Scoped Prediction Key</code>ä¼šæ‰§è¡Œå’Œ<code>Activation Prediction Key</code>åŒæ ·çš„æ“ä½œ â€”â€” åº”ç”¨åˆ°<code>GameplayEffect</code>å¹¶åŒæ­¥å›å®¢æˆ·ç«¯æ ‡è®°ä¸ºé™ˆæ—§(Stale). <code>Scoped Prediction Key</code>ç›´åˆ°å‡ºåŸŸå‰éƒ½æœ‰æ•ˆ, ä¹Ÿå°±è¡¨ç¤º<code>Scoped Prediction Window</code>å·²ç»å…³é—­äº†. æ‰€ä»¥åªæœ‰åŸå­(Atomic)æ“ä½œ, nothing latent, å¯ä»¥ä½¿ç”¨æ–°çš„<code>Scoped Prediction Key</code>.  </p><p>ä½ å¯ä»¥æ ¹æ®éœ€æ±‚åˆ›å»ºä»»æ„æ•°é‡çš„<code>Scoped Prediction Window</code>.  </p><p>å¦‚æœä½ æƒ³æ·»åŠ åŒæ­¥ç‚¹(Sync Point)åŠŸèƒ½åˆ°è‡ªå·±çš„è‡ªå®šä¹‰<code>AbilityTask</code>, è¯·æŸ¥çœ‹é‚£äº›è¾“å…¥<code>AbilityTask</code>æ˜¯å¦‚ä½•ä»æ ¹æœ¬ä¸Šæ³¨å…¥<code>WaitNetSync AbilityTask</code>ä»£ç åˆ°è‡ªèº«çš„.  </p><p><strong>Note:</strong> å½“ä½¿ç”¨<code>WaitNetSync</code>æ—¶, ä¼šé˜»å¡æœåŠ¡ç«¯<code>GameplayAbility</code>ç»§ç»­æ‰§è¡Œç›´åˆ°å…¶æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„æ¶ˆæ¯. è¿™å¯èƒ½ä¼šè¢«ç ´è§£æ¸¸æˆçš„æ¶æ„ç”¨æˆ·æ»¥ç”¨ä»¥æ•…æ„å»¶è¿Ÿå‘é€æ–°çš„<code>Scoped Prediction Key</code>, å°½ç®¡Epicå¾ˆå°‘ä½¿ç”¨<code>WaitNetSync</code>, ä½†å¦‚æœä½ å¯¹æ­¤æ‹…å¿§çš„è¯, å…¶å»ºè®®åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å»¶è¿Ÿçš„æ–°<code>AbilityTask</code>, å®ƒä¼šè‡ªåŠ¨ç»§ç»­è¿è¡Œè€Œæ— éœ€ç­‰å¾…å®¢æˆ·ç«¯æ¶ˆæ¯.  </p><p>æ ·ä¾‹é¡¹ç›®åœ¨å¥”è·‘<code>GameplayAbility</code>ä¸­ä½¿ç”¨äº†<code>WaitNetSync</code>ä»¥åœ¨æ¯æ¬¡åº”ç”¨è€åŠ›èŠ±è´¹æ—¶åˆ›å»ºæ–°çš„<code>Scoped Prediction Window</code>, è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œé¢„æµ‹. ç†æƒ³ä¸Šå½“åº”ç”¨èŠ±è´¹å’Œå†·å´æ—¶é—´æ—¶æˆ‘ä»¬å°±æƒ³è¦ä¸€ä¸ªæœ‰æ•ˆçš„<code>Prediction Key</code>.  </p><p>å¦‚æœä½ æœ‰ä¸€ä¸ªåœ¨æ‰€å±(Owning)å®¢æˆ·ç«¯æ‰§è¡Œä¸¤æ¬¡çš„é¢„æµ‹<code>GameplayEffect</code>, é‚£ä¹ˆä½ çš„<code>Prediction Key</code>å°±æ˜¯é™ˆæ—§(Stall)çš„, å¹¶ä¸”æ­£åœ¨ç»å†â€redoâ€é—®é¢˜. ä½ é€šå¸¸å¯ä»¥åœ¨åº”ç”¨<code>GameplayEffect</code>ä¹‹å‰å°†<code>OnlyServerWait</code>é€‰é¡¹çš„<code>WaitNetSync AbilityTask</code>æ”¾åˆ°æ­£ç¡®çš„ä½ç½®ä»¥åˆ›å»ºæ–°çš„<code>Scoped Prediction Key</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-p-spawn"></a></p><h4 id="4-10-3-é¢„æµ‹æ€§åœ°ç”ŸæˆActor"><a href="#4-10-3-é¢„æµ‹æ€§åœ°ç”ŸæˆActor" class="headerlink" title="4.10.3 é¢„æµ‹æ€§åœ°ç”ŸæˆActor"></a>4.10.3 é¢„æµ‹æ€§åœ°ç”ŸæˆActor</h4><p>åœ¨å®¢æˆ·ç«¯é¢„æµ‹æ€§åœ°ç”ŸæˆActoræ˜¯ä¸€é¡¹é«˜çº§æŠ€æœ¯. GASå¯¹æ­¤æ²¡æœ‰æä¾›å¼€ç®±å³ç”¨çš„åŠŸèƒ½(<code>SpawnActor AbilityTask</code>åªåœ¨æœåŠ¡ç«¯ç”ŸæˆActor). å…¶å…³é”®æ˜¯åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½ç”ŸæˆåŒæ­¥çš„Actor.  </p><p>å¦‚æœActoråªæ˜¯ç”¨äºåœºæ™¯è£…é¥°æˆ–è€…ä¸æœåŠ¡äºä»»ä½•æ¸¸æˆé€»è¾‘, ç®€å•çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯é‡å†™Actorçš„<code>IsNetRelevantFor()</code>å‡½æ•°ä»¥é™åˆ¶æœåŠ¡ç«¯åŒæ­¥åˆ°æ‰€å±(Owning)å®¢æˆ·ç«¯, æ‰€å±(Owning)å®¢æˆ·ç«¯ä¼šæ‹¥æœ‰å…¶æœ¬åœ°ç”Ÿæˆçš„ç‰ˆæœ¬, è€ŒæœåŠ¡ç«¯å’Œå…¶ä»–å®¢æˆ·ç«¯ä¼šæ‹¥æœ‰æœåŠ¡ç«¯åŒæ­¥çš„ç‰ˆæœ¬.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">APAReplicatedActorExceptOwner::IsNetRelevantFor</span><span class="params">(<span class="type">const</span> AActor * RealViewer, <span class="type">const</span> AActor * ViewTarget, <span class="type">const</span> FVector &amp; SrcLocation)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> !<span class="built_in">IsOwnedBy</span>(ViewTarget);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç”Ÿæˆçš„Actorå½±å“äº†æ¸¸æˆé€»è¾‘, åƒæŠ•æ·ç‰©å°±éœ€è¦é¢„æµ‹ä¼¤å®³å€¼, é‚£ä¹ˆä½ éœ€è¦æœ¬æ–‡æ¡£èŒƒå›´ä¹‹å¤–çš„é«˜çº§çŸ¥è¯†, åœ¨Epic Gamesçš„Githubä¸ŠæŸ¥çœ‹UnrealTournamentæ˜¯å¦‚ä½•ç”ŸæˆæŠ•æ·ç‰©çš„, å®ƒæœ‰ä¸€ä¸ªåªåœ¨æ‰€å±(Owning)å®¢æˆ·ç«¯ç”Ÿæˆä¸”ä¸æœåŠ¡ç«¯åŒæ­¥çš„æŠ•æ·ç‰©.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-p-future"></a></p><h4 id="4-10-4-GASä¸­é¢„æµ‹çš„æœªæ¥"><a href="#4-10-4-GASä¸­é¢„æµ‹çš„æœªæ¥" class="headerlink" title="4.10.4 GASä¸­é¢„æµ‹çš„æœªæ¥"></a>4.10.4 GASä¸­é¢„æµ‹çš„æœªæ¥</h4><p><code>GameplayPrediction.h</code>è¯´æ˜äº†åœ¨æœªæ¥å¯èƒ½ä¼šå¢åŠ é¢„æµ‹<code>GameplayEffect</code>ç§»é™¤å’Œå‘¨æœŸ<code>GameplayEffect</code>çš„åŠŸèƒ½.  </p><p>æ¥è‡ªEpicçš„Dave Rattiå·²ç»<a href="https://epicgames.ent.box.com/s/m1egifkxv3he3u3xezb9hzbgroxyhx89">è¡¨è¾¾è¿‡å¯¹å…¶ä¿®å¤çš„å…´è¶£</a>, åŒ…æ‹¬é¢„æµ‹å†·å´æ—¶é—´æ—¶çš„å»¶è¿Ÿé—®é¢˜å’Œé«˜å»¶è¿Ÿç©å®¶å¯¹ä½å»¶è¿Ÿç©å®¶çš„åŠ£åŠ¿.  </p><p>æ¥è‡ªEpicä¹‹æ‰‹çš„æ–°<a href="#concepts-p-npp">ç½‘ç»œé¢„æµ‹æ’ä»¶(Network Prediction plugin)</a>æœŸæœ›èƒ½ä¸GASå……åˆ†äº¤äº’, å°±åƒåœ¨æ¬¡ä¹‹å‰çš„<code>CharacterMovementComponent</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-p-npp"></a></p><h4 id="4-10-5-ç½‘ç»œé¢„æµ‹æ’ä»¶-Network-Prediction-plugin"><a href="#4-10-5-ç½‘ç»œé¢„æµ‹æ’ä»¶-Network-Prediction-plugin" class="headerlink" title="4.10.5 ç½‘ç»œé¢„æµ‹æ’ä»¶(Network Prediction plugin)"></a>4.10.5 ç½‘ç»œé¢„æµ‹æ’ä»¶(Network Prediction plugin)</h4><p>Epicæœ€è¿‘å‘èµ·äº†ä¸€é¡¹å€¡è®®, å°†ä½¿ç”¨æ–°çš„ç½‘ç»œé¢„æµ‹æ’ä»¶æ›¿æ¢<code>CharacterMovementComponent</code>, è¯¥æ’ä»¶ä»å¤„äºèµ·æ­¥é˜¶æ®µ, ä½†æ˜¯åœ¨Unreal Engine Githubä¸Šå·²ç»å¯ä»¥è®¿é—®äº†, ç°åœ¨è¯´æœªæ¥å“ªä¸ªå¼•æ“ç‰ˆæœ¬å°†é¦–æ¬¡æ­è½½å…¶è¯•éªŒç‰ˆè¿˜ä¸ºæ—¶å°šæ—©.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-targeting"></a></p><h3 id="4-11-Targeting"><a href="#4-11-Targeting" class="headerlink" title="4.11 Targeting"></a>4.11 Targeting</h3><p><a name="concepts-targeting-data"></a></p><h4 id="4-11-1-Target-Data"><a href="#4-11-1-Target-Data" class="headerlink" title="4.11.1 Target Data"></a>4.11.1 Target Data</h4><p><a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/Abilities/FGameplayAbilityTargetData/index.html">FGameplayAbilityTargetData</a>æ˜¯ç”¨äºé€šè¿‡ç½‘ç»œä¼ è¾“å®šä½æ•°æ®çš„é€šç”¨ç»“æ„ä½“. <code>TargetData</code>ä¸€èˆ¬ç”¨äºä¿å­˜AActor/UObjectå¼•ç”¨, FHitResultå’Œå…¶ä»–é€šç”¨çš„Location/Direction/Originä¿¡æ¯. ç„¶è€Œ, æœ¬è´¨ä¸Šä½ å¯ä»¥ç»§æ‰¿å®ƒä»¥å¢æ·»æƒ³è¦çš„ä»»ä½•æ•°æ®, å…¶å¯ä»¥ç®€å•ç†è§£ä¸ºåœ¨<a href="#concepts-ga-data">å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„<code>GameplayAbility</code>ä¸­ä¼ é€’æ•°æ®</a>. åŸºç¡€ç»“æ„ä½“<code>FGameplayAbilityTargetData</code>ä¸èƒ½ç›´æ¥ä½¿ç”¨, è€Œæ˜¯è¦ç»§æ‰¿å®ƒ. GASçš„<code>GameplayAbilityTargetTypes.h</code>ä¸­æœ‰ä¸€äº›å¼€ç®±å³ç”¨çš„æ´¾ç”Ÿ<code>FGameplayAbilityTargetData</code>ç»“æ„ä½“.  </p><p><code>TargetData</code>ä¸€èˆ¬ç”±<a href="#concepts-targeting-actors">Target Actor</a>æˆ–è€…æ‰‹åŠ¨åˆ›å»º, ä¾›<a href="#concepts-at">AbilityTask</a>ä½¿ç”¨, æˆ–è€…<a href="#concepts-ge">GameplayEffect</a>é€šè¿‡<a href="#concepts-ge-context">EffectContext</a>ä½¿ç”¨. å› ä¸ºå…¶ä½äº<code>EffectContext</code>ä¸­, æ‰€ä»¥<a href="#concepts-ge-ec">Execution</a>, <a href="#concepts-ge-mmc">MMC</a>, <a href="#concepts-gc">GameplayCue</a>å’Œ<a href="#concepts-as">AttributeSet</a>çš„åç«¯å‡½æ•°å¯ä»¥è®¿é—®è¯¥<code>TargetData</code>.  </p><p>æˆ‘ä»¬ä¸€èˆ¬ä¸ç›´æ¥ä¼ é€’<code>FGameplayAbilityTargetData</code>è€Œæ˜¯ä½¿ç”¨<a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/Abilities/FGameplayAbilityTargetDataHandle/index.html">FGameplayAbilityTargetDataHandle</a>, å…¶åŒ…å«ä¸€ä¸ª<code>FGameplayAbilityTargetData</code>æŒ‡é’ˆç±»å‹çš„TArray, è¿™ä¸ªä¸­é—´ç»“æ„ä½“å¯ä»¥ä¸º<code>TargetData</code>çš„å¤šæ€æ€§æä¾›æ”¯æŒ.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-targeting-actors"></a></p><h4 id="4-11-2-Target-Actor"><a href="#4-11-2-Target-Actor" class="headerlink" title="4.11.2 Target Actor"></a>4.11.2 Target Actor</h4><p><code>GameplayAbility</code>ä½¿ç”¨<code>WaitTargetData AbilityTask</code>ç”Ÿæˆ<a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/Abilities/AGameplayAbilityTargetActor/index.html">TargetActor</a>ä»¥åœ¨ä¸–ç•Œä¸­å¯è§†åŒ–å’Œè·å–å®šä½ä¿¡æ¯. <code>TargetActor</code>å¯ä»¥é€‰æ‹©ä½¿ç”¨<a href="#concepts-targeting-reticles">GameplayAbilityWorldReticles</a>æ˜¾ç¤ºå½“å‰ç›®æ ‡. ç»ç¡®è®¤å, å®šä½ä¿¡æ¯å°†ä½œä¸º<a href="#concepts-targeting-data">TargetData</a>è¿”å›, ä¹‹åå…¶å¯ä»¥ä¼ é€’ç»™<code>GameplayEffect</code>.  </p><p><code>TargetActor</code>æ˜¯åŸºäº<code>AActor</code>çš„, å› æ­¤å®ƒå¯ä»¥ä½¿ç”¨ä»»æ„ç§ç±»çš„å¯è§†ç»„ä»¶æ¥è¡¨ç¤ºå…¶åœ¨ä½•å¤„å’Œå¦‚ä½•å®šä½çš„, ä¾‹å¦‚é™æ€ç½‘æ ¼ç‰©(Static Mesh)å’Œè´´èŠ±(Decal). é™æ€ç½‘æ ¼ç‰©(Static Mesh)å¯ä»¥ç”¨æ¥å¯è§†åŒ–è§’è‰²å°†è¦å»ºé€ çš„ç‰©ä½“, è´´èŠ±(Decal)å¯ä»¥ç”¨æ¥è¡¨ç°åœ°é¢ä¸Šçš„æ•ˆæœåŒºåŸŸ. æ ·ä¾‹é¡¹ç›®ä½¿ç”¨å¸¦æœ‰åœ°é¢è´´èŠ±çš„<a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/Abilities/AGameplayAbilityTargetActor_Grou-/index.html">AGameplayAbilityTargetActor_GroundTrace</a>è¡¨ç¤ºé™¨çŸ³æŠ€èƒ½çš„ä¼¤å®³åŒºåŸŸæ•ˆæœ. å®ƒä¹Ÿå¯ä»¥ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤º, ä¾‹å¦‚, GASShooterä¸­çš„æªæ”¯å‘½ä¸­åˆ¤æ–­, è¦å¯¹ç›®æ ‡çš„å°„çº¿æ£€æµ‹æ˜¾ç¤ºäº›ä»€ä¹ˆå°±æ˜¯æ²¡æœ‰æ„ä¹‰çš„.  </p><p>å…¶ä½¿ç”¨åŸºæœ¬çš„å°„çº¿æˆ–è€…Overlapæ•è·å®šä½ä¿¡æ¯, å¹¶æ ¹æ®<code>TargetActor</code>çš„å®ç°å°†<code>FHitResult</code>æˆ–<code>AActor</code>æ•°ç»„è½¬æ¢ä¸º<code>TargetData</code>. <code>WaitTargetData AbilityTask</code>é€šè¿‡<code>TEnumAsByte&lt;EGameplayTargetingConfirmation::Type&gt; ConfirmationType</code>å‚æ•°å†³å®šç›®æ ‡ä½•æ—¶è¢«ç¡®è®¤, å½“ä¸ä½¿ç”¨<code>TEnumAsByte&lt;EGameplayTargetingConfirmation::Type::Instant</code>æ—¶, <code>TargetActor</code>ä¸€èˆ¬å°±åœ¨<code>Tick()</code>ä¸­æ‰§è¡Œå°„çº¿/Overlap, å¹¶æ ¹æ®å®ƒçš„å®ç°æ¥æ›´æ–°ä½ç½®ä¿¡æ¯åˆ°<code>FHitResult</code>. å°½ç®¡æ˜¯åœ¨<code>Tick()</code>ä¸­æ‰§è¡Œçš„å°„çº¿/Overlap, ä½†æ˜¯ä¸€èˆ¬ä¸ç”¨æ‹…å¿ƒ, å› ä¸ºå®ƒæ˜¯ä¸åŒæ­¥çš„å¹¶ä¸”ä¸€èˆ¬æ²¡æœ‰å¤šä¸ª(å°½ç®¡å­˜åœ¨å¤šä¸ª)<code>TargetActor</code>åŒæ—¶è¿è¡Œ, åªæ˜¯è¦ç•™æ„å®ƒä½¿ç”¨çš„æ˜¯<code>Tick()</code>, ä¸€äº›å¤æ‚çš„<code>TargetActor</code>å¯èƒ½ä¼šåœ¨å…¶ä¸­åšå¾ˆå¤šäº‹æƒ…, å°±åƒGASShooterä¸­ç«ç®­ç­’çš„äºŒæŠ€èƒ½. å½“<code>Tick()</code>ä¸­çš„æ£€æµ‹å¯¹å®¢æˆ·ç«¯å“åº”éå¸¸é¢‘ç¹æ—¶, å¦‚æœæ€§èƒ½å½±å“å¾ˆå¤§çš„è¯, ä½ å¯èƒ½å°±è¦è€ƒè™‘é™ä½<code>TargetActor</code>çš„Tické¢‘ç‡. å¯¹äº<code>TEnumAsByte&lt;EGameplayTargetingConfirmation::Type::Instant</code>, <code>TargetActor</code>ä¼šç«‹å³ç”Ÿæˆ, äº§ç”Ÿ<code>TargetData</code>, ç„¶åé”€æ¯, å¹¶ä¸”ä»ä¸ä¼šè°ƒç”¨<code>Tick()</code>.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">EGameplayTargetingConfirmation::Type</th><th style="text-align:center">ä½•æ—¶ç¡®è®¤Target</th></tr></thead><tbody><tr><td style="text-align:center">Instant</td><td style="text-align:center">è¯¥å®šä½æ— éœ€ç‰¹æ®Šé€»è¾‘å³å¯ç«‹å³è¿›è¡Œ, æˆ–è€…ç”¨æˆ·è¾“å…¥å†³å®šä½•æ—¶å¼€å§‹.</td></tr><tr><td style="text-align:center">UserConfirmed</td><td style="text-align:center">å½“<a href="#concepts-ga-input">Abilityç»‘å®šåˆ°<code>Confirm</code>è¾“å…¥</a>ä¸”ç”¨æˆ·ç¡®è®¤æˆ–è°ƒç”¨<code>UAbilitySystemComponent::TargetConfirm()</code>æ—¶è§¦å‘è¯¥å®šä½. <code>TargetActor</code>ä¹Ÿä¼šå“åº”ç»‘å®šçš„<code>Cancel</code>è¾“å…¥æˆ–è€…è°ƒç”¨<code>UAbilitySystemComponent::TargetCancel()</code>æ¥å–æ¶ˆå®šä½.</td></tr><tr><td style="text-align:center">Custom</td><td style="text-align:center">GameplayTargeting Abilityè´Ÿè´£è°ƒç”¨<code>UGameplayAbility::ConfirmTaskByInstanceName()</code>æ¥å†³å®šä½•æ—¶å‡†å¤‡å¥½å®šä½æ•°æ®. <code>TargetActor</code>ä¹Ÿå¯ä»¥å“åº”<code>UGameplayAbility::CancelTaskByInstanceName()</code>æ¥å–æ¶ˆå®šä½.</td></tr><tr><td style="text-align:center">CustomMulti</td><td style="text-align:center">GameplayTargeting Abilityè´Ÿè´£è°ƒç”¨<code>UGameplayAbility::ConfirmTaskByInstanceName()</code>æ¥å†³å®šä½•æ—¶å‡†å¤‡å¥½å®šä½æ•°æ®. <code>TargetActor</code>ä¹Ÿå¯ä»¥å“åº”<code>UGameplayAbility::CancelTaskByInstanceName()</code>æ¥å–æ¶ˆå®šä½. ä¸åº”åœ¨æ•°æ®ç”Ÿæˆåå°±ç»“æŸAbilityTask, å› ä¸ºå…¶å…è®¸å¤šæ¬¡ç¡®è®¤.</td></tr></tbody></table></div><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„<code>TargetActor</code>éƒ½æ”¯æŒæ¯ä¸ª<code>EGameplayTargetingConfirmation::Type</code>, ä¾‹å¦‚, <code>AGameplayAbilityTargetActor_GroundTrace</code>å°±ä¸æ”¯æŒ<code>Instant</code>ç¡®è®¤.  </p><p><code>WaitTargetData AbilityTask</code>å°†ä¸€ä¸ª<code>AGameplayAbilityTargetActor</code>ç±»ä½œä¸ºå‚æ•°, å…¶ä¼šåœ¨æ¯æ¬¡<code>AbilityTask</code>æ¿€æ´»æ—¶ç”Ÿæˆä¸€ä¸ªå®ä¾‹å¹¶ä¸”åœ¨<code>AbilityTask</code>ç»“æŸæ—¶é”€æ¯è¯¥<code>TargetActor</code>. <code>WaitTargetDataUsingActor AbilityTask</code>æ¥å—ä¸€ä¸ªå·²ç»ç”Ÿæˆçš„<code>TargetActor</code>, ä½†æ˜¯åœ¨è¯¥<code>AbilityTask</code>ç»“æŸæ—¶ä»ä¼šé”€æ¯å®ƒ. è¿™ä¸¤ç§<code>AbilityTask</code>éƒ½æ˜¯ä½æ•ˆçš„, å› ä¸ºå®ƒä»¬åœ¨æ¯æ¬¡ä½¿ç”¨æ—¶éƒ½è¦ç”Ÿæˆæˆ–éœ€è¦ä¸€ä¸ªæ–°ç”Ÿæˆçš„<code>TargetActor</code>, å®ƒä»¬ç”¨äºåŸå‹å¼€å‘æ˜¯å¾ˆå¥½çš„, ä½†æ˜¯åœ¨å®é™…å‘å¸ƒç‰ˆæœ¬ä¸­, å¦‚æœæœ‰æŒç»­äº§ç”Ÿ<code>TargetData</code>çš„åœºæ™¯, åƒå…¨è‡ªåŠ¨å¼€ç«, ä½ å¯èƒ½å°±è¦æ¢ç´¢ä¼˜åŒ–å®ƒçš„åŠæ³•. GASShooteræœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„<a href="https://github.com/tranek/GASShooter/blob/master/Source/GASShooter/Public/Characters/Abilities/GSGATA_Trace.h">AGameplayAbilityTargetActor</a>å­ç±»å’Œä¸€ä¸ªå®Œå…¨é‡å†™çš„<a href="https://github.com/tranek/GASShooter/blob/master/Source/GASShooter/Public/Characters/Abilities/AbilityTasks/GSAT_WaitTargetDataUsingActor.h">WaitTargetDataWithReusableActor AbilityTask</a>, å…¶å…è®¸ä½ å¤ç”¨<code>TargetActor</code>è€Œæ— éœ€å°†å…¶é”€æ¯.  </p><p><code>TargetActor</code>é»˜è®¤æ˜¯ä¸å¯åŒæ­¥çš„. ç„¶è€Œ, å¦‚æœåœ¨ä½ çš„æ¸¸æˆä¸­å‘å…¶ä»–ç©å®¶å±•ç¤ºæœ¬åœ°ç©å®¶æ­£åœ¨å®šä½çš„ç›®æ ‡æ˜¯æœ‰æ„ä¹‰çš„, é‚£ä¹ˆå®ƒä¹Ÿå¯ä»¥è¢«è®¾è®¡æˆå¯åŒæ­¥çš„, <code>WaitTargetData AbilityTask</code>ä¹Ÿç¡®å®åŒ…å«å…¶é€šè¿‡RPCå’ŒæœåŠ¡ç«¯é€šä¿¡çš„é»˜è®¤åŠŸèƒ½. å¦‚æœ<code>TargetActor</code>çš„<code>ShouldProduceTargetDataOnServer</code>å±æ€§è®¾ç½®ä¸ºfalse, é‚£ä¹ˆå®¢æˆ·ç«¯å°±ä¼šåœ¨ç¡®è®¤æ—¶é€šè¿‡<code>UAbilityTask_WaitTargetData::OnTargetDataReadyCallback()</code>ä¸­çš„<code>CallServerSetReplicatedTargetData()</code>RPCå®ƒçš„<code>TargetData</code>åˆ°æœåŠ¡ç«¯. å¦‚æœ<code>ShouldProduceTargetDataOnServer</code>ä¸ºtrue, é‚£ä¹ˆå®¢æˆ·ç«¯å°±ä¼šå‘é€ä¸€ä¸ªé€šç”¨ç¡®è®¤äº‹ä»¶, <code>EAbilityGenericReplicatedEvent::GenericConfirm</code>, åœ¨<code>UAbilityTask_WaitTargetData::OnTargetDataReadyCallback()</code>ä¸­RPCåˆ°æœåŠ¡ç«¯, æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°RPCæ—¶å°±ä¼šæ‰§è¡Œå°„çº¿æˆ–è€…Overlapæ£€æµ‹ä»¥ç”Ÿæˆæ•°æ®. å¦‚æœå®¢æˆ·ç«¯å–æ¶ˆè¯¥å®šä½, å®ƒä¼šå‘é€ä¸€ä¸ªé€šç”¨å–æ¶ˆäº‹ä»¶, <code>EAbilityGenericReplicatedEvent::GenericCancel</code>, åœ¨<code>UAbilityTask_WaitTargetData::OnTargetDataCancelledCallback</code>ä¸­RPCåˆ°æœåŠ¡ç«¯. ä½ å¯ä»¥çœ‹åˆ°, åœ¨<code>TargetActor</code>å’Œ<code>WaitTargetData AbilityTask</code>ä¸­å­˜åœ¨å¤§é‡å§”æ‰˜, <code>TargetActor</code>å“åº”è¾“å…¥æ¥äº§ç”Ÿå¹¿æ’­<code>TargetData</code>çš„å‡†å¤‡, ç¡®è®¤æˆ–è€…å–æ¶ˆå§”æ‰˜, <code>WaitTargetData</code>ç›‘å¬<code>TargetActor</code>çš„<code>TargetData</code>çš„å‡†å¤‡, ç¡®è®¤å’Œå–æ¶ˆå§”æ‰˜, å¹¶å°†è¯¥ä¿¡æ¯è½¬å‘å›<code>GameplayAbility</code>å’ŒæœåŠ¡ç«¯. å¦‚æœæ˜¯å‘æœåŠ¡ç«¯å‘é€<code>TargetData</code>, ä¸ºäº†é˜²æ­¢ä½œå¼Š, å¯èƒ½éœ€è¦åœ¨æœåŠ¡ç«¯åšæ ¡éªŒä»¥ä¿è¯è¯¥<code>TargetData</code>æ˜¯åˆç†çš„. ç›´æ¥åœ¨æœåŠ¡ç«¯ä¸Šäº§ç”Ÿ<code>TargetData</code>å¯ä»¥å®Œå…¨é¿å…è¿™ä¸ªé—®é¢˜, ä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´æ‰€å±(Owning)å®¢æˆ·ç«¯çš„é”™è¯¯é¢„æµ‹.  </p><p>æ ¹æ®ä½¿ç”¨çš„ä¸åŒ<code>AGameplayAbilityTargetActor</code>å­ç±», <code>WaitTargetData AbilityTask</code>èŠ‚ç‚¹ä¼šæš´éœ²ä¸åŒçš„<code>ExposeOnSpawn</code>å‚æ•°, ä¸€äº›å¸¸ç”¨çš„å‚æ•°åŒ…æ‹¬:  </p><div class="table-container"><table><thead><tr><th style="text-align:center">å¸¸ç”¨<code>TargetActor</code>å‚æ•°</th><th style="text-align:center">å®šä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">Debug</td><td style="text-align:center">å¦‚æœä¸ºçœŸ, æ¯å½“éå‘è¡Œç‰ˆæœ¬ä¸­çš„<code>TargetActor</code>æ‰§è¡Œå°„çº¿æ£€æµ‹æ—¶, å…¶ä¼šç»˜åˆ¶debugå°„çº¿/Overlapä¿¡æ¯. è¯·è®°ä½, <code>non-Instant TargetActor</code>ä¼šåœ¨<code>Tick()</code>ä¸­æ‰§è¡Œå°„çº¿æ£€æµ‹, å› æ­¤è¿™äº›debugç»˜åˆ¶è°ƒç”¨ä¹Ÿä¼šåœ¨<code>Tick()</code>ä¸­è§¦å‘.</td></tr><tr><td style="text-align:center">Filter</td><td style="text-align:center">[å¯é€‰]å½“å°„çº¿/Overlapè§¦å‘æ—¶, ç”¨äºä»Targetä¸­è¿‡æ»¤(ç§»é™¤)Actorçš„ç‰¹æ®Šç»“æ„ä½“. å…¸å‹çš„ä½¿ç”¨æ¡ˆä¾‹æ˜¯è¿‡æ»¤ç©å®¶çš„<code>Pawn</code>, å…¶è¦æ±‚Targetæ˜¯ç‰¹æ®Šç±». æŸ¥çœ‹<a href="#concepts-target-data-filters">Target Data Filters</a>ä»¥è·å¾—æ›´å¤šé«˜çº§ä½¿ç”¨æ¡ˆä¾‹.</td></tr><tr><td style="text-align:center">Reticle Class</td><td style="text-align:center">[å¯é€‰]<code>TargetActor</code>ç”Ÿæˆçš„<code>AGameplayAbilityWorldReticle</code>å­ç±».</td></tr><tr><td style="text-align:center">Reticle Parameters</td><td style="text-align:center">[å¯é€‰]é…ç½®ä½ çš„Reticle. æŸ¥çœ‹<a href="#concepts-targeting-reticles">Reticles</a>.</td></tr><tr><td style="text-align:center">Start Location</td><td style="text-align:center">ç”¨äºè®¾ç½®å°„çº¿æ£€æµ‹åº”è¯¥ä»ä½•å¤„å¼€å§‹çš„ç‰¹æ®Šç»“æ„ä½“. ä¸€èˆ¬è¿™åº”è¯¥æ˜¯ç©å®¶çš„è§†å£(Viewport), æªå£æˆ–è€…Pawnçš„ä½ç½®.</td></tr></tbody></table></div><p>ä½¿ç”¨é»˜è®¤çš„<code>TargetActor</code>ç±»æ—¶, Actoråªæœ‰ç›´æ¥åœ¨å°„çº¿/Overlapä¸­æ—¶æ‰æ˜¯æœ‰æ•ˆçš„, å¦‚æœå®ƒç¦»å¼€å°„çº¿/Overlap(å®ƒç§»åŠ¨å¼€æˆ–ä½ çš„è§†çº¿è½¬å‘åˆ«å¤„), å°±ä¸å†æœ‰æ•ˆäº†. å¦‚æœä½ æƒ³<code>TargetActor</code>è®°ä½æœ€åæœ‰æ•ˆçš„Target, å°±éœ€è¦æ·»åŠ è¿™é¡¹åŠŸèƒ½åˆ°ä¸€ä¸ªè‡ªå®šä¹‰çš„<code>TargetActor</code>ç±». æˆ‘ç§°ä¹‹ä¸ºæŒä¹…åŒ–Target, å› ä¸ºå…¶ä¼šæŒç»­å­˜åœ¨ç›´åˆ°<code>TargetActor</code>æ¥æ”¶åˆ°ç¡®è®¤æˆ–å–æ¶ˆæ¶ˆæ¯, <code>TargetActor</code>ä¼šåœ¨å®ƒçš„å°„çº¿/Overlapä¸­æ‰¾åˆ°ä¸€ä¸ªæ–°çš„æœ‰æ•ˆTarget, æˆ–è€…Targetä¸å†æœ‰æ•ˆ(å·²é”€æ¯). GASShooterå¯¹ç«ç®­ç­’äºŒæŠ€èƒ½çš„åˆ¶å¯¼ç«ç®­å®šä½ä½¿ç”¨äº†æŒä¹…åŒ–Target.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-target-data-filters"></a></p><h4 id="4-11-3-TargetDataè¿‡æ»¤å™¨"><a href="#4-11-3-TargetDataè¿‡æ»¤å™¨" class="headerlink" title="4.11.3 TargetDataè¿‡æ»¤å™¨"></a>4.11.3 TargetDataè¿‡æ»¤å™¨</h4><p>åŒæ—¶ä½¿ç”¨<code>Make GameplayTargetDataFilter</code>å’Œ<code>Make Filter Handle</code>èŠ‚ç‚¹, ä½ å¯ä»¥è¿‡æ»¤ç©å®¶çš„<code>Pawn</code>æˆ–è€…åªé€‰æ‹©æŸä¸ªç‰¹å®šç±». å¦‚æœéœ€è¦æ›´å¤šé«˜çº§è¿‡æ»¤æ¡ä»¶, å¯ä»¥ç»§æ‰¿<code>FGameplayTargetDataFilter</code>å¹¶é‡å†™<code>FilterPassesForActor</code>å‡½æ•°.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">USTRUCT</span>(BlueprintType)</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GASDOCUMENTATION_API</span> FGDNameTargetDataFilter : <span class="keyword">public</span> FGameplayTargetDataFilter</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Returns true if the actor passes the filter and will be targeted */</span></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">FilterPassesForActor</span><span class="params">(<span class="type">const</span> AActor* ActorToBeFiltered)</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line">However, <span class="keyword">this</span> will <span class="keyword">not</span> work directly into the Wait Target Data node as it <span class="keyword">requires</span> a FGameplayTargetDataFilterHandle. A <span class="keyword">new</span> custom Make Filter Handle must be made to accept the subclass:</span><br><span class="line"></span><br><span class="line">FGameplayTargetDataFilterHandle UGDTargetDataFilterBlueprintLibrary::<span class="built_in">MakeGDNameFilterHandle</span>(FGDNameTargetDataFilter Filter, AActor* FilterActor)</span><br><span class="line">&#123;</span><br><span class="line">FGameplayTargetDataFilter* NewFilter = <span class="keyword">new</span> <span class="built_in">FGDNameTargetDataFilter</span>(Filter);</span><br><span class="line">NewFilter-&gt;<span class="built_in">InitializeFilterContext</span>(FilterActor);</span><br><span class="line"></span><br><span class="line">FGameplayTargetDataFilterHandle FilterHandle;</span><br><span class="line">FilterHandle.Filter = <span class="built_in">TSharedPtr</span>&lt;FGameplayTargetDataFilter&gt;(NewFilter);</span><br><span class="line"><span class="keyword">return</span> FilterHandle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-targeting-reticles"></a></p><h4 id="4-11-4-Gameplay-Ability-World-Reticles"><a href="#4-11-4-Gameplay-Ability-World-Reticles" class="headerlink" title="4.11.4 Gameplay Ability World Reticles"></a>4.11.4 Gameplay Ability World Reticles</h4><p>å½“ä½¿ç”¨å·²ç¡®è®¤çš„<code>non-Instant</code> <a href="#concepts-targeting-actors">TargetActor</a>å®šä½æ—¶, <a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/Abilities/AGameplayAbilityWorldReticle/index.html">AGameplayAbilityWorldReticles(Reticles)</a>å¯ä»¥å¯è§†åŒ–æ­£åœ¨å®šä½çš„ç›®æ ‡. <code>TargetActor</code>è´Ÿè´£æ‰€æœ‰<code>Reticle</code>ç”Ÿå‘½å‘¨æœŸçš„ç”Ÿæˆå’Œé”€æ¯. <code>Reticle</code>æ˜¯AActor, å› æ­¤å…¶å¯ä»¥ä½¿ç”¨ä»»æ„ç§ç±»çš„å¯è§†ç»„ä»¶ä½œä¸ºè¡¨ç°å½¢å¼. GASShooterä¸­å¸¸è§çš„ä¸€ç§å®ç°æ–¹å¼æ˜¯ä½¿ç”¨<code>WidgetComponent</code>åœ¨å±å¹•ç©ºé—´ä¸­æ˜¾ç¤ºUMG Widget(æ°¸è¿œé¢å¯¹ç©å®¶çš„æ‘„åƒæœº). <code>Reticle</code>ä¸çŸ¥é“å…¶æ­£åœ¨å®šä½çš„Actor, ä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ç»§æ‰¿åœ¨è‡ªå®šä¹‰<code>TargetActor</code>ä¸­å®ç°è¯¥åŠŸèƒ½. <code>TargetActor</code>ä¸€èˆ¬åœ¨æ¯æ¬¡<code>Tick()</code>ä¸­æ›´æ–°<code>Reticle</code>çš„ä½ç½®ä¸ºTargetçš„ä½ç½®.  </p><p>GASShooterå¯¹ç«ç®­ç­’äºŒæŠ€èƒ½åˆ¶å¯¼ç«ç®­é”å®šçš„ç›®æ ‡ä½¿ç”¨äº†<code>Reticle</code>. æ•Œäººèº«ä¸Šçš„çº¢è‰²æ ‡è¯†å°±æ˜¯<code>Reticle</code>, ç›¸ä¼¼çš„ç™½è‰²å›¾åƒæ˜¯ç«ç®­ç­’çš„å‡†æ˜Ÿ.  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/gameplayabilityworldreticle.png" alt="Reticles in GASShooter">  </p><p><code>Reticle</code>å¸¦æœ‰ä¸€äº›é¢å‘è®¾è®¡å¸ˆçš„<code>BlueprintImplementableEvents</code>(å®ƒä»¬è¢«è®¾è®¡ç”¨æ¥åœ¨è“å›¾ä¸­å¼€å‘):  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Called whenever bIsTargetValid changes value. */</span></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintImplementableEvent, Category = Reticle)</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">OnValidTargetChanged</span><span class="params">(<span class="type">bool</span> bNewValue)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Called whenever bIsTargetAnActor changes value. */</span></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintImplementableEvent, Category = Reticle)</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">OnTargetingAnActor</span><span class="params">(<span class="type">bool</span> bNewValue)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintImplementableEvent, Category = Reticle)</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">OnParametersInitialized</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintImplementableEvent, Category = Reticle)</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SetReticleMaterialParamFloat</span><span class="params">(FName ParamName, <span class="type">float</span> value)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintImplementableEvent, Category = Reticle)</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SetReticleMaterialParamVector</span><span class="params">(FName ParamName, FVector value)</span></span>;</span><br></pre></td></tr></table></figure><p><code>Reticle</code>å¯ä»¥é€‰æ‹©ä½¿ç”¨<code>TargetActor</code>æä¾›çš„<a href="https://docs.unrealengine.com/en-US/API/Plugins/GameplayAbilities/Abilities/FWorldReticleParameters/index.html">FWorldReticleParameters</a>æ¥é…ç½®, é»˜è®¤ç»“æ„ä½“åªæä¾›ä¸€ä¸ªå˜é‡<code>FVector AOEScale</code>, å°½ç®¡ä½ å¯ä»¥åœ¨æŠ€æœ¯ä¸Šç»§æ‰¿è¯¥ç»“æ„ä½“, ä½†æ˜¯<code>TargetActor</code>åªæ¥å—åŸºç±»ç»“æ„ä½“, ä¸å…è®¸åœ¨é»˜è®¤<code>TargetActor</code>ä¸­å­ç±»åŒ–è¯¥ç»“æ„ä½“ä¼¼ä¹æœ‰äº›çŸ­è§, ç„¶è€Œ, å¦‚æœä½ åˆ›å»ºäº†è‡ªå·±çš„è‡ªå®šä¹‰<code>TargetActor</code>, å°±å¯ä»¥æä¾›è‡ªå®šä¹‰çš„<code>Reticle</code>å‚æ•°ç»“æ„ä½“å¹¶åœ¨ç”Ÿæˆ<code>Reticle</code>æ—¶æ‰‹åŠ¨ä¼ é€’å®ƒåˆ°<code>AGameplayAbilityWorldReticles</code>å­ç±».  </p><p><code>Reticle</code>é»˜è®¤æ˜¯ä¸å¯åŒæ­¥çš„, ä½†æ˜¯å¦‚æœåœ¨ä½ çš„æ¸¸æˆä¸­å‘å…¶ä»–ç©å®¶å±•ç¤ºæœ¬åœ°ç©å®¶æ­£åœ¨å®šä½çš„ç›®æ ‡æ˜¯æœ‰æ„ä¹‰çš„, é‚£ä¹ˆå®ƒä¹Ÿå¯ä»¥è¢«è®¾è®¡æˆå¯åŒæ­¥çš„.  </p><p><code>Reticle</code>åªä¼šæ˜¾ç¤ºåœ¨é»˜è®¤<code>TargetActor</code>çš„å½“å‰æœ‰æ•ˆTargetä¸Š, ä¾‹å¦‚, å¦‚æœä½ æ­£åœ¨ä½¿ç”¨<code>AGameplayAbilityTargetActor_SingleLineTrace</code>å¯¹ç›®æ ‡æ‰§è¡Œå°„çº¿æ£€æµ‹, æ•Œäººåªæœ‰ç›´æ¥å¤„äºå°„çº¿è·¯å¾„ä¸Šæ—¶<code>Reticle</code>æ‰ä¼šæ˜¾ç¤º, å¦‚æœè§’è‰²è§†çº¿çœ‹å‘åˆ«å¤„, é‚£ä¹ˆè¯¥æ•Œäººå°±ä¸å†æ˜¯ä¸€ä¸ªæœ‰æ•ˆTarget, å› æ­¤è¯¥<code>Reticle</code>å°±ä¼šæ¶ˆå¤±. å¦‚æœä½ æƒ³<code>Reticle</code>ä¿ç•™åœ¨æœ€åä¸€ä¸ªæœ‰æ•ˆTargetä¸Š, å°±éœ€è¦è‡ªå®šä¹‰<code>TargetActor</code>æ¥è®°ä½æœ€åä¸€ä¸ªæœ‰æ•ˆTargetå¹¶ä½¿<code>Reticle</code>ä¿ç•™åœ¨å…¶ä¸Š. æˆ‘ç§°ä¹‹ä¸ºæŒä¹…åŒ–Target, å› ä¸ºå…¶ä¼šæŒç»­å­˜åœ¨ç›´åˆ°<code>TargetActor</code>æ¥æ”¶åˆ°ç¡®è®¤æˆ–å–æ¶ˆæ¶ˆæ¯, <code>TargetActor</code>ä¼šåœ¨å®ƒçš„å°„çº¿/Overlapä¸­æ‰¾åˆ°ä¸€ä¸ªæ–°çš„æœ‰æ•ˆTarget, æˆ–è€…Targetä¸å†æœ‰æ•ˆ(å·²é”€æ¯). GASShooterå¯¹ç«ç®­ç­’äºŒæŠ€èƒ½çš„åˆ¶å¯¼ç«ç®­å®šä½ä½¿ç”¨äº†æŒä¹…åŒ–Target.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="concepts-targeting-containers"></a></p><h4 id="4-11-5-Gameplay-Effect-Containers-Targeting"><a href="#4-11-5-Gameplay-Effect-Containers-Targeting" class="headerlink" title="4.11.5 Gameplay Effect Containers Targeting"></a>4.11.5 Gameplay Effect Containers Targeting</h4><p><a href="#concepts-ge-containers">GameplayEffectContainer</a>æä¾›äº†ä¸€ä¸ªå¯é€‰çš„äº§ç”Ÿ<a href="#concepts-targeting-data">TargetData</a>çš„é«˜æ•ˆæ–¹æ³•. å½“<code>EffectContainer</code>åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸Šåº”ç”¨æ—¶, è¯¥å®šä½ä¼šç«‹å³è¿›è¡Œ, å®ƒæ¯”<a href="#concepts-targeting-actors">TargetActor</a>æ›´æœ‰æ•ˆç‡, å› ä¸ºå®ƒæ˜¯è¿è¡Œåœ¨å®šä½å¯¹è±¡çš„CDO(Class Default Object)ä¸Šçš„(æ²¡æœ‰Actorçš„ç”Ÿæˆå’Œé”€æ¯), ä½†æ˜¯å®ƒä¸æ”¯æŒç”¨æˆ·è¾“å…¥, æ— éœ€ç¡®è®¤å³å¯ç«‹å³è¿›è¡Œ, ä¸èƒ½å–æ¶ˆ, å¹¶ä¸”ä¸èƒ½ä»å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®(åœ¨ä¸¤è€…ä¸Šäº§ç”Ÿæ•°æ®), å®ƒå¯¹å³æ—¶å°„çº¿æ£€æµ‹å’Œç¢°æ’Overlapå¾ˆæœ‰ç”¨. Epicçš„<a href="https://www.unrealengine.com/marketplace/en-US/slug/action-rpg">Action RPG Sample Project</a>åŒ…å«ä¸¤ç§ä½¿ç”¨Containerå®šä½çš„æ ·ä¾‹ â€”â€” å®šä½Abilityæ‹¥æœ‰è€…å’Œä»äº‹ä»¶æ‹‰å–<code>TargetData</code>, å®ƒè¿˜åœ¨è“å›¾ä¸­å®ç°äº†åœ¨è·ç©å®¶æŸä¸ªåç§»å¤„(ç”±è“å›¾å­ç±»è®¾ç½®)åšçƒå½¢å°„çº¿æ£€æµ‹(Sphere Trace), ä½ å¯ä»¥åœ¨C++æˆ–è“å›¾ä¸­ç»§æ‰¿<code>URPGTargetType</code>ä»¥å®ç°è‡ªå·±çš„å®šä½ç±»å‹.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae"></a></p><h2 id="5-å¸¸ç”¨çš„Abiltyå’ŒEffect"><a href="#5-å¸¸ç”¨çš„Abiltyå’ŒEffect" class="headerlink" title="5. å¸¸ç”¨çš„Abiltyå’ŒEffect"></a>5. å¸¸ç”¨çš„Abiltyå’ŒEffect</h2><p><a name="cae-stun"></a></p><h3 id="5-1-çœ©æ™•-Stun"><a href="#5-1-çœ©æ™•-Stun" class="headerlink" title="5.1 çœ©æ™•(Stun)"></a>5.1 çœ©æ™•(Stun)</h3><p>ä¸€èˆ¬åœ¨çœ©æ™•çŠ¶æ€æ—¶, æˆ‘ä»¬å°±è¦å–æ¶ˆCharacteræ‰€æœ‰å·²æ¿€æ´»çš„<code>GameplayAbility</code>, é˜»æ­¢æ–°çš„<code>GameplayAbility</code>æ¿€æ´», å¹¶åœ¨æ•´ä¸ªçœ©æ™•æœŸé—´é˜»æ­¢ç§»åŠ¨. æ ·ä¾‹é¡¹ç›®çš„é™¨çŸ³<code>GameplayAbility</code>ä¼šåœ¨å‡»ä¸­çš„ç›®æ ‡ä¸Šåº”ç”¨çœ©æ™•æ•ˆæœ.  </p><p>ä¸ºäº†å–æ¶ˆç›®æ ‡æ´»è·ƒçš„<code>GameplayAbility</code>, å¯ä»¥åœ¨çœ©æ™•<a href="#concepts-gt-change"><code>GameplayTag</code>æ·»åŠ </a>æ—¶è°ƒç”¨<code>AbilitySystemComponent-&gt;CancelAbilities()</code>.  </p><p>ä¸ºäº†åœ¨çœ©æ™•æ—¶é˜»æ­¢æ–°çš„<code>GameplayAbility</code>æ¿€æ´», å¯ä»¥åœ¨<code>GameplayAbility</code>çš„<a href="#concepts-ga-tags">Activation Blocked Tags GameplayTagContainer</a>ä¸­æ·»åŠ çœ©æ™•<code>GameplayTag</code>.  </p><p>ä¸ºäº†åœ¨çœ©æ™•æ—¶é˜»æ­¢ç§»åŠ¨, æˆ‘ä»¬å¯ä»¥åœ¨æ‹¥æœ‰è€…æ‹¥æœ‰çœ©æ™•<code>GameplayTag</code>æ—¶é‡å†™<code>CharacterMovementComponent</code>çš„<code>GetMaxSpeed()</code>å‡½æ•°ä»¥è¿”å›0.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae-sprint"></a></p><h3 id="5-2-å¥”è·‘-Sprint"><a href="#5-2-å¥”è·‘-Sprint" class="headerlink" title="5.2 å¥”è·‘(Sprint)"></a>5.2 å¥”è·‘(Sprint)</h3><p>æ ·ä¾‹é¡¹ç›®æä¾›äº†ä¸€ä¸ªå¦‚ä½•å¥”è·‘çš„ä¾‹å­ â€”â€” æŒ‰ä½å·¦Shiftæ—¶è·‘å¾—æ›´å¿«.  </p><p>æ›´å¿«çš„ç§»åŠ¨ç”±<code>CharacterMovementComponent</code>é€šè¿‡ç½‘ç»œå‘é€flagåˆ°æœåŠ¡ç«¯é¢„æµ‹æ€§åœ°å¤„ç†. è¯¦è§<code>GDCharacterMovementComponent.h/cpp</code>.  </p><p><code>GA</code>å¤„ç†å“åº”å·¦Shiftè¾“å…¥, å‘ŠçŸ¥<code>CMC</code>å¼€å§‹å’Œåœæ­¢å¥”è·‘, å¹¶ä¸”åœ¨å·¦ShiftæŒ‰ä¸‹æ—¶é¢„æµ‹æ€§åœ°æ¶ˆè€—è€åŠ›. è¯¦è§<code>GA_Sprint_BP</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae-ads"></a></p><h3 id="5-3-ç„å‡†-Aim-Down-Sight"><a href="#5-3-ç„å‡†-Aim-Down-Sight" class="headerlink" title="5.3 ç„å‡†(Aim Down Sight)"></a>5.3 ç„å‡†(Aim Down Sight)</h3><p>æ ·ä¾‹é¡¹ç›®å¤„ç†å®ƒå’Œå¥”è·‘æ—¶å®Œå…¨ä¸€æ ·, é™¤äº†é™ä½ç§»åŠ¨é€Ÿåº¦è€Œä¸æ˜¯æé«˜å®ƒ.  </p><p>è¯¦è§<code>GDCharacterMovementComponent.h/cpp</code>æ˜¯å¦‚ä½•é¢„æµ‹æ€§åœ°é™ä½ç§»åŠ¨é€Ÿåº¦çš„.  </p><p>è¯¦è§<code>GA_AimDownSight_BP</code>æ˜¯å¦‚ä½•å¤„ç†è¾“å…¥çš„. ç„å‡†æ—¶æ˜¯ä¸æ¶ˆè€—è€åŠ›çš„.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae-ls"></a></p><h3 id="5-4-ç”Ÿå‘½å·å–-Lifesteal"><a href="#5-4-ç”Ÿå‘½å·å–-Lifesteal" class="headerlink" title="5.4 ç”Ÿå‘½å·å–(Lifesteal)"></a>5.4 ç”Ÿå‘½å·å–(Lifesteal)</h3><p>æˆ‘åœ¨ä¼¤å®³<a href="#concepts-ge-ec">ExecutionCalculation</a>ä¸­å¤„ç†ç”Ÿå‘½å·å–. <code>GameplayEffect</code>ä¼šæœ‰ä¸€ä¸ªåƒ<code>Effect.CanLifesteal</code>æ ·çš„<code>GameplayTag</code>, <code>ExecutionCalculation</code>ä¼šæ£€æŸ¥<code>GameplayEffectSpec</code>æ˜¯å¦æœ‰<code>Effect.CanLifesteal GameplayTag</code>, å¦‚æœè¯¥<code>GameplayTag</code>å­˜åœ¨, <code>ExecutionCalculation</code>ä¼šä½¿ç”¨ä½œä¸ºModiferçš„ç”Ÿå‘½å€¼<a href="#concepts-ge-dynamic">åˆ›å»ºä¸€ä¸ªåŠ¨æ€çš„<code>å³åˆ»(Instant)GameplayEffect</code></a>, å¹¶å°†å…¶åº”ç”¨å›æº(Source)ASC.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (SpecAssetTags.<span class="built_in">HasTag</span>(FGameplayTag::<span class="built_in">RequestGameplayTag</span>(<span class="built_in">FName</span>(<span class="string">&quot;Effect.Damage.CanLifesteal&quot;</span>))))</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">float</span> Lifesteal = Damage * LifestealPercent;</span><br><span class="line"></span><br><span class="line">UGameplayEffect* GELifesteal = <span class="built_in">NewObject</span>&lt;UGameplayEffect&gt;(<span class="built_in">GetTransientPackage</span>(), <span class="built_in">FName</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;Lifesteal&quot;</span>)));</span><br><span class="line">GELifesteal-&gt;DurationPolicy = EGameplayEffectDurationType::Instant;</span><br><span class="line"></span><br><span class="line">int32 Idx = GELifesteal-&gt;Modifiers.<span class="built_in">Num</span>();</span><br><span class="line">GELifesteal-&gt;Modifiers.<span class="built_in">SetNum</span>(Idx + <span class="number">1</span>);</span><br><span class="line">FGameplayModifierInfo&amp; Info = GELifesteal-&gt;Modifiers[Idx];</span><br><span class="line">Info.ModifierMagnitude = <span class="built_in">FScalableFloat</span>(Lifesteal);</span><br><span class="line">Info.ModifierOp = EGameplayModOp::Additive;</span><br><span class="line">Info.Attribute = UPAAttributeSetBase::<span class="built_in">GetHealthAttribute</span>();</span><br><span class="line"></span><br><span class="line">SourceAbilitySystemComponent-&gt;<span class="built_in">ApplyGameplayEffectToSelf</span>(GELifesteal, <span class="number">1.0f</span>, SourceAbilitySystemComponent-&gt;<span class="built_in">MakeEffectContext</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae-random"></a></p><h3 id="5-5-åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸­ç”Ÿæˆéšæœºæ•°"><a href="#5-5-åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸­ç”Ÿæˆéšæœºæ•°" class="headerlink" title="5.5 åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸­ç”Ÿæˆéšæœºæ•°"></a>5.5 åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸­ç”Ÿæˆéšæœºæ•°</h3><p>æœ‰æ—¶ä½ éœ€è¦åœ¨<code>GameplayAbility</code>ä¸­ç”Ÿæˆéšæœºæ•°ç”¨äºæªæ”¯åååŠ›æˆ–è€…å­å¼¹æ‰©æ•£, å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½éœ€è¦ç”Ÿæˆç›¸åŒçš„éšæœºæ•°, è¦åšåˆ°è¿™ä¸€ç‚¹, æˆ‘ä»¬å¿…é¡»åœ¨<code>GameplayAbility</code>æ¿€æ´»æ—¶è®¾ç½®ç›¸åŒçš„<code>éšæœºæ•°ç§å­</code>, ä½ éœ€è¦åœ¨æ¯æ¬¡æ¿€æ´»<code>GameplayAbility</code>æ—¶è®¾ç½®<code>éšæœºæ•°ç§å­</code>, ä»¥é˜²å®¢æˆ·ç«¯é”™è¯¯é¢„æµ‹æ¿€æ´»æˆ–è€…å®ƒçš„éšæœºæ•°åˆ—è¡¨ä¸æœåŠ¡ç«¯çš„ä¸åŒæ­¥.  </p><div class="table-container"><table><thead><tr><th style="text-align:center">éšæœºç§å­è®¾ç½®æ–¹æ³•</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">ä½¿ç”¨<code>Activation Prediction Key</code></td><td style="text-align:center"><code>GameplayAbility</code>çš„<code>Activation Prediction Key</code>æ˜¯ä¸€ä¸ªç¡®ä¿åŒæ­¥å¹¶ä¸”åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„<code>Activation()</code>ä¸­éƒ½å¯ç”¨çš„int16ç±»å‹å€¼. ä½ å¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸­è®¾ç½®å…¶ä½œä¸º<code>éšæœºæ•°ç§å­</code>. è¯¥æ–¹æ³•çš„ç¼ºç‚¹æ˜¯æ¯æ¬¡æ¸¸æˆå¼€å§‹æ—¶<code>Prediction Key</code>æ€»æ˜¯ä»0å¼€å§‹å¹¶ä¸”ä¼šåœ¨ç”Ÿæˆkeyä¹‹åæŒç»­å¢åŠ , è¿™æ„å‘³ç€æ¯åœºæ¸¸æˆéƒ½æœ‰ç€åŠå…¶ç›¸åŒçš„éšæœºæ•°åºåˆ—, è¿™å¯èƒ½æ»¡è¶³æˆ–ä¸æ»¡è¶³ä½ çš„éšæœºæ•°éœ€è¦.</td></tr><tr><td style="text-align:center">æ¿€æ´»<code>GameplayAbility</code>æ—¶é€šè¿‡äº‹ä»¶è´Ÿè½½(Event Payload)å‘é€ç§å­</td><td style="text-align:center">é€šè¿‡äº‹ä»¶æ¿€æ´»<code>GameplayAbility</code>å¹¶é€šè¿‡å¯åŒæ­¥çš„äº‹ä»¶è´Ÿè½½(Event Payload)ä»å®¢æˆ·ç«¯å‘é€éšæœºç”Ÿæˆçš„ç§å­åˆ°æœåŠ¡ç«¯, è¿™å…è®¸æ›´é«˜çš„éšæœºæ€§, ä½†æ˜¯å®¢æˆ·ç«¯ä¹Ÿå®¹æ˜“è¢«ç ´è§£è€Œæ¯æ¬¡åªå‘é€ç›¸åŒçš„ç§å­. é€šè¿‡äº‹ä»¶æ¿€æ´»<code>GameplayAbility</code>ä¹Ÿä¼šé˜»æ­¢å…¶ä»ç”¨æˆ·ç»‘å®šæ¿€æ´».</td></tr></tbody></table></div><p>å¦‚æœä½ çš„éšæœºåå·®å¾ˆå°, å¤§å¤šæ•°ç©å®¶æ˜¯ä¸ä¼šæ³¨æ„åˆ°æ¯æ¬¡æ¸¸æˆçš„éšæœºåºåˆ—éƒ½æ˜¯ç›¸åŒçš„, é‚£ä¹ˆä½¿ç”¨<code>Activation Prediction Key</code>ä½œä¸ºéšæœºç§å­å°±åº”è¯¥é€‚ç”¨äºä½ . å¦‚æœä½ æ­£åœ¨åšä¸€äº›æ›´å¤æ‚çš„äº‹, éœ€è¦é˜²èŒƒç ´è§£è€…, é‚£ä¹ˆä½¿ç”¨<code>Server Initiated GameplayAbility</code>ä¼šæ›´å¥½, æœåŠ¡ç«¯å¯ä»¥åˆ›å»º<code>Prediction Key</code>æˆ–è€…ç”Ÿæˆéšæœºæ•°ç§å­æ¥é€šè¿‡äº‹ä»¶è´Ÿè½½(Event Payload)å‘é€.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae-crit"></a></p><h3 id="5-6-æš´å‡»-Critical-Hits"><a href="#5-6-æš´å‡»-Critical-Hits" class="headerlink" title="5.6 æš´å‡»(Critical Hits)"></a>5.6 æš´å‡»(Critical Hits)</h3><p>æˆ‘åœ¨ä¼¤å®³<a href="#concepts-ge-ec">ExecutionCalculation</a>ä¸­å¤„ç†æš´å‡». <code>GameplayEffect</code>ä¼šæœ‰ä¸€ä¸ªåƒ<code>Effect.CanCrit</code>æ ·çš„<code>GameplayTag</code>, <code>ExecutionCalculation</code>ä¼šæ£€æŸ¥<code>GameplayEffectSpec</code>æ˜¯å¦æœ‰<code>Effect.CanCrit  GameplayTag</code>, å¦‚æœè¯¥<code>GameplayTag</code>å­˜åœ¨, <code>ExecutionCalculation</code>å°±ä¼šç”Ÿæˆä¸€ä¸ªä¸æš´å‡»ç‡ç›¸å…³è”çš„éšæœºæ•°(ä»Sourceæ•è·çš„<code>Attribute</code>), å¦‚æœæˆåŠŸçš„è¯å°±ä¼šå¢åŠ æš´å‡»ä¼¤å®³(å¦ä¸€ä¸ªä»Sourceæ•è·çš„<code>Attribute</code>). å› ä¸ºæˆ‘æ²¡æœ‰é¢„æµ‹ä¼¤å®³, æ‰€ä»¥ä¸å¿…æ‹…å¿ƒåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸ŠåŒæ­¥éšæœºæ•°ç”Ÿæˆå™¨çš„é—®é¢˜(<code>ExecutionCalculation</code>åªè¿è¡Œåœ¨æœåŠ¡ç«¯ä¸Š). å¦‚æœä½ å°è¯•ä½¿ç”¨<code>MMC</code>é¢„æµ‹æ€§åœ°æ‰§è¡Œä¼¤å®³è®¡ç®—, å°±å¿…é¡»ä»<code>GameplayEffectSpec-&gt;GameplayEffectContext-&gt;GameplayAbilityInstance</code>ä¸­è·å–éšæœºæ•°ç§å­çš„å¼•ç”¨.  </p><p>æŸ¥çœ‹GASShooteræ˜¯å¦‚ä½•å¤„ç†çˆ†å¤´é—®é¢˜çš„, å…¶æ¦‚å¿µæ˜¯ä¸€æ ·çš„, é™¤äº†ä¸å†ä¾èµ–éšæœºæ•°ä½œä¸ºæ¦‚ç‡è€Œæ˜¯æ£€æµ‹<code>FHitResult</code>éª¨éª¼å.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae-nonstackingge"></a></p><h3 id="5-7-éå †æ ˆGameplayEffect-ä½†æ˜¯åªæœ‰å…¶æœ€é«˜çº§-Greatest-Magnitude-æ‰èƒ½å®é™…å½±å“Target"><a href="#5-7-éå †æ ˆGameplayEffect-ä½†æ˜¯åªæœ‰å…¶æœ€é«˜çº§-Greatest-Magnitude-æ‰èƒ½å®é™…å½±å“Target" class="headerlink" title="5.7 éå †æ ˆGameplayEffect, ä½†æ˜¯åªæœ‰å…¶æœ€é«˜çº§(Greatest Magnitude)æ‰èƒ½å®é™…å½±å“Target"></a>5.7 éå †æ ˆGameplayEffect, ä½†æ˜¯åªæœ‰å…¶æœ€é«˜çº§(Greatest Magnitude)æ‰èƒ½å®é™…å½±å“Target</h3><p>Paragonä¸­çš„Slow Effectæ˜¯éå †æ ˆçš„. åº”ç”¨æ¯ä¸ªå®ä¾‹å¹¶ä¸”åƒå¹³å¸¸ä¸€æ ·è·Ÿè¸ªå…¶ç”Ÿå‘½å‘¨æœŸ, ä½†æ˜¯åªæœ‰æœ€é«˜çº§(Greatest Magnitude)çš„Slow Effectæ‰èƒ½å®é™…å½±å“<code>Character</code>. GASä¸ºè¿™ç§åœºæ™¯æä¾›äº†å¼€ç®±å³ç”¨çš„<code>AggregatorEvaluateMetaData</code>, è¯¦è§<a href="#concepts-as-onattributeaggregatorcreated">AggregatorEvaluateMetaData()</a>åŠå…¶å®ç°.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae-paused"></a></p><h3 id="5-8-æ¸¸æˆæš‚åœæ—¶ç”ŸæˆTargetData"><a href="#5-8-æ¸¸æˆæš‚åœæ—¶ç”ŸæˆTargetData" class="headerlink" title="5.8 æ¸¸æˆæš‚åœæ—¶ç”ŸæˆTargetData"></a>5.8 æ¸¸æˆæš‚åœæ—¶ç”Ÿæˆ<code>TargetData</code></h3><p>å¦‚æœä½ éœ€è¦åœ¨ç­‰å¾…ç©å®¶ä»<code>WaitTargetData AbilityTask</code>ç”Ÿæˆ<a href="#concepts-targeting-data">TargetData</a>æ—¶æš‚åœæ¸¸æˆ, æˆ‘å»ºè®®ä½¿ç”¨<code>slomo 0</code>è€Œä¸æ˜¯æš‚åœ.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="cae-onebuttoninteractionsystem"></a></p><h3 id="5-9-æŒ‰é’®äº¤äº’ç³»ç»Ÿ-Button-Interaction-System"><a href="#5-9-æŒ‰é’®äº¤äº’ç³»ç»Ÿ-Button-Interaction-System" class="headerlink" title="5.9 æŒ‰é’®äº¤äº’ç³»ç»Ÿ(Button Interaction System)"></a>5.9 æŒ‰é’®äº¤äº’ç³»ç»Ÿ(Button Interaction System)</h3><p>GASShooterå®ç°äº†ä¸€ä¸ªæŒ‰é’®äº¤äº’ç³»ç»Ÿ, ç©å®¶å¯ä»¥æŒ‰ä¸‹æˆ–æŒ‰ä½â€™Eâ€™é”®æ¥å’Œå¯äº¤äº’å¯¹è±¡äº¤äº’, åƒå¤æ´»ç©å®¶, æ‰“å¼€æ­¦å™¨ç®±, æ‰“å¼€æˆ–å…³é—­æ»‘åŠ¨é—¨.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="debugging"></a></p><h2 id="6-è°ƒè¯•GAS"><a href="#6-è°ƒè¯•GAS" class="headerlink" title="6. è°ƒè¯•GAS"></a>6. è°ƒè¯•GAS</h2><p>é€šå¸¸åœ¨è°ƒè¯•GASç›¸å…³çš„é—®é¢˜æ—¶, ä½ æ„Ÿå…´è¶£çš„äº‹æƒ…åƒ:  </p><blockquote><p>â€œæˆ‘çš„Attributeçš„å€¼æ˜¯å¤šå°‘?â€<br>â€œæˆ‘æœ‰å“ªäº›GameplayTag?â€<br>â€œæˆ‘ç°åœ¨æœ‰å“ªäº›GameplayEffect?â€<br>â€œæˆ‘å·²ç»æˆäºˆçš„Abilityæœ‰å“ªäº›, å“ªä¸ªæ­£åœ¨è¿è¡Œ, å“ªä¸ªè¢«å µæ­¢æ¿€æ´»?â€</p></blockquote><p>GASæœ‰ä¸¤ç§æŠ€æœ¯å¯ä»¥åœ¨è¿è¡Œæ—¶è§£å†³è¿™äº›é—®é¢˜ â€”â€” <a href="#debugging-sd">showdebug abilitysystem</a>å’Œåœ¨<a href="#debugging-gd">GameplayDebugger</a>ä¸­Hook.  </p><p><strong>Tip:</strong> UE4å€¾å‘äºä¼˜åŒ–C++ä»£ç , è¿™ä½¿å¾—æŸäº›å‡½æ•°å˜å¾—å¾ˆéš¾è°ƒè¯•, å½“æ·±å…¥è¿½è¸ªä»£ç æ—¶å¾ˆå°‘é‡åˆ°è¿™ç§æƒ…å†µ. å¦‚æœå°†Visual Studioçš„è§£å†³æ–¹æ¡ˆé…ç½®è®¾ç½®ä¸º<code>DebugGame Editor</code>ä»ç„¶ä¸èƒ½è¿½è¸ªä»£ç æˆ–è€…ç›‘è§†å˜é‡, å¯ä»¥ä½¿ç”¨<code>PRAGMA_DISABLE_OPTIMIZATION_ACTUAL</code>å’Œ<code>PRAGMA_ENABLE_OPTIMIZATION_ACTUAL</code>å®åŒ…è£¹ä¼˜åŒ–å‡½æ•°æ¥å…³é—­ä¼˜åŒ–, è¿™ä¸èƒ½åœ¨æ’ä»¶ä»£ç ä¸­ä½¿ç”¨é™¤éä»æºç é‡æ–°ç¼–è¯‘æ’ä»¶. è¿™å¯ä»¥æˆ–ä¸å¯ä»¥ç”¨äºinlineå‡½æ•°, å–å†³äºå®ƒçš„ä½œç”¨å’Œä½ç½®. ç¡®ä¿å®Œæˆè°ƒè¯•åç§»é™¤è¿™ä¸¤ä¸ªå®!  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">PRAGMA_DISABLE_OPTIMIZATION_ACTUAL</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MyClass::MyFunction</span><span class="params">(int32 MyIntParameter)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// My code</span></span><br><span class="line">&#125;</span><br><span class="line">PRAGMA_ENABLE_OPTIMIZATION_ACTUAL</span><br></pre></td></tr></table></figure><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="debugging-sd"></a></p><h3 id="6-1-showdebug-abilitysystem"><a href="#6-1-showdebug-abilitysystem" class="headerlink" title="6.1 showdebug abilitysystem"></a>6.1 showdebug abilitysystem</h3><p>åœ¨æ¸¸æˆä¸­çš„æ§åˆ¶å°è¾“å…¥<code>showdebug abilitysystem</code>. è¯¥ç‰¹æ€§è¢«åˆ†ä¸ºä¸‰â€é¡µâ€, ä¸‰é¡µéƒ½ä¼šæ˜¾ç¤ºå½“å‰æ‹¥æœ‰çš„<code>GameplayTag</code>, åœ¨æ§åˆ¶å°è¾“å…¥<code>AbilitySystem.Debug.NextCategory</code>æ¥æ¢é¡µ.  </p><p>ç¬¬ä¸€é¡µæ˜¾ç¤ºäº†æ‰€æœ‰<code>Attribute</code>çš„<code>CurrentValue</code>: <img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/showdebugpage1.png" alt="First Page of showdebug abilitysystem">  </p><p>ç¬¬äºŒé¡µæ˜¾ç¤ºäº†æ‰€æœ‰åº”ç”¨åˆ°ä½ çš„<code>æŒç»­(Duration)</code>å’Œ<code>æ— é™(Infinite)GameplayEffect</code>, å®ƒä»¬çš„å †æ ˆæ•°, ä½¿ç”¨çš„<code>GameplayTag</code>å’Œ<code>Modifier</code>. <img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/showdebugpage2.png" alt="Second Page of showdebug abilitysystem">  </p><p>ç¬¬ä¸‰é¡µæ˜¾ç¤ºäº†æ‰€æœ‰æˆäºˆåˆ°ä½ çš„<code>GameplayAbility</code>, æ— è®ºå…¶æ˜¯å¦æ­£åœ¨è¿è¡Œ, æ— è®ºå…¶æ˜¯å¦è¢«é˜»æ­¢æ¿€æ´», å’Œå½“å‰æ­£åœ¨è¿è¡Œçš„<code>AbilityTask</code>çš„çŠ¶æ€.  <img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/showdebugpage3.png" alt="Third Page of showdebug abilitysystem">  </p><p>ä½ å¯ä»¥ä½¿ç”¨<code>PageUp</code>å’Œ<code>PageDown</code>åˆ‡æ¢Target, é¡µé¢åªæ˜¾ç¤ºä½ æœ¬åœ°æ§åˆ¶çš„<code>Character</code>ä¸­çš„<code>ASC</code>æ•°æ®, ç„¶è€Œ, ä½¿ç”¨<code>AbilitySystem.Debug.NextTarget</code>å’Œ<code>AbilitySystem.Debug.PrevTarget</code>å¯ä»¥æ˜¾ç¤ºå…¶ä»–<code>ASC</code>çš„æ•°æ®, ä½†æ˜¯ä¸ä¼šæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯çš„ä¸ŠåŠéƒ¨åˆ†, ä¹Ÿä¸ä¼šæ›´æ–°ç»¿è‰²ç›®æ ‡é•¿æ–¹ä½“, å› æ­¤æ— æ³•çŸ¥é“å½“å‰å®šä½çš„æ˜¯å“ªä¸ª<code>ASC</code>, è¯¥BUGå·²ç»è¢«æäº¤åˆ°<a href="https://issues.unrealengine.com/issue/UE-90437">https://issues.unrealengine.com/issue/UE-90437.</a>.  </p><p><strong>Note:</strong>  ä¸ºäº†<code>showdebug abilitysystem</code>å¯ä»¥ä½¿ç”¨, å¿…é¡»åœ¨GameModeä¸­é€‰æ‹©ä¸€ä¸ªå®é™…çš„HUDç±», å¦åˆ™å°±ä¼šæ‰¾ä¸åˆ°è¯¥å‘½ä»¤å¹¶è¿”å›â€Unknown Commandâ€.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="debugging-gd"></a></p><h3 id="6-2-Gameplay-Debugger"><a href="#6-2-Gameplay-Debugger" class="headerlink" title="6.2 Gameplay Debugger"></a>6.2 Gameplay Debugger</h3><p>GASå‘Gameplay Debuggerä¸­æ·»åŠ äº†åŠŸèƒ½, ä½¿ç”¨<code>åå¼•å·(`)</code>é”®ä»¥è®¿é—®Gameplay Debugger. æŒ‰ä¸‹å°é”®ç›˜çš„3é”®ä»¥å¯ç”¨Abilityåˆ†ç±», å–å†³äºä½ æ‰€æ‹¥æœ‰çš„æ’ä»¶, åˆ†ç±»å¯èƒ½æ˜¯ä¸åŒçš„. å¦‚æœä½ çš„é”®ç›˜æ²¡æœ‰å°é”®ç›˜, æ¯”å¦‚ç¬”è®°æœ¬, é‚£ä¹ˆä½ å¯ä»¥åœ¨é¡¹ç›®è®¾ç½®(Project Settings)é‡Œä¿®æ”¹é”®ç›˜ç»‘å®š.  </p><p>å½“ä½ æƒ³è¦æŸ¥çœ‹å…¶ä»–Characterçš„<code>GameplayTag</code>, <code>GameplayEffect</code>å’Œ<code>GameplayAbility</code>æ—¶å¯ä»¥ä½¿ç”¨Gameplay Debugger, å¯æƒœçš„æ˜¯å®ƒä¸èƒ½æ˜¾ç¤ºTargetçš„<code>Attribute</code>ä¸­çš„<code>CurrentValue</code>. å®ƒä¼šå®šä½å±å¹•ä¸­å¤®çš„ä»»ä½•Character, ä½ å¯ä»¥é€šè¿‡é€‰æ‹©ç¼–è¾‘å™¨ä¸–ç•Œå¤§çº²(World Outliner)æˆ–è€…çœ‹å‘å¦ä¸€ä¸ªä¸åŒçš„Characterå¹¶å†æ¬¡æŒ‰ä¸‹<code>åå¼•å·(`)</code>é”®æ¥ä¿®æ”¹Target. å½“å‰ç›‘è§†çš„Characterä¸Šæ–¹æœ‰æœ€å¤§çš„çº¢è‰²åœ†.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="debugging-log"></a></p><h3 id="6-3-GASæ—¥å¿—-Logging"><a href="#6-3-GASæ—¥å¿—-Logging" class="headerlink" title="6.3 GASæ—¥å¿—(Logging)"></a>6.3 GASæ—¥å¿—(Logging)</h3><p>GASåŒ…å«äº†å¤§é‡ä¸åŒè¯¦ç»†çº§åˆ«çš„æ—¥å¿—ç”Ÿæˆè¯­å¥, ä½ å¾ˆå¯èƒ½è§åˆ°çš„æ˜¯<code>ABILITY_LOG()</code>è¿™æ ·çš„è¯­å¥. é»˜è®¤çš„è¯¦ç»†çº§åˆ«æ˜¯<code>Display</code>, æ›´é«˜çš„é»˜è®¤ä¸ä¼šæ˜¾ç¤ºåœ¨æ§åˆ¶å°é‡Œ.  </p><p>ä¸ºäº†ä¿®æ”¹æŸä¸ªæ—¥å¿—åˆ†ç±»çš„è¯¦ç»†çº§åˆ«, åœ¨æ§åˆ¶å°ä¸­è¾“å…¥:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log [category] [verbosity]</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚, ä¸ºäº†å¼€å¯<code>ABILITY_LOG()</code>è¯­å¥, åº”è¯¥åœ¨æ§åˆ¶å°ä¸­è¾“å…¥:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log LogAbilitySystem VeryVerbose</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ¢å¤é»˜è®¤, è¾“å…¥:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log LogAbilitySystem Display</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ˜¾ç¤ºæ‰€æœ‰çš„æ—¥å¿—åˆ†ç±», è¾“å…¥:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log list</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„GASç›¸å…³çš„æ—¥å¿—åˆ†ç±»:  </p><div class="table-container"><table><thead><tr><th style="text-align:center">æ—¥å¿—åˆ†ç±»</th><th style="text-align:center">é»˜è®¤è¯¦ç»†çº§åˆ«</th></tr></thead><tbody><tr><td style="text-align:center">LogAbilitySystem</td><td style="text-align:center">Display</td></tr><tr><td style="text-align:center">LogAbilitySystemComponent</td><td style="text-align:center">Log</td></tr><tr><td style="text-align:center">LogGameplayCueDetails</td><td style="text-align:center">Log</td></tr><tr><td style="text-align:center">LogGameplayCueTranslator</td><td style="text-align:center">Display</td></tr><tr><td style="text-align:center">LogGameplayEffectDetails</td><td style="text-align:center">Log</td></tr><tr><td style="text-align:center">LogGameplayEffects</td><td style="text-align:center">Display</td></tr><tr><td style="text-align:center">LogGameplayTags</td><td style="text-align:center">Log</td></tr><tr><td style="text-align:center">LogGameplayTasks</td><td style="text-align:center">Log</td></tr><tr><td style="text-align:center">VLogAbilitySystem</td><td style="text-align:center">Display</td></tr></tbody></table></div><p>è¯¦æƒ…æŸ¥çœ‹<a href="https://www.ue4community.wiki/Legacy/Logs,_Printing_Messages_To_Yourself_During_Runtime">æ—¥å¿—Wiki</a>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="optimizations"></a></p><h2 id="7-ä¼˜åŒ–"><a href="#7-ä¼˜åŒ–" class="headerlink" title="7. ä¼˜åŒ–"></a>7. ä¼˜åŒ–</h2><p><a name="optimizations-abilitybatching"></a></p><h2 id="7-1-Abilityæ‰¹å¤„ç†"><a href="#7-1-Abilityæ‰¹å¤„ç†" class="headerlink" title="7.1 Abilityæ‰¹å¤„ç†"></a>7.1 Abilityæ‰¹å¤„ç†</h2><p><a href="#concepts-ga">GameplayAbility</a>åœ¨ä¸€å¸§ä¸­çš„çš„æ¿€æ´»ã€é€‰æ‹©æ€§åœ°å‘æœåŠ¡å™¨å‘é€<code>TargetData</code>ã€ç»“æŸå¯ä»¥è¢«<a href="#concepts-ga-batching">æ‰¹å¤„ç†è€Œå°†2-3ä¸ªRPCå‹ç¼©æˆä¸€ä¸ªRPC</a>. è¿™ç§RPCå¸¸ç”¨äºæªæ”¯çš„å‘½ä¸­åˆ¤æ–­.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="optimizations-gameplaycuebatching"></a></p><h2 id="7-2-GameplayCueæ‰¹å¤„ç†"><a href="#7-2-GameplayCueæ‰¹å¤„ç†" class="headerlink" title="7.2 GameplayCueæ‰¹å¤„ç†"></a>7.2 GameplayCueæ‰¹å¤„ç†</h2><p>å¦‚æœä½ éœ€è¦åŒæ—¶å‘é€å¾ˆå¤š<a href="#concepts-gc">GameplayCue</a>, å¯ä»¥è€ƒè™‘å°†å…¶<a href="#concepts-gc-batching">æ‰¹å¤„ç†æˆä¸€ä¸ªRPC</a>, ç›®æ ‡å°±æ˜¯å‡å°‘RPCæ•°é‡(<code>GameplayCue</code>æ˜¯ä¸å¯é çš„ç½‘ç»œå¤šæ’­(NetMulticast))å¹¶ä»¥å°½å¯èƒ½å°‘çš„æ•°æ®é‡å‘é€.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="optimizations-ascreplicationmode"></a></p><h2 id="7-3-AbilitySystemComponentåŒæ­¥æ¨¡å¼-Replication-Mode"><a href="#7-3-AbilitySystemComponentåŒæ­¥æ¨¡å¼-Replication-Mode" class="headerlink" title="7.3 AbilitySystemComponentåŒæ­¥æ¨¡å¼(Replication Mode)"></a>7.3 AbilitySystemComponentåŒæ­¥æ¨¡å¼(Replication Mode)</h2><p>é»˜è®¤æƒ…å†µä¸‹, <a href="#concepts-asc">ASC</a>å¤„äº<a href="#concepts-asc-rm">Full Replication</a>æ¨¡å¼, è¿™ä¼šåŒæ­¥æ‰€æœ‰çš„<a href="#concepts-ge">GameplayEffect</a>åˆ°æ¯ä¸ªå®¢æˆ·ç«¯(å¯¹å•äººæ¸¸æˆæ¥è¯´å¾ˆå¥½). åœ¨å¤šäººæ¸¸æˆä¸­, è®¾ç½®ç©å®¶æ‹¥æœ‰çš„<code>ASC</code>ä¸º<code>Mixed Replication</code>æ¨¡å¼, AIæ§åˆ¶çš„Characterä¸º<code>Minimal Replication</code>æ¨¡å¼, è¿™ä¼šå°†åº”ç”¨åˆ°ç©å®¶Characterä¸Šçš„<code>GE</code>ä»…åŒæ­¥åˆ°è¯¥Characterçš„æ‹¥æœ‰è€…, åº”ç”¨åˆ°AIæ§åˆ¶çš„Characterä¸Šçš„<code>GE</code>æ°¸è¿œä¸ä¼šåŒæ­¥åˆ°å®¢æˆ·ç«¯. æ— è®ºæ˜¯ä»€ä¹ˆåŒæ­¥æ¨¡å¼, <a href="#concepts-gt">GameplayTag</a>ä»ä¼šè¿›è¡ŒåŒæ­¥, <a href="#concepts-gc">GameplayCue</a>ä»ä¼šä»¥ä¸å¯é çš„ç½‘ç»œå¤šæ’­(NetMulticast)åˆ°æ‰€æœ‰å®¢æˆ·ç«¯. å½“æ‰€æœ‰å®¢æˆ·ç«¯éƒ½ä¸éœ€è¦æŸ¥çœ‹è¿™äº›æ•°æ®æ—¶, è¿™ä¼šå‡å°‘ä»<code>GE</code>åŒæ­¥çš„ç½‘ç»œæ•°æ®.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="optimizations-attributeproxyreplication"></a></p><h2 id="7-4-Attributeä»£ç†åŒæ­¥"><a href="#7-4-Attributeä»£ç†åŒæ­¥" class="headerlink" title="7.4 Attributeä»£ç†åŒæ­¥"></a>7.4 Attributeä»£ç†åŒæ­¥</h2><p>åœ¨æœ‰å¾ˆå¤šç©å®¶çš„å¤§å‹æ¸¸æˆä¸­, åƒFortniteå¤§é€ƒæ€(Fortnite Battle Royale), æœ‰å¤§é‡å­˜åœ¨äºå¸¸ç›¸å…³<code>PlayerState</code>ä¸Šçš„<a href="#concepts-asc">ASC</a>, å…¶ä¼šåŒæ­¥å¤§é‡<a href="#concepts-a">Attribute</a>. ä¸ºäº†ä¼˜åŒ–è¯¥ç“¶é¢ˆ, Fortniteç¦æ­¢åœ¨<code>PlayerState::ReplicateSubobjects()</code>ä¸­å®Œå…¨åŒæ­¥<code>ASC</code>å’Œå®ƒçš„<a href="#concepts-as">AttributeSet</a>åˆ°æ¨¡æ‹Ÿç©å®¶æ§åˆ¶çš„ä»£ç†(Simulated Player-Controlled Proxy)ä¸Š. Autonomouä»£ç†å’ŒAIæ§åˆ¶çš„<code>Pawn</code>ä»ç„¶æ ¹æ®å…¶<a href="#concepts-asc-rm">åŒæ­¥æ¨¡å¼</a>æ¥å®Œå…¨åŒæ­¥. Fortniteä½¿ç”¨äº†ç©å®¶Pawnä¸Šçš„å¯åŒæ­¥ä»£ç†ç»“æ„ä½“, è€Œä¸æ˜¯åŒæ­¥å¸¸ç›¸å…³<code>PlayerState</code>ä¸Šçš„<code>ASC</code>çš„<code>Attribute</code>. å½“æœåŠ¡ç«¯ASCä¸Šçš„<code>Attribute</code>æ”¹å˜æ—¶, å…¶ä¹Ÿä¼šåœ¨ä»£ç†ç»“æ„ä½“ä¸­æ”¹å˜, å®¢æˆ·ç«¯ä¼šä»ä»£ç†ç»“æ„ä½“æ¥æ”¶åŒæ­¥çš„<code>Attribute</code>å¹¶å°†ä¿®æ”¹è¿”å›å…¶æœ¬åœ°<code>ASC</code>, è¿™å…è®¸<code>Attribute</code>åŒæ­¥ä½¿ç”¨<code>Pawn</code>çš„ç›¸å…³æ€§(Relevancy)å’Œ<code>NetUpdateFrequency</code>, è¯¥ä»£ç†ç»“æ„ä½“ä¹Ÿä¼šä½¿ç”¨ä½æ©ç (Bitmask)åŒæ­¥ä¸€ä¸ªå°çš„<code>GameplayTag</code>ç™½åå•é›†åˆ. è¯¥ä¼˜åŒ–å‡å°‘äº†ç½‘ç»œæ•°æ®é‡, å¹¶å…è®¸æˆ‘ä»¬åˆ©ç”¨Pawnç›¸å…³æ€§(Relevancy). AIæ§åˆ¶çš„<code>Pawn</code>çš„<code>ASC</code>ä½äºå·²ç»ä½¿ç”¨å…¶ç›¸å…³æ€§çš„<code>Pawn</code>ä¸Š, å› æ­¤å…¶å¹¶ä¸éœ€è¦è¯¥ä¼˜åŒ–.  </p><blockquote><p>Iâ€™m not sure if it is still necessary with other server side optimizations that have been done since then (Replication Graph, etc) and it is not the most maintainable pattern.</p></blockquote><p>æ¥è‡ªEpicçš„Dave Rattiå›ç­”<a href="https://epicgames.ent.box.com/s/m1egifkxv3he3u3xezb9hzbgroxyhx89">ç¤¾åŒºé—®é¢˜#3</a>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="optimizations-asclazyloading"></a></p><h2 id="7-5-ASCæ‡’åŠ è½½"><a href="#7-5-ASCæ‡’åŠ è½½" class="headerlink" title="7.5 ASCæ‡’åŠ è½½"></a>7.5 ASCæ‡’åŠ è½½</h2><p>Fortniteå¤§é€ƒæ€(Fortnite Battle Royale)ä¸–ç•Œä¸­æœ‰å¾ˆå¤šå¯æŸåçš„<code>AActor</code>(æ ‘æœ¨, å»ºç­‘ç‰©ç­‰ç­‰), æ¯ä¸ªéƒ½æœ‰ä¸€ä¸ª<code>ASC</code>, è¿™ä¼šå¢åŠ å†…å­˜æ¶ˆè€—, Fortniteé€šè¿‡åªåœ¨éœ€è¦æ—¶(å½“å…¶ç¬¬ä¸€æ¬¡è¢«ç©å®¶ä¼¤å®³æ—¶)æ‡’åŠ è½½<code>ASC</code>çš„æ–¹å¼ä¼˜åŒ–è¯¥é—®é¢˜, è¿™ä¼šå‡å°‘æ•´ä½“å†…å­˜æ¶ˆè€—, å› ä¸ºæŸäº›<code>AActor</code>åœ¨ä¸€å±€æ¯”èµ›ä¸­å¯èƒ½æ°¸è¿œä¸ä¼šè¢«ä¼¤å®³.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="qol"></a></p><h1 id="8-Quality-of-Life-Suggestions"><a href="#8-Quality-of-Life-Suggestions" class="headerlink" title="8. Quality of Life Suggestions"></a>8. Quality of Life Suggestions</h1><p><a name="qol-gameplayeffectcontainers"></a></p><h2 id="8-1-Gameplay-Effect-Containers"><a href="#8-1-Gameplay-Effect-Containers" class="headerlink" title="8.1 Gameplay Effect Containers"></a>8.1 Gameplay Effect Containers</h2><p><a href="#concepts-ge-containers">GameplayEffectContainer</a>å°†<a href="#concepts-ge-spec">GameplayEffectSpec</a>, <a href="#concepts-targeting-data">TargetData</a>, ç®€å•å®šä½å’Œå…¶ä»–ç›¸å…³åŠŸèƒ½æ•´åˆè¿›ç®€å•æ˜“ç”¨çš„ç»“æ„ä½“, è¿™å¯¹è½¬ç§»<code>GameplayEffectSpec</code>åˆ°Abilityç”Ÿæˆçš„æŠ›å°„ç‰©å¾ˆæœ‰ç”¨, è¯¥æŠ›å°„ç‰©ä¹‹åä¼šåœ¨ç¢°æ’ä½“ä¸Šåº”ç”¨<code>GameplayEffectSpec</code>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="qol-asynctasksascdelegates"></a></p><h2 id="8-2-å°†è“å›¾AsyncTaskç»‘å®šåˆ°ASCå§”æ‰˜"><a href="#8-2-å°†è“å›¾AsyncTaskç»‘å®šåˆ°ASCå§”æ‰˜" class="headerlink" title="8.2 å°†è“å›¾AsyncTaskç»‘å®šåˆ°ASCå§”æ‰˜"></a>8.2 å°†è“å›¾AsyncTaskç»‘å®šåˆ°ASCå§”æ‰˜</h2><p>ä¸ºäº†å¢åŠ è®¾è®¡å¸ˆå‹å¥½çš„è¿­ä»£æ¬¡æ•°, ç‰¹åˆ«æ˜¯åœ¨ä¸ºUIè®¾è®¡UMG Widgetæ—¶, å¯ä»¥åˆ›å»ºè“å›¾AsyncTask(åœ¨C++ä¸­)ä»¥ç›´æ¥åœ¨UMGè“å›¾å›¾è¡¨ä¸­ç»‘å®šåˆ°<code>ASC</code>ä¸­å¸¸è§çš„ä¿®æ”¹å§”æ‰˜, å”¯ä¸€çš„å‘Šè¯«å°±æ˜¯å…¶å¿…é¡»æ‰‹åŠ¨é”€æ¯(æ¯”å¦‚åœ¨widgeté”€æ¯æ—¶), å¦åˆ™å°±ä¼šæ°¸è¿œå­˜äºå†…å­˜ä¸­.æ ·ä¾‹é¡¹ç›®åŒ…å«ä¸‰ä¸ªè“å›¾AsyncTask.  </p><p>ç›‘å¬<code>Attribute</code>ä¿®æ”¹:  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/attributeschange.png" alt="Listen for Attributes Changes BP Node">  </p><p>ç›‘å¬å†·å´æ—¶é—´ä¿®æ”¹:  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/cooldownchange.png" alt="Listen for Cooldown Change BP Node">  </p><p>ç›‘å¬<code>GE</code>å †æ ˆä¿®æ”¹:  </p><p><img src="https://raw.githubusercontent.com/BillEliot/GASDocumentation_Chinese/main/Images/gestackchange.png" alt="Listen for GameplayEffect Stack Change BP Node">  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="troubleshooting"></a></p><h1 id="9-ç–‘éš¾è§£ç­”"><a href="#9-ç–‘éš¾è§£ç­”" class="headerlink" title="9. ç–‘éš¾è§£ç­”"></a>9. ç–‘éš¾è§£ç­”</h1><p><a name="troubleshooting-notlocal"></a></p><h2 id="9-1-LogAbilitySystem-Warning-Canâ€™t-activate-LocalOnly-or-LocalPredicted-ability-s-when-not-local"><a href="#9-1-LogAbilitySystem-Warning-Canâ€™t-activate-LocalOnly-or-LocalPredicted-ability-s-when-not-local" class="headerlink" title="9.1 LogAbilitySystem: Warning: Canâ€™t activate LocalOnly or LocalPredicted ability %s when not local!"></a>9.1 LogAbilitySystem: Warning: Canâ€™t activate LocalOnly or LocalPredicted ability %s when not local!</h2><p>ä½ éœ€è¦åœ¨<a href="#concepts-asc-setup">å®¢æˆ·ç«¯åˆå§‹åŒ–<code>ASC</code></a>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="troubleshooting-scriptstructcache"></a></p><h2 id="9-2-ScriptStructCacheé”™è¯¯"><a href="#9-2-ScriptStructCacheé”™è¯¯" class="headerlink" title="9.2 ScriptStructCacheé”™è¯¯"></a>9.2 <code>ScriptStructCache</code>é”™è¯¯</h2><p>ä½ éœ€è¦è°ƒç”¨<a href="#concepts-asg-initglobaldata">UAbilitySystemGlobals::InitGlobalData()</a>.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="troubleshooting-replicatinganimmontages"></a></p><h2 id="9-3-åŠ¨ç”»è’™å¤ªå¥‡ä¸èƒ½åŒæ­¥åˆ°å®¢æˆ·ç«¯"><a href="#9-3-åŠ¨ç”»è’™å¤ªå¥‡ä¸èƒ½åŒæ­¥åˆ°å®¢æˆ·ç«¯" class="headerlink" title="9.3 åŠ¨ç”»è’™å¤ªå¥‡ä¸èƒ½åŒæ­¥åˆ°å®¢æˆ·ç«¯"></a>9.3 åŠ¨ç”»è’™å¤ªå¥‡ä¸èƒ½åŒæ­¥åˆ°å®¢æˆ·ç«¯</h2><p>ç¡®ä¿åœ¨<a href="#concepts-ga">GameplayAbility</a>ä¸­æ­£åœ¨ä½¿ç”¨çš„æ˜¯<code>PlayMontageAndWait</code>èŠ‚ç‚¹è€Œä¸æ˜¯<code>PlayMontage</code>, è¯¥<a href="#concepts-at">AbilityTask</a>å¯ä»¥é€šè¿‡<code>ASC</code>è‡ªåŠ¨åŒæ­¥è’™å¤ªå¥‡è€Œ<code>PlayMontage</code>èŠ‚ç‚¹ä¸å¯ä»¥.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="troubleshooting-duplicatingblueprintactors"></a></p><h2 id="9-4-å¤åˆ¶çš„è“å›¾Actorä¼šå°†AttributeSetè®¾ç½®ä¸ºnullptr"><a href="#9-4-å¤åˆ¶çš„è“å›¾Actorä¼šå°†AttributeSetè®¾ç½®ä¸ºnullptr" class="headerlink" title="9.4 å¤åˆ¶çš„è“å›¾Actorä¼šå°†AttributeSetè®¾ç½®ä¸ºnullptr"></a>9.4 å¤åˆ¶çš„è“å›¾Actorä¼šå°†AttributeSetè®¾ç½®ä¸ºnullptr</h2><p>è¿™æ˜¯ä¸€ä¸ª<a href="https://issues.unrealengine.com/issue/UE-81109">è™šå¹»å¼•æ“çš„bug</a>, å½“ä½¿ç”¨ä»ä¸€ä¸ªå­˜åœ¨çš„è“å›¾Actorç±»å¤åˆ¶çš„æ–¹å¼æ¥åˆ›å»ºæ–°çš„ç±», è¿™ä¼šè®©è¿™ä¸ªç±»ä¸­å°†AttributeSetæŒ‡é’ˆè®¾ç½®ä¸ºç©ºæŒ‡é’ˆ.  </p><p>å¯¹æ­¤æœ‰ä¸€äº›å˜é€šçš„æ–¹æ³•, æˆ‘å·²ç»æˆåŠŸåœ°ä¸åœ¨æˆ‘çš„ç±»å†…åˆ›å»ºå®šåˆ¶çš„<code>AttributeSet</code>æŒ‡é’ˆ(å¤´æ–‡ä»¶ä¸­æ²¡æœ‰æŒ‡é’ˆ, ä¹Ÿä¸åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨<code>CreateDefaultSubobject</code>),<br>è€Œæ˜¯ç›´æ¥åœ¨PostInitializeComponents()ä¸­å‘<code>ASC</code>æ·»åŠ <code>AttributeSets</code>(æ ·æœ¬é¡¹ç›®ä¸­æ²¡æœ‰æ˜¾ç¤º).<br>å¤åˆ¶çš„AttributeSetså°†ä»ç„¶å­˜åœ¨äº<code>ASC</code>çš„<code>SpawnedAttributes</code>æ•°ç»„ä¸­. å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AGDPlayerState::PostInitializeComponents</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Super::<span class="built_in">PostInitializeComponents</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (AbilitySystemComponent)</span><br><span class="line">&#123;</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">AddSet</span>&lt;UGDAttributeSetBase&gt;();</span><br><span class="line"><span class="comment">// ... å…¶ä»–ä½ å¯èƒ½æ‹¥æœ‰çš„å±æ€§é›†</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹, ä½ æƒ³è¦è¯»å–æˆ–è€…ä¿®æ”¹<code>AttributeSet</code>çš„å€¼, å°±éœ€è¦è°ƒç”¨<code>ASC</code>å®ä¾‹ä¸­çš„å‡½æ•°, è€Œä¸æ˜¯<a href="#concepts-as-attributes"><code>AttributeSet</code>ä¸­å®šä¹‰çš„å®</a>.  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** è¿”å›å½“å‰(æœ€ç»ˆ)å±æ€§å€¼ */</span></span><br><span class="line"><span class="function"><span class="type">float</span> <span class="title">GetNumericAttribute</span><span class="params">(<span class="type">const</span> FGameplayAttribute &amp;Attribute)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** è®¾ç½®ä¸€ä¸ªå±æ€§çš„åŸºç¡€å€¼ã€‚ å½“å‰æ¿€æ´»çš„ä¿®æ”¹å™¨ä¸ä¼šè¢«æ¸…é™¤å¹¶å°†åœ¨NewBaseValueä¸Šå‘æŒ¥ä½œç”¨ */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SetNumericAttributeBase</span><span class="params">(<span class="type">const</span> FGameplayAttribute &amp;Attribute, <span class="type">float</span> NewBaseValue)</span></span>;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥GetHealth()çš„å®ç°å°†ä¼šå¦‚ä¸‹:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">float</span> <span class="title">AGDPlayerState::GetHealth</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (AbilitySystemComponent)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> AbilitySystemComponent-&gt;<span class="built_in">GetNumericAttribute</span>(UGDAttributeSetBase::<span class="built_in">GetHealthAttribute</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0.0f</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¾ç½®(åˆå§‹åŒ–)ç”Ÿå‘½å€¼å±æ€§çš„å®ç°å°†ä¼šæ˜¯è¿™æ ·:  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">float</span> NewHealth = <span class="number">100.0f</span>;</span><br><span class="line"><span class="keyword">if</span> (AbilitySystemComponent)</span><br><span class="line">&#123;</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">SetNumericAttributeBase</span>(UGDAttributeSetBase::<span class="built_in">GetHealthAttribute</span>(), NewHealth);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¡ºä¾¿æä¸€ä¸‹, å¾€<code>ASC</code>ç»„ä»¶æ³¨å†Œçš„æ¯ä¸ª<code>AttributeSet</code>ç±»æœ€å¤šåªæœ‰ä¸€ä¸ªå¯¹è±¡.  </p><p><strong><a href="#table-of-contents">â¬† Back to Top</a></strong></p><p><a name="acronyms"></a></p><h1 id="10-ASCå¸¸ç”¨æœ¯è¯­ç¼©ç•¥"><a href="#10-ASCå¸¸ç”¨æœ¯è¯­ç¼©ç•¥" class="headerlink" title="10. ASCå¸¸ç”¨æœ¯è¯­ç¼©ç•¥"></a>10. ASCå¸¸ç”¨æœ¯è¯­ç¼©ç•¥</h1><div class="table-container"><table><thead><tr><th style="text-align:center">æœ¯è¯­</th><th style="text-align:center">ç¼©ç•¥</th></tr></thead><tbody><tr><td style="text-align:center">AbilitySystemComponent</td><td style="text-align:center">ASC</td></tr><tr><td style="text-align:center">AbilityTask</td><td style="text-align:center">AT</td></tr><tr><td style="text-align:center">Action RPG Sample Project by Epic</td><td style="text-align:center">ARPG, ARPG Sample</td></tr><tr><td style="text-align:center">CharacterMovementComponent</td><td style="text-align:center">CMC</td></tr><tr><td style="text-align:center">GameplayAbility</td><td style="text-align:center">GA</td></tr><tr><td style="text-align:center">GameplayAbilitySystem</td><td style="text-align:center">GAS</td></tr><tr><td style="text-align:center">GameplayCue</td><td style="text-align:center">GC</td></tr><tr><td style="text-align:center">GameplayEffect</td><td style="text-align:center">GE</td></tr><tr><td style="text-align:center">GameplayEffectExecutionCalculation</td><td style="text-align:center">ExecCalc, Execution</td></tr><tr><td style="text-align:center">GameplayTag</td><td style="text-align:center">Tag, GT</td></tr><tr><td style="text-align:center">ModiferMagnitudeCalculation</td><td style="text-align:center">ModMagCalc, MMC</td></tr></tbody></table></div><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="resources"></a></p><h1 id="11-å…¶ä»–èµ„æº"><a href="#11-å…¶ä»–èµ„æº" class="headerlink" title="11. å…¶ä»–èµ„æº"></a>11. å…¶ä»–èµ„æº</h1><p><a href="https://docs.unrealengine.com/en-US/InteractiveExperiences/GameplayAbilitySystem/index.html">å®˜æ–¹æ–‡æ¡£</a>  </p><p>æºä»£ç ! ç‰¹åˆ«æ˜¯<code>GameplayPrediction.h</code>.  </p><p><a href="https://www.unrealengine.com/marketplace/en-US/slug/action-rpg">Epicçš„Action RPGæ ·ä¾‹é¡¹ç›®</a>  </p><p><a href="https://epicgames.ent.box.com/s/m1egifkxv3he3u3xezb9hzbgroxyhx89">æ¥è‡ªEpicçš„Dave Rattiå›å¤ç¤¾åŒºå…³äºGASçš„é—®é¢˜</a>  </p><p><a href="https://unrealslackers.org">Unreal Slackers Discord</a>æœ‰ä¸€ä¸ªä¸“æ³¨äºGAS<code>#gameplay-abilities-plugin</code>çš„æ–‡å­—é¢‘é“  </p><p><a href="https://github.com/Pantong51/GASContent">Dan â€˜Panâ€™çš„Githubåº“</a>  </p><p><a href="https://www.youtube.com/channel/UCCFUhQ6xQyjXDZ_d6X_H_-A">SabreDartStudiosçš„YouTubeè§†é¢‘</a></p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="changelog"></a></p><h1 id="12-GASæ›´æ–°æ—¥å¿—"><a href="#12-GASæ›´æ–°æ—¥å¿—" class="headerlink" title="12. GASæ›´æ–°æ—¥å¿—"></a>12. GASæ›´æ–°æ—¥å¿—</h1><p>è¿™æ˜¯ä»Unreal Engineå®˜æ–¹å‡çº§æ—¥å¿—å’Œæˆ‘é‡åˆ°çš„ä¸”æœªè®°å½•çš„å‡çº§ä¸­æ•´ç†çš„ä¸€ä»½å€¼å¾—ä¸€çœ‹çš„å‡çº§åˆ—è¡¨, å¦‚æœä½ å‘ç°æŸäº›æ²¡æœ‰åˆ—åœ¨å…¶ä¸­, è¯·æissueæˆ–è€…PR.  </p><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="changelog-4.26"></a></p><h2 id="4-26"><a href="#4-26" class="headerlink" title="4.26"></a>4.26</h2><ul><li>GAS plugin is no longer flagged as beta.</li><li>Crash Fix: Fixed a crash when adding a gameplay tag without a valid tag source selection.</li><li>Crash Fix: Added the path string arg to a message to fix a crash in UGameplayCueManager::VerifyNotifyAssetIsInValidPath.</li><li>Crash Fix: Fixed an access violation crash in AbilitySystemComponent_Abilities when using a ptr without checking it.</li><li>Bug Fix: Fixed a bug where stacking GEs that did not reset the duration on additional instances of the effect being applied.</li><li>Bug Fix: Fixed an issue that caused CancelAllAbilities to only cancel non-instanced abilities.</li><li>New: Added optional tag parameters to gameplay ability commit functions.</li><li>New: Added StartTimeSeconds to PlayMontageAndWait ability task and improved comments.</li><li>New: Added tag container â€œDynamicAbilityTagsâ€ to FGameplayAbilitySpec. These are optional ability tags that are replicated with the spec. They are also captured as source tags by applied gameplay effects.</li><li>New: GameplayAbility IsLocallyControlled and HasAuthority functions are now callable from Blueprint.</li><li>New: Visual logger will now only collect and store info about instant GEs if weâ€™re currently recording visual logging data.</li><li>New: Added support for redirectors on gameplay attribute pins in blueprint nodes.</li><li>New: Added new functionality for when root motion movement related ability tasks end they will return the movement componentâ€™s movement mode to the movement mode it was in before the task started.</li></ul><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="changelog-4.25.1"></a></p><h2 id="4-25-1"><a href="#4-25-1" class="headerlink" title="4.25.1"></a>4.25.1</h2><ul><li>Fixed! UE-92787 Crash saving blueprint with a Get Float Attribute node and the attribute pin is set inline</li><li>Fixed! UE-92810 Crash spawning actor with instance editable gameplay tag property that was changed inline</li></ul><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="changelog-4.25"></a></p><h2 id="4-25"><a href="#4-25" class="headerlink" title="4.25"></a>4.25</h2><ul><li>Fixed prediction of RootMotionSource AbilityTasks</li><li><a href="#concepts-as-attributes">GAMEPLAYATTRIBUTE_REPNOTIFY()</a> now additionally takes in the old Attribute value. We must supply that as the optional parameter to our OnRep functions. Previously, it was reading the attribute value to try to get the old value. However, if called from a replication function, the old value had already been discarded before reaching SetBaseAttributeValueFromReplication so weâ€™d get the new value instead.</li><li>Added <a href="#concepts-ga-netsecuritypolicy">NetSecurityPolicy</a> to UGameplayAbility.</li><li>Crash Fix: Fixed a crash when adding a gameplay tag without a valid tag source selection.</li><li>Crash Fix: Removed a few ways for attackers to crash a server through the ability system.</li><li>Crash Fix: We now make sure we have a GamplayEffect definition before checking tag requirements.</li><li>Bug Fix: Fixed an issue with gameplay tag categories not applying to function parameters in Blueprints if they were part of a function terminator node.</li><li>Bug Fix: Fixed an issue with gameplay effectsâ€™ tags not being replicated with multiple viewports.</li><li>Bug Fix: Fixed a bug where a gameplay ability spec could be invalidated by the InternalTryActivateAbility function while looping through triggered abilities.</li><li>Bug Fix: Changed how we handle updating gameplay tags inside of tag count containers. When deferring the update of parent tags while removing gameplay tags, we will now call the change-related delegates after the parent tags have updated. This ensures that the tag table is in a consistent state when the delegates broadcast.</li><li>Bug Fix: We now make a copy of the spawned target actor array before iterating over it inside when confirming targets because some callbacks may modify the array.</li><li>Bug Fix: Fixed a bug where stacking GamplayEffects that did not reset the duration on additional instances of the effect being applied and with set by caller durations would only have the duration correctly set for the first instance on the stack. All other GE specs in the stack would have a duration of 1 second. Added automation tests to detect this case.</li><li>Bug Fix: Fixed a bug that could occur if handling gameplay event delegates modified the list of gameplay event delegates.</li><li>Bug Fix: Fixed a bug causing GiveAbilityAndActivateOnce to behave inconsistently.</li><li>Bug Fix: Reordered some operations inside FGameplayEffectSpec::Initialize to deal with a potential ordering dependency.</li><li>New: UGameplayAbility now has an OnRemoveAbility function. It follows the same pattern as OnGiveAbility and is only called on the primary instance of the ability or the class default object.</li><li>New: When displaying blocked ability tags, the debug text now includes the total number of blocked tags.</li><li>New: Renamed UAbilitySystemComponent::InternalServerTryActiveAbility to UAbilitySystemComponent::InternalServerTryActivateAbility.Code that was calling InternalServerTryActiveAbility should now call InternalServerTryActivateAbility.</li><li>New: Continue to use the filter text for displaying gameplay tags when a tag is added or deleted. The previous behaviour cleared the filter.</li><li>New: Donâ€™t reset the tag source when we add a new tag in the editor.</li><li>New: Added the ability to query an ability system component for all active gameplay effects that have a specified set of tags. The new function is called GetActiveEffectsWithAllTags and can be accessed through code or blueprints.</li><li>New: When root motion movement related ability tasks end they now return the movement componentâ€™s movement mode to the movement mode it was in before the task started.</li><li>New: Made SpawnedAttributes transient so it wonâ€™t save data that can become stale and incorrect. Added null checks to prevent any currently saved stale data from propagating. This prevents problems related to bad data getting stored in SpawnedAttributes.</li><li>API Change: AddDefaultSubobjectSet has been deprecated. AddAttributeSetSubobject should be used instead.</li><li>New: Gameplay Abilities can now specify the Anim Instance on which to play a montage.</li></ul><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p><p><a name="changelog-4.24"></a></p><h2 id="4-24"><a href="#4-24" class="headerlink" title="4.24"></a>4.24</h2><ul><li>Fixed blueprint node Attribute variables resetting to None on compile.</li><li>Need to call <a href="#concepts-asg-initglobaldata">UAbilitySystemGlobals::InitGlobalData()</a> to use <a href="#concepts-targeting-data">TargetData</a> otherwise you will get ScriptStructCache errors and clients will be disconnected from the server. My advice is to always call this in every project now whereas before 4.24 it was optional.</li><li>Fixed crash when copying a GameplayTag setter to a blueprint that didnâ€™t have the variable previously defined.</li><li>UGameplayAbility::MontageStop() function now properly uses the OverrideBlendOutTime parameter.</li><li>Fixed GameplayTag query variables on components not being modified when edited.</li><li>Added the ability for GameplayEffectExecutionCalculations to support scoped modifiers against â€œtemporary variablesâ€ that arenâ€™t required to be backed by an attribute capture.<ul><li>Implementation basically enables GameplayTag-identified aggregators to be created as a means for an execution to expose a temporary value to be manipulated with scoped modifiers; you can now build formulas that want manipulatable values that donâ€™t need to be captured from a source or target.</li><li>To use, an execution has to add a tag to the new member variable ValidTransientAggregatorIdentifiers; those tags will show up in the calculation modifier array of scoped mods at the bottom, marked as temporary variablesâ€”with updated details customizations accordingly to support feature</li></ul></li><li>Added restricted tag quality-of-life improvements. Removed the default option for restricted GameplayTag source. We no longer reset the source when adding restricted tags to make it easier to add several in a row.</li><li>APawn::PossessedBy() now sets the owner of the Pawn to the new Controller. Useful because Mixed Replication Mode expects the owner of the Pawn to be the Controller if the ASC lives on the Pawn.</li><li>Fixed bug with POD (Plain Old Data) in FAttributeSetInittterDiscreteLevels.</li></ul><p><strong><a href="#table-of-contents">â¬† è¿”å›ç›®å½•</a></strong></p>]]></content>
    
    
    <summary type="html">GASä¸­æ–‡æ–‡æ¡£ï¼Œæ›´æ–°è‡³5.3ç‰ˆæœ¬ï¼ˆæ›´æ–°ä¸­ï¼Œimagesä»¥åé…ç½®ï¼‰</summary>
    
    
    
    <category term="GAS" scheme="https://sumikiru.top/categories/GAS/"/>
    
    
    <category term="GAS" scheme="https://sumikiru.top/tags/GAS/"/>
    
    <category term="UE" scheme="https://sumikiru.top/tags/UE/"/>
    
  </entry>
  
  <entry>
    <title>7.1è´ªå¿ƒç®—æ³•ç¯‡(2)</title>
    <link href="https://sumikiru.top/posts/5846fa02.html"/>
    <id>https://sumikiru.top/posts/5846fa02.html</id>
    <published>2024-08-14T00:12:25.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    
    <summary type="html">è´ªå¿ƒç®—æ³•éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="è´ªå¿ƒ" scheme="https://sumikiru.top/tags/%E8%B4%AA%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>è¯­è¨€åŸºç¡€2.é¢å‘å¯¹è±¡</title>
    <link href="https://sumikiru.top/posts/816de279.html"/>
    <id>https://sumikiru.top/posts/816de279.html</id>
    <published>2024-08-10T12:14:15.000Z</published>
    <updated>2024-12-12T05:10:58.029Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h1><h2 id="å†…å­˜åˆ†åŒº"><a href="#å†…å­˜åˆ†åŒº" class="headerlink" title="å†…å­˜åˆ†åŒº"></a>å†…å­˜åˆ†åŒº</h2><div class="table-container"><table><thead><tr><th style="text-align:center">ä»£ç åŒº</th><th style="text-align:center">å…¨å±€åŒº</th><th style="text-align:center">æ ˆåŒº</th><th style="text-align:center">å †åŒº</th></tr></thead><tbody><tr><td style="text-align:center">å­˜æ”¾äºŒè¿›åˆ¶ä»£ç ï¼Œç”±æ“ä½œç³»ç»Ÿç®¡ç†</td><td style="text-align:center">å­˜æ”¾å…¨å±€å˜é‡ã€é™æ€å˜é‡ã€å¸¸é‡</td><td style="text-align:center">ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ï¼Œå­˜æ”¾å‡½æ•°å‚æ•°å€¼ã€å±€éƒ¨å˜é‡</td><td style="text-align:center">ç”±ç¨‹åºå‘˜åˆ†é…å’Œé‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸å¤„ç†ï¼Œç¨‹åºç»“æŸæ—¶ç”±æ“ä½œç³»ç»Ÿå›æ”¶</td></tr><tr><td style="text-align:center">1. ç¨‹åºè¿è¡Œå‰å°±å­˜åœ¨ï¼›<br>2. å­˜æ”¾ CPU æ‰§è¡Œçš„æœºå™¨æŒ‡ä»¤ï¼›<br>3. å…±äº«ï¼šå¯¹äºéœ€è¦é¢‘ç¹æ‰§è¡Œçš„ç¨‹åºï¼Œåªéœ€åœ¨å†…å­˜ä¸­æœ‰ä¸€ä»½å³å¯ï¼›<br>4. åªè¯»ï¼šé˜²æ­¢ç¨‹åºæ„å¤–ä¿®æ”¹æŒ‡ä»¤ã€‚</td><td style="text-align:center">1. ç¨‹åºè¿è¡Œå‰å°±å­˜åœ¨ï¼›<br>2. å­˜æ”¾å…¨å±€å˜é‡ã€é™æ€å˜é‡ã€å¸¸é‡ï¼›<br>3. ç¨‹åºç»“æŸç”±æ“ä½œç³»ç»Ÿé‡Šæ”¾ã€‚</td><td style="text-align:center">1. ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ï¼Œå­˜æ”¾å‡½æ•°å‚æ•°å€¼ã€å±€éƒ¨å˜é‡ï¼›<br>2. æ³¨æ„ä¸è¦è¿”å›å±€éƒ¨å˜é‡çš„åœ°å€ï¼Œå› ä¸ºæ ˆåŒºå¼€é—­çš„æ•°æ®ç”±ç¼–è¯‘å™¨è‡ªåŠ¨é‡Šæ”¾ã€‚</td><td style="text-align:center">1. ç”±ç¨‹åºå‘˜åˆ†é…å’Œé‡Šæ”¾;<br>2. åˆ©ç”¨ new åœ¨å †åŒºå¼€è¾Ÿæ•°æ®ã€‚</td></tr></tbody></table></div><p>ğŸ¤”é€šè¿‡ä»£ç åˆ†æï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> b = <span class="number">20</span>;<span class="comment">//ä¸åœ¨å‡½æ•°ä½“ä¸­ï¼Œå…¨å±€å˜é‡ï¼Œå­˜æ”¾åœ¨å…¨å±€åŒºï¼›</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> d = <span class="number">30</span>;<span class="comment">//constä¿®é¥°çš„å…¨å±€å˜é‡ï¼Œä¹Ÿå«å…¨å±€å¸¸é‡ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> *<span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> *p = <span class="keyword">new</span> <span class="built_in">int</span>(<span class="number">10</span>);<span class="comment">//åˆ©ç”¨newæŠŠæ•°æ®å¼€è¾Ÿåˆ°å †åŒºï¼›//ä½œç”¨ç±»ä¼¼Cè¯­è¨€çš„malloc()</span></span><br><span class="line"><span class="comment">//æŒ‡é’ˆä¹Ÿæ˜¯å±€éƒ¨å˜é‡ï¼Œæ”¾åœ¨æ ˆåŒºï¼ŒæŒ‡é’ˆä¿å­˜çš„æ•°æ®æ”¾åœ¨å †åŒºï¼›</span></span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> *p = <span class="built_in">func</span>();</span><br><span class="line">cout &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; *p &lt;&lt; endl;</span><br><span class="line"><span class="keyword">delete</span> p;<span class="comment">//ç”¨deleteé‡Šæ”¾å †åŒºæ•°æ®ï¼›//ç±»ä¼¼Cè¯­è¨€çš„free()</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; *p &lt;&lt; endl;å·²é‡Šæ”¾ï¼Œå†æ¬¡è®¿é—®å°±è®¿é—®ä¸åˆ°ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> *arr = <span class="keyword">new</span> <span class="type">int</span>[<span class="number">10</span>];<span class="comment">//åœ¨å †åŒºåˆ›å»ºæ•°ç»„ï¼›</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">arr[i] = i + <span class="number">100</span>;</span><br><span class="line">cout &lt;&lt; arr[i] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">delete</span>[] arr;<span class="comment">//é‡Šæ”¾æ•°ç»„è¦åŠ []ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;<span class="comment">//å±€éƒ¨å˜é‡ï¼Œåªè¦æ˜¯åœ¨å‡½æ•°ä½“å†…çš„å˜é‡éƒ½æ˜¯å±€éƒ¨å˜é‡ï¼›</span></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; (<span class="type">int</span>)&amp;a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; (<span class="type">int</span>)&amp;b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> c = <span class="number">15</span>;<span class="comment">//é™æ€å˜é‡ï¼Œå­˜æ”¾åœ¨å…¨å±€åŒºï¼›</span></span><br><span class="line">cout &lt;&lt; (<span class="type">int</span>)&amp;c &lt;&lt; endl;<span class="comment">//åœ°å€å’Œå…¨å±€å˜é‡å¾ˆè¿‘ï¼Œåœ¨ä¸€ä¸ªåŒºåŸŸå†…ï¼›</span></span><br><span class="line">cout &lt;&lt; (<span class="type">int</span>)&amp;<span class="string">&quot;hello world&quot;</span> &lt;&lt; endl;<span class="comment">//å¸¸é‡ç¦»å…¨å±€å˜é‡ä¹Ÿå¾ˆè¿‘ï¼Œä¹Ÿåœ¨ä¸€ä¸ªåŒºå†…ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> e = <span class="number">25</span>;<span class="comment">//å±€éƒ¨å¸¸é‡ï¼Œå­˜æ”¾åœ¨æ ˆåŒºï¼›</span></span><br><span class="line">cout &lt;&lt; (<span class="type">int</span>)&amp;d &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; (<span class="type">int</span>)&amp;e &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> *q = <span class="built_in">func</span>();</span><br><span class="line">cout &lt;&lt; *q &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; *q &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; *q &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">delete</span> q;</span><br><span class="line"></span><br><span class="line"><span class="built_in">test01</span>();</span><br><span class="line"><span class="built_in">test02</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="ğŸš©å¼•ç”¨"><a href="#ğŸš©å¼•ç”¨" class="headerlink" title="ğŸš©å¼•ç”¨"></a>ğŸš©å¼•ç”¨</h2><blockquote><p>å¼•ç”¨ç›¸å½“äºç»™å˜é‡èµ·åˆ«åã€‚<br>å¿…é¡»åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–ä»¥åä¸å¯æ›´æ”¹ï¼›<br>å‡½æ•°å¼•ç”¨æ—¶ï¼Œå¯ä»¥è®©å½¢å‚ä¿®é¥°å®å‚ï¼Œå¯ç®€åŒ–æŒ‡é’ˆï¼›<br>å¼•ç”¨çš„æœ¬è´¨ï¼šåœ¨ C++å†…éƒ¨å®ç°çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¸¸é‡ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap01</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span><span class="comment">//å€¼ä¼ é€’ï¼Œå®å‚ä¸ä¼šè¢«ä¿®æ”¹</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> temp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap02</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b)</span><span class="comment">//åœ°å€ä¼ é€’ï¼Œå®å‚å¯ä»¥ä¿®æ”¹</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> temp = *a;</span><br><span class="line">*a = *b;</span><br><span class="line">*b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap03</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> &amp;b)</span><span class="comment">//å¼•ç”¨ä¼ é€’ï¼Œå®å‚å¯ä»¥ä¿®æ”¹</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> temp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸è¦è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ï¼›</span></span><br><span class="line"><span class="comment">//int&amp; test01()</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//int a1 = 10;//å±€éƒ¨å˜é‡ï¼Œå­˜æ”¾åœ¨æ ˆåŒºï¼›</span></span><br><span class="line"><span class="comment">//return a1;//éæ³•æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> &amp;<span class="title">test02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> a2 = <span class="number">10</span>;<span class="comment">//é™æ€å˜é‡ï¼Œå­˜æ”¾åœ¨å…¨å±€åŒºï¼›</span></span><br><span class="line"><span class="keyword">return</span> a2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">showValue</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;val)</span><span class="comment">//constä¿®é¥°ï¼Œå¸¸é‡å¼•ç”¨ï¼Œé˜²æ­¢ä¿®æ”¹å®å‚ï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//val = 60;//ä¸èƒ½ä¿®æ”¹valäº†ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;val= &quot;</span> &lt;&lt; val &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> &amp;b = a; <span class="comment">//ç³»ç»Ÿè‡ªåŠ¨è½¬åŒ–ä¸ºint *const b = &amp;a;æŒ‡é’ˆå¸¸é‡æ˜¯æŒ‡é’ˆæŒ‡å‘ä¸å¯æ›´æ”¹ï¼Œæ‰€ä»¥å¼•ç”¨ä¸å¯æ›´æ”¹ï¼›</span></span><br><span class="line">cout &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">b = <span class="number">20</span>;<span class="comment">//å‘ç°bæ˜¯å¼•ç”¨ï¼Œç³»ç»Ÿè‡ªåŠ¨è½¬ä¸º*b = 20; è§£å¼•ç”¨ï¼›</span></span><br><span class="line">cout &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; b &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> m = <span class="number">4</span>;</span><br><span class="line"><span class="type">int</span> n = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">swap01</span>(m, n);<span class="comment">//å€¼ä¼ é€’ï¼Œå®å‚ä¸ä¼šè¢«ä¿®æ”¹</span></span><br><span class="line">cout &lt;&lt; m &lt;&lt; <span class="string">&quot;   &quot;</span> &lt;&lt;n &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">swap02</span>(&amp;m, &amp;n);<span class="comment">//æŒ‡é’ˆä¼ å‚è¦åŠ &amp;ï¼Œå®å‚å¯ä»¥ä¿®æ”¹</span></span><br><span class="line">cout &lt;&lt; m &lt;&lt; <span class="string">&quot;   &quot;</span> &lt;&lt; n &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">swap03</span>(m, n);<span class="comment">//å¼•ç”¨ä¼ é€’å’Œå€¼ä¼ é€’ä¸€æ ·ï¼Œåªæ˜¯å®å‚å¯ä»¥ä¿®æ”¹</span></span><br><span class="line">cout &lt;&lt; m &lt;&lt; <span class="string">&quot;   &quot;</span> &lt;&lt; n &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*int &amp;ref1 = test01();</span></span><br><span class="line"><span class="comment">cout &lt;&lt; ref1 &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; ref1 &lt;&lt; endl;*/</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> &amp;ref2 = <span class="built_in">test02</span>();</span><br><span class="line">cout &lt;&lt; ref2 &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; ref2 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">test02</span>() = <span class="number">1000</span>;<span class="comment">//å¦‚æœå‡½æ•°çš„è¿”å›å€¼æ˜¯å¼•ç”¨ï¼Œå‡½æ•°è°ƒç”¨å¯ä»¥ä½œä¸ºå·¦å€¼ï¼›</span></span><br><span class="line">cout &lt;&lt; ref2 &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; ref2 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¸¸é‡å¼•ç”¨ï¼Œä¿®é¥°å½¢å‚ï¼Œé˜²æ­¢è¯¯æ“ä½œï¼›</span></span><br><span class="line"><span class="type">int</span> d = <span class="number">30</span>;</span><br><span class="line"><span class="type">int</span> &amp;ref3 = d;</span><br><span class="line"><span class="comment">//int &amp;ref3 = 30;//å¼•ç”¨å¿…é¡»å¼•ç”¨ä¸€å—åˆæ³•çš„å†…å­˜ç©ºé—´ï¼Œå¸¸é‡åœ¨å¸¸é‡åŒºï¼Œä¸èƒ½è¢«å¼•ç”¨ï¼›</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> &amp;ref4 = <span class="number">30</span>;<span class="comment">//åŠ ä¸Šconst åï¼Œç¼–è¯‘å™¨å°†ä»£ç è‡ªåŠ¨ä¿®æ”¹ä¸ºint temp = 30; int &amp;ref4 = temp; åªè¯»ï¼Œä¸å¯ä¿®æ”¹ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> e = <span class="number">40</span>;</span><br><span class="line"><span class="built_in">showValue</span>(e);</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‡½æ•°çš„é»˜è®¤å‚æ•°"><a href="#å‡½æ•°çš„é»˜è®¤å‚æ•°" class="headerlink" title="å‡½æ•°çš„é»˜è®¤å‚æ•°"></a>å‡½æ•°çš„é»˜è®¤å‚æ•°</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‡½æ•°é»˜è®¤å‚æ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">( <span class="type">int</span> a, <span class="type">int</span> b = <span class="number">20</span>, <span class="type">int</span> c = <span class="number">30</span>)</span><span class="comment">//bå’Œcæ˜¯é»˜è®¤å€¼ï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœæŸä¸ªä½ç½®æœ‰äº†é»˜è®¤å€¼ï¼Œé‚£ä»è¿™ä¸ªä½ç½®å¾€åéƒ½è¦æœ‰é»˜è®¤å€¼ï¼›</span></span><br><span class="line"><span class="comment">//å¦‚æœå‡½æ•°çš„å£°æ˜æœ‰äº†é»˜è®¤å‚æ•°ï¼Œé‚£å‡½æ•°çš„å®ç°å°±ä¸èƒ½å†æœ‰ï¼Œå£°æ˜å’Œå®ç°åªèƒ½æœ‰ä¸€ä¸ªæœ‰é»˜è®¤å‚æ•°ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func2</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span>)</span><span class="comment">//å ä½å‚æ•°ï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;111&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func3</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> = <span class="number">30</span>)</span><span class="comment">//å ä½å‚æ•°ä¹Ÿå¯ä»¥æœ‰é»˜è®¤å‚æ•°ï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;222&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> f = <span class="built_in">func</span>(<span class="number">10</span>);<span class="comment">//å‡½æ•°åŠ äº†é»˜è®¤å€¼åï¼Œè°ƒç”¨æ—¶å¯ä»¥çœå»å®å‚ï¼›å¦‚æœä¼ äº†å®å‚ï¼Œå°±ç”¨å®å‚ï¼›</span></span><br><span class="line">cout &lt;&lt; f &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="built_in">func2</span>(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line"><span class="built_in">func3</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‡½æ•°é‡è½½"><a href="#å‡½æ•°é‡è½½" class="headerlink" title="å‡½æ•°é‡è½½"></a>å‡½æ•°é‡è½½</h2><blockquote><p>è®©å‡½æ•°åç›¸åŒï¼Œæé«˜å¤ç”¨æ€§ã€‚<br>ğŸš€æ¡ä»¶ï¼š</p><ol><li>å¿…é¡»åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸä¸‹ï¼›</li><li>å‡½æ•°åç§°ç›¸åŒï¼›</li><li>å‡½æ•°å‚æ•°ç±»å‹ä¸åŒã€æˆ–è€…ä¸ªæ•°ä¸åŒã€æˆ–è€…é¡ºåºä¸åŒï¼ˆä½†æ˜¯è¿”å›å€¼ç±»å‹å¯ä»¥ä¸åŒï¼ï¼‰</li></ol></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;funcçš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func(int a)çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">double</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func(double a)çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func(int a, int b)çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">int</span> a, <span class="type">double</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func(int a, double b)çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">double</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func(double a, int b)çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//int func(double a, int b)//å‡½æ•°è¿”å›å€¼ä¸å¯ä½œä¸ºå‡½æ•°é‡è½½çš„æ¡ä»¶ï¼</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;func(double a, int b)çš„è°ƒç”¨&quot; &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//-------------------------------------------</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func1</span><span class="params">(<span class="type">int</span> &amp;a)</span><span class="comment">//å¼•ç”¨</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func1(int &amp;a)çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;a)</span><span class="comment">//åŠ constå¯ä»¥é‡è½½ï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func1(const int &amp;a)çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//--------------------------------------------</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func02</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func02çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func02</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b = <span class="number">10</span>)</span><span class="comment">//åŠ é»˜è®¤å‚æ•°å¯ä»¥é‡è½½ï¼Œå°½é‡é¿å…ï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;func02(a,b)çš„è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">func</span>();</span><br><span class="line"><span class="built_in">func</span>(<span class="number">3</span>);</span><br><span class="line"><span class="built_in">func</span>(<span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"><span class="built_in">func</span>(<span class="number">3.14</span>);</span><br><span class="line"><span class="built_in">func</span>(<span class="number">5</span>, <span class="number">7.8</span>);</span><br><span class="line"><span class="built_in">func</span>(<span class="number">5.6</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">func1</span>(a);<span class="comment">//å˜é‡ï¼Œè°ƒç”¨ä¸åŠ constçš„ï¼›</span></span><br><span class="line"><span class="built_in">func1</span>(<span class="number">20</span>);<span class="comment">//å¸¸é‡ï¼Œè°ƒç”¨åŠ constçš„ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//func2(20);//ä¸èƒ½åªè°ƒä¸€ä¸ªå‚æ•°ï¼Œå°½é‡é¿å…ï¼›</span></span><br><span class="line"><span class="built_in">func02</span>(<span class="number">20</span>, <span class="number">30</span>);<span class="comment">//ä¼ ä¸¤ä¸ªå€¼å¯ä»¥ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h1><h2 id="ç›¸å…³åŸºç¡€çŸ¥è¯†"><a href="#ç›¸å…³åŸºç¡€çŸ¥è¯†" class="headerlink" title="ç›¸å…³åŸºç¡€çŸ¥è¯†"></a>ç›¸å…³åŸºç¡€çŸ¥è¯†</h2><p>C++é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§ï¼š<code>å°è£…ã€ç»§æ‰¿ã€å¤šæ€</code>ã€‚</p><p>å°è£…çš„æ„ä¹‰ï¼š<br>    å°†å±æ€§å’Œè¡Œä¸ºä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œå†™åœ¨ä¸€èµ·ï¼Œè¡¨ç°ç”Ÿæ´»ä¸­çš„äº‹ç‰©ï¼›å°†å±æ€§å’Œè¡Œä¸ºåŠ ä»¥æƒé™æ§åˆ¶ï¼ˆpublic/protected/privateï¼‰ï¼›è¯­æ³•ï¼šclass ç±»å{è®¿é—®æƒé™: å±æ€§/è¡Œä¸º};</p><p>class å’Œ struct çš„åŒºåˆ«ï¼š</p><pre><code>1. é»˜è®¤çš„è®¿é—®æƒé™ä¸åŒï¼Œclass é»˜è®¤ä¸ºç§æœ‰ï¼Œstruct é»˜è®¤ä¸ºå…¬å…±ï¼›2. ç±»å¯ä»¥ç»§æ‰¿ï¼Œç»“æ„ä½“ä¸å¯ä»¥ã€‚</code></pre><p>Getter å’Œ Setter ä¸€èˆ¬æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œæƒé™ä¸º publicï¼Œé€šè¿‡è¿™ä¸ªæ–¹å¼æ¥ get/set ä¿æŠ¤æˆ–è€…ç§æœ‰å˜é‡ã€‚</p><h1 id="å¯¹è±¡ç‰¹æ€§"><a href="#å¯¹è±¡ç‰¹æ€§" class="headerlink" title="å¯¹è±¡ç‰¹æ€§"></a>å¯¹è±¡ç‰¹æ€§</h1><h2 id="æ„é€ ã€ææ„ä¸æ‹·è´å‡½æ•°"><a href="#æ„é€ ã€ææ„ä¸æ‹·è´å‡½æ•°" class="headerlink" title="æ„é€ ã€ææ„ä¸æ‹·è´å‡½æ•°"></a>æ„é€ ã€ææ„ä¸æ‹·è´å‡½æ•°</h2><p>å¯¹è±¡çš„åˆå§‹åŒ–å’Œæ¸…ç†ï¼š<br><code>æ„é€ å‡½æ•°</code>ï¼šåˆ›å»ºå¯¹è±¡æ—¶ç»™æˆå‘˜å±æ€§èµ‹å€¼ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨ï¼›<br><code>ææ„å‡½æ•°</code>ï¼šæ¸…ç†ï¼Œå¯¹è±¡é”€æ¯å‰ç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨ã€‚</p><p>æ„é€ å‡½æ•°åˆ†ç±»ï¼š<font color="#2DC26B">æœ‰å‚ã€æ— å‚</font>ï¼›<font color="#2DC26B">æ™®é€šã€æ‹·è´</font>ã€‚</p><blockquote><p>å¦‚æœç”¨æˆ·å®šä¹‰æœ‰å‚æ„é€ ï¼ŒC++ä¸å†æä¾›é»˜è®¤æ„é€ ï¼Œä½†æ˜¯ä¼šæä¾›æ‹·è´æ„é€ ï¼›<br>å¦‚æœç”¨æˆ·å®šä¹‰æ‹·è´æ„é€ ï¼ŒC++ä¸å†æä¾›é»˜è®¤æ„é€ å’Œæœ‰å‚æ„é€ ã€‚<br><code>æ‹·è´ &gt; æœ‰å‚ &gt; æ— å‚</code></p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°ï¼š</span></span><br><span class="line"><span class="comment">//1.æ²¡æœ‰è¿”å›å€¼ï¼Œä¸ç”¨å†™voidï¼›</span></span><br><span class="line"><span class="comment">//2.å‡½æ•°åä¸ç±»åç›¸åŒï¼›</span></span><br><span class="line"><span class="comment">//3.å¯ä»¥æœ‰å‚æ•°ï¼Œå¯ä»¥å‘ç”Ÿé‡è½½ï¼›</span></span><br><span class="line"><span class="comment">//4.åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œåªè°ƒç”¨ä¸€æ¬¡ï¼›</span></span><br><span class="line"><span class="built_in">Person</span>()<span class="comment">//æŒ‰å‚æ•°åˆ†ç±»ï¼Œåˆ†ä¸ºæœ‰å‚å’Œæ— å‚ï¼Œæ— å‚æ„é€ ä¹Ÿå«é»˜è®¤æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Personçš„é»˜è®¤æ„é€ å‡½æ•°è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Person</span>(<span class="type">int</span> a)<span class="comment">//æœ‰å‚æ„é€ </span></span><br><span class="line">&#123;</span><br><span class="line">age = a;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Personçš„æœ‰å‚æ„é€ å‡½æ•°è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Person</span>(<span class="type">const</span> Person &amp;p)<span class="comment">//æ‹·è´æ„é€ å‡½æ•°ï¼Œåˆ«çš„å¯¹è±¡çš„å±æ€§æ‹·è´è¿›æ¥ï¼Œä½†ä¸æ”¹å˜åŸå¯¹è±¡çš„å±æ€§ï¼›å…¶ä»–éƒ½å«æ™®é€šæ„é€ å‡½æ•°ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">age = p.age; <span class="comment">//åˆ«çš„å¯¹è±¡çš„å±æ€§æ‹·è´è¿›æ¥ï¼Œä½†ä¸æ”¹å˜åŸå¯¹è±¡çš„å±æ€§ï¼›</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Personçš„æ‹·è´æ„é€ å‡½æ•°è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ææ„å‡½æ•°ï¼š</span></span><br><span class="line"><span class="comment">//1.æ²¡æœ‰è¿”å›å€¼ï¼Œä¸ç”¨å†™voidï¼›</span></span><br><span class="line"><span class="comment">//2.å‡½æ•°åä¸ç±»åç›¸åŒï¼Œå‰é¢åŠ ~ï¼›</span></span><br><span class="line"><span class="comment">//3.å¯ä»¥æœ‰å‚æ•°ï¼Œå¯ä»¥å‘ç”Ÿé‡è½½ï¼›</span></span><br><span class="line"><span class="comment">//4.å¯¹è±¡é”€æ¯å‰ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œåªè°ƒç”¨ä¸€æ¬¡ï¼›</span></span><br><span class="line">~<span class="built_in">Person</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Personçš„ææ„å‡½æ•°è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getage</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test001</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//æ‹¬å·æ³•</span></span><br><span class="line">Person p0;<span class="comment">//é»˜è®¤æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼Œä¸è¦åŠ å°æ‹¬å·ï¼ï¼å¦åˆ™Person p0()ä¼šè¢«è®¤ä¸ºæ˜¯å‡½æ•°çš„å£°æ˜ï¼</span></span><br><span class="line"><span class="function">Person <span class="title">p1</span><span class="params">(<span class="number">10</span>)</span></span>;<span class="comment">//æœ‰å‚æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼›</span></span><br><span class="line"><span class="function">Person <span class="title">p2</span><span class="params">(p1)</span></span>;<span class="comment">//æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼›ä½¿ç”¨ä¸€ä¸ªå·²ç»åˆ›å»ºå®Œæ¯•çš„å¯¹è±¡æ¥åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼›</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p1çš„å¹´é¾„ä¸ºï¼š%d \n&quot;</span>, p1.<span class="built_in">getage</span>());</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p2çš„å¹´é¾„ä¸ºï¼š%d \n&quot;</span>, p2.<span class="built_in">getage</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¾ç¤ºæ³•</span></span><br><span class="line">Person p00;</span><br><span class="line">Person p01 = <span class="built_in">Person</span>(<span class="number">30</span>);<span class="comment">//æœ‰å‚æ„é€ ;Person(30)å«åŒ¿åå¯¹è±¡ï¼å¦‚æœæ”¾åœ¨ç­‰å·å³ä¾§ï¼Œé‚£ç­‰å·å·¦ä¾§å°±æ˜¯å…¶å¯¹è±¡åï¼›</span></span><br><span class="line"><span class="built_in">Person</span>(<span class="number">40</span>);<span class="comment">//å½“å‰è¡Œæ‰§è¡Œç»“æŸåï¼Œç³»ç»Ÿä¼šç«‹å³å›æ”¶åŒ¿åå¯¹è±¡ï¼›</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;åŒ¿åå¯¹è±¡\n&quot;</span>);</span><br><span class="line">Person p02 = <span class="built_in">Person</span>(p01);<span class="comment">//æ‹·è´æ„é€ </span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p01çš„å¹´é¾„ä¸ºï¼š%d \n&quot;</span>, p01.<span class="built_in">getage</span>());</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p02çš„å¹´é¾„ä¸ºï¼š%d \n&quot;</span>, p02.<span class="built_in">getage</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">//Person(p02);//ä¸è¦åˆ©ç”¨æ‹·è´æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–åŒ¿åå¯¹è±¡ï¼ç¼–è¯‘å™¨ä¼šè®¤ä¸ºPerson(p02) == Person p02ï¼Œå°±é‡å®šä¹‰äº†ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//éšå¼è½¬æ¢æ³•</span></span><br><span class="line">Person p3 = <span class="number">25</span>;<span class="comment">//ç›¸å½“äºPerson p3 = Person(25);æœ‰å‚æ„é€ </span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p3çš„å¹´é¾„ä¸ºï¼š%d \n&quot;</span>, p3.<span class="built_in">getage</span>());</span><br><span class="line">Person p4 = p3;<span class="comment">//æ‹·è´æ„é€ </span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p4çš„å¹´é¾„ä¸ºï¼š%d \n&quot;</span>, p4.<span class="built_in">getage</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doWork</span><span class="params">(Person p)</span><span class="comment">//å€¼ä¼ é€’çš„æ–¹å¼ç»™å‡½æ•°å‚æ•°ä¼ å€¼ï¼Œå¯ä»¥è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test002</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Person p;</span><br><span class="line"><span class="built_in">doWork</span>(p);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Person <span class="title">doWork2</span><span class="params">()</span><span class="comment">//å€¼æ–¹å¼è¿”å›å±€éƒ¨å¯¹è±¡ï¼Œå¯ä»¥è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Person p5;</span><br><span class="line"><span class="keyword">return</span> p5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test003</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Person p = <span class="built_in">doWork2</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;doWork2 \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">test001</span>();</span><br><span class="line"><span class="built_in">test002</span>();</span><br><span class="line"><span class="built_in">test003</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸš©æ·±æ‹·è´ã€æµ…æ‹·è´"><a href="#ğŸš©æ·±æ‹·è´ã€æµ…æ‹·è´" class="headerlink" title="ğŸš©æ·±æ‹·è´ã€æµ…æ‹·è´"></a>ğŸš©æ·±æ‹·è´ã€æµ…æ‹·è´</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person01</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Person01</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Person01çš„é»˜è®¤æ„é€ å‡½æ•°è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Person01</span>(<span class="type">int</span> a, <span class="type">int</span> h)</span><br><span class="line">&#123;</span><br><span class="line">m_Age = a;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Person01çš„æœ‰å‚æ„é€ å‡½æ•°è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">m_Height = <span class="keyword">new</span> <span class="built_in">int</span>(h);<span class="comment">//åˆ›å»ºåœ¨å †åŒºï¼Œè¿”å›çš„æ˜¯æŒ‡é’ˆï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªå·±åˆ›å»ºä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°æ¥è§£å†³æµ…æ‹·è´çš„é—®é¢˜ï¼Œæ·±æ‹·è´ï¼</span></span><br><span class="line"><span class="built_in">Person01</span>(<span class="type">const</span> Person01 &amp;p)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Person01çš„æ‹·è´æ„é€ å‡½æ•°è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">m_Age = p.m_Age;</span><br><span class="line"><span class="comment">//m_Height = p.m_Height;//ç¼–è¯‘å™¨é»˜è®¤æä¾›çš„ï¼Œåœ¨å †åŒºä¼šé‡å¤é‡Šæ”¾ï¼›</span></span><br><span class="line">m_Height = <span class="keyword">new</span> <span class="built_in">int</span>(*p.m_Height);<span class="comment">//æ·±æ‹·è´ï¼Œé‡æ–°å¼€è¾Ÿä¸€å—å†…å­˜ï¼Œè®©m_HeightæŒ‡å‘è¿™å—æ–°çš„å†…å­˜ï¼è¿™æ ·å°±å¯ä»¥è¿›è¡Œç¬¬äºŒæ¬¡é‡Šæ”¾ï¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">~<span class="built_in">Person01</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Person01çš„ææ„å‡½æ•°è°ƒç”¨ \n&quot;</span>);<span class="comment">//å°†å †åŒºæ•°æ®é‡Šæ”¾ï¼›</span></span><br><span class="line"><span class="keyword">if</span> (m_Height != <span class="literal">nullptr</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">delete</span> m_Height;<span class="comment">//æ‰‹åŠ¨å¼€è¾Ÿï¼Œæ‰‹åŠ¨é‡Šæ”¾å†…å­˜ï¼›</span></span><br><span class="line">m_Height = <span class="literal">nullptr</span>;<span class="comment">//é˜²æ­¢é‡æŒ‡é’ˆå‡ºç°ï¼Œå³é˜²æ­¢å·²ç»é‡Šæ”¾çš„å†…å­˜å†æ¬¡è¢«è®¿é—®ï¼Œæ»ç©ºï¼›</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getm_age</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> m_Age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> *<span class="title">getHeight</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> m_Height;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">int</span> m_Age;</span><br><span class="line"><span class="type">int</span> *m_Height;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test02_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Person01 <span class="title">P1</span><span class="params">(<span class="number">18</span>, <span class="number">175</span>)</span></span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;P1çš„å¹´é¾„æ˜¯: %d, èº«é«˜æ˜¯: %d \n&quot;</span>, P1.<span class="built_in">getm_age</span>(), *P1.<span class="built_in">getHeight</span>());</span><br><span class="line"></span><br><span class="line"><span class="function">Person01 <span class="title">P2</span><span class="params">(P1)</span></span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;P2çš„å¹´é¾„æ˜¯: %d, èº«é«˜æ˜¯: %d \n&quot;</span>, P2.<span class="built_in">getm_age</span>(), *P2.<span class="built_in">getHeight</span>());</span><br><span class="line"><span class="comment">//å¦‚æœç”¨ç¼–è¯‘å™¨è‡ªå·±æä¾›çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œä¼šåšæµ…æ‹·è´æ“ä½œï¼</span></span><br><span class="line"><span class="comment">//æµ…æ‹·è´çš„é—®é¢˜ï¼šå †åŒºçš„å†…å­˜é‡å¤é‡Šæ”¾ï¼ç¬¬äºŒæ¬¡é‡Šæ”¾æ˜¯éæ³•æ“ä½œï¼è¦ç”¨æ·±æ‹·è´æ¥è§£å†³ï¼</span></span><br><span class="line"><span class="comment">//å¦‚æœæœ‰åœ¨å †åŒºå¼€è¾Ÿçš„å±æ€§ï¼Œä¸€å®šè¦è‡ªå·±æä¾›æ‹·è´æ„é€ å‡½æ•°ï¼ç”¨æ·±æ‹·è´æ¥é˜²æ­¢æµ…æ‹·è´çš„é—®é¢˜ï¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">test02_01</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆå§‹åŒ–åˆ—è¡¨"><a href="#åˆå§‹åŒ–åˆ—è¡¨" class="headerlink" title="åˆå§‹åŒ–åˆ—è¡¨"></a>åˆå§‹åŒ–åˆ—è¡¨</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person02</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//Person02(int a, int b, int c)//æœ‰å‚æ„é€ </span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//m_A = a;</span></span><br><span class="line"><span class="comment">//m_B = b;</span></span><br><span class="line"><span class="comment">//m_C = c;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Person02() :m_A(10), m_B(20), m_C(30)//åˆå§‹åŒ–åˆ—è¡¨</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Person02</span>(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c) :<span class="built_in">m_A</span>(a), <span class="built_in">m_B</span>(b), <span class="built_in">m_C</span>(c)<span class="comment">//åˆå§‹åŒ–åˆ—è¡¨ å¯ä¼ ä¸åŒå€¼ï¼›æ³¨æ„å†’å·ä½ç½®ï¼</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> m_A;</span><br><span class="line"><span class="type">int</span> m_B;</span><br><span class="line"><span class="type">int</span> m_C;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ğŸš€æ³¨æ„ï¼š</p><ol><li><strong>å®šä¹‰é¡ºåº</strong>ï¼šæˆå‘˜å˜é‡çš„åˆå§‹åŒ–é¡ºåºéµå¾ªå®ƒä»¬åœ¨<font color="#2DC26B">ç±»å£°æ˜ä¸­çš„é¡ºåº</font>ï¼Œè€Œä¸æ˜¯åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„é¡ºåºã€‚</li><li><strong>å¿…è¦æƒ…å†µ</strong>ï¼šå¦‚æœæˆå‘˜å˜é‡æ˜¯<font color="#2DC26B">å¸¸é‡ const</font>æˆ–è€…<font color="#2DC26B">æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°çš„ç±»ç±»å‹</font>ï¼Œåˆ™å¿…é¡»ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨è¿›è¡Œåˆå§‹åŒ–ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šåˆå§‹åŒ–åˆ—è¡¨å¯ä»¥<font color="#2DC26B">æé«˜æ•ˆç‡</font>ï¼Œå› ä¸ºå®ƒ<font color="#2DC26B">é¿å…äº†æ„é€ å‡½æ•°ä½“ä¸­çš„èµ‹å€¼æ“ä½œ</font>ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†ä¸éœ€è¦æˆ–ä¸èƒ½é€šè¿‡é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºçš„å¤æ‚å¯¹è±¡æ—¶ã€‚</li><li><strong>æ‰§è¡Œé¡ºåº</strong>ï¼š<font color="#2DC26B">åŸºç±»</font>çš„æ„é€ å‡½æ•°æŒ‰ç…§å®ƒä»¬åœ¨ç±»ç»§æ‰¿åˆ—è¡¨ä¸­å£°æ˜çš„é¡ºåºä¾æ¬¡è°ƒç”¨ <code>-&gt;</code><font color="#2DC26B">æˆå‘˜å¯¹è±¡</font>çš„æ„é€ å‡½æ•°æŒ‰ç…§å®ƒä»¬åœ¨ç±»ä½“ä¸­å£°æ˜çš„é¡ºåºè°ƒç”¨ <code>-&gt;</code> æ‰§è¡Œæ„é€ å‡½æ•°ä½“å†…çš„ä»£ç ã€‚</li><li><strong>ä½¿ç”¨æ¡ä»¶</strong>ï¼šä»…<font color="#2DC26B">æ„é€ å‡½æ•°</font>å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ã€‚</li></ol><p>ç°åœ¨å…·ä½“è§£é‡Šæ³¨æ„ç‚¹ã€‚<br>ç¬¬ 2 ç‚¹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BaseClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">BaseClass</span>() : <span class="built_in">m_Value</span>(<span class="number">0</span>) &#123;&#125;  <span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">BaseClass</span>(<span class="type">int</span> value) : <span class="built_in">m_Value</span>(value) &#123;&#125;  <span class="comment">// æœ‰å‚æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="type">int</span> m_Value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> baseValue, <span class="type">int</span> constVal)</span><br><span class="line">        : <span class="built_in">m_BaseMember</span>(baseValue),  <span class="comment">// åˆå§‹åŒ–BaseClassç±»å‹æˆå‘˜å˜é‡</span></span><br><span class="line">          <span class="built_in">m_ConstMember</span>(constVal)   <span class="comment">// åˆå§‹åŒ–const intç±»å‹æˆå‘˜å˜é‡</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Base member initialized with: &quot;</span> &lt;&lt; m_BaseMember.m_Value &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Const member initialized with: &quot;</span> &lt;&lt; m_ConstMember &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    BaseClass m_BaseMember;  <span class="comment">// ç±»ç±»å‹æˆå‘˜å˜é‡</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m_ConstMember;  <span class="comment">// constç±»å‹æˆå‘˜å˜é‡</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">obj</span><span class="params">(<span class="number">10</span>, <span class="number">20</span>)</span></span>;  <span class="comment">// åˆ›å»ºMyClasså¯¹è±¡ï¼Œæµ‹è¯•åˆå§‹åŒ–åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ 4 ç‚¹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// åŸºç±»æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">Base</span>() &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Base class constructor&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Member</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æˆå‘˜ç±»æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">Member</span>() &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Member object constructor&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span> : <span class="keyword">public</span> Base &#123;</span><br><span class="line">    <span class="comment">// æˆå‘˜å˜é‡åˆå§‹åŒ–ä½¿ç”¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</span></span><br><span class="line">    Member obj; </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ´¾ç”Ÿç±»æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">Derived</span>() : <span class="built_in">obj</span>() &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Derived class constructor body&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Derived d; <span class="comment">// è¿™å°†è§¦å‘Derivedç±»çš„æ„é€ è¿‡ç¨‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„é¡ºåºï¼šçˆ¶ç±»-&gt;æˆå‘˜ç±»-&gt;è‡ªèº«æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">//Base class constructor</span></span><br><span class="line"><span class="comment">//Member object constructor</span></span><br><span class="line"><span class="comment">//Derived class constructor body</span></span><br></pre></td></tr></table></figure><h2 id="ğŸš©ç±»å¯¹è±¡ä½œä¸ºæˆå‘˜"><a href="#ğŸš©ç±»å¯¹è±¡ä½œä¸ºæˆå‘˜" class="headerlink" title="ğŸš©ç±»å¯¹è±¡ä½œä¸ºæˆå‘˜"></a>ğŸš©ç±»å¯¹è±¡ä½œä¸ºæˆå‘˜</h2><p>æ„é€ å‡½æ•°é¡ºåºï¼š<code>çˆ¶ç±»-&gt;æˆå‘˜ç±»-&gt;è‡ªèº«æ„é€ å‡½æ•°</code><br>ææ„å‡½æ•°é¡ºåºï¼šåä¹‹ã€‚åè¿›å…ˆå‡ºï¼Œææ„å‡½æ•°é‡Šæ”¾çš„é¡ºåºå’Œæ„é€ å‡½æ•°ç›¸åã€‚</p><p>ä»£ç è¯¦è§â€œåˆå§‹åŒ–åˆ—è¡¨â€”æ³¨æ„â€”ç¬¬ 4 ç‚¹â€ã€‚</p><h2 id="é™æ€æˆå‘˜"><a href="#é™æ€æˆå‘˜" class="headerlink" title="é™æ€æˆå‘˜"></a>é™æ€æˆå‘˜</h2><p>é™æ€æˆå‘˜ï¼šå°±æ˜¯åœ¨æˆå‘˜å˜é‡æˆ–æˆå‘˜å‡½æ•°å‰é¢åŠ ä¸Š static</p><p>é™æ€æˆå‘˜å˜é‡ï¼š</p><ol><li>æ‰€æœ‰å¯¹è±¡<font color="#2DC26B">å…±äº«</font>åŒä¸€ä»½æ•°æ®ï¼Œä¸å•ç‹¬å±äºæŸä¸ªå¯¹è±¡ï¼ˆä½†è¿™ä¸æ„å‘³ç€éƒ½æ˜¯ public æˆ–è€…è¯´åˆå§‹åŒ–çš„æ—¶å€™ä¸éœ€è¦åŠ ä¸Šä½œç”¨åŸŸï¼‰</li><li>åœ¨<font color="#2DC26B">ç¼–è¯‘é˜¶æ®µ</font>åˆ†é…å†…å­˜ï¼ˆå…¨å±€åŒºï¼‰</li><li><font color="#2DC26B">ç±»å†…å£°æ˜ï¼Œç±»å¤–åˆå§‹åŒ–</font></li><li>å¦‚æœé™æ€æˆå‘˜å˜é‡æ˜¯ <code>const</code> æ•´æ•°ç±»å‹æˆ– <code>const</code> æšä¸¾ç±»å‹ï¼Œå¯ä»¥åœ¨ç±»å†…éƒ¨ç›´æ¥å®šä¹‰å¹¶åˆå§‹åŒ–</li></ol><p>é™æ€æˆå‘˜å‡½æ•°ï¼š</p><ol><li>æ‰€æœ‰å¯¹è±¡å…±äº«åŒä¸€ä¸ªå‡½æ•°</li><li>é™æ€æˆå‘˜å‡½æ•°<font color="#2DC26B">åªèƒ½è®¿é—®é™æ€æˆå‘˜å˜é‡</font></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person04</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> m_A;<span class="comment">//é™æ€æˆå‘˜å˜é‡ï¼Œç±»å†…å£°æ˜</span></span><br><span class="line"><span class="type">int</span> m_C;<span class="comment">//éé™æ€æˆå‘˜å˜é‡ï¼Œä¸å¯è¢«static void funcè°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">func</span><span class="params">()</span><span class="comment">//é™æ€æˆå‘˜å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">m_A = <span class="number">400</span>;<span class="comment">//å¯è°ƒç”¨é™æ€æˆå‘˜å˜é‡</span></span><br><span class="line"><span class="comment">//m_C = 200;//éé™æ€æˆå‘˜å˜é‡ï¼Œä¸å¯è¢«funcè°ƒç”¨ï¼Œå› ä¸ºè¿™ä¸ªæ•°æ®æ˜¯å±äºæŸä¸ªå…·ä½“å¯¹è±¡çš„</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;static void funcçš„è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> m_B;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">func1</span><span class="params">()</span><span class="comment">//é™æ€æˆå‘˜å‡½æ•°æœ‰è®¿é—®æƒé™</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;static void func1çš„è°ƒç”¨ \n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> Person04::m_A = <span class="number">100</span>;<span class="comment">//ç±»å¤–åˆå§‹åŒ–ï¼Œä¸€å®šè¦æœ‰</span></span><br><span class="line"><span class="type">int</span> Person04::m_B = <span class="number">300</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_12_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Person04 p1;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p1A= %d \n&quot;</span>, p1.m_A);</span><br><span class="line"></span><br><span class="line">Person04 p2;</span><br><span class="line">p2.m_A = <span class="number">200</span>;<span class="comment">//ç”¨p2æŠŠm_Açš„å€¼ä¿®æ”¹</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p2A= %d \n&quot;</span>, p1.m_A);<span class="comment">//ä½†æ˜¯è¿˜æ˜¯ç”¨p1å»è®¿é—®m_Aï¼Œç»“æœä¸º200ï¼Œå…±äº«åŒä¸€ä»½æ•°æ®</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_12_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//é™æ€æˆå‘˜å˜é‡ä¸å±äºæŸä¸ªå¯¹è±¡ä¸Šï¼Œå…±äº«åŒä¸€ä¸ªå‡½æ•°ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½å…±äº«ä¸€ä»½æ•°æ®</span></span><br><span class="line"><span class="comment">//æ‰€ä»¥æœ‰ä¸¤ç§è®¿é—®æ–¹å¼ï¼š</span></span><br><span class="line">Person04 p;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;pA= %d \n&quot;</span>, p.m_A);<span class="comment">//1ï¼Œé€šè¿‡å¯¹è±¡è¿›è¡Œè®¿é—®ï¼›</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;pA= %d \n&quot;</span>, Person04::m_A);<span class="comment">//2ï¼Œé€šè¿‡ç±»åè¿›è¡Œè®¿é—®ï¼Œä¸éœ€è¦åˆ›å»ºå¯¹è±¡ï¼›</span></span><br><span class="line"><span class="comment">//printf(&quot;pB= %d \n&quot;, Person04::m_B);//é™æ€æˆå‘˜å˜é‡ä¹Ÿæ˜¯æœ‰è®¿é—®æƒé™çš„ï¼Œprivateåœ¨ç±»å¤–ä¸å¯è®¿é—®ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_12_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//é™æ€æˆå‘˜å‡½æ•°ä¸å±äºæŸä¸ªå¯¹è±¡ä¸Šï¼Œæœ‰ä¸¤ç§è®¿é—®æ–¹å¼ï¼š</span></span><br><span class="line">Person04 p;</span><br><span class="line">p.<span class="built_in">func</span>();<span class="comment">//1ï¼Œé€šè¿‡å¯¹è±¡è¿›è¡Œè®¿é—®ï¼›</span></span><br><span class="line">Person04::<span class="built_in">func</span>();<span class="comment">//2ï¼Œé€šè¿‡ç±»åè¿›è¡Œè®¿é—®ï¼Œä¸éœ€è¦åˆ›å»ºå¯¹è±¡ï¼›</span></span><br><span class="line"><span class="comment">//Person04::func1();//é™æ€æˆå‘˜å‡½æ•°æœ‰è®¿é—®æƒé™ï¼Œprivateåœ¨ç±»å¤–ä¸å¯è®¿é—®ï¼›</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸš€æ³¨æ„ï¼š</p><ul><li>å¯ä»¥åœ¨ç±»å†…éƒ¨ä»¥ <code>static const int var = 10;</code> è¿™æ ·çš„ä»£ç ç›´æ¥åˆå§‹åŒ–å¸¸é‡é™æ€æˆå‘˜å˜é‡ã€‚</li><li>å¯¹äºå…¶ä»–ç±»å‹çš„é™æ€æˆå‘˜ï¼ˆä¾‹å¦‚ <code>double</code> æˆ–å…¶ä»–ç±»ç±»å‹ï¼‰ï¼Œå¿…é¡»åœ¨ç±»å¤–å¦‚ <code>double MyClass::staticVar = 10;</code> è¿›è¡Œå®šä¹‰å’Œåˆå§‹åŒ–ï¼Œä¸èƒ½å†™ä½œ <code>double staticVar = 10;</code>ã€‚</li><li>C++11 å¼€å§‹ï¼Œå…è®¸<strong>å†…è”åˆå§‹åŒ–</strong>é™æ€æˆå‘˜å˜é‡ã€‚<code>inline</code> å…³é”®å­—å…è®¸é™æ€æˆå‘˜å˜é‡çš„å®šä¹‰åœ¨ä¸€ä¸ª <code>.h</code> æ–‡ä»¶ä¸­ï¼ˆæˆ–ä»»ä½•åŒ…å«å®ƒçš„ç¿»è¯‘å•å…ƒï¼‰è¿›è¡Œï¼Œç¼–è¯‘å™¨ä¼šåœ¨éœ€è¦æ—¶å°†å…¶å¤åˆ¶åˆ°å¤šä¸ªç¿»è¯‘å•å…ƒä¸­ã€‚è¿™æ ·å¯ä»¥é¿å…å¤šä¸ªç¿»è¯‘å•å…ƒä¸­å®šä¹‰ç›¸åŒçš„é™æ€æˆå‘˜å˜é‡ï¼Œä»è€Œè§£å†³äº†å¤šé‡å®šä¹‰çš„é—®é¢˜ã€‚ä»£ç å¦‚ä¸‹ï¼š</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//.hæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> staticVar; <span class="comment">// å£°æ˜å¹¶å†…è”åˆå§‹åŒ–</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// C++11çš„ç¼–è¯‘å™¨ç‰¹æ€§ä½¿å¾—è¿™æ ·å°±å¯ä»¥åœ¨ä½¿ç”¨é™æ€æˆå‘˜çš„ä»»ä½•ç¿»è¯‘å•å…ƒä¸­ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨å®šä¹‰å®ƒ</span></span><br><span class="line"><span class="keyword">inline</span> <span class="type">int</span> MyClass::staticVar = <span class="number">10</span>; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//.cppæ–‡ä»¶(éå¿…è¦ï¼Œåªéœ€è¦å®šä¹‰ä¸€æ¬¡)</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨å…³é”®å­—inlineå¯ä»¥åœ¨ç±»çš„å£°æ˜ä¸­ç›´æ¥åˆå§‹åŒ–é™æ€æˆå‘˜ï¼Œæ— éœ€åœ¨.cppæ–‡ä»¶ä¸­å…·ä½“å®šä¹‰</span></span><br><span class="line"><span class="keyword">inline</span> <span class="type">int</span> MyClass::staticVar = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><h2 id="æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°åˆ†å¼€å‚¨å­˜"><a href="#æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°åˆ†å¼€å‚¨å­˜" class="headerlink" title="æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°åˆ†å¼€å‚¨å­˜"></a>æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°åˆ†å¼€å‚¨å­˜</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">test</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person05</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> m_A = <span class="number">1</span>;<span class="comment">//éé™æ€æˆå‘˜å˜é‡ï¼Œå±äºç±»çš„å¯¹è±¡ä¸Šï¼›</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> m_B;<span class="comment">//é™æ€æˆå‘˜å˜é‡ï¼Œä¸å±äºç±»çš„å¯¹è±¡ä¸Šï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;&#125;;<span class="comment">//éé™æ€æˆå‘˜å‡½æ•°ï¼Œå’Œå˜é‡åˆ†å¼€å­˜å‚¨çš„ï¼Œä¸å±äºç±»çš„å¯¹è±¡ä¸Šï¼</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">func1</span><span class="params">()</span> </span>&#123;&#125;;<span class="comment">//é™æ€æˆå‘˜å‡½æ•°ï¼Œä¸å±äºç±»çš„å¯¹è±¡ä¸Šï¼›</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> Person05::m_B = <span class="number">0</span>;<span class="comment">//ç±»å¤–åˆå§‹åŒ–ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_13_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">test p;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;sizeof p=&quot;</span>&lt;&lt;<span class="built_in">sizeof</span>(p)&lt;&lt;endl;</span><br><span class="line"><span class="comment">//ç©ºå¯¹è±¡å ç”¨å­—èŠ‚ä¸º1ï¼ŒC++ç¼–è¯‘å™¨ä¼šç»™ç©ºå¯¹è±¡åˆ†é…1ä¸ªå­—èŠ‚ç©ºé—´ï¼Œæ˜¯ä¸ºäº†åŒºåˆ†ç©ºå¯¹è±¡å å†…å­˜çš„ä½ç½®ï¼›</span></span><br><span class="line"><span class="comment">//æ¯ä¸ªç©ºå¯¹è±¡ä¹Ÿåº”è¯¥æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å†…å­˜åœ°å€ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_13_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Person05 p;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;sizeof p=&quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(p) &lt;&lt; endl;<span class="comment">//4ä¸ªå­—èŠ‚ï¼Œå› ä¸ºæ˜¯éé™æ€æˆå‘˜å˜é‡ï¼Œå±äºpçš„å±æ€§ï¼Œintç±»å‹ï¼›</span></span><br><span class="line"><span class="comment">//ä»…m_Aæ˜¯pçš„å±æ€§</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="this-æŒ‡é’ˆ"><a href="#this-æŒ‡é’ˆ" class="headerlink" title="this æŒ‡é’ˆ"></a>this æŒ‡é’ˆ</h2><p>ç‰¹ç‚¹ï¼š</p><ul><li>å½“å½¢å‚å’Œæˆå‘˜å˜é‡åŒåæ—¶ï¼Œè§£å†³åç§°å†²çªï¼›</li><li>this æŒ‡é’ˆæŒ‡å‘çš„æ˜¯è¢«è°ƒç”¨çš„æˆå‘˜å‡½æ•°æ‰€å±çš„å¯¹è±¡ï¼Œè°è°ƒç”¨å°±æŒ‡å‘è°ï¼›</li><li>åœ¨ç±»çš„éé™æ€æˆå‘˜å‡½æ•°ä¸­ï¼Œè¿”å›å¯¹è±¡æœ¬èº«ç”¨ <code>*this</code>ï¼›</li><li>ä¸éœ€è¦å®šä¹‰ï¼Œç›´æ¥ä½¿ç”¨ï¼›</li></ul><h2 id="ç©ºæŒ‡é’ˆè®¿é—®æˆå‘˜å‡½æ•°"><a href="#ç©ºæŒ‡é’ˆè®¿é—®æˆå‘˜å‡½æ•°" class="headerlink" title="ç©ºæŒ‡é’ˆè®¿é—®æˆå‘˜å‡½æ•°"></a>ç©ºæŒ‡é’ˆè®¿é—®æˆå‘˜å‡½æ•°</h2><p>ç©ºæŒ‡é’ˆå¯ä»¥è®¿é—®æˆå‘˜å‡½æ•°ï¼Œä½†æ˜¯å¦‚æœç”¨åˆ° this æŒ‡é’ˆï¼Œéœ€è¦åŠ ä»¥åˆ¤æ–­ä¿è¯ä»£ç å¥å£®æ€§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person07</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">showClassName</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;this is person class&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">showPersonAge</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span> == <span class="literal">nullptr</span>)<span class="comment">//å¦‚æœæ˜¯ç©ºæŒ‡é’ˆå°±returnï¼Œé¿å…æŠ¥é”™ï¼Œæé«˜å¥å£®æ€§ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;age=&quot;</span> &lt;&lt; <span class="keyword">this</span>-&gt;m_Age &lt;&lt; endl;<span class="comment">//m_Ageå’Œthis-&gt;m_Ageåœ¨è¿™é‡Œæ˜¯ç­‰æ•ˆçš„ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> m_Age;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_15_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Person07 *p = <span class="literal">nullptr</span>;</span><br><span class="line">p-&gt;<span class="built_in">showClassName</span>();</span><br><span class="line">p-&gt;<span class="built_in">showPersonAge</span>();<span class="comment">//ç©ºæŒ‡é’ˆæ²¡æœ‰å¯¹è±¡ï¼Œè®¿é—®é‡Œé¢çš„å±æ€§ä¼šæŠ¥é”™ï¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="const-ä¿®é¥°æˆå‘˜å‡½æ•°"><a href="#const-ä¿®é¥°æˆå‘˜å‡½æ•°" class="headerlink" title="const ä¿®é¥°æˆå‘˜å‡½æ•°"></a>const ä¿®é¥°æˆå‘˜å‡½æ•°</h2><blockquote><p>å¸¸å¯¹è±¡ (const object) æ— æ³•ç›´æ¥ä¿®æ”¹å±æ€§ï¼Œé™¤éä½¿ç”¨è¿™å‡ ä¸ªæ–¹å¼ï¼š</p><ol><li>å°†ç±»æˆå‘˜å˜é‡å£°æ˜ä¸º <code>mutable/static</code>, åˆ™å¯¹åº”å˜é‡å¯ä»¥ä¿®æ”¹ï¼›</li><li>ä½¿ç”¨ <code>const_cast</code> ç§»é™¤ const é™å®šç¬¦ã€‚<br>æ³¨æ„ï¼Œ<font color="#2DC26B">æ— æ³•ä¿®æ”¹</font>æŒ‡å‘å¸¸å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚</li></ol></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¸¸å‡½æ•°//å¸¸å¯¹è±¡</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person08</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//thisæŒ‡é’ˆæœ¬è´¨æ˜¯æŒ‡é’ˆå¸¸é‡ï¼ŒæŒ‡é’ˆçš„æŒ‡å‘æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼›</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">showPerson</span><span class="params">()</span> <span class="type">const</span><span class="comment">//å¸¸å‡½æ•°ï¼Œç›¸å½“äºconst Person08 *const thisï¼Œä¿®é¥°çš„æ˜¯thisçš„æŒ‡å‘ï¼Œè®©æŒ‡å‘çš„å€¼ä¹Ÿä¸å¯ä¿®æ”¹</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//m_A = 100;//ç­‰æ•ˆäºthis-&gt;m_A = 100;</span></span><br><span class="line">m_B = <span class="number">200</span>; <span class="comment">//m_Bå¯ä¿®æ”¹ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> m_A;</span><br><span class="line"><span class="keyword">mutable</span> <span class="type">int</span> m_B;<span class="comment">//å³ä½¿åœ¨å¸¸å‡½æ•°ä¸­ä¹Ÿå¯ä»¥ä¿®æ”¹ï¼›</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_16_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Person08 p;</span><br><span class="line">p.<span class="built_in">showPerson</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_16_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">const</span> Person08 p;<span class="comment">//å¸¸å¯¹è±¡</span></span><br><span class="line"><span class="comment">//p.m_A = 300;//ä¸å¯ä¿®æ”¹</span></span><br><span class="line">p.m_B = <span class="number">400</span>;<span class="comment">//m_Bå¯ä¿®æ”¹ï¼›</span></span><br><span class="line">p.<span class="built_in">showPerson</span>();<span class="comment">//å¸¸å¯¹è±¡åªèƒ½è°ƒç”¨å¸¸å‡½æ•°ï¼</span></span><br><span class="line"><span class="comment">//p.func();//å¸¸å¯¹è±¡åªèƒ½è°ƒç”¨å¸¸å‡½æ•°ï¼å› ä¸ºå¸¸å‡½æ•°å¯ä»¥ä¿®æ”¹å±æ€§ï¼Œä½†æ˜¯å¸¸å¯¹è±¡ä¸èƒ½ä¿®æ”¹ï¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº†è§£ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setValue</span><span class="params">(<span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        value = v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡å‘å¸¸å¯¹è±¡çš„æŒ‡é’ˆï¼ˆconst MyClass* const pï¼‰éƒ½ä¸å…è®¸é€šè¿‡æŒ‡é’ˆä¿®æ”¹å¯¹è±¡çš„å†…å®¹</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modifyValue</span><span class="params">(MyClass* <span class="type">const</span> cptr)</span> </span>&#123;</span><br><span class="line">    cptr-&gt;<span class="built_in">setValue</span>(<span class="number">10</span>); <span class="comment">// æ­£ç¡®ï¼šå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å»é—´æ¥æ”¹å˜æˆå‘˜å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> MyClass obj;</span><br><span class="line">    <span class="built_in">modifyValue</span>(<span class="built_in">const_cast</span>&lt;MyClass*&gt;(&amp;obj)); <span class="comment">// ä½¿ç”¨const_castç§»é™¤consté™å®šç¬¦</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="ğŸš©å‹å…ƒ"><a href="#ğŸš©å‹å…ƒ" class="headerlink" title="ğŸš©å‹å…ƒ"></a>ğŸš©å‹å…ƒ</h2><p>å®šä¹‰ï¼šè®©ä¸€ä¸ªå‡½æ•°æˆ–è€…ç±»ï¼Œè®¿é—®å¦ä¸€ä¸ªç±»ä¸­çš„<strong>æ‰€æœ‰æˆå‘˜</strong>ã€‚</p><p>ğŸš€æ³¨æ„ï¼š</p><ol><li>å‹å…ƒå‡½æ•°ä¸€å®šè¦<font color="#2DC26B">åœ¨ç±»å¤–å®ç°</font>ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼</li><li>éœ€è¦å…ˆå¯¹å‹å…ƒç±»è¿›è¡Œ<font color="#2DC26B">å‰å‘å£°æ˜</font> (forward declareï¼Œå¯åœ¨ç±»å†…ç±»å¤–), ç„¶åå†å£°æ˜å‹å…ƒå‡½æ•°ã€‚</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Building</span>;<span class="comment">//å‰å‘å£°æ˜ï¼Œå…ˆè®©ç¼–è¯‘å™¨çŸ¥é“æœ‰ä¸ªBuildingç±»ï¼Œå…ˆåœ¨å‰é¢å£°æ˜ï¼Œä¸ç„¶åé¢æˆå‘˜å‡½æ•°ä½œå‹å…ƒä¼šæŠ¥é”™ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Goodguy</span><span class="comment">//åˆ›å»ºä¸€ä¸ªå¥½å‹ç±»ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Goodguy</span>();<span class="comment">//æ„é€ å‡½æ•°å£°æ˜ï¼Œèµ‹åˆå€¼ï¼›ç±»å¤–å†™æˆå‘˜å‡½æ•°ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">visit</span><span class="params">()</span></span>;<span class="comment">//å‚è§‚å‡½æ•°å£°æ˜ï¼Œè®¿é—®å¯¹è±¡buildingä¸­çš„å±æ€§ï¼›ç±»å¤–å†™æˆå‘˜å‡½æ•°ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sleep</span><span class="params">()</span></span>;<span class="comment">//ç¡è§‰å‡½æ•°å£°æ˜ï¼Œè®¿é—®å¯¹è±¡buildingä¸­çš„å±æ€§ï¼›ç±»å¤–å†™æˆå‘˜å‡½æ•°ï¼›æˆå‘˜å‡½æ•°ä½œå‹å…ƒï¼›</span></span><br><span class="line"><span class="comment">//å¦‚æœæƒ³è®©sleepè®¿é—®ç§æœ‰æˆå‘˜è€Œä¸è®©visitè®¿é—®ï¼Œå°±éœ€è¦ç”¨åˆ°æˆå‘˜å‡½æ•°ä½œå‹å…ƒï¼</span></span><br><span class="line"><span class="comment">//å¦‚æœç±»ä½œå‹å…ƒæ˜¯æ‰€æœ‰æˆå‘˜å‡½æ•°éƒ½èƒ½è®¿é—®ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Building *building;<span class="comment">//æŒ‡é’ˆä½œæˆå‘˜ï¼›</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Building</span><span class="comment">//åˆ›å»ºä¸€ä¸ªå»ºç­‘ç‰©ç±»</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="keyword">friend</span> <span class="type">void</span> <span class="title">goodguy</span><span class="params">(Building &amp;building)</span></span>;<span class="comment">//å…¨å±€å‡½æ•°ä½œå‹å…ƒï¼Œå…¨å±€å‡½æ•°çš„å£°æ˜ï¼Œå‰é¢åŠ friendæ„æ€å°±æ˜¯è¿™ä¸ªå‡½æ•°å¯ä»¥è®¿é—®Buildingçš„ç§æœ‰æˆå‘˜ï¼›</span></span><br><span class="line"><span class="comment">//friend class Goodguy;//ç±»ä½œå‹å…ƒï¼Œç±»çš„å£°æ˜ï¼›</span></span><br><span class="line"><span class="function"><span class="keyword">friend</span> <span class="type">void</span> <span class="title">Goodguy::sleep</span><span class="params">()</span></span>;<span class="comment">//æˆå‘˜å‡½æ•°ä½œå‹å…ƒï¼Œæˆå‘˜å‡½æ•°çš„å£°æ˜ï¼›æˆå‘˜å‡½æ•°è¦åŠ ä½œç”¨åŸŸï¼Œå…¨å±€å‡½æ•°ä¸åŠ ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//Building()//æ„é€ å‡½æ•°ï¼Œèµ‹åˆå€¼ï¼›ç±»å†…å®ç°ï¼›</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//m_SittingRoom = &quot;å®¢å…&quot;;</span></span><br><span class="line"><span class="comment">//m_BedRoom = &quot;å§å®¤&quot;;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="built_in">Building</span>();<span class="comment">//æ„é€ å‡½æ•°ï¼Œèµ‹åˆå€¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">string m_SittingRoom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">string m_BedRoom;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Building::<span class="built_in">Building</span>()<span class="comment">//ç±»å¤–å®ç°æ„é€ å‡½æ•°ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">m_SittingRoom = <span class="string">&quot;å®¢å…&quot;</span>;</span><br><span class="line">m_BedRoom = <span class="string">&quot;å§å®¤&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1ï¼Œå…¨å±€å‡½æ•°ä½œå‹å…ƒ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">goodguy</span><span class="params">(Building &amp;building)</span><span class="comment">//å…¨å±€å‡½æ•°ï¼Œå¼•ç”¨ä¼ é€’</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;01å¥½å‹æ­£åœ¨è®¿é—®ï¼š&quot;</span> &lt;&lt; building.m_SittingRoom &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;01å¥½å‹æ­£åœ¨è®¿é—®ï¼š&quot;</span> &lt;&lt; building.m_BedRoom &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_01_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Building b;<span class="comment">//åˆ›å»ºBuildingçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™å°±ä¼šè°ƒç”¨Buildingæ„é€ å‡½æ•°ï¼Œæ¥èµ‹åˆå€¼</span></span><br><span class="line"><span class="built_in">goodguy</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2ï¼Œç±»ä½œå‹å…ƒ  //3ï¼Œæˆå‘˜å‡½æ•°ä½œå‹å…ƒ</span></span><br><span class="line">Goodguy::<span class="built_in">Goodguy</span>()<span class="comment">//æ„é€ å‡½æ•°å®šä¹‰ï¼Œèµ‹åˆå€¼ï¼›ç±»å¤–å†™æˆå‘˜å‡½æ•°ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line">building = <span class="keyword">new</span> <span class="built_in">Building</span>();<span class="comment">//åœ¨å †åŒºåˆ›å»ºä¸€ä¸ªBuildingçš„å¯¹è±¡ï¼Œç”¨buildingå»æ¥æ”¶ï¼šnew Buildingçš„æ—¶å€™ä¼šè°ƒç”¨Buildingæ„é€ å‡½æ•°ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Goodguy::visit</span><span class="params">()</span><span class="comment">//visitå‡½æ•°å®šä¹‰ï¼Œç±»å¤–å†™æˆå‘˜å‡½æ•°ï¼›ä¸ç”¨ä¼ å€¼ï¼Œå› ä¸ºåŒå±ä¸€ä¸ªç±»çš„æˆå‘˜é‡Œæœ‰å¯¹åº”å˜é‡ï¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;02å¥½å‹æ­£åœ¨è®¿é—®ï¼š&quot;</span> &lt;&lt; building-&gt;m_SittingRoom &lt;&lt; endl;<span class="comment">//å®é™…ä¸Šè¿˜æ˜¯å‡½æ•°è®¿é—®æˆå‘˜ï¼Œåªä¸è¿‡è¿™ä¸ªå‡½æ•°æ˜¯ä½œä¸ºç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼›</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;02å¥½å‹æ­£åœ¨è®¿é—®ï¼š&quot; &lt;&lt; building-&gt;m_BedRoom &lt;&lt; endl;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Goodguy::sleep</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;03å¥½å‹æ­£åœ¨ï¼š&quot;</span> &lt;&lt; building-&gt;m_SittingRoom &lt;&lt; <span class="string">&quot;é‡Œç¡è§‰&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;03å¥½å‹æ­£åœ¨ï¼š&quot;</span> &lt;&lt; building-&gt;m_BedRoom &lt;&lt; <span class="string">&quot;é‡Œç¡è§‰&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_01_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Goodguy g;<span class="comment">//åˆ›å»ºGoodguyçš„å¯¹è±¡ï¼Œè¿™æ—¶å€™å°±ä¼šè°ƒç”¨Goodguyæ„é€ å‡½æ•°ï¼Œæ¥èµ‹åˆå€¼ï¼›</span></span><br><span class="line">g.<span class="built_in">visit</span>();<span class="comment">//è°ƒç”¨visitå‡½æ•°ï¼Œæ¥è®¿é—®Buildingçš„æˆå‘˜ï¼›</span></span><br><span class="line">g.<span class="built_in">sleep</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸš©è¿ç®—ç¬¦é‡è½½"><a href="#ğŸš©è¿ç®—ç¬¦é‡è½½" class="headerlink" title="ğŸš©è¿ç®—ç¬¦é‡è½½"></a>ğŸš©è¿ç®—ç¬¦é‡è½½</h2><h3 id="æˆå‘˜å‡½æ•°é‡è½½-å·"><a href="#æˆå‘˜å‡½æ•°é‡è½½-å·" class="headerlink" title="æˆå‘˜å‡½æ•°é‡è½½+å·"></a>æˆå‘˜å‡½æ•°é‡è½½+å·</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person01</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Person01 <span class="keyword">operator</span>+(Person01 &amp;p)</span><br><span class="line">&#123;</span><br><span class="line">Person01 temp;</span><br><span class="line">temp.m_A = <span class="keyword">this</span>-&gt;m_A + p.m_A;</span><br><span class="line">temp.m_B = <span class="keyword">this</span>-&gt;m_B + p.m_B;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">int</span> m_A;</span><br><span class="line"><span class="type">int</span> m_B;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å…¨å±€å‡½æ•°é‡è½½-å·"><a href="#å…¨å±€å‡½æ•°é‡è½½-å·" class="headerlink" title="å…¨å±€å‡½æ•°é‡è½½+å·"></a>å…¨å±€å‡½æ•°é‡è½½+å·</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Person01 <span class="keyword">operator</span>+(Person01 &amp;p1, Person01 &amp;p2)</span><br><span class="line">&#123;</span><br><span class="line">Person01 temp;</span><br><span class="line">temp.m_A = p1.m_A + p2.m_A;</span><br><span class="line">temp.m_B = p1.m_B + p2.m_B;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿ç®—ç¬¦é‡è½½ä¹Ÿå¯ä»¥å‘ç”Ÿå‡½æ•°é‡è½½ï¼›</span></span><br><span class="line">Person01 <span class="keyword">operator</span>+(Person01 &amp;p1, <span class="type">int</span> num)</span><br><span class="line">&#123;</span><br><span class="line">Person01 temp;</span><br><span class="line">temp.m_A = p1.m_A + num;</span><br><span class="line">temp.m_B = p1.m_B + num;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¨å±€å‡½æ•°é‡è½½å·¦ç§»è¿ç®—ç¬¦-lt-lt"><a href="#å…¨å±€å‡½æ•°é‡è½½å·¦ç§»è¿ç®—ç¬¦-lt-lt" class="headerlink" title="å…¨å±€å‡½æ•°é‡è½½å·¦ç§»è¿ç®—ç¬¦&lt;&lt;"></a>å…¨å±€å‡½æ•°é‡è½½å·¦ç§»è¿ç®—ç¬¦&lt;&lt;</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å·¦ç§»è¿ç®—ç¬¦é…åˆå‹å…ƒå¯ä»¥å®ç°è¾“å‡ºè‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼</span></span><br><span class="line">ostream &amp;<span class="keyword">operator</span>&lt;&lt;(ostream &amp;out, Person01 &amp;p)<span class="comment">//å› ä¸ºcout&lt;&lt;pæœ¬è´¨æ˜¯operator&lt;&lt;(cout, p),ç®€åŒ–ç‰ˆæœ¬æ˜¯cout&lt;&lt;p; coutæ˜¯è¾“å‡ºæµå¯¹è±¡ï¼</span></span><br><span class="line">&#123;</span><br><span class="line">out &lt;&lt; <span class="string">&quot;m_A=&quot;</span> &lt;&lt; p.m_A &lt;&lt; endl;</span><br><span class="line">out &lt;&lt; <span class="string">&quot;m_B=&quot;</span> &lt;&lt; p.m_B &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Person01 p1;</span><br><span class="line">p1.m_A = <span class="number">10</span>;</span><br><span class="line">p1.m_B = <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; p1 &lt;&lt; <span class="string">&quot;hello world&quot;</span> &lt;&lt; endl;<span class="comment">//å·¦ç§»è¿ç®—ç¬¦é‡è½½ï¼›</span></span><br><span class="line"></span><br><span class="line">Person01 p2;</span><br><span class="line">p2.m_A = <span class="number">20</span>;</span><br><span class="line">p2.m_B = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">Person01 p3 = p1 + p2;<span class="comment">//ç›´æ¥å†™+å·ï¼Œç¼–è¯‘å™¨ä¸è®¤è¯†ï¼Œè¦ç”¨é‡è½½ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p3.m_A = &quot;</span> &lt;&lt; p3.m_A &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p3.m_B = &quot;</span> &lt;&lt; p3.m_B &lt;&lt; endl;</span><br><span class="line"><span class="comment">//æˆå‘˜å‡½æ•°é‡è½½æœ¬è´¨æ˜¯Person01 p3 = p1.operator+(p2);</span></span><br><span class="line"><span class="comment">//å…¨å±€å‡½æ•°é‡è½½æœ¬è´¨æ˜¯Person01 p3 = operator+(p1, p2);</span></span><br><span class="line"></span><br><span class="line">Person01 p4 = p1 + <span class="number">100</span>;<span class="comment">//å‡½æ•°é‡è½½</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p4.m_A = &quot;</span> &lt;&lt; p4.m_A &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p4.m_B = &quot;</span> &lt;&lt; p4.m_B &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‹å…ƒå‡½æ•°é‡è½½å³ç§»è¿ç®—ç¬¦-gt-gt"><a href="#å‹å…ƒå‡½æ•°é‡è½½å³ç§»è¿ç®—ç¬¦-gt-gt" class="headerlink" title="å‹å…ƒå‡½æ•°é‡è½½å³ç§»è¿ç®—ç¬¦&gt;&gt;"></a>å‹å…ƒå‡½æ•°é‡è½½å³ç§»è¿ç®—ç¬¦&gt;&gt;</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="comment">// å£°æ˜å‹å…ƒå‡½æ•°</span></span><br><span class="line">    <span class="keyword">friend</span> istream&amp; <span class="keyword">operator</span>&gt;&gt; (istream&amp; is, MyClass&amp; obj);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‹å…ƒå‡½æ•°å®šä¹‰</span></span><br><span class="line">istream&amp; <span class="keyword">operator</span>&gt;&gt; (istream&amp; is, MyClass&amp; obj) &#123;</span><br><span class="line">    is &gt;&gt; obj.value; <span class="comment">// ä»è¾“å…¥æµè¯»å–æ•°æ®åˆ°objçš„æˆå‘˜å˜é‡</span></span><br><span class="line">    <span class="keyword">return</span> is;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é‡è½½é€’å¢è¿ç®—ç¬¦"><a href="#é‡è½½é€’å¢è¿ç®—ç¬¦" class="headerlink" title="é‡è½½é€’å¢è¿ç®—ç¬¦++"></a>é‡è½½é€’å¢è¿ç®—ç¬¦++</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">myint</span><span class="comment">//è‡ªå®šä¹‰æ•´å‹</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">friend</span> ostream &amp;<span class="keyword">operator</span>&lt;&lt;(ostream &amp;cout, myint m);<span class="comment">//ç”¨å‹å…ƒè®¿é—®privateæˆå‘˜ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">myint</span>()</span><br><span class="line">&#123;</span><br><span class="line">m_Num = <span class="number">0</span>;<span class="comment">//ç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–æ•°æ®ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myint &amp;<span class="keyword">operator</span>++()<span class="comment">//é‡è½½å‰ç½®++è¿ç®—ç¬¦ï¼Œç”¨æˆå‘˜å‡½æ•°ï¼›è¦è¿”å›å¼•ç”¨ï¼ä¸ç„¶ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°å¤åˆ¶ä¸€ä»½æ–°çš„å¯¹è±¡ï¼</span></span><br><span class="line">&#123;</span><br><span class="line">m_Num++;<span class="comment">//å…ˆè¿›è¡Œ++è¿ç®—ï¼›</span></span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;<span class="comment">//å†è¿”å›è‡ªèº«ï¼›thisæŒ‡é’ˆçš„ç”¨æ³•ä¹‹ä¸€ï¼Œéé™æ€æˆå‘˜å‡½æ•°è¿”å›å¯¹è±¡æœ¬èº«ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myint <span class="keyword">operator</span>++(<span class="type">int</span>)<span class="comment">//é‡è½½åç½®++è¿ç®—ç¬¦ï¼Œç”¨æˆå‘˜å‡½æ•°ï¼›intä¸ºå ä½å‚æ•°ï¼å¯ç”¨äºåŒºåˆ†å‰ç½®å’Œåç½®é€’å¢ï¼åç½®è¦è¿”å›å€¼ï¼Œä¸èƒ½è¿”å›å¼•ç”¨ï¼</span></span><br><span class="line">&#123;</span><br><span class="line">myint temp = *<span class="keyword">this</span>;<span class="comment">//å…ˆè®°å½•å½“æ—¶çš„ç»“æœï¼›</span></span><br><span class="line">m_Num++;<span class="comment">//å†é€’å¢ï¼›</span></span><br><span class="line"><span class="keyword">return</span> temp;<span class="comment">//å†å°†è®°å½•çš„ç»“æœè¿”å›ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myint &amp;<span class="keyword">operator</span>--()<span class="comment">//é‡è½½å‰ç½®--è¿ç®—ç¬¦</span></span><br><span class="line">&#123;</span><br><span class="line">m_Num--;</span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myint <span class="keyword">operator</span>--(<span class="type">int</span>)<span class="comment">//é‡è½½åç½®--è¿ç®—ç¬¦</span></span><br><span class="line">&#123;</span><br><span class="line">myint temp = *<span class="keyword">this</span>;</span><br><span class="line">m_Num--;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">int</span> m_Num;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ostream &amp;<span class="keyword">operator</span>&lt;&lt;(ostream &amp;cout, myint m)<span class="comment">//å…¨å±€å‡½æ•°é‡è½½å·¦ç§»è¿ç®—ç¬¦</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;æ•°æ®çš„å€¼æ˜¯ï¼š&quot;</span> &lt;&lt; m.m_Num;</span><br><span class="line"><span class="keyword">return</span> cout;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">myint newint;</span><br><span class="line">cout &lt;&lt; newint &lt;&lt; endl;<span class="comment">//å› ä¸ºæ˜¯æ‰“å°è‡ªå®šä¹‰çš„æ•´å‹ï¼Œæ‰€ä»¥è¦é‡è½½&lt;&lt;ï¼›</span></span><br><span class="line">cout &lt;&lt; ++newint &lt;&lt; endl;<span class="comment">//éœ€è¦é‡è½½å‰ç½®++ï¼›</span></span><br><span class="line">cout &lt;&lt; ++(++newint) &lt;&lt; endl;<span class="comment">//ç”¨å¼•ç”¨è¿”å›ï¼Œå°±èƒ½å¯¹ä¸€ä¸ªå¯¹è±¡ä¸€ç›´++ï¼›</span></span><br><span class="line">cout &lt;&lt; newint &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">myint newint;</span><br><span class="line">cout &lt;&lt; newint &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; newint++ &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; newint &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_04</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">myint newint;</span><br><span class="line">cout &lt;&lt; newint &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; --newint &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; --(--newint) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; newint &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_05</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">myint newint;</span><br><span class="line">cout &lt;&lt; newint &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; newint-- &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; newint &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é‡è½½èµ‹å€¼è¿ç®—ç¬¦"><a href="#é‡è½½èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="é‡è½½èµ‹å€¼è¿ç®—ç¬¦="></a>é‡è½½èµ‹å€¼è¿ç®—ç¬¦=</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//C++ç¼–è¯‘å™¨è‡³å°‘ç»™ä¸€ä¸ªç±»æ·»åŠ 4ä¸ªå‡½æ•°ï¼Œ</span></span><br><span class="line"><span class="comment">//é»˜è®¤æ„é€ å‡½æ•°ï¼Œæ— å‚ï¼Œå‡½æ•°ä½“ä¸ºç©ºï¼›</span></span><br><span class="line"><span class="comment">//é»˜è®¤ææ„å‡½æ•°ï¼Œæ— å‚ï¼Œå‡½æ•°ä½“ä¸ºç©ºï¼›</span></span><br><span class="line"><span class="comment">//é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ï¼Œå¯¹å±æ€§è¿›è¡Œå€¼æ‹·è´ï¼›</span></span><br><span class="line"><span class="comment">//èµ‹å€¼è¿ç®—ç¬¦operator=ï¼Œå¯¹å±æ€§è¿›è¡Œå€¼æ‹·è´ï¼›</span></span><br><span class="line"><span class="comment">//å¦‚æœç±»ä¸­æœ‰å±æ€§æŒ‡å‘å †åŒºï¼Œèµ‹å€¼æ“ä½œä¹Ÿä¼šå‡ºç°æ·±æµ…æ‹·è´çš„é—®é¢˜ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person02</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Person02</span>(<span class="type">int</span> age)</span><br><span class="line">&#123;</span><br><span class="line">m_Age = <span class="keyword">new</span> <span class="built_in">int</span>(age);<span class="comment">//åœ¨å †åŒºï¼Œè¦ç¨‹åºå‘˜æ‰‹åŠ¨å¼€è¾Ÿå’Œé‡Šæ”¾ï¼Œé‡Šæ”¾çš„æ—¶æœºæ˜¯åœ¨ææ„å‡½æ•°ä¸­ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">~<span class="built_in">Person02</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (m_Age != <span class="literal">nullptr</span>)<span class="comment">//é‡Šæ”¾å †åŒºçš„æ•°æ®ï¼›å¦‚æœç”¨é»˜è®¤çš„èµ‹å€¼è¿ç®—ä¼šé€ æˆæµ…æ‹·è´ï¼Œæ‰€ä»¥è¦é‡è½½=ï¼Œç”¨æ·±æ‹·è´ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">delete</span> m_Age;</span><br><span class="line">m_Age = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person02 &amp;<span class="keyword">operator</span>=(Person02 &amp;p)<span class="comment">//é‡è½½=è¿ç®—ç¬¦ï¼›è¿”å›å¼•ç”¨ï¼Œå¯è¿”å›è‡ªèº«ï¼Œå¯å®ç°é“¾å¼ç¼–ç¨‹ï¼›</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//ç¼–è¯‘å™¨é»˜è®¤ï¼šm_Age = p.m_Age;è¿™æ ·æ˜¯æµ…æ‹·è´ï¼›</span></span><br><span class="line"><span class="comment">//åº”è¯¥å…ˆåˆ¤æ–­æ˜¯å¦æœ‰å±æ€§åœ¨å †åŒºï¼Œå¦‚æœæœ‰ï¼Œåº”è¯¥é‡Šæ”¾å¹²å‡€ï¼ç„¶åå†æ·±æ‹·è´ï¼</span></span><br><span class="line"><span class="keyword">if</span> (m_Age != <span class="literal">nullptr</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">delete</span> m_Age;</span><br><span class="line">m_Age = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">m_Age = <span class="keyword">new</span> <span class="built_in">int</span>(*p.m_Age);<span class="comment">//æ·±æ‹·è´ï¼é‡æ–°å¼€è¾Ÿä¸€å—å †åŒºç©ºé—´ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> *<span class="keyword">this</span>;<span class="comment">//è¿”å›è‡ªèº«ï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> *m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_06</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Person02 <span class="title">P1</span><span class="params">(<span class="number">18</span>)</span></span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;P1å¹´é¾„æ˜¯ï¼š&quot;</span> &lt;&lt; *P1.m_Age &lt;&lt; endl;</span><br><span class="line"><span class="function">Person02 <span class="title">P2</span><span class="params">(<span class="number">20</span>)</span></span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;P2å¹´é¾„æ˜¯ï¼š&quot;</span> &lt;&lt; *P2.m_Age &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">P2 = P1;<span class="comment">//å°†P1çš„æ‰€æœ‰æ•°æ®èµ‹å€¼ç»™P2ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;P1å¹´é¾„æ˜¯ï¼š&quot;</span> &lt;&lt; *P1.m_Age &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;P2å¹´é¾„æ˜¯ï¼š&quot;</span> &lt;&lt; *P2.m_Age &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="function">Person02 <span class="title">P3</span><span class="params">(<span class="number">30</span>)</span></span>;</span><br><span class="line">P3 = P2 = P1;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;P3å¹´é¾„æ˜¯ï¼š&quot;</span> &lt;&lt; *P3.m_Age &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é‡è½½å…³ç³»è¿ç®—ç¬¦"><a href="#é‡è½½å…³ç³»è¿ç®—ç¬¦" class="headerlink" title="é‡è½½å…³ç³»è¿ç®—ç¬¦"></a>é‡è½½å…³ç³»è¿ç®—ç¬¦</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®©ä¸¤ä¸ªè‡ªå®šä¹‰ç±»å‹å¯¹è±¡è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person03</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Person03</span>(string name, <span class="type">int</span> age)</span><br><span class="line">&#123;</span><br><span class="line">m_Name = name;</span><br><span class="line">m_Age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>==(Person03 &amp;p)<span class="comment">//é‡è½½==</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>-&gt;m_Name == p.m_Name &amp;&amp; <span class="keyword">this</span>-&gt;m_Age == p.m_Age)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>!=(Person03 &amp;p)<span class="comment">//é‡è½½!=</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>-&gt;m_Name == p.m_Name &amp;&amp; <span class="keyword">this</span>-&gt;m_Age == p.m_Age)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>&lt;(Person03 &amp;p)<span class="comment">//é‡è½½&lt;</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>-&gt;m_Age &lt; p.m_Age)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>&gt;(Person03 &amp;p)<span class="comment">//é‡è½½&gt;</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>-&gt;m_Age &gt; p.m_Age)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">string m_Name;</span><br><span class="line"><span class="type">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_07</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Person03 <span class="title">p1</span><span class="params">(<span class="string">&quot;Tom&quot;</span>, <span class="number">18</span>)</span></span>;</span><br><span class="line"><span class="function">Person03 <span class="title">p2</span><span class="params">(<span class="string">&quot;Jerry&quot;</span>, <span class="number">18</span>)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (p1 == p2)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p1å’Œp2ç›¸ç­‰&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(p1 != p2)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p1å’Œp2ä¸ç­‰&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_08</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">Person03 <span class="title">p3</span><span class="params">(<span class="string">&quot;Vettel&quot;</span>, <span class="number">35</span>)</span></span>;</span><br><span class="line"><span class="function">Person03 <span class="title">p4</span><span class="params">(<span class="string">&quot;Kimi&quot;</span>, <span class="number">40</span>)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (p3 &lt; p4)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p3æ¯”p4å°&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (p3 &gt; p4)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p3æ¯”p4å¤§&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é‡è½½å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦"><a href="#é‡è½½å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦" class="headerlink" title="é‡è½½å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦ ()"></a>é‡è½½å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦ ()</h3><p>ä¹Ÿå«åšä»¿å‡½æ•°ã€‚<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//éå¸¸çµæ´»ï¼Œæ²¡æœ‰å›ºå®šå†™æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyPrint</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(string test)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; test &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_09</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">MyPrint print;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello world&quot;</span>);<span class="comment">//éå¸¸ç±»ä¼¼å‡½æ•°è°ƒç”¨ï¼Œä¹Ÿå«ä»¿å‡½æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyAdd</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> num1, <span class="type">int</span> num2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_02_10</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">MyAdd add;</span><br><span class="line"><span class="type">int</span> ret = <span class="built_in">add</span>(<span class="number">100</span>, <span class="number">200</span>);<span class="comment">//ä»¿å‡½æ•°</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ret=&quot;</span> &lt;&lt; ret &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; <span class="built_in">MyAdd</span>()(<span class="number">200</span>, <span class="number">300</span>) &lt;&lt; endl;<span class="comment">//åŒ¿åå‡½æ•°å¯¹è±¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ğŸ¤”æ€»ç»“"><a href="#ğŸ¤”æ€»ç»“" class="headerlink" title="ğŸ¤”æ€»ç»“"></a>ğŸ¤”æ€»ç»“</h3><div class="table-container"><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th><th>å‹å…ƒå‡½æ•°é‡è½½</th><th>å…¨å±€å‡½æ•°é‡è½½</th><th>æˆå‘˜å‡½æ•°é‡è½½</th></tr></thead><tbody><tr><td>+</td><td>ä¸€å…ƒåŠ </td><td>å¦</td><td>âœ…</td><td>å¦</td></tr><tr><td>-</td><td>ä¸€å…ƒå‡</td><td>å¦</td><td>âœ…</td><td>å¦</td></tr><tr><td>!</td><td>é€»è¾‘é</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>+ +</td><td>è‡ªå¢</td><td>å¦</td><td>âœ…</td><td>âœ…</td></tr><tr><td>- -</td><td>è‡ªå‡</td><td>å¦</td><td>âœ…</td><td>âœ…</td></tr><tr><td>=</td><td>èµ‹å€¼</td><td>âœ…</td><td>å¦</td><td>âœ…</td></tr><tr><td>*</td><td>è§£å¼•ç”¨</td><td>å¦</td><td>å¦</td><td>âœ…</td></tr><tr><td>&amp;</td><td>å–åœ°å€</td><td>å¦</td><td>å¦</td><td>âœ…</td></tr><tr><td>[ ]</td><td>ç´¢å¼•/ä¸‹æ ‡</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>-&gt;</td><td>ç®­å¤´</td><td>å¦</td><td>å¦</td><td>âœ…</td></tr><tr><td>( )</td><td>ç±»å‹è½¬æ¢</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>&lt;&lt;</td><td>å·¦ç§»</td><td>âœ…</td><td>âœ…</td><td>å¦</td></tr><tr><td>&gt;&gt;</td><td>å³ç§»</td><td>âœ…</td><td>âœ…</td><td>å¦</td></tr><tr><td>+, -, *, /</td><td>äºŒå…ƒåŠ ã€å‡ã€ä¹˜ã€é™¤ç­‰</td><td>âœ…</td><td>âœ…</td><td>å¦ï¼ˆæ„é€ å‡½æ•°å¯ä»¥éƒ¨åˆ†å®ç°è¿™äº›ï¼‰</td></tr><tr><td>==, !=</td><td>æ¯”è¾ƒ</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>&lt;, &gt;, &lt;=, &gt;=</td><td>æ¯”è¾ƒ</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>++(ä½œä¸ºåç¼€)</td><td>è‡ªå¢åç¼€</td><td>å¦</td><td>âœ…</td><td>âœ…</td></tr><tr><td>â€”(ä½œä¸ºåç¼€)</td><td>è‡ªå‡åç¼€</td><td>å¦</td><td>âœ…</td><td>âœ…</td></tr></tbody></table></div><p>ğŸš€æ³¨æ„ï¼š</p><ul><li>ä¸€å…ƒè¿ç®—ç¬¦ï¼ˆå¦‚ <code>+</code>, <code>-</code>, <code>!</code>, <code>++</code>, <code>--</code>ï¼‰<font color="#2DC26B">ä¸é€šè¿‡æˆå‘˜å‡½æ•°</font>é‡è½½ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰è¶³å¤Ÿçš„å‚æ•°æ¥ä½¿å¾—å®ƒä»¬æˆä¸ºæˆå‘˜å‡½æ•°ã€‚(+a)</li><li>äºŒå…ƒè¿ç®—ç¬¦å¯ä»¥ä½¿ç”¨<font color="#2DC26B">ä»»æ„ç±»å‹</font>çš„ç»„åˆè¿›è¡Œé‡è½½ï¼Œåªéœ€è¦ç¬¦åˆè¿ç®—çš„é€»è¾‘ï¼Œå¹¶ä¸”å¯ä»¥ä½œä¸ºå‹å…ƒå‡½æ•°æˆ–å…¨å±€å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæˆå‘˜å‡½æ•°ã€‚(a+b)</li><li>ä¸‰ä½è¿ç®—ç¬¦å’Œä¸€äº›ç‰¹å®šæƒ…æ€§éœ€è¦ç‰¹æ®Šæ³¨æ„ï¼Œæ¯”å¦‚èµ‹å€¼è¿ç®—ç¬¦ <code>=</code> å’Œä¸‹æ ‡è¿ç®—ç¬¦ <code>[ ]</code> é€šå¸¸é€šè¿‡<font color="#2DC26B">æˆå‘˜å‡½æ•°</font>é‡è½½ã€‚</li><li>æ„é€ å‡½æ•°ç”¨åšç±»å‹è½¬æ¢ï¼Œå®ƒå®é™…ä¸Šé‡è½½äº†è½¬æ¢è¿ç®—ç¬¦ <code>()</code>ã€‚</li><li>å¯¹äºæŸäº›ç‰¹æ®Šçš„è¿ç®—ç¬¦ï¼Œå¦‚èµ‹å€¼è¿ç®—ç¬¦å’Œä¸‹æ ‡è¿ç®—ç¬¦ï¼Œå¸¸å¸¸ä¼šé€šè¿‡<font color="#2DC26B">æˆå‘˜å‡½æ•°</font>çš„æ–¹å¼æ¥é‡è½½ã€‚</li></ul><hr><h1 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h1><p>ç±»ä¸ç±»ä¸Šä¸‹çº§ä¹‹é—´æœ‰å…±æ€§å’Œç‰¹æ€§ï¼Œä½¿ç”¨ç»§æ‰¿å¯ä»¥å‡å°‘å¾ˆå¤šé‡å¤ä»£ç ã€‚</p><h2 id="ç»§æ‰¿ä¸­çš„æ„é€ å’Œææ„é¡ºåºï¼ŒåŒåæˆå‘˜å±æ€§ã€åŒåé™æ€æˆå‘˜çš„å¤„ç†"><a href="#ç»§æ‰¿ä¸­çš„æ„é€ å’Œææ„é¡ºåºï¼ŒåŒåæˆå‘˜å±æ€§ã€åŒåé™æ€æˆå‘˜çš„å¤„ç†" class="headerlink" title="ç»§æ‰¿ä¸­çš„æ„é€ å’Œææ„é¡ºåºï¼ŒåŒåæˆå‘˜å±æ€§ã€åŒåé™æ€æˆå‘˜çš„å¤„ç†"></a>ç»§æ‰¿ä¸­çš„æ„é€ å’Œææ„é¡ºåºï¼ŒåŒåæˆå‘˜å±æ€§ã€åŒåé™æ€æˆå‘˜çš„å¤„ç†</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Base1</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Base1çš„æ„é€ å‡½æ•°&quot;</span> &lt;&lt; endl;</span><br><span class="line">m_F = <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">~<span class="built_in">Base1</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Base1çš„ææ„å‡½æ•°&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Base1ä¸‹æˆå‘˜å‡½æ•°func()è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Base1ä¸‹æˆå‘˜å‡½æ•°func(int a)è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">func1</span><span class="params">()</span><span class="comment">//é™æ€æˆå‘˜å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Base1ä¸‹é™æ€æˆå‘˜å‡½æ•°func1()è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> m_F;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> m_G;<span class="comment">//é™æ€æˆå‘˜å˜é‡ï¼Œç¼–è¯‘é˜¶æ®µåˆ†é…å†…å­˜ï¼Œæ‰€æœ‰å¯¹è±¡å…±äº«åŒä¸€ä»½æ•°æ®ï¼Œç±»å†…å£°æ˜ç±»å¤–åˆå§‹åŒ–</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> Base1::m_G = <span class="number">50</span>;<span class="comment">//ç±»å¤–åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son4</span> : <span class="keyword">public</span> Base1</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Son4</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Son4çš„æ„é€ å‡½æ•°&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">~<span class="built_in">Son4</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Son4çš„ææ„å‡½æ•°&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_03_07</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//Base1 b;</span></span><br><span class="line">Son4 s;<span class="comment">//å…ˆæ„é€ çˆ¶ç±»ï¼Œå†æ„é€ å­ç±»ï¼Œææ„ä¸æ„é€ ç›¸åï¼å…ˆè¿›åå‡ºï¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son5</span> :<span class="keyword">public</span> Base1</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Son5</span>()</span><br><span class="line">&#123;</span><br><span class="line">m_F = <span class="number">200</span>; <span class="comment">//å’Œçˆ¶ç±»æˆå‘˜å˜é‡åŒåï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Son5ä¸‹æˆå‘˜å‡½æ•°func()è°ƒç”¨&quot;</span> &lt;&lt; endl;<span class="comment">//å’Œçˆ¶ç±»æˆå‘˜å‡½æ•°åŒåï¼›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">func1</span><span class="params">()</span><span class="comment">//é™æ€æˆå‘˜å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Son5ä¸‹é™æ€æˆå‘˜å‡½æ•°func1()è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> m_F;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> m_G;<span class="comment">//å’Œçˆ¶ç±»é™æ€æˆå‘˜å˜é‡åŒåï¼›</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> Son5::m_G = <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_03_08</span><span class="params">()</span><span class="comment">//åŒåæˆå‘˜å˜é‡è®¿é—®æ–¹å¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Son5 s;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å­ç±» Son5ä¸‹ m_F=&quot;</span> &lt;&lt; s.m_F &lt;&lt; endl;<span class="comment">//ç›´æ¥è®¿é—®æ˜¯è®¿é—®å­ç±»çš„æˆå‘˜</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;çˆ¶ç±» Base1ä¸‹ m_F=&quot;</span> &lt;&lt; s.Base1::m_F &lt;&lt; endl;<span class="comment">//åœ¨s.åé¢åŠ ä¸ŠBase1ä½œç”¨åŸŸï¼Œå°±è®¿é—®çˆ¶ç±»ä¸­çš„åŒåæˆå‘˜</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_03_09</span><span class="params">()</span><span class="comment">//åŒåæˆå‘˜å‡½æ•°è°ƒç”¨æ–¹å¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Son5 s;</span><br><span class="line">s.<span class="built_in">func</span>();<span class="comment">//ç›´æ¥è°ƒç”¨æ˜¯è°ƒç”¨å­ç±»çš„æˆå‘˜å‡½æ•°</span></span><br><span class="line">s.Base1::<span class="built_in">func</span>();<span class="comment">//åœ¨s.åé¢åŠ ä¸ŠBase1ä½œç”¨åŸŸï¼Œå°±è°ƒç”¨çˆ¶ç±»ä¸­çš„åŒåå‡½æ•°</span></span><br><span class="line">s.Base1::<span class="built_in">func</span>(<span class="number">20</span>);<span class="comment">//è°ƒç”¨çˆ¶ç±»ä¸­é‡è½½çš„åŒåå‡½æ•°</span></span><br><span class="line"><span class="comment">//å¦‚æœå­ç±»ä¸­å‡ºç°çˆ¶ç±»åŒåçš„æˆå‘˜å‡½æ•°ï¼Œä¼šéšè—æ‰çˆ¶ç±»ä¸­æ‰€æœ‰çš„åŒåæˆå‘˜å‡½æ•°ï¼ŒåŒ…æ‹¬æ‰€æœ‰é‡è½½çš„ï¼›å¯¹é™æ€æˆå‘˜å‡½æ•°ä¹Ÿé€‚ç”¨ï¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_03_10</span><span class="params">()</span><span class="comment">//åŒåé™æ€æˆå‘˜å˜é‡è®¿é—®æ–¹å¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//é€šè¿‡åˆ›å»ºå¯¹è±¡æ¥è®¿é—®é™æ€å˜é‡ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;é€šè¿‡åˆ›å»ºå¯¹è±¡æ¥è®¿é—®é™æ€å˜é‡&quot;</span> &lt;&lt; endl;</span><br><span class="line">Son5 s;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å­ç±» Son5ä¸‹ m_G=&quot;</span> &lt;&lt; s.m_G &lt;&lt; endl;<span class="comment">//ç›´æ¥è®¿é—®å°±æ˜¯è®¿é—®å­ç±»çš„æˆå‘˜ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;çˆ¶ç±» Base1ä¸‹ m_G=&quot;</span> &lt;&lt; s.Base1::m_G &lt;&lt; endl;<span class="comment">//åœ¨s.åé¢åŠ ä¸ŠBase1ä½œç”¨åŸŸï¼Œå°±è®¿é—®çˆ¶ç±»ä¸­çš„åŒåæˆå‘˜ï¼›</span></span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸åˆ›å»ºå¯¹è±¡ï¼Œé€šè¿‡ç±»åæ¥è®¿é—®é™æ€å˜é‡ï¼Œå› ä¸ºæ˜¯å…±äº«çš„ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;é€šè¿‡ç±»åæ¥è®¿é—®é™æ€å˜é‡&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å­ç±» Son5ä¸‹ m_G=&quot;</span> &lt;&lt; Son5::m_G &lt;&lt; endl;<span class="comment">//è¿™é‡Œ::æ˜¯é€šè¿‡ç±»åè®¿é—®ï¼Œä¸æ˜¯ä½œç”¨åŸŸ</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;çˆ¶ç±» Base1ä¸‹ m_G=&quot;</span> &lt;&lt; Son5::Base1::m_G &lt;&lt; endl;<span class="comment">//ç›¸å½“äºSon5::(Base1::m_G)ï¼Œç¬¬ä¸€ä¸ª::æ˜¯é€šè¿‡ç±»åè®¿é—®ï¼Œç¬¬äºŒä¸ª::æ˜¯çˆ¶ç±»ä½œç”¨åŸŸ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_03_11</span><span class="params">()</span><span class="comment">//åŒåé™æ€æˆå‘˜å‡½æ•°è°ƒç”¨æ–¹å¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//é€šè¿‡åˆ›å»ºå¯¹è±¡æ¥è®¿é—®é™æ€æˆå‘˜å‡½æ•°ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;é€šè¿‡åˆ›å»ºå¯¹è±¡æ¥è®¿é—®é™æ€æˆå‘˜å‡½æ•°&quot;</span> &lt;&lt; endl;</span><br><span class="line">Son5 s;</span><br><span class="line">s.<span class="built_in">func1</span>();<span class="comment">//ç›´æ¥è°ƒç”¨æ˜¯è°ƒç”¨å­ç±»çš„æˆå‘˜å‡½æ•°</span></span><br><span class="line">s.Base1::<span class="built_in">func1</span>();<span class="comment">//çˆ¶ç±»é™æ€æˆå‘˜å‡½æ•°è°ƒç”¨</span></span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸åˆ›å»ºå¯¹è±¡ï¼Œé€šè¿‡ç±»åæ¥è®¿é—®é™æ€æˆå‘˜å‡½æ•°ï¼Œå› ä¸ºæ˜¯å…±äº«çš„ï¼›</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;é€šè¿‡ç±»åæ¥è®¿é—®é™æ€æˆå‘˜å‡½æ•°&quot;</span> &lt;&lt; endl;</span><br><span class="line">Son5::<span class="built_in">func1</span>();</span><br><span class="line">Son5::Base1::<span class="built_in">func1</span>(); <span class="comment">//ç›¸å½“äºSon5::(Base1::func1());</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//C++å…è®¸ä¸€ä¸ªç±»ç»§æ‰¿å¤šä¸ªçˆ¶ç±»ï¼Œä½†å¯èƒ½ä¼šå¼•å‘çˆ¶ç±»ä¸­æœ‰åŒåæˆå‘˜çš„é—®é¢˜ï¼Œå› æ­¤å®é™…å¼€å‘ä¸­ä¸å»ºè®®ç”¨ï¼›</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base01</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Base01</span>()</span><br><span class="line">&#123;</span><br><span class="line">m_A1 = <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> m_A1;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base02</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Base02</span>()</span><br><span class="line">&#123;</span><br><span class="line">m_B1 = <span class="number">100</span>;</span><br><span class="line">m_A1 = <span class="number">700</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> m_B1;</span><br><span class="line"><span class="type">int</span> m_A1;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son06</span> : <span class="keyword">public</span> Base01, <span class="keyword">public</span> Base02<span class="comment">//åŒæ—¶ç»§æ‰¿Base01å’ŒBase02ï¼Œä¸­é—´ç”¨é€—å·éš”å¼€</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Son06</span>()</span><br><span class="line">&#123;</span><br><span class="line">m_C1 = <span class="number">300</span>;</span><br><span class="line">m_D1 = <span class="number">400</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> m_C1;</span><br><span class="line"><span class="type">int</span> m_D1;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_03_12</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Son06 s;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;sizeof Son06 =&quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(s) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Base01 m_A1=&quot;</span> &lt;&lt; s.Base01::m_A1 &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Base02 m_A1=&quot;</span> &lt;&lt; s.Base02::m_A1 &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è±å½¢ç»§æ‰¿"><a href="#è±å½¢ç»§æ‰¿" class="headerlink" title="è±å½¢ç»§æ‰¿"></a>è±å½¢ç»§æ‰¿</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¹Ÿå«é’»çŸ³ç»§æ‰¿ï¼Œä¸€ä¸ªçˆ¶ç±»æœ‰ä¸¤ä¸ªå­ç±»ï¼Œç„¶åå†æœ‰ä¸€ä¸ªå­ç±»ç»§æ‰¿äº†è¿™ä¸¤ä¸ªå­ç±»ï¼›</span></span><br><span class="line"><span class="comment">//ä»¥ä¸‹ä»£ç ä½¿ç”¨è™šç»§æ‰¿è§£å†³è±å½¢ç»§æ‰¿ä¸­çš„å¤šé‡æ•°æ®æˆå‘˜é—®é¢˜</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span><span class="comment">//åŠ¨ç‰©</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sheep</span> : <span class="keyword">virtual</span> <span class="keyword">public</span> Animal<span class="comment">//ç¾Šï¼ŒåŠ ä¸Švirtualï¼Œè™šç»§æ‰¿ï¼Animalç§°ä¸ºè™šå…¶ç±»</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Camel</span> : <span class="keyword">virtual</span> <span class="keyword">public</span> Animal<span class="comment">//é©¼</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Alpaca</span> : <span class="keyword">public</span> Sheep, <span class="keyword">public</span> Camel<span class="comment">//ç¾Šé©¼</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_03_13</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Alpaca al;</span><br><span class="line">al.Sheep::m_Age = <span class="number">3</span>;</span><br><span class="line">al.Camel::m_Age = <span class="number">5</span>;<span class="comment">//ä¸¤ä¸ªçˆ¶ç±»ç›¸åŒåç§°æˆå‘˜ï¼Œè¦åŠ ä½œç”¨åŸŸåŒºåˆ†</span></span><br><span class="line"><span class="comment">//è±å½¢ç»§æ‰¿ä¼šå¯¼è‡´èµ„æºæµªè´¹ï¼Œéœ€è¦ç”¨åˆ°è™šç»§æ‰¿ï¼è™šç»§æ‰¿ååªæœ‰ä¸€ä»½æ•°æ®ï¼</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Sheep age=&quot;</span> &lt;&lt; al.Sheep::m_Age &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Camel age=&quot;</span> &lt;&lt; al.Camel::m_Age &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Alpaca age=&quot;</span> &lt;&lt; al.m_Age &lt;&lt; endl;<span class="comment">//è™šç»§æ‰¿ä¸ä¼šå‡ºç°ä¸æ˜ç¡®</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è±å½¢ç»§æ‰¿çš„å¼Šç«¯:</p><ol><li><strong>äºŒä¹‰æ€§</strong>ï¼šå½“åŸºç±»ä¸­çš„ä¸¤ä¸ªå­ç±»éƒ½é‡å†™äº†åŸºç±»çš„æŸä¸ªæˆå‘˜æ—¶ï¼Œç”±æ­¤äº§ç”Ÿçš„æœ€å­ç±»åœ¨é€‰æ‹©è¦è®¿é—®å“ªä¸ªç‰ˆæœ¬ä¼šå¼•å‘äºŒä¹‰æ€§ã€‚</li><li><strong>å†…å­˜å†—ä½™</strong>ï¼šä¸¤ä¸ªå­ç±»åˆ†åˆ«ç»§æ‰¿äº†è‡ªèº«çš„å‰¯æœ¬åŸºç±»ï¼Œå¢åŠ äº†å†…å­˜å ç”¨ã€‚</li><li><strong>æ„é€ å’Œææ„çš„å¤æ‚æ€§</strong>ï¼šæˆå‘˜çš„æ„é€ å’Œææ„å¯èƒ½å˜å¾—å¤æ‚ï¼Œéœ€è¦å¤šä¸ªæ„é€ å‡½æ•°å’Œææ„å‡½æ•°æ¥å¤„ç†ä¸åŒç»§æ‰¿é“¾çš„åˆå§‹åŒ–å’Œæ¸…ç†ã€‚</li></ol><p>ğŸ˜Šæ”¹è¿›æ–¹æ¡ˆï¼š</p><ol><li><strong>è™šç»§æ‰¿</strong>ï¼šé€šè¿‡ä½¿ç”¨ <code>virtual</code> å…³é”®å­—åœ¨åŸºç±»ç»§æ‰¿ä¸­ï¼Œå¯ä»¥æŒ‡å®šå…±äº«çš„åŸºç±»ä¸ºè™šåŸºç±»ï¼Œä»è€Œé¿å…æ¯ä¸ªæ´¾ç”Ÿç±»å­˜å‚¨ç‹¬ç«‹çš„åŸºç±»å‰¯æœ¬ã€‚</li><li><strong>å¤šé‡ç»§æ‰¿çš„æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼šè€ƒè™‘ä½¿ç”¨<font color="#2DC26B">ç»„åˆ</font>è€Œéç»§æ‰¿ï¼Œæˆ–è€…ä½¿ç”¨<font color="#2DC26B">æ¥å£ç±»</font>è§£å†³é—®é¢˜ã€‚</li><li><strong>è®¾è®¡å®¡æŸ¥</strong>ï¼šåœ¨å†³å®šä½¿ç”¨å¤šé‡ç»§æ‰¿æ—¶ï¼Œä»”ç»†å®¡æŸ¥è®¾è®¡ï¼Œä»¥ç¡®ä¿æ²¡æœ‰è¿‡åº¦è€¦åˆã€‚</li></ol><p>ç¬¬ä¸€ç‚¹è™šç»§æ‰¿ä»£ç å¦‚ä¸Šï¼Œä¸‹é¢ç»™å‡ºç¬¬äºŒç‚¹çš„ä»£ç  (æ¨è)ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸºç±» Animal</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> m_Age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­ç±» Sheepï¼Œç»„åˆäº† Animal è€Œä¸æ˜¯ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sheep</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Animal animal;  <span class="comment">// Sheep æ‹¥æœ‰ä¸€ä¸ª Animal å±æ€§</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Sheep</span>(<span class="type">int</span> age) : <span class="built_in">animal</span>(age) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setAge</span><span class="params">(<span class="type">int</span> age)</span> </span>&#123;</span><br><span class="line">        animal.m_Age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getAge</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> animal.m_Age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­ç±» Camelï¼ŒåŒæ ·ç»„åˆ Animal</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Camel</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Animal animal; <span class="comment">// Camel ä¹Ÿæ‹¥æœ‰ä¸€ä¸ª Animal å±æ€§</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Camel</span>(<span class="type">int</span> age) : <span class="built_in">animal</span>(age) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setAge</span><span class="params">(<span class="type">int</span> age)</span> </span>&#123;</span><br><span class="line">        animal.m_Age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getAge</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> animal.m_Age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤åˆåŠ¨ç‰©ç±» Alpacaï¼Œå®ƒç»„åˆäº† Sheep å’Œ Camel</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Alpaca</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Sheep sheep;</span><br><span class="line">    Camel camel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Alpaca</span>(<span class="type">int</span> sheepAge, <span class="type">int</span> camelAge) : <span class="built_in">sheep</span>(sheepAge), <span class="built_in">camel</span>(camelAge) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getSheepAge</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sheep.<span class="built_in">getAge</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getCamelAge</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> camel.<span class="built_in">getAge</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setSheepAge</span><span class="params">(<span class="type">int</span> age)</span> </span>&#123;</span><br><span class="line">        sheep.<span class="built_in">setAge</span>(age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setCamelAge</span><span class="params">(<span class="type">int</span> age)</span> </span>&#123;</span><br><span class="line">        camel.<span class="built_in">setAge</span>(age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Alpaca <span class="title">al</span><span class="params">(<span class="number">3</span>, <span class="number">5</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Sheep age=&quot;</span> &lt;&lt; al.<span class="built_in">getSheepAge</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Camel age=&quot;</span> &lt;&lt; al.<span class="built_in">getCamelAge</span>() &lt;&lt; endl;</span><br><span class="line">    al.<span class="built_in">setSheepAge</span>(<span class="number">4</span>);</span><br><span class="line">    al.<span class="built_in">setCamelAge</span>(<span class="number">6</span>);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Updated Sheep age=&quot;</span> &lt;&lt; al.<span class="built_in">getSheepAge</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Updated Camel age=&quot;</span> &lt;&lt; al.<span class="built_in">getCamelAge</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h1 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h1><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p><strong>é™æ€å¤šæ€</strong>ï¼šå‡½æ•°é‡è½½ã€è¿ç®—ç¬¦é‡è½½ã€‚å‡½æ•°åœ°å€æ—©ç»‘å®šï¼šç¼–è¯‘é˜¶æ®µç¡®å®šå‡½æ•°åœ°å€ã€‚<br><strong>åŠ¨æ€å¤šæ€</strong>ï¼šæ´¾ç”Ÿç±»å’Œè™šå‡½æ•°å®ç°è¿è¡Œæ—¶çš„å¤šæ€ã€‚å‡½æ•°åœ°å€æ™šç»‘å®šï¼šè¿è¡Œé˜¶æ®µç¡®å®šå‡½æ•°åœ°å€ã€‚</p><p>ğŸ’­åŠ¨æ€å¤šæ€çš„æ»¡è¶³æ¡ä»¶ï¼š</p><ol><li>æœ‰ç»§æ‰¿å…³ç³»ï¼›</li><li>å­ç±»<font color="#2DC26B">é‡å†™</font>çˆ¶ç±»çš„è™šå‡½æ•°ï¼Œä¸æ˜¯é‡è½½ï¼Œæ˜¯å®Œå…¨ç›¸åŒçš„å‡½æ•°ã€‚</li></ol><p>åŠ¨æ€å¤šæ€çš„ä½¿ç”¨ï¼šçˆ¶ç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨æŒ‡å‘å­ç±»çš„å¯¹è±¡ã€‚</p><p>ğŸš€é‡å†™(overload)å’Œé‡è½½(override)çš„åŒºåˆ«:</p><ul><li><strong>èŒƒå›´å’Œä½œç”¨åŸŸ</strong>ï¼šé‡å†™å‘ç”Ÿåœ¨<font color="#2DC26B">æ´¾ç”Ÿç±»ä¸å…¶åŸºç±»</font>ä¹‹é—´ï¼Œéœ€åœ¨ä¸åŒçš„ç±»ä¸­å®šä¹‰ï¼›è€Œé‡è½½å‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»æˆ–åŒä¸€ä¸ªä½œç”¨åŸŸä¸­ï¼Œæ¶‰åŠå¤šä¸ªå…·æœ‰ç›¸åŒåç§°ä½†å‚æ•°ä¸åŒçš„å‡½æ•°ã€‚</li><li><strong>å‚æ•°åˆ—è¡¨</strong>ï¼šé‡å†™è¦æ±‚æ´¾ç”Ÿç±»ä¸­é‡å†™çš„å‡½æ•°ä¸åŸºç±»ä¸­çš„è™šå‡½æ•°<font color="#2DC26B">å‚æ•°åˆ—è¡¨å®Œå…¨ç›¸åŒï¼Œä»¥å®ç°çœŸæ­£çš„å‡½æ•°æ›¿ä»£</font>ï¼›é‡è½½çš„å‡½æ•°åˆ™æœ‰ä¸åŒå‚æ•°åˆ—è¡¨ï¼Œæ ¹æ®å‚æ•°çš„ç±»å‹ã€æ•°é‡ã€é¡ºåºæ¥åŒºåˆ†ã€‚</li><li><strong>å…³é”®å­—<code>virtual</code></strong>ï¼šè¿›è¡Œé‡å†™çš„åŸºç±»å‡½æ•°å¿…é¡»æœ‰<code>virtual</code>å…³é”®å­—ï¼Œä»¥ç¡®ä¿å®ƒèƒ½å¤Ÿæ¥æ”¶åŠ¨æ€ç»‘å®šï¼ˆRuntime Polymorphismï¼‰ï¼›è€Œé‡è½½åˆ™ä¸å¼ºåˆ¶è¦æ±‚<code>virtual</code>å…³é”®å­—ã€‚ </li><li><strong>è¿”å›ç±»å‹</strong>ï¼šå°½ç®¡è¿”å›ç±»å‹ç›¸åŒå¯ä»¥ä½œä¸ºé‡å†™å’Œé‡è½½çš„ä¸€ç§æƒ…å†µï¼Œä½†é‡è½½æ›´ä¾§é‡äºå‚æ•°çš„ä¸åŒï¼Œä¸åŒçš„è¿”å›ç±»å‹å¹¶ä¸å½±å“å‡½æ•°çš„é‡è½½å…³ç³»ã€‚</li><li><strong>è®¿é—®çº§åˆ«</strong>ï¼šåœ¨é‡å†™ä¸­ï¼Œæ´¾ç”Ÿç±»çš„å‡½æ•°<font color="#2DC26B">ä¸èƒ½</font>æœ‰æ¯”åŸºç±»ä¸­ç›¸åº”å‡½æ•°æ›´ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶ï¼ˆå¦‚åŸºç±»æ–¹æ³•ä¸º<code>public</code>ï¼Œè€Œæ´¾ç”Ÿç±»æ–¹æ³•ä¸º<code>private</code>ï¼‰ã€‚ </li><li><strong>æ¦‚å¿µä¸Šçš„åŒºåˆ«</strong>ï¼šé‡å†™å®ç°å¤šæ€æ€§ï¼ˆPolymorphismï¼‰ï¼Œä¸€ä¸ªåŸºç±»å¼•ç”¨æˆ–æŒ‡é’ˆå¯ä»¥æŒ‡å‘ä¸åŒæ´¾ç”Ÿç±»çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„é‡å†™å‡½æ•°ï¼›é‡è½½å…è®¸ç¼–è¯‘æ—¶åŸºäºå‚æ•°åˆ—è¡¨ä½¿ç”¨å‡½æ•°åç§°æ¥åŒºåˆ†å¤šä¸ªå‡½æ•°ã€‚ </li><li><strong>éšè—ï¼ˆHidingï¼‰</strong>ï¼šä¸é‡å†™å’Œé‡è½½ä¸åŒï¼Œåœ¨éšè—æƒ…å†µä¸‹åŸºç±»å‡½æ•°è¢«æ´¾ç”Ÿç±»åŒåå‡½æ•°ç›–æ‰ï¼Œå³ä½¿åŸºç±»å‡½æ•°ä¸º<code>virtual</code>ï¼Œå¦‚æœæ´¾ç”Ÿç±»å‡½æ•°å‚æ•°åˆ—è¡¨ä¸åŒä¹Ÿä¸æ„æˆé‡å†™ï¼Œè€Œæ˜¯éšè—ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span><span class="comment">//åŠ¨ç‰©ç±»</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">//void speak()</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;åŠ¨ç‰©åœ¨è¯´è¯&quot; &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">speak</span><span class="params">()</span><span class="comment">//è¿™æ ·å¯ä»¥è®©åœ°å€æ™šç»‘å®šï¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;åŠ¨ç‰©åœ¨è¯´è¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> : <span class="keyword">public</span> Animal<span class="comment">//çŒ«ç±»</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">speak</span><span class="params">()</span><span class="comment">//å‡½æ•°é‡å†™ï¼Œå¯åŠ ä¹Ÿå¯ä¸åŠ virtual</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;çŒ«åœ¨è¯´è¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> : <span class="keyword">public</span> Animal<span class="comment">//ç‹—ç±»</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">speak</span><span class="params">()</span><span class="comment">//å‡½æ•°é‡å†™ï¼Œå¯åŠ ä¹Ÿå¯ä¸åŠ virtual</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;ç‹—åœ¨è¯´è¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doSpeak</span><span class="params">(Animal &amp;animal)</span><span class="comment">//æ‰§è¡Œè¯´è¯çš„å‡½æ•°//çˆ¶ç±»çš„å¼•ç”¨å¯ä»¥ç›´æ¥æŒ‡å‘å­ç±»çš„å¯¹è±¡ï¼Animal &amp;animal = cæˆ–è€…dï¼›</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">animal.<span class="built_in">speak</span>();<span class="comment">//ä¹‹å‰æ˜¯åœ°å€æ—©ç»‘å®šï¼Œç¼–è¯‘é˜¶æ®µå°±ç¡®å®šäº†å‡½æ•°åœ°å€ï¼</span></span><br><span class="line"><span class="comment">//å¦‚æœè¦è®©çŒ«è¯´è¯ï¼Œå°±è¦è®©åœ°å€åœ¨è¿è¡Œé˜¶æ®µæ‰ç»‘å®šï¼è¦åœ¨çˆ¶ç±»å‡½æ•°åå‰åŠ virtualï¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Cat c;</span><br><span class="line"><span class="built_in">doSpeak</span>(c);</span><br><span class="line"></span><br><span class="line">Dog d;</span><br><span class="line"><span class="built_in">doSpeak</span>(d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸš©çº¯è™šå‡½æ•°ä¸æŠ½è±¡ç±»"><a href="#ğŸš©çº¯è™šå‡½æ•°ä¸æŠ½è±¡ç±»" class="headerlink" title="ğŸš©çº¯è™šå‡½æ•°ä¸æŠ½è±¡ç±»"></a>ğŸš©çº¯è™šå‡½æ•°ä¸æŠ½è±¡ç±»</h2><p>çˆ¶ç±»ä¸­çš„è™šå‡½æ•°æ²¡ç”¨æ—¶ï¼Œå¯ä»¥å†™æˆçº¯è™šå‡½æ•°ï¼Œå› ä¸ºä¸»è¦éƒ½æ˜¯è°ƒç”¨å­ç±»é‡å†™çš„å‡½æ•°ã€‚<font color="#2DC26B">æœ‰çº¯è™šå‡½æ•°çš„ç±»ç§°ä¸ºæŠ½è±¡ç±»</font>ã€‚C++ä¸­å¸¸ä½¿ç”¨çº¯è™šå‡½æ•°å’ŒæŠ½è±¡ç±»æ¥å®ç°æ¥å£ã€‚</p><p>è¯­æ³•ï¼švirtual è¿”å›å€¼ å‡½æ•°å(å‚æ•°åˆ—è¡¨) = 0;<br>ç‰¹ç‚¹1ï¼š<font color="#2DC26B">æ— æ³•å®ä¾‹åŒ–</font>å¯¹è±¡ï¼›<br>ç‰¹ç‚¹2ï¼šå­ç±»<font color="#2DC26B">å¿…é¡»é‡å†™æŠ½è±¡ç±»ä¸­çš„çº¯è™šå‡½æ•°</font>ï¼Œå¦åˆ™ä¹Ÿå±äºæŠ½è±¡ç±»ï¼<br>å¤šæ€ä½¿ç”¨çš„æ¡ä»¶ï¼šçˆ¶ç±»çš„<font color="#2DC26B">æŒ‡é’ˆæˆ–è€…å¼•ç”¨</font>æŒ‡å‘å­ç±»å¯¹è±¡ã€‚</p><p><strong>æŠ½è±¡ç±»ç‰¹ç‚¹</strong>ï¼š</p><ul><li>ä¸èƒ½ç›´æ¥è¢«å®ä¾‹åŒ–ã€‚</li><li><font color="#2DC26B">å¯ä»¥</font>æ‹¥æœ‰æˆå‘˜å˜é‡ã€‚</li><li>å¯ä»¥æ‹¥æœ‰æ™®é€šæˆå‘˜å‡½æ•°ä»¥åŠæ„é€ å‡½æ•°å’Œææ„å‡½æ•°ã€‚</li><li>ç”¨ä½œåŸºç±»ï¼Œä¸ºæ´¾ç”Ÿç±»æä¾›å…±åŒçš„æ¥å£ã€‚</li><li><font color="#2DC26B">å¿…é¡»æœ‰çº¯è™šå‡½æ•°</font>ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span><span class="comment">//æŠ½è±¡ç±»</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">()</span> </span>= <span class="number">0</span>;<span class="comment">//çº¯è™šå‡½æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son</span> : <span class="keyword">public</span> Base</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">()</span><span class="comment">//é‡å†™æŠ½è±¡ç±»ä¸­çš„çº¯è™šå‡½æ•°ï¼Œä¸ç„¶ä¸èƒ½åˆ›å»ºå¯¹è±¡ï¼ä½†é‡å†™ä¸æ˜¯=0ï¼Œè€Œæ˜¯è¦æœ‰å®ç°ï¼</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;funcå‡½æ•°è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//Base b;//ä¸å¯å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="comment">//new Base;//å †åŒºä¹Ÿä¸å¯å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">Son s;<span class="comment">//å¯ä»¥å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">Base *p = <span class="keyword">new</span> <span class="built_in">Son</span>();<span class="comment">//å †åŒºæ•°æ®ï¼Œæ‰‹åŠ¨å¼€è¾Ÿï¼Œæ‰‹åŠ¨é‡Šæ”¾ï¼//å¤šæ€ä½¿ç”¨çš„æ¡ä»¶ï¼šçˆ¶ç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ï¼</span></span><br><span class="line">p-&gt;<span class="built_in">func</span>();</span><br><span class="line"><span class="keyword">delete</span> p;<span class="comment">//æ‰‹åŠ¨é‡Šæ”¾ï¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ¤”æ€è€ƒï¼šå¦‚æœ Base å¹¶ä¸æ˜¯æŠ½è±¡ç±»ï¼Œå³å¹¶æ²¡æœ‰çº¯è™šå‡½æ•°ï¼Œæ­¤æ—¶ <code>func ()</code> çš„ä»£ç ä¸ºï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;çˆ¶ç±»&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>è¾“å‡ºç»“æœä¾ç„¶ä¸ºï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">funcå‡½æ•°è°ƒç”¨</span><br></pre></td></tr></table></figure><br>åˆ†æå‡½æ•°æ‰§è¡Œé¡ºåºï¼šï¼ˆä¸åŒ…æ‹¬ <code>Son s</code> çš„æƒ…å†µä¸‹ï¼‰</p><ol><li>åŸºç±»æ„é€ å‡½æ•° <code>Base()</code></li><li>æ´¾ç”Ÿç±»æ„é€ å‡½æ•° <code>Son()</code></li><li>æ´¾ç”Ÿç±»é‡å†™çš„å‡½æ•° <code>Son::func()</code></li><li>æ´¾ç”Ÿç±»ææ„å‡½æ•° <code>~Base()</code></li><li>åŸºç±»ææ„å‡½æ•° <code>~Son()</code><br>ç”±æ­¤å¯è§ï¼Œå³ä½¿ Base ä¸æ˜¯æŠ½è±¡ç±»ï¼Œp-&gt;func() ä»ç„¶åªè°ƒç”¨å­ç±»å¯¹è±¡çš„å¯¹åº”å‡½æ•°ã€‚ç»“æœå’Œ <code>Son s; s.func()</code> çš„è¾“å‡ºç»“æœä¸€è‡´ã€‚</li></ol><p>è¿›è¡ŒéªŒè¯ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Base</span>() &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Base constructor called.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Base func called.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Base</span>() &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Base destructor called.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son</span> : <span class="keyword">public</span> Base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Son</span>() &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Son constructor called.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Son func called.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">Son</span>() <span class="keyword">override</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Son destructor called.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_02</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Base* p = <span class="keyword">new</span> <span class="built_in">Son</span>();</span><br><span class="line">    p-&gt;<span class="built_in">func</span>();</span><br><span class="line">    <span class="keyword">delete</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">test04_02</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="ğŸš©è™šææ„ä¸çº¯è™šææ„"><a href="#ğŸš©è™šææ„ä¸çº¯è™šææ„" class="headerlink" title="ğŸš©è™šææ„ä¸çº¯è™šææ„"></a>ğŸš©è™šææ„ä¸çº¯è™šææ„</h2><p>å¦‚æœå­ç±»ä¸­æœ‰å±æ€§å¼€è¾Ÿåˆ°å †åŒºï¼Œé‚£ä¹ˆçˆ¶ç±»æŒ‡é’ˆåœ¨é‡Šæ”¾æ—¶æ— æ³•è°ƒç”¨åˆ°å­ç±»çš„ææ„ä»£ç ã€‚<br>ğŸ’¡è§£å†³æ–¹æ³•ï¼šå°†<font color="#2DC26B">çˆ¶ç±»</font>ä¸­çš„ææ„å‡½æ•°å†™æˆ<font color="#2DC26B">è™šææ„æˆ–çº¯è™šææ„</font>å‡½æ•°ã€‚</p><p>ğŸ’­è™šææ„ä¸çº¯è™šææ„å…±æ€§ï¼š<br>1ï¼Œå¯ä»¥è§£å†³<font color="#2DC26B">çˆ¶ç±»æŒ‡é’ˆé‡Šæ”¾å­ç±»çš„å †åŒºå¯¹è±¡</font>ï¼›<br>2ï¼Œéƒ½éœ€è¦æœ‰<font color="#2DC26B">å…·ä½“çš„å‡½æ•°å®ç°</font>ã€‚</p><p>ğŸ’­è™šææ„ä¸çº¯è™šææ„åŒºåˆ«ï¼šçº¯è™šææ„ï¼Œè¯¥ç±»å±äºæŠ½è±¡ç±»ï¼Œ<font color="#2DC26B">æ— æ³•å®ä¾‹åŒ–</font>å¯¹è±¡ã€‚<br>å¦‚æœå­ç±»ä¸­æ²¡æœ‰å †åŒºæ•°æ®ï¼ˆnewï¼‰ï¼Œå¯ä»¥ä¸å†™è™šææ„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Animal1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Animal1</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Animal1æ„é€ å‡½æ•°è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//virtual ~Animal1()//è™šææ„</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;Animal1ææ„å‡½æ•°è°ƒç”¨&quot; &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="keyword">virtual</span> ~<span class="built_in">Animal1</span>() = <span class="number">0</span>;<span class="comment">//çº¯è™šææ„</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">speak</span><span class="params">()</span> </span>= <span class="number">0</span>;<span class="comment">//çº¯è™šå‡½æ•°ï¼›</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Animal1::~<span class="built_in">Animal1</span>()<span class="comment">//çº¯è™šææ„å‡½æ•°ä¸€å®šè¦æœ‰å…·ä½“å®ç°å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Animal1çº¯è™šææ„å‡½æ•°è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Lion</span> : <span class="keyword">public</span> Animal1</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Lion</span>(string name)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Lionæ„é€ å‡½æ•°è°ƒç”¨&quot;</span> &lt;&lt; endl;</span><br><span class="line">m_Name = <span class="keyword">new</span> <span class="built_in">string</span>(name);<span class="comment">//å †åŒº</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">speak</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; *m_Name &lt;&lt; <span class="string">&quot;ç‹®å­åœ¨è¯´è¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">~<span class="built_in">Lion</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (m_Name != <span class="literal">nullptr</span>)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Lionææ„å‡½æ•°è°ƒç”¨&quot;</span> &lt;&lt; endl;<span class="comment">//çˆ¶ç±»ç”¨è™šææ„ï¼Œå­ç±»çš„è™šææ„æ‰èƒ½è¢«è°ƒç”¨ã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨è™šææ„å‡½æ•°é‡Šæ”¾æ‰å †åŒºå†…å­˜äº†</span></span><br><span class="line"><span class="keyword">delete</span> m_Name;</span><br><span class="line">m_Name = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">string *m_Name;<span class="comment">//æŒ‡é’ˆï¼›</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test04_03</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Animal1 *p = <span class="keyword">new</span> <span class="built_in">Lion</span>(<span class="string">&quot;Simba&quot;</span>);</span><br><span class="line">p-&gt;<span class="built_in">speak</span>();</span><br><span class="line"><span class="keyword">delete</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœï¼š</span></span><br><span class="line"><span class="comment">//Animal1æ„é€ å‡½æ•°è°ƒç”¨</span></span><br><span class="line"><span class="comment">//Lionæ„é€ å‡½æ•°è°ƒç”¨</span></span><br><span class="line"><span class="comment">//Simbaç‹®å­åœ¨è¯´è¯</span></span><br><span class="line"><span class="comment">//Lionææ„å‡½æ•°è°ƒç”¨</span></span><br><span class="line"><span class="comment">//Animal1çº¯è™šææ„å‡½æ•°è°ƒç”¨</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">C++åŸºç¡€ï¼šé¢å‘å¯¹è±¡</summary>
    
    
    
    <category term="C++è¯­è¨€åŸºç¡€" scheme="https://sumikiru.top/categories/C-%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="é¢å‘å¯¹è±¡" scheme="https://sumikiru.top/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    
  </entry>
  
  <entry>
    <title>è¯­è¨€åŸºç¡€1.æŒ‡é’ˆä¸ç»“æ„ä½“</title>
    <link href="https://sumikiru.top/posts/685aa201.html"/>
    <id>https://sumikiru.top/posts/685aa201.html</id>
    <published>2024-07-28T13:18:39.000Z</published>
    <updated>2024-12-12T05:10:58.029Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h1><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </span><br><span class="line"><span class="comment">//æŒ‡é’ˆå°±æ˜¯åœ°å€ï¼Œå–*æ“ä½œäº†å°±æ˜¯å€¼ </span></span><br><span class="line"><span class="comment">//å®šä¹‰æŒ‡é’ˆï¼š </span></span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>; </span><br><span class="line"><span class="type">int</span> * p;<span class="comment">//è¯­æ³•ï¼šæ•°æ®ç±»å‹ * æŒ‡é’ˆå˜é‡åï¼›é€šå¸¸ç”¨pè¡¨ç¤ºæŒ‡é’ˆï¼› </span></span><br><span class="line">p = &amp;a;<span class="comment">//&amp;aä¸ºå–açš„åœ°å€ï¼Œè®©æŒ‡é’ˆpè®°å½•å˜é‡açš„åœ°å€ï¼› </span></span><br><span class="line"><span class="comment">//ä¹Ÿå¯ä»¥å†™æˆï¼š</span></span><br><span class="line"><span class="type">int</span> *p = &amp;a;<span class="comment">//ä¹Ÿå°±æ˜¯è®©æŒ‡é’ˆpæŒ‡å‘açš„åœ°å€ï¼› </span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;açš„åœ°å€æ˜¯ï¼š&quot;</span> &lt;&lt; &amp;a &lt;&lt; endl; </span><br><span class="line">cout &lt;&lt; <span class="string">&quot;æŒ‡é’ˆpæ˜¯ï¼š&quot;</span> &lt;&lt; p &lt;&lt; endl; </span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡é’ˆä½¿ç”¨ï¼š </span></span><br><span class="line"><span class="comment">//é€šè¿‡â€œè§£å¼•ç”¨â€çš„æ–¹å¼æ‰¾åˆ°æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ï¼Œå–*æ“ä½œï¼› </span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*p=&quot;</span> &lt;&lt; *p &lt;&lt; endl; <span class="comment">//æŒ‡é’ˆå‰åŠ *è¡¨ç¤ºè§£å¼•ç”¨ï¼Œæ‰¾åˆ°æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸­çš„æ•°æ®ï¼›è¿™é‡Œä¸ºå¯¹å†…å­˜è¿›è¡Œè¯»å–ï¼› </span></span><br><span class="line">*p = <span class="number">1000</span>;<span class="comment">//è¿™é‡Œä¸ºå¯¹å†…å­˜è¿›è¡Œä¿®æ”¹ï¼Œè®©æŒ‡é’ˆæŒ‡å‘å†…å­˜ä¸º1000çš„ä½ç½®ï¼› </span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;a=&quot;</span> &lt;&lt; a &lt;&lt; endl; </span><br><span class="line">cout &lt;&lt; <span class="string">&quot;p=&quot;</span> &lt;&lt; p &lt;&lt; endl; </span><br><span class="line">cout &lt;&lt; <span class="string">&quot;*p=&quot;</span> &lt;&lt; *p &lt;&lt; endl; </span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡é’ˆå ç”¨çš„ç©ºé—´ï¼š </span></span><br><span class="line"><span class="type">int</span> b = <span class="number">5</span>; </span><br><span class="line"><span class="comment">//int * p1; </span></span><br><span class="line"><span class="comment">//p1 = &amp;b; </span></span><br><span class="line"><span class="type">int</span> * p1 = &amp;b;<span class="comment">//ç›´æ¥è®©æŒ‡é’ˆæŒ‡å‘bçš„åœ°å€ï¼› </span></span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(p1) &lt;&lt; endl;<span class="comment">//32ä½ç³»ç»Ÿå ç”¨4ä¸ªå­—èŠ‚ï¼Œ64ä½ä¸º8ä¸ªå­—èŠ‚,ä¸ç®¡ä»€ä¹ˆæ•°æ®ç±»å‹ï¼› </span></span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">int</span>*) &lt;&lt; endl;<span class="comment">//ç­‰ä»·äºä¸Šä¸€è¡Œï¼› </span></span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">float</span>*) &lt;&lt; endl; </span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">double</span>*) &lt;&lt; endl; </span><br><span class="line">cout &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">char</span>*) &lt;&lt; endl; </span><br><span class="line"></span><br><span class="line"><span class="comment">//ç©ºæŒ‡é’ˆï¼šæŒ‡å‘å†…å­˜ä¸­ç¼–å·ä¸º0çš„å˜é‡ï¼› </span></span><br><span class="line"><span class="comment">//ç”¨é€”ï¼šåˆå§‹åŒ–æŒ‡é’ˆå˜é‡ï¼› </span></span><br><span class="line"><span class="comment">//ç©ºæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸å¯è®¿é—®ï¼å› ä¸º0-255ä¹‹é—´çš„å†…å­˜ç¼–å·æ˜¯ç³»ç»Ÿå ç”¨çš„ï¼Œä¸å¯æ›´æ”¹ï¼</span></span><br><span class="line"><span class="comment">//int *p2 = NULL; //é”™è¯¯</span></span><br><span class="line"><span class="type">int</span> *p2 = <span class="literal">nullptr</span>; <span class="comment">//æ­£ç¡®ï¼Œæ˜¯ç©ºæŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//é‡æŒ‡é’ˆï¼šæŒ‡å‘éæ³•çš„å†…å­˜ç©ºé—´ï¼› </span></span><br><span class="line"><span class="type">int</span> *p3 = (<span class="type">int</span> *)<span class="number">0x1100</span>;<span class="comment">//ä¸æ˜¯è‡ªå·±ç”³è¯·çš„å†…å­˜ç©ºé—´ï¼Œä¸è¦å»è®¿é—®ï¼ </span></span><br><span class="line"><span class="comment">//cout &lt;&lt; *p3 &lt;&lt; endl; </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//constæŒ‡é’ˆï¼šçœ‹conståé¢è·Ÿç€æ˜¯ä»€ä¹ˆï¼› </span></span><br><span class="line"><span class="comment">//constä¿®é¥°æŒ‡é’ˆï¼š </span></span><br><span class="line"><span class="type">int</span> a1 = <span class="number">4</span>; </span><br><span class="line"><span class="type">int</span> a2 = <span class="number">9</span>; </span><br><span class="line"><span class="type">const</span> <span class="type">int</span> *p4 = &amp;a1;<span class="comment">//å¸¸é‡æŒ‡é’ˆï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸å¯ä»¥æ”¹ï¼Œè€ŒæŒ‡å‘çš„ä½ç½®å¯ä»¥æ”¹ï¼› </span></span><br><span class="line"><span class="comment">//*p4 = 10;é”™è¯¯ï¼ </span></span><br><span class="line">p4 = &amp;a2;<span class="comment">//æ­£ç¡®ï¼Œå¯ä»¥æ”¹ï¼ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//constä¿®é¥°å¸¸é‡ï¼š </span></span><br><span class="line"><span class="type">int</span> * <span class="type">const</span> p5 = &amp;a1;<span class="comment">//æŒ‡é’ˆå¸¸é‡ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å€¼å¯ä»¥æ”¹ï¼Œè€ŒæŒ‡å‘çš„ä½ç½®ä¸å¯ä»¥æ”¹ï¼› </span></span><br><span class="line">*p5 = <span class="number">10</span>;<span class="comment">//æ­£ç¡®ï¼Œå¯ä»¥æ”¹ï¼ </span></span><br><span class="line"><span class="comment">//p5 = &amp;a2;é”™è¯¯ï¼ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//constä¿®é¥°æŒ‡é’ˆå’Œå¸¸é‡ï¼š </span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> * <span class="type">const</span> p6 = &amp;a1;<span class="comment">//æŒ‡é’ˆæŒ‡å‘çš„å€¼å’ŒæŒ‡å‘çš„ä½ç½®éƒ½ä¸å¯ä»¥æ”¹ï¼ </span></span><br><span class="line"><span class="comment">//*p6 = 7;é”™è¯¯ï¼ </span></span><br><span class="line"><span class="comment">//p6 = &amp;a2;é”™è¯¯ï¼ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡é’ˆå’Œæ•°ç»„ï¼Œç”¨æŒ‡é’ˆè®¿é—®æ•°ç»„ä¸­çš„å…ƒç´  </span></span><br><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span> &#125;; </span><br><span class="line"><span class="type">int</span> *p7 = arr;<span class="comment">//arrå°±æ˜¯æ•°ç»„çš„é¦–åœ°å€ï¼› </span></span><br><span class="line">cout &lt;&lt; *p7 &lt;&lt; endl;<span class="comment">//è§£å¼•ç”¨ï¼Œå–*æ“ä½œï¼Œç”¨æŒ‡é’ˆè®¿é—®ç¬¬ä¸€ä¸ªå…ƒç´ ï¼› </span></span><br><span class="line">p7++;<span class="comment">//è®©æŒ‡é’ˆå‘å³åç§»4ä¸ªå­—èŠ‚ï¼› </span></span><br><span class="line">cout &lt;&lt; *p7 &lt;&lt; endl;<span class="comment">//è®¿é—®ç¬¬äºŒä¸ªå…ƒç´ ï¼› </span></span><br><span class="line"><span class="type">int</span> *p8 = arr;<span class="comment">//ç”¨æŒ‡é’ˆè®¿é—®æ‰€æœ‰å…ƒç´ ï¼› </span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123; </span><br><span class="line"><span class="comment">//cout &lt;&lt; arr[i] &lt;&lt; endl;ä¸ç”¨æŒ‡é’ˆè®¿é—®æ¯ä¸ªå…ƒç´ ï¼› </span></span><br><span class="line">cout &lt;&lt; *p8 &lt;&lt; endl; </span><br><span class="line">p8++;<span class="comment">//æŒ‡é’ˆåç§»ä¸€ä½ </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ’­æ³¨ï¼š<code>nullptr</code> æ˜¯åœ¨C++11å¼•å…¥çš„ä¸€ä¸ªç‰¹æ®Šçš„å­—é¢å€¼ï¼Œç”¨æ¥å®‰å…¨é«˜æ•ˆåœ°è¡¨ç¤ºç©ºæŒ‡é’ˆï¼Œé¿å…äº†Cè¯­è¨€é£æ ¼ä¸­å°† <code>NULL</code> æˆ– <code>0</code> ç”¨ä½œç©ºæŒ‡é’ˆæ—¶å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚åœ¨ <code>int *p2 = nullptr;</code> è¿™è¡Œä»£ç ä¸­ï¼Œ<code>p2</code> è¢«åˆå§‹åŒ–ä¸ºæŒ‡å‘ç©ºå¯¹è±¡çš„æŒ‡é’ˆã€‚è¿™åœ¨ç¼–ç¨‹ä¸­æ˜¯ä¸€ç§å¸¸è§çš„åšæ³•ï¼Œç¡®ä¿æŒ‡é’ˆåœ¨æœªè¢«æ­£ç¡®åˆå§‹åŒ–ä¹‹å‰ä¸ä¼šè®¿é—®ä»»ä½•å¯¹è±¡ï¼Œå¯ä»¥é¿å…è¿è¡Œæ—¶é”™è¯¯ã€‚<code>nullptr</code> ä¸ <code>NULL</code> ä¸åŒï¼Œ<code>NULL</code> é€šå¸¸è¢«å®šä¹‰ä¸º <code>0</code> çš„å®ï¼Œè€Œ <code>nullptr</code> æ˜¯ç²¾ç¡®çš„ç©ºæŒ‡é’ˆã€‚</p><blockquote><p><code>const</code> åœ¨ <code>*</code> çš„ä½ç½®ï¼šå·¦å®šå€¼ï¼Œå³å®šå‘ã€‚</p></blockquote><h2 id="å‡½æ•°çš„åœ°å€ä¼ é€’"><a href="#å‡½æ•°çš„åœ°å€ä¼ é€’" class="headerlink" title="å‡½æ•°çš„åœ°å€ä¼ é€’"></a>å‡½æ•°çš„åœ°å€ä¼ é€’</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span> *p1, <span class="type">int</span> *p2)</span><span class="comment">//åœ°å€ä¼ é€’ï¼Œç”¨æŒ‡é’ˆæ¥æ”¶ä¼ å…¥çš„åœ°å€ï¼› </span></span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="type">int</span> temp = *p1; </span><br><span class="line">*p1 = *p2; </span><br><span class="line">*p2 = temp; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>; </span><br><span class="line"><span class="type">int</span> b = <span class="number">20</span>; </span><br><span class="line"><span class="built_in">swap</span>(&amp;a, &amp;b);<span class="comment">//æŠŠaå’Œbçš„åœ°å€ä¼ å…¥å‡½æ•°ï¼Œå‡½æ•°ä¸­ç”¨æŒ‡é’ˆæ¥æ”¶åœ°å€ï¼› </span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;a=&quot;</span> &lt;&lt; a &lt;&lt; endl; </span><br><span class="line">cout &lt;&lt; <span class="string">&quot;b=&quot;</span> &lt;&lt; b &lt;&lt; endl; </span><br><span class="line"><span class="comment">//åœ°å€ä¼ é€’å¯ä»¥ä¿®æ”¹å®å‚ï¼è€Œå€¼ä¼ é€’ä¸èƒ½ï¼ </span></span><br><span class="line"><span class="comment">//å¦‚æœä¸æƒ³å®å‚è¢«ä¿®æ”¹ï¼Œå‡½æ•°çš„å‚æ•°åˆ—è¡¨å¯ä»¥å†™æˆconstï¼›å¦‚æœæƒ³è¦ä¿®æ”¹ï¼Œå¯ä»¥ç”¨åœ°å€ä¼ é€’ï¼Œæˆ–è€…å¼•ç”¨ä¼ é€’ï¼ˆåç»­ä»‹ç»ï¼‰ï¼› </span></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h1><h2 id="åŸºæœ¬æ¦‚å¿µ-1"><a href="#åŸºæœ¬æ¦‚å¿µ-1" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Student</span><span class="comment">//å®šä¹‰çš„æ—¶å€™ä¸å¯ä»¥çœç•¥æ‰struct! ä¸€èˆ¬å®šä¹‰åœ¨mainå‡½æ•°ä¹‹å‰æˆ–å¤´æ–‡ä»¶é‡Œï¼›</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//æˆå‘˜åˆ—è¡¨</span></span><br><span class="line">string name;</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line"><span class="type">int</span> score;</span><br><span class="line">&#125;S3;<span class="comment">//é¡ºä¾¿ç›´æ¥åˆ›å»ºå˜é‡ï¼›</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">C++åŸºç¡€ï¼šæŒ‡é’ˆä¸ç»“æ„ä½“</summary>
    
    
    
    <category term="C++è¯­è¨€åŸºç¡€" scheme="https://sumikiru.top/categories/C-%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="æŒ‡é’ˆ" scheme="https://sumikiru.top/tags/%E6%8C%87%E9%92%88/"/>
    
    <category term="ç»“æ„ä½“" scheme="https://sumikiru.top/tags/%E7%BB%93%E6%9E%84%E4%BD%93/"/>
    
  </entry>
  
  <entry>
    <title>7.è´ªå¿ƒç®—æ³•ç¯‡</title>
    <link href="https://sumikiru.top/posts/dc2082d.html"/>
    <id>https://sumikiru.top/posts/dc2082d.html</id>
    <published>2024-07-27T21:27:16.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    
    <summary type="html">è´ªå¿ƒç®—æ³•éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="è´ªå¿ƒ" scheme="https://sumikiru.top/tags/%E8%B4%AA%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>6.1å“ˆå¸Œè¡¨ç¯‡(2)</title>
    <link href="https://sumikiru.top/posts/6f36f465.html"/>
    <id>https://sumikiru.top/posts/6f36f465.html</id>
    <published>2024-07-14T17:27:36.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="3-å“ˆå¸Œè¡¨ä¸ç»Ÿè®¡"><a href="#3-å“ˆå¸Œè¡¨ä¸ç»Ÿè®¡" class="headerlink" title="3.å“ˆå¸Œè¡¨ä¸ç»Ÿè®¡"></a>3.å“ˆå¸Œè¡¨ä¸ç»Ÿè®¡</h1><h2 id="3-1-æœ€é•¿å’Œè°å­åºåˆ—ï¼š594"><a href="#3-1-æœ€é•¿å’Œè°å­åºåˆ—ï¼š594" class="headerlink" title="3-1.æœ€é•¿å’Œè°å­åºåˆ—ï¼š594"></a>3-1.æœ€é•¿å’Œè°å­åºåˆ—ï¼š594</h2><p>æ³•ä¸€ï¼šæ’åº+æ»‘åŠ¨çª—å£</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findLHS</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="type">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; right &lt;= nums.<span class="built_in">size</span>() - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">abs</span>(nums[right] - nums[left]) == <span class="number">1</span>) &#123;</span><br><span class="line">                ans = <span class="built_in">max</span>(right - left + <span class="number">1</span>, ans);</span><br><span class="line">                right++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">abs</span>(nums[right] - nums[left]) &lt; <span class="number">1</span>) &#123;</span><br><span class="line">                right++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šå“ˆå¸Œè¡¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findLHS</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; cnt;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            cnt[num]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> [key, val] : cnt) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cnt.<span class="built_in">count</span>(key + <span class="number">1</span>)) &#123;</span><br><span class="line">                ans = <span class="built_in">max</span>(ans, val + cnt[key + <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="3-2-ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†IIï¼š350"><a href="#3-2-ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†IIï¼š350" class="headerlink" title="3-2.ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†IIï¼š350"></a>3-2.ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†IIï¼š350</h2><p>ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†:349ï¼Œè¯¦è§ã€Š6.0å“ˆå¸Œè¡¨ç¯‡1-2ã€‹</p><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨(æœ€ä¼˜è§£)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">intersect</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums1, vector&lt;<span class="type">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums1) &#123;</span><br><span class="line">            mp[num]++;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums2) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mp.<span class="built_in">count</span>(num) &amp;&amp; mp[num]) &#123;</span><br><span class="line">                mp[num]--;</span><br><span class="line">                res.<span class="built_in">emplace_back</span>(num);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ’åº+åŒæŒ‡é’ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">intersect</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums1, vector&lt;<span class="type">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums1.<span class="built_in">begin</span>(), nums1.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">sort</span>(nums2.<span class="built_in">begin</span>(), nums2.<span class="built_in">end</span>());</span><br><span class="line">        <span class="type">int</span> index1 = <span class="number">0</span>, index2 = <span class="number">0</span>;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">        <span class="keyword">while</span> (index1 &lt; nums1.<span class="built_in">size</span>() &amp;&amp; index2 &lt; nums2.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> num1 = nums1[index1], num2 = nums2[index2];</span><br><span class="line">            <span class="keyword">if</span> (num1 == num2) &#123;</span><br><span class="line">                res.<span class="built_in">emplace_back</span>(num1);</span><br><span class="line">                index1++;</span><br><span class="line">                index2++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num1 &lt; num2) &#123;</span><br><span class="line">                index1++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                index2++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><pre><code>å¦‚æœ$&#123;nums&#125;_2$çš„å…ƒç´ å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œç£ç›˜å†…å­˜æ˜¯æœ‰é™çš„ï¼Œå¹¶ä¸”ä½ **ä¸èƒ½ä¸€æ¬¡åŠ è½½æ‰€æœ‰çš„å…ƒç´ åˆ°å†…å­˜ä¸­**ã€‚é‚£ä¹ˆå°±æ— æ³•é«˜æ•ˆåœ°å¯¹$&#123;nums&#125;_2$è¿›è¡Œæ’åºï¼Œå› æ­¤æ¨èä½¿ç”¨æ–¹æ³•ä¸€è€Œä¸æ˜¯æ–¹æ³•äºŒã€‚åœ¨æ–¹æ³•ä¸€ä¸­ï¼Œ$&#123;nums&#125;_2$åªå…³ç³»åˆ°æŸ¥è¯¢æ“ä½œï¼Œå› æ­¤æ¯æ¬¡è¯»å–$&#123;nums&#125;_2$ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¹¶è¿›è¡Œå¤„ç†å³å¯ã€‚</code></pre><h2 id="3-3-ç –å¢™ï¼š554"><a href="#3-3-ç –å¢™ï¼š554" class="headerlink" title="3-3.ç –å¢™ï¼š554"></a>3-3.ç –å¢™ï¼š554</h2><p>å“ˆå¸Œè¡¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">leastBricks</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; wall)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; widths : wall) &#123;</span><br><span class="line">            <span class="type">int</span> n = widths.<span class="built_in">size</span>();</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                sum += widths[i];</span><br><span class="line">                mp[sum]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> maxCnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; [_, value] : mp) &#123;</span><br><span class="line">            maxCnt = <span class="built_in">max</span>(maxCnt, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> wall.<span class="built_in">size</span>() - maxCnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="3-4-åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾é‡å¤æ–‡ä»¶ï¼š609"><a href="#3-4-åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾é‡å¤æ–‡ä»¶ï¼š609" class="headerlink" title="3-4.åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾é‡å¤æ–‡ä»¶ï¼š609"></a>3-4.åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾é‡å¤æ–‡ä»¶ï¼š609</h2><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</p><pre><code>éº»çƒ¦ä¹‹å¤„åœ¨äºï¼Œä¸åªæ˜¯`&quot;root/a 1.txt(abcd)&quot;`ä¸€ç§æ ¼å¼ï¼Œè¿˜å¯èƒ½æ˜¯`&quot;root/a 1.txt(abcd) 2.txt(efgh)&quot;`ã€‚æ€è·¯ç®€å•ï¼Œä½†æ˜¯å†™èµ·æ¥å¤æ‚ã€‚</code></pre><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;string&gt;&gt; <span class="built_in">findDuplicate</span>(vector&lt;string&gt;&amp; paths) &#123;</span><br><span class="line">        unordered_map&lt;string, vector&lt;string&gt;&gt; t;</span><br><span class="line">        <span class="keyword">auto</span> help = [](string s) -&gt; pair&lt;string, string&gt; &#123;</span><br><span class="line">            string name, content;</span><br><span class="line">            <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(; i&lt;s.<span class="built_in">size</span>() &amp;&amp; s[i] != <span class="string">&#x27;(&#x27;</span>; i++)&#123;</span><br><span class="line">                name += s[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(i++; i&lt;s.<span class="built_in">size</span>() &amp;&amp; s[i] != <span class="string">&#x27;)&#x27;</span>; i++)&#123;</span><br><span class="line">                content += s[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> &#123;name, content&#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> path : paths)&#123;</span><br><span class="line">            string p;</span><br><span class="line">            <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(path[i] != <span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">                p += path[i];</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            string tmp;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> l=i, r=i+<span class="number">1</span>; r &lt; path.<span class="built_in">size</span>(); r++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(path[r] == <span class="string">&#x27; &#x27;</span> || r == path.<span class="built_in">size</span>() - <span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">auto</span> [name, content] = <span class="built_in">help</span>(path.<span class="built_in">substr</span>(l+<span class="number">1</span>, r-l));</span><br><span class="line">                    t[content].<span class="built_in">push_back</span>(p+<span class="string">&#x27;/&#x27;</span>+name);</span><br><span class="line">                    l = r;</span><br><span class="line">                    tmp.<span class="built_in">clear</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;vector&lt;string&gt;&gt; ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;[_, names] : t)&#123;</span><br><span class="line">            <span class="keyword">if</span>(names.<span class="built_in">size</span>() &gt; <span class="number">1</span>)</span><br><span class="line">                ans.<span class="built_in">emplace_back</span>(names);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šistringstream</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;string&gt;&gt; <span class="built_in">findDuplicate</span>(vector&lt;string&gt;&amp; paths) &#123;</span><br><span class="line">        vector&lt;vector&lt;string&gt;&gt; ans;</span><br><span class="line">        unordered_map&lt;string, vector&lt;string&gt;&gt; um;   <span class="comment">//æ–‡ä»¶å†…å®¹-&gt;æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> string&amp; path: paths) &#123;</span><br><span class="line">            <span class="function">istringstream <span class="title">iss</span><span class="params">(path)</span></span>;</span><br><span class="line">            string dir, tmp;</span><br><span class="line">            iss &gt;&gt; dir;</span><br><span class="line">            <span class="keyword">while</span> (iss &gt;&gt; tmp) &#123;</span><br><span class="line">                string key, val;</span><br><span class="line">                <span class="built_in">getKeyAndVal</span>(key, val, tmp, dir);</span><br><span class="line">                um[key].<span class="built_in">push_back</span>(val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; p: um) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p.second.<span class="built_in">size</span>() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                ans.<span class="built_in">push_back</span>(p.second);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getKeyAndVal</span><span class="params">(string&amp; key, string&amp; val, <span class="type">const</span> string&amp; tmp, <span class="type">const</span> string&amp; dir)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (tmp[i] != <span class="string">&#x27;(&#x27;</span>) ++i;</span><br><span class="line">        val = dir + <span class="string">&quot;/&quot;</span> + tmp.<span class="built_in">substr</span>(<span class="number">0</span>, i);</span><br><span class="line">        <span class="type">int</span> j = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (tmp[j] != <span class="string">&#x27;)&#x27;</span>) ++j;</span><br><span class="line">        key = tmp.<span class="built_in">substr</span>(i + <span class="number">1</span>, j - i - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å…³äºstringstream"><a href="#å…³äºstringstream" class="headerlink" title="å…³äºstringstream"></a>å…³äºstringstream</h2><pre><code>istringstreamæ˜¯ç»§æ‰¿äºistreamï¼Œostringstreamæ˜¯ç»§æ‰¿äºostreamï¼Œè€Œä»–ä»¬ä½¿ç”¨çš„ç¼“å†²åŒºç±»æ˜¯stringbufã€‚äºŒè€…è¯¦ç»†è¯´æ˜ï¼š[istringstreamåŠostringstreamè¶…è¯¦ç»†è¯´æ˜--çŸ¥ä¹](https://zhuanlan.zhihu.com/p/367869633)</code></pre><p><img src="https://s2.loli.net/2024/04/07/eMHJ6g4Wcxmld8u.png" alt=""></p><pre><code>stringstreamæ ·ä¾‹ï¼š[C++ä¸­stringstreamæ ·ä¾‹-åšå®¢å›­](https://www.cnblogs.com/zhang-qc/p/9048977.html)åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ`istringstream` ç”¨äºä»å­—ç¬¦ä¸²ä¸­æå–æ•°æ®ã€‚é’ˆå¯¹æ¯ä¸ª `path`ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ª `istringstream` å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ `iss &gt;&gt; dir` è¯­å¥æå–ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆç›®å½•ä¿¡æ¯ï¼‰ï¼Œä¹‹åä½¿ç”¨ `iss &gt;&gt; tmp` å¾ªç¯æå–åç»­çš„å­—ç¬¦ä¸²ã€‚</code></pre><p>ä¼˜åŠ¿ï¼š</p><ol><li><p><strong>æ–¹ä¾¿çš„è¾“å…¥æµæ“ä½œ</strong>ï¼š<code>istringstream</code> æä¾›äº†ä¸æ ‡å‡†è¾“å…¥è¾“å‡ºæµ <code>cin</code> å’Œ <code>cout</code> ç›¸ä¼¼çš„æ¥å£æ¥å¤„ç†å­—ç¬¦ä¸²ã€‚</p></li><li><p><strong>è½»é‡çº§</strong>ï¼š<code>istringstream</code> æ˜¯åŸºäºå†…å­˜çš„è¾“å…¥æµï¼Œå› æ­¤æ“ä½œé€Ÿåº¦å¿«ã€‚</p></li><li><p><strong>å¯é‡å¤ä½¿ç”¨</strong>ï¼šå¯ä»¥é‡å¤ä½¿ç”¨ <code>istringstream</code> å¯¹ä¸åŒçš„å­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œè€Œæ— éœ€é‡æ–°åˆå§‹åŒ–ã€‚</p></li><li><p><strong>æ•°æ®ç±»å‹è½¬æ¢</strong>ï¼š<code>istringstream</code> æä¾›äº†å¯ä»¥è½»æ¾å°†ä¸åŒç±»å‹æ•°æ®ä»å­—ç¬¦ä¸²ä¸­æå–å‡ºæ¥çš„æ–¹æ³•ã€‚</p></li><li><p><strong>é€‚ç”¨äºåˆ†è¯</strong>ï¼šé€‚ç”¨äºä»è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æå–å•è¯æˆ–æ•°æ®ã€‚å¯ä»¥ä½¿ç”¨ <code>&gt;&gt;</code> æ“ä½œç¬¦æ¥<u>æŒ‰ç©ºæ ¼ç­‰åˆ†éš”ç¬¦å°†å­—ç¬¦ä¸²åˆ†è¯</u>ã€‚</p><p> æ€»ä¹‹ï¼Œ<code>istringstream</code> æä¾›äº†ä¸€ç§æ–¹ä¾¿ã€é«˜æ•ˆçš„æ–¹å¼æ¥å¤„ç†ä»å­—ç¬¦ä¸²ä¸­æå–æ•°æ®ï¼Œä½¿å¾—å¯¹æ–‡æœ¬è¿›è¡Œè§£æå’Œå¤„ç†å˜å¾—æ›´åŠ å®¹æ˜“ã€‚åœ¨éœ€è¦å°†å­—ç¬¦ä¸²æŒ‰ç…§ç©ºæ ¼åˆ†å‰²ä¸ºå„ä¸ªéƒ¨åˆ†å¹¶è®°å½•ä¸‹å¯¹åº”å€¼æ—¶ï¼Œå¯ä»¥èµ·åˆ°ç±»ä¼¼å…¶ä»–è¯­è¨€ä¸­<code>split(&#39; &#39;)</code>çš„ä½œç”¨ã€‚</p></li></ol><h2 id="3-5-å››æ•°ç›¸åŠ IIï¼š454"><a href="#3-5-å››æ•°ç›¸åŠ IIï¼š454" class="headerlink" title="3-5.å››æ•°ç›¸åŠ IIï¼š454"></a>3-5.å››æ•°ç›¸åŠ IIï¼š454</h2><p>ğŸ’¬éš¾åœ¨æ€è·¯: åˆ†æ²»+å“ˆå¸Œè¡¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">fourSumCount</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums1, vector&lt;<span class="type">int</span>&gt;&amp; nums2, vector&lt;<span class="type">int</span>&gt;&amp; nums3, vector&lt;<span class="type">int</span>&gt;&amp; nums4)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp; <span class="comment">//ç´¯åŠ å’Œ-&gt;ç»„åˆæ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>&amp; a : nums1) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span>&amp; b : nums2) &#123;</span><br><span class="line">                mp[a + b]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>&amp; c : nums3) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span>&amp; d : nums4) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mp.<span class="built_in">count</span>(-c - d)) &#123;</span><br><span class="line">                    ans += mp[-c - d]; <span class="comment">// ä¸èƒ½åªåŠ ä¸€æ¬¡ï¼Œå¯èƒ½å¤šç§æƒ…å†µ</span></span><br><span class="line">                    <span class="comment">// åŒæ—¶ä¸åº”å†æ”¹å˜mp[-c-d]çš„å€¼</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><pre><code>ä¸‰æ•°ä¹‹å’Œï¼š15,å››æ•°ä¹‹å’Œï¼š18ã€‚è¿™ä¸¤é¢˜æœ€ä¼˜è§£ä¸ºåŒæŒ‡é’ˆï¼Œè€Œä¸æ˜¯å“ˆå¸Œè¡¨ã€‚æœ‰æ—¶å€™å“ˆå¸Œè¡¨æ—¶ç©ºå¼€é”€å¤ªå¤§æ—¶ï¼ŒåŒæŒ‡é’ˆå¾€å¾€èƒ½å¾ˆå¥½åœ°è§£å†³ã€‚</code></pre><h2 id="3-6-å¤šæ•°å…ƒç´ ï¼š169"><a href="#3-6-å¤šæ•°å…ƒç´ ï¼š169" class="headerlink" title="3-6.å¤šæ•°å…ƒç´ ï¼š169"></a>3-6.å¤šæ•°å…ƒç´ ï¼š169</h2><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨(27ms,27.3MB)âœ…</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; counts;</span><br><span class="line">        <span class="type">int</span> majority = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            ++counts[num];</span><br><span class="line">            <span class="keyword">if</span> (counts[num] &gt; cnt) &#123;</span><br><span class="line">                majority = num;</span><br><span class="line">                cnt = counts[num];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> majority;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ’åº+å–ä¼—æ•°(20ms,27.2MB)</p><blockquote><p>è¿™é‡Œçš„â€å¤šæ•°å…ƒç´ â€å‡ºç°æ¬¡æ•°è¶…è¿‡æ€»æ¬¡æ•°çš„ä¸€åŠï¼Œæ‰€ä»¥å¿…å®šæ˜¯ä¼—æ•°ï¼Œå¹¶ä¸”æ’åºåä½äºä¸­é—´çš„æ•°ä¸€å®šæ˜¯ä¼—æ•°ï¼ˆæ•°å­¦æ€ç»´ï¼‰ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> nums[nums.<span class="built_in">size</span>() / <span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è™½ç„¶æ—¶é—´å¤æ‚åº¦æ¯”æ³•ä¸€é«˜ï¼Œä½†å®é™…è¿è¡Œæ—¶é—´ä¼šæ›´å°ã€‚ä½¿ç”¨å †æ’åºå¯ä»¥è¿›ä¸€æ­¥å‡å°ç©ºé—´å¼€é”€ã€‚</p><p>æ³•ä¸‰ï¼šéšæœºæ•°(äº†è§£)</p><p>æœ€åæ—¶é—´å¤æ‚åº¦ä¸º$O(\infty)$ï¼Œå¯èƒ½ä¸€ç›´æ‰¾ä¸åˆ°ä¼—æ•°ã€‚ç”¨<code>rand()</code>ç”Ÿæˆéšæœºæ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">int</span> candidate = nums[<span class="built_in">rand</span>() % nums.<span class="built_in">size</span>()];</span><br><span class="line">            <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> num : nums)</span><br><span class="line">                <span class="keyword">if</span> (num == candidate)</span><br><span class="line">                    ++count;</span><br><span class="line">            <span class="keyword">if</span> (count &gt; nums.<span class="built_in">size</span>() / <span class="number">2</span>)</span><br><span class="line">                <span class="keyword">return</span> candidate;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•å››ï¼šåˆ†æ²»(24ms,26MB)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">count_in_range</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = lo; i &lt;= hi; ++i)</span><br><span class="line">            <span class="keyword">if</span> (nums[i] == target)</span><br><span class="line">                ++count;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majority_element_rec</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (lo == hi)</span><br><span class="line">            <span class="keyword">return</span> nums[lo];</span><br><span class="line">        <span class="type">int</span> mid = (lo + hi) / <span class="number">2</span>;</span><br><span class="line">        <span class="type">int</span> left_majority = <span class="built_in">majority_element_rec</span>(nums, lo, mid);</span><br><span class="line">        <span class="type">int</span> right_majority = <span class="built_in">majority_element_rec</span>(nums, mid + <span class="number">1</span>, hi);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">count_in_range</span>(nums, left_majority, lo, hi) &gt; (hi - lo + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> left_majority;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">count_in_range</span>(nums, right_majority, lo, hi) &gt; (hi - lo + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> right_majority;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">majority_element_rec</span>(nums, <span class="number">0</span>, nums.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äº”ï¼šBoyer-MooreæŠ•ç¥¨ç®—æ³•(17ms,26.1MB)âœ…</p><p>è¯¦è§<a href="https://leetcode.cn/problems/majority-element/solutions/1/169-duo-shu-yuan-su-mo-er-tou-piao-qing-ledrh/">æœ¬é¢˜æ‘©å°”æŠ•ç¥¨æ¸…æ™°å›¾è§£</a>ã€‚æ ¸å¿ƒæ€æƒ³ä¸ºå¯¹æ‹¼æ¶ˆè€—ï¼Œå¦‚æœå…ƒç´ å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ä¸€åŠï¼Œåˆ™è¯¥æ–¹æ³•å¤±æ•ˆï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°å…¶æ³›åŒ–ç‰ˆâ€”â€”â€”Misra-Griesç®—æ³•ã€‚</p><p><a href="https://www.zhihu.com/question/49973163/answer/3202021480">å¦‚ä½•ç†è§£æ‘©å°”æŠ•ç¥¨ç®—æ³•ï¼Ÿâ€”åŠ›æ‰£</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="number">0</span>, votes = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums)&#123;</span><br><span class="line">            <span class="keyword">if</span> (votes == <span class="number">0</span>) x = num;</span><br><span class="line">            votes += num == x ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ‹“å±•-å¤šæ•°å…ƒç´ IIï¼š229"><a href="#æ‹“å±•-å¤šæ•°å…ƒç´ IIï¼š229" class="headerlink" title="æ‹“å±•.å¤šæ•°å…ƒç´ IIï¼š229"></a>æ‹“å±•.å¤šæ•°å…ƒç´ IIï¼š229</h3><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; counts;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : nums) &#123;</span><br><span class="line">            counts[num]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; cnt : counts) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cnt.second &gt; n / <span class="number">3</span>) &#123;</span><br><span class="line">                ans.<span class="built_in">push_back</span>(cnt.first);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ‘©å°”æŠ•ç¥¨æ³•âœ…</p><blockquote><p>å‡ºç°æ¬¡æ•°è¶…è¿‡$\lfloor\frac{n}{2}\rfloor$çš„æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªï¼Œå‡ºç°æ¬¡æ•°è¶…è¿‡$\lfloor\frac{n}{3}\rfloor$çš„æœ€å¤šåªèƒ½æœ‰ä¸¤ä¸ªã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="comment">// ä¸´æ—¶å…ƒç´ 1å’Œ2ï¼Œå¯¹åº”æŠ•ç¥¨votes1å’Œvotes2</span></span><br><span class="line">        <span class="type">int</span> element1 = <span class="number">0</span>, element2 = <span class="number">0</span>, votes1 = <span class="number">0</span>, votes2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : nums) &#123;</span><br><span class="line">            <span class="keyword">if</span> (votes1 &gt; <span class="number">0</span> &amp;&amp; num == element1) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœè¯¥å…ƒç´ ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™è®¡æ•°åŠ 1</span></span><br><span class="line">                votes1++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (votes2 &amp;&amp; num == element2) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœè¯¥å…ƒç´ ä¸ºç¬¬äºŒä¸ªå…ƒç´ ï¼Œåˆ™è®¡æ•°åŠ 1</span></span><br><span class="line">                votes2++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (votes1 == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// é€‰æ‹©ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">                element1 = num;</span><br><span class="line">                votes1++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (votes2 == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// é€‰æ‹©ç¬¬äºŒä¸ªå…ƒç´ </span></span><br><span class="line">                element2 = num;</span><br><span class="line">                votes2++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœä¸‰ä¸ªå…ƒç´ å‡ä¸ç›¸åŒï¼Œåˆ™ç›¸äº’æŠµæ¶ˆ1æ¬¡</span></span><br><span class="line">                votes1--;</span><br><span class="line">                votes2--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> cnt1 = <span class="number">0</span>, cnt2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : nums) &#123;</span><br><span class="line">            <span class="keyword">if</span> (votes1 &gt; <span class="number">0</span> &amp;&amp; num == element1) &#123;</span><br><span class="line">                cnt1++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (votes2 &gt; <span class="number">0</span> &amp;&amp; num == element2) &#123;</span><br><span class="line">                cnt2++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ£€æµ‹å…ƒç´ å‡ºç°çš„æ¬¡æ•°æ˜¯å¦æ»¡è¶³è¦æ±‚,å› ä¸ºä¸ä¸€å®šæ˜¯å­˜åœ¨ä¸¤ä¸ªæ•°</span></span><br><span class="line">        <span class="keyword">if</span> (votes1 &gt; <span class="number">0</span> &amp;&amp; cnt1 &gt; n / <span class="number">3</span>) &#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(element1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (votes2 &gt; <span class="number">0</span> &amp;&amp; cnt2 &gt; n / <span class="number">3</span>) &#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(element2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åŒç†ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ä»£ç è§£å†³$\lfloor\frac{n}{m}\rfloor$çš„æƒ…å†µï¼Œåªéœ€è¦è®©å¤‡é€‰elementå’Œvotesçš„æ•°ç›®ä¸º$m-1$å³å¯ã€‚</p><hr><h1 id="4-å“ˆå¸Œè¡¨ä¸å‰ç¼€å’Œ-éš¾ç†è§£"><a href="#4-å“ˆå¸Œè¡¨ä¸å‰ç¼€å’Œ-éš¾ç†è§£" class="headerlink" title="4.å“ˆå¸Œè¡¨ä¸å‰ç¼€å’Œ(éš¾ç†è§£)"></a>4.å“ˆå¸Œè¡¨ä¸å‰ç¼€å’Œ(éš¾ç†è§£)</h1><p>å‰ç¼€æ€æƒ³æ¨èæ–‡ç« <a href="https://leetcode.cn/problems/continuous-subarray-sum/solutions/562196/de-liao-wo-ba-qian-zhui-he-miao-de-gan-g-c8kp/">ã€åŠ¨ç”»æ¨¡æ‹Ÿã€‘ä¸€æ–‡ç§’æ€ä¸ƒé“é¢˜â€”åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a>,åŒ…æ‹¬å‰ç¼€å’Œ/å¥‡æ•°/ç§¯â€¦</p><p><img src="https://s2.loli.net/2024/04/13/3PrTOI5fg9Czw6J.png" alt=""></p><h2 id="4-1-å’Œä¸ºKçš„å­æ•°ç»„ï¼š560"><a href="#4-1-å’Œä¸ºKçš„å­æ•°ç»„ï¼š560" class="headerlink" title="4-1.å’Œä¸ºKçš„å­æ•°ç»„ï¼š560"></a>4-1.å’Œä¸ºKçš„å­æ•°ç»„ï¼š560</h2><p>æ³•ä¸€ï¼šæšä¸¾(è¶…æ—¶)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">subarraySum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> right = <span class="number">0</span>; right &lt; nums.<span class="built_in">size</span>(); right++) &#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> left = right; left &gt;= <span class="number">0</span>; left--) &#123;</span><br><span class="line">                sum += nums[left];</span><br><span class="line">                <span class="keyword">if</span> (sum == k) &#123;</span><br><span class="line">                    ans++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>è¯¥é¢˜ç”¨æ»‘åŠ¨çª—å£éš¾ä»¥å®ç°ï¼Œå› ä¸ºå­˜åœ¨è´Ÿæ•°ã€‚æ¯”å¦‚[-2,-1,0,1,2]ï¼Œk=0ã€‚å•çº¯çš„æ»‘åŠ¨çª—å£ä¼šä½¿å¾—æ¼æ‰[-1,0,1]ã€‚è½¬è€Œç”¨åŠ¨æ€è§„åˆ’ï¼Œåˆå®¹æ˜“å¯¼è‡´å†…å­˜æº¢å‡ºã€‚</p></blockquote><p>æ³•äºŒï¼šå‰ç¼€å’Œ+å“ˆå¸Œè¡¨ä¼˜åŒ–</p><p><img src="https://s2.loli.net/2024/04/13/m1bqx9fNwlX4Ku8.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">subarraySum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;<span class="comment">//å‰ç¼€å’Œï¼Œå‡ºç°æ¬¡æ•°</span></span><br><span class="line">        mp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> pre = <span class="number">0</span>, ans = <span class="number">0</span>; <span class="comment">// preè®°å½•å‰ç¼€å’Œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : nums) &#123;</span><br><span class="line">            pre += num;</span><br><span class="line">            <span class="keyword">if</span> (mp.<span class="built_in">find</span>(pre - k) != mp.<span class="built_in">end</span>()) &#123;</span><br><span class="line">                ans += mp[pre - k];</span><br><span class="line">            &#125;</span><br><span class="line">            mp[pre]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ¨å¯¼å’Œå›¾è§£è¯¦è§å®˜æ–¹é¢˜è§£ã€‚</p><h2 id="4-2-è¿ç»­çš„å­æ•°ç»„å’Œï¼š523"><a href="#4-2-è¿ç»­çš„å­æ•°ç»„å’Œï¼š523" class="headerlink" title="4-2.è¿ç»­çš„å­æ•°ç»„å’Œï¼š523"></a>4-2.è¿ç»­çš„å­æ•°ç»„å’Œï¼š523</h2><p>å‰ç¼€å’Œï¼‹å“ˆå¸Œè¡¨,æœ¬é¢˜ç»¼åˆæ€§è¾ƒå¼ºã€‚</p><p>è¯¦ç»†è§£ç­”<a href="https://leetcode.cn/problems/continuous-subarray-sum/solutions/808246/gong-shui-san-xie-tuo-zhan-wei-qiu-fang-1juse/">ã€å®«æ°´ä¸‰å¶ã€‘æ‹“å±•åˆ°æ±‚æ–¹æ¡ˆæ•°é—®é¢˜â€”LeetCode</a></p><p><img src="https://s2.loli.net/2024/04/13/8kMtUX4nupvZQ6z.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">checkSubarraySum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;<span class="comment">//&lt;å‰ç¼€å’Œ%k,ç´¢å¼•&gt;</span></span><br><span class="line">        mp[<span class="number">0</span>] = <span class="number">-1</span>;<span class="comment">//å› ä¸ºå…ƒç´ å‡ä¸ºéè´Ÿæ•°ï¼Œæ‰€ä»¥å‰ç¼€å’Œä¸å¯èƒ½ä¸º0ï¼Œå³å¯¹åº”ç´¢å¼•ä¸º-1æ— æ•ˆå€¼</span></span><br><span class="line">        <span class="type">int</span> presum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            presum = (presum + nums[i]) % k;</span><br><span class="line">            <span class="keyword">if</span> (mp.<span class="built_in">count</span>(presum)) &#123;</span><br><span class="line">                <span class="type">int</span> preIdx = mp[presum];</span><br><span class="line">                <span class="keyword">if</span> (i - preIdx &gt;= <span class="number">2</span>) &#123;<span class="comment">//å­æ•°ç»„é•¿åº¦è‡³å°‘ä¸º2</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mp[presum] = i;<span class="comment">//æ³¨æ„è®°å½•çš„æ˜¯ç´¢å¼•è€Œä¸æ˜¯æ¬¡æ•°ï¼Œå› ä¸ºéœ€è¦æ¯”è¾ƒi-preIdxæ˜¯å¦&gt;=2</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ‹“å±•ï¼šå¦‚æœè¯´è¿˜è¦è®°å½•ä¸‹å­æ•°ç»„é•¿åº¦ï¼Œå¯ä»¥ä½¿ç”¨<code>unordered_map&lt;int,pair&lt;int,int&gt;&gt;mp;//&lt;å‰ç¼€å’Œ%k,pair&lt;ç´¢å¼•ï¼Œé•¿åº¦&gt;&gt;</code>ã€‚</p><h2 id="4-3-è¿ç»­æ•°ç»„ï¼š525"><a href="#4-3-è¿ç»­æ•°ç»„ï¼š525" class="headerlink" title="4-3.è¿ç»­æ•°ç»„ï¼š525"></a>4-3.è¿ç»­æ•°ç»„ï¼š525</h2><p>å‰ç¼€å’Œ+å“ˆå¸Œè¡¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findMaxLength</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line">        mp[<span class="number">0</span>] = <span class="number">-1</span>;                 <span class="comment">// è®°å½•ç´¢å¼•è€Œéæ¬¡æ•°</span></span><br><span class="line">        <span class="type">int</span> presum = <span class="number">0</span>, maxLen = <span class="number">0</span>; <span class="comment">// presumè®°å½•0/1äº¤æ›¿çš„é•¿åº¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="comment">// åœ¨è¿™é‡Œå¯ä»¥å°†1è§†ä½œ1,0è§†ä½œ-1ï¼Œäº¤æ›¿çš„å’Œå°±æ˜¯presumå‰ç¼€å’Œ</span></span><br><span class="line">            <span class="keyword">if</span> (nums[i]) &#123;</span><br><span class="line">                presum++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                presum--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// é—®é¢˜è½¬åŒ–ä¸ºï¼šå¦‚ä½•æ±‚å¾—æœ€é•¿ä¸€æ®µåŒºé—´å’Œä¸º0çš„å­æ•°ç»„,æ‰€ä»¥è¿™é‡Œçš„k==0</span></span><br><span class="line">            <span class="keyword">if</span> (mp.<span class="built_in">count</span>(presum)) &#123;</span><br><span class="line">                <span class="type">int</span> preIdx = mp[presum];</span><br><span class="line">                maxLen = <span class="built_in">max</span>(maxLen, i - preIdx);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mp[presum] = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxLen;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å“ˆå¸Œè¡¨éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="å“ˆå¸Œè¡¨" scheme="https://sumikiru.top/tags/%E5%93%88%E5%B8%8C%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>6.0å“ˆå¸Œè¡¨ç¯‡</title>
    <link href="https://sumikiru.top/posts/5d437c4b.html"/>
    <id>https://sumikiru.top/posts/5d437c4b.html</id>
    <published>2024-06-27T17:08:19.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å…³äºå“ˆå¸Œè¡¨"><a href="#å…³äºå“ˆå¸Œè¡¨" class="headerlink" title="å…³äºå“ˆå¸Œè¡¨"></a>å…³äºå“ˆå¸Œè¡¨</h1><p><a href="https://zhuanlan.zhihu.com/p/535427115">ä¸€æ–‡çœ‹æ‡‚ä½¿ç”¨C++ STL ä¸­çš„å“ˆå¸Œè¡¨â€”çŸ¥ä¹</a></p><h1 id="1-å“ˆå¸Œè¡¨çš„æŸ¥æ‰¾ã€æ’å…¥åŠåˆ é™¤"><a href="#1-å“ˆå¸Œè¡¨çš„æŸ¥æ‰¾ã€æ’å…¥åŠåˆ é™¤" class="headerlink" title="1.å“ˆå¸Œè¡¨çš„æŸ¥æ‰¾ã€æ’å…¥åŠåˆ é™¤"></a>1.å“ˆå¸Œè¡¨çš„æŸ¥æ‰¾ã€æ’å…¥åŠåˆ é™¤</h1><h2 id="1-1-å­˜åœ¨é‡å¤å…ƒç´ ï¼š217"><a href="#1-1-å­˜åœ¨é‡å¤å…ƒç´ ï¼š217" class="headerlink" title="1-1.å­˜åœ¨é‡å¤å…ƒç´ ï¼š217"></a>1-1.å­˜åœ¨é‡å¤å…ƒç´ ï¼š217</h2><p>æ³•ä¸€ï¼šæ’åº</p><p><code>sort()</code>çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(NlogN)$,ç©ºé—´å¤æ‚åº¦ä¸º$O(logN)$ï¼Œå› ä¸ºæ’åºè¿‡ç¨‹ä¸­éœ€è¦é€’å½’è°ƒç”¨æ ˆç©ºé—´ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">containsDuplicate</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] == nums[i + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šå“ˆå¸Œè¡¨</p><p>æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦å‡ä¸º$O(N)$ï¼Œsetçš„find()æ—¶é—´å¤æ‚åº¦æ˜¯$O(1)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">containsDuplicate</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x : nums) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s.<span class="built_in">find</span>(x) != s.<span class="built_in">end</span>()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            s.<span class="built_in">insert</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>â€‹    ä½†è¯¥é¢˜å®é™…ä¸Šæ’åºæ¯”å“ˆå¸Œè¡¨çš„æ‰§è¡Œç”¨æ—¶å’Œæ¶ˆè€—å†…å­˜æ›´å°ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸æ˜¯å”¯ä¸€ã€‚å“ˆå¸Œè¡¨è¦è®¡ç®—å“ˆå¸Œå€¼ç­‰ï¼Œå¯ä»¥ç†è§£å“ˆå¸Œè¡¨æ—¶é—´å¤æ‚åº¦å¸¸æ•°é¡¹æ¯”è¾ƒå¤§ã€‚å¸¸æ•°ä¸ä¸€æ ·ï¼Œhashsetçš„å¸¸æ•°å¼€é”€å¤§ï¼Œæ‰€ä»¥å¯¹äºéå¤§é‡çš„æ•°æ®æ¥è¯´ï¼Œå¸¸æ•°æ•ˆåº”è¦†ç›–äº†æ—¶é—´å¤æ‚åº¦çš„å·®è·ã€‚å¦‚æœæŠŠæ•°æ®é‡æ”¾å¤§ï¼Œé‚£ä¹ˆéšç€æ•°æ®é‡çš„å¢åŠ ï¼Œhashsetæ–¹å¼çš„æ—¶é—´æ˜¯çº¿æ€§å¢åŠ ï¼Œsortæ˜¯éçº¿æ€§å¢åŠ ï¼Œåˆ°ä¸€ä¸ªé˜ˆå€¼ï¼Œåˆ™hashsetçš„ä½æ—¶é—´å¤æ‚åº¦çš„ä¼˜åŠ¿æ‰èƒ½å‘æŒ¥å‡ºæ¥ã€‚</p><h2 id="1-2-ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†ï¼š349"><a href="#1-2-ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†ï¼š349" class="headerlink" title="1-2.ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†ï¼š349"></a>1-2.ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†ï¼š349</h2><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</p><blockquote><p>å¦‚æœä½¿ç”¨å“ˆå¸Œé›†åˆå­˜å‚¨å…ƒç´ ï¼Œåˆ™å¯ä»¥åœ¨ $O(1)$ çš„æ—¶é—´å†…åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ï¼Œä»è€Œé™ä½æ—¶é—´å¤æ‚åº¦ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">getSets</span><span class="params">(unordered_set&lt;<span class="type">int</span>&gt;&amp; set1, unordered_set&lt;<span class="type">int</span>&gt;&amp; set2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (set1.<span class="built_in">size</span>() &lt; set2.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getSets</span>(set2, set1);</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : set1) &#123;</span><br><span class="line">            <span class="keyword">if</span> (set2.<span class="built_in">count</span>(num)) &#123; <span class="comment">// set1ä¸­çš„numï¼Œset2ä¹Ÿæœ‰</span></span><br><span class="line">                ans.<span class="built_in">push_back</span>(num);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">intersection</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums1, vector&lt;<span class="type">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="type">int</span>&gt; set1, set2;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>&amp; x : nums1) &#123;</span><br><span class="line">            set1.<span class="built_in">insert</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>&amp; x : nums2) &#123;</span><br><span class="line">            set2.<span class="built_in">insert</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getSets</span>(set1, set2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ’åº+åŒæŒ‡é’ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">intersection</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums1, vector&lt;<span class="type">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums1.<span class="built_in">begin</span>(), nums1.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">sort</span>(nums2.<span class="built_in">begin</span>(), nums2.<span class="built_in">end</span>());</span><br><span class="line">        <span class="type">int</span> index1 = <span class="number">0</span>, index2 = <span class="number">0</span>;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">        <span class="keyword">while</span> (index1 &lt; nums1.<span class="built_in">size</span>() &amp;&amp; index2 &lt; nums2.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> num1 = nums1[index1], num2 = nums2[index2];</span><br><span class="line">            <span class="keyword">if</span> (num1 == num2) &#123;</span><br><span class="line">                <span class="comment">// ç¡®ä¿åŠ å…¥çš„å…ƒç´ æ˜¯å”¯ä¸€çš„</span></span><br><span class="line">                <span class="keyword">if</span> (!ans.<span class="built_in">size</span>() || num1 != ans.<span class="built_in">back</span>()) &#123;</span><br><span class="line">                    ans.<span class="built_in">emplace_back</span>(num1);</span><br><span class="line">                &#125;</span><br><span class="line">                ++index1;</span><br><span class="line">                ++index2;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num1 &lt; num2) &#123;</span><br><span class="line">                ++index1;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ++index2;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•ä¸‰ï¼šç›´æ¥ä½¿ç”¨set,çœå»æ’åºçš„æ­¥éª¤ã€‚æ•ˆç‡å’Œæ³•ä¸€å·®ä¸å¤š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">intersection</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums1, vector&lt;<span class="type">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        set&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : nums1) &#123;</span><br><span class="line">            s.<span class="built_in">insert</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        set&lt;<span class="type">int</span>&gt; intersectionSet;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : nums2) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s.<span class="built_in">find</span>(num) != s.<span class="built_in">end</span>()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (intersectionSet.<span class="built_in">find</span>(num) == intersectionSet.<span class="built_in">end</span>()) &#123; </span><br><span class="line">                    intersectionSet.<span class="built_in">insert</span>(num);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">        <span class="keyword">for</span> (set&lt;<span class="type">int</span>&gt;::iterator it = intersectionSet.<span class="built_in">begin</span>();</span><br><span class="line">             it != intersectionSet.<span class="built_in">end</span>(); it++) &#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(*it);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="1-3-æœ€é•¿è¿ç»­åºåˆ—ï¼š128"><a href="#1-3-æœ€é•¿è¿ç»­åºåˆ—ï¼š128" class="headerlink" title="1-3.æœ€é•¿è¿ç»­åºåˆ—ï¼š128"></a>1-3.æœ€é•¿è¿ç»­åºåˆ—ï¼š128</h2><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨(è¯¥é¢˜ä¹Ÿå¯ä»¥ç›´æ¥ç”¨set)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">longestConsecutive</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>&amp; num : nums) &#123;</span><br><span class="line">            s.<span class="built_in">insert</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; num : s) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!s.<span class="built_in">count</span>(num - <span class="number">1</span>)) &#123; <span class="comment">// ä¸å­˜åœ¨numçš„å‰ä¸€ä¸ªæ•°å­—ï¼Œé‡ç½®</span></span><br><span class="line">                <span class="type">int</span> currentNum = num, currentCount = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (s.<span class="built_in">count</span>(currentNum + <span class="number">1</span>)) &#123;</span><br><span class="line">                    currentCount++;</span><br><span class="line">                    currentNum++;</span><br><span class="line">                &#125;</span><br><span class="line">                count = <span class="built_in">max</span>(count, currentCount);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><pre><code>æ³¨æ„ç¬¬9è¡Œï¼Œå¦‚æœå†™ä½œ`int&amp; num:s`åˆ™ä¼šæŠ¥é”™ï¼Œè€Œä½¿ç”¨`const int&amp; num:s`/`auto&amp; num:s`/`const auto&amp; num:s`/`auto&amp;&amp; num:s`åˆ™ä¸ä¼šæŠ¥é”™ã€‚å› ä¸ºå‰è€…å°†å°è¯•ä»¥éconstå¼•ç”¨çš„æ–¹å¼è®¿é—®å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œè€Œunordered_setä¸­çš„å…ƒç´ æ˜¯&lt;mark&gt;åªè¯»&lt;/mark&gt;çš„ã€‚Q:ä½†æ˜¯ä¸ºä»€ä¹ˆ`int&amp; num:s`ä¸æ­£ç¡®ï¼Œè€Œ`auto&amp; num:s`å°±å¯ä»¥å‘¢ï¼ŸA:å¯å‚è§[C++ä¸­çš„autoå…³é”®å­—](https://zhuanlan.zhihu.com/p/390608866)ï¼Œè¿™é‡Œautoå°±ç›¸å½“äºTï¼Œè€Œè¿™é‡ŒTç›¸å½“äºæ˜¯const int.</code></pre><h2 id="1-4-å¿«ä¹æ•°ï¼š202"><a href="#1-4-å¿«ä¹æ•°ï¼š202" class="headerlink" title="1-4.å¿«ä¹æ•°ï¼š202"></a>1-4.å¿«ä¹æ•°ï¼š202</h2><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</p><p>éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šå¦‚ä½•è§£å†³æ— é™å¾ªç¯è¿™ä¸€é—®é¢˜ã€‚è®°å½•ä¸‹æ¯æ¬¡çš„å¹³æ–¹å’Œï¼Œå½“å‡ºç°é‡å¤åˆ™è¯´æ˜è¿›å…¥æ— é™å¾ªç¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isHappy</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="type">int</span>&gt; numbers;</span><br><span class="line">        <span class="keyword">while</span> (!numbers.<span class="built_in">count</span>(n)) &#123; <span class="comment">// næ²¡æœ‰å‡ºç°åœ¨å¹³æ–¹å’Œè®°å½•ä¸­è¿‡</span></span><br><span class="line">            <span class="type">int</span> num = n;</span><br><span class="line">            numbers.<span class="built_in">insert</span>(num);</span><br><span class="line">            n = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (num) &#123;</span><br><span class="line">                <span class="type">int</span> i = num % <span class="number">10</span>;</span><br><span class="line">                num /= <span class="number">10</span>;</span><br><span class="line">                n += i * i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n == <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆï¼ˆç©ºé—´å¤æ‚åº¦æ›´ä½ï¼Œæ—¶é—´å¤æ‚åº¦ç›¸åŒï¼Œä½†æ˜¯å®é™…é€Ÿåº¦æ›´æ…¢ä¸€ç‚¹ï¼‰</p><blockquote><p>æ¯æ¬¡è·å–ä¸‹ä¸€ä¸ªå¹³æ–¹å’Œçš„æ“ä½œï¼Œå¯ä»¥è®¤ä¸ºæ˜¯åœ¨æ„é€ ä¸€ä¸ªéšå¼é“¾è¡¨çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚æ£€æµ‹æ˜¯å¦è¿›å…¥å¾ªç¯ï¼Œç›¸å½“äºæ£€æµ‹ä¸€ä¸ªé“¾è¡¨æ˜¯å¦æœ‰ç¯ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨Floydå¾ªç¯æŸ¥æ‰¾ç®—æ³•ã€‚</p></blockquote><p>slowæ¯æ¬¡å‰è¿›ä¸€ä¸ªèŠ‚ç‚¹ï¼Œfastæ¯æ¬¡å‰è¿›ä¸¤æ¬¡ï¼Œè¿™æ ·å®ƒä»¬æœ€ç»ˆå°†åœ¨å¾ªç¯ä¸­ç›¸é‡ï¼Œwhileå¾ªç¯ä¸­æ­¢æ¡ä»¶å…¶ä¸€å³ä¸º<code>slow==fast</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getNext</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n) &#123;</span><br><span class="line">            <span class="type">int</span> i = n % <span class="number">10</span>;</span><br><span class="line">            n /= <span class="number">10</span>;</span><br><span class="line">            sum += i * i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isHappy</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> slow = n, fast = <span class="built_in">getNext</span>(n);</span><br><span class="line">        <span class="keyword">while</span> (fast != <span class="number">1</span> &amp;&amp; slow != fast) &#123;</span><br><span class="line">            slow = <span class="built_in">getNext</span>(slow);</span><br><span class="line">            fast = <span class="built_in">getNext</span>(<span class="built_in">getNext</span>(fast));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fast == <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="1-5-é”®ç›˜è¡Œï¼š500"><a href="#1-5-é”®ç›˜è¡Œï¼š500" class="headerlink" title="1-5.é”®ç›˜è¡Œï¼š500"></a>1-5.é”®ç›˜è¡Œï¼š500</h2><p>æ³•ä¸€ï¼šéå†</p><p>é”®ç›˜å­—æ¯è½¬æ¢ä¸ºè¡Œå·ã€‚2ms,7.82MBã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">findWords</span><span class="params">(vector&lt;string&gt;&amp; words)</span> </span>&#123;</span><br><span class="line">        vector&lt;string&gt; ans;</span><br><span class="line">        string rowIdx = <span class="string">&quot;12210111011122000010020202&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; word : words) &#123;</span><br><span class="line">            <span class="type">bool</span> isValid = <span class="literal">true</span>;</span><br><span class="line">            <span class="type">char</span> idx = rowIdx[<span class="built_in">tolower</span>(word[<span class="number">0</span>]) - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; word.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span>(rowIdx[<span class="built_in">tolower</span>(word[i]) - <span class="string">&#x27;a&#x27;</span>] != idx) &#123;</span><br><span class="line">                    isValid = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (isValid) &#123;</span><br><span class="line">                ans.<span class="built_in">emplace_back</span>(word);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šå“ˆå¸Œè¡¨</p><p>4ms,8MB</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">findWords</span><span class="params">(vector&lt;string&gt;&amp; words)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="type">char</span>&gt; s&#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>&#125;;</span><br><span class="line">        unordered_set&lt;<span class="type">char</span>&gt; s2&#123;<span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>&#125;;</span><br><span class="line">        unordered_set&lt;<span class="type">char</span>&gt; s3&#123;<span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;m&#x27;</span>&#125;;</span><br><span class="line">        <span class="type">int</span> n = words.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;string&gt; ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; word : words) &#123;</span><br><span class="line">            <span class="type">bool</span> inS1 = <span class="literal">true</span>, inS2 = <span class="literal">true</span>, inS3 = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; c : word) &#123;</span><br><span class="line">                <span class="type">char</span> ch = <span class="built_in">tolower</span>(c); <span class="comment">// è®°å¾—è½¬æ¢æˆå°å†™,æ³¨æ„tolower()è¿”å›çš„æ˜¯intå€¼</span></span><br><span class="line">                <span class="comment">// æˆ–è€…å†™ä½œauto ch = char(tolower(c));</span></span><br><span class="line">                <span class="keyword">if</span> (inS1 &amp;&amp; (s.<span class="built_in">find</span>(ch) == s.<span class="built_in">end</span>())) &#123;</span><br><span class="line">                    inS1 = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (inS2 &amp;&amp; (s2.<span class="built_in">find</span>(ch) == s2.<span class="built_in">end</span>())) &#123;</span><br><span class="line">                    inS2 = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (inS3 &amp;&amp; (s3.<span class="built_in">find</span>(ch) == s3.<span class="built_in">end</span>())) &#123;</span><br><span class="line">                    inS3 = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (inS1 || inS2 || inS3) &#123;</span><br><span class="line">                ans.<span class="built_in">push_back</span>(word);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•ä¸‰ï¼šæ­£åˆ™</p><p>41ms,20.8MB</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(string&amp; word)</span> </span>&#123;</span><br><span class="line">        <span class="function">std::regex <span class="title">pattern</span><span class="params">(<span class="string">&quot;^[QqWwEeRrTtYyUuIiOoPp]*$|^[AaSsDdFfGgHhJjKkLl]*$|^[ZzXxCcVvBbNnMm]*$&quot;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">if</span> (std::<span class="built_in">regex_match</span>(word, pattern)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">findWords</span><span class="params">(vector&lt;string&gt;&amp; words)</span> </span>&#123;</span><br><span class="line">        vector&lt;string&gt; ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; word : words) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isValid</span>(word)) &#123;</span><br><span class="line">                ans.<span class="built_in">emplace_back</span>(word);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/03/28/86NXqkOvRoCaFux.png" alt="chrome_oAb79KjUWh"></p><h2 id="1-6-å•è¯è§„å¾‹ï¼š290"><a href="#1-6-å•è¯è§„å¾‹ï¼š290" class="headerlink" title="1-6.å•è¯è§„å¾‹ï¼š290"></a>1-6.å•è¯è§„å¾‹ï¼š290</h2><p>ç”±äºè¦è®°å½•stringå’Œcharï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨mapè€Œä¸æ˜¯set.</p><p>æ³¨æ„ï¼špattern=â€abbaâ€,s=â€dog dog dog dogâ€æ—¶ï¼Œåº”è¯¥è¾“å‡ºfalse.æ‰€ä»¥ä¸æ­¢è¦è®°å½•char-&gt;string,è¿˜è¦è®°å½•string-&gt;char.</p><p>pattern=â€aaaâ€,s=â€aa aa aa aaâ€æ—¶ï¼Œåº”è¯¥è¾“å‡ºfalse.æ‰€ä»¥æœ€ç»ˆä¸èƒ½å•çº¯è¿”å›true,è€Œæ˜¯è¿”å›é•¿åº¦æ¯”è¾ƒã€‚</p><p>å®˜æ–¹è§£ç­”ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">wordPattern</span><span class="params">(string pattern, string str)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;string, <span class="type">char</span>&gt; str2ch;</span><br><span class="line">        unordered_map&lt;<span class="type">char</span>, string&gt; ch2str;</span><br><span class="line">        <span class="type">int</span> m = str.<span class="built_in">length</span>();</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> ch : pattern) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= m) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> j = i;</span><br><span class="line">            <span class="keyword">while</span> (j &lt; m &amp;&amp; str[j] != <span class="string">&#x27; &#x27;</span>) j++;</span><br><span class="line">            <span class="type">const</span> string &amp;tmp = str.<span class="built_in">substr</span>(i, j - i);</span><br><span class="line">            <span class="keyword">if</span> (str2ch.<span class="built_in">count</span>(tmp) &amp;&amp; str2ch[tmp] != ch) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ch2str.<span class="built_in">count</span>(ch) &amp;&amp; ch2str[ch] != tmp) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            str2ch[tmp] = ch;</span><br><span class="line">            ch2str[ch] = tmp;</span><br><span class="line">            i = j + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> i &gt;= m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼é¢˜ï¼šåŒæ„å­—ç¬¦ä¸²205ï¼ˆæ›´ç®€å•ï¼Œå› ä¸ºéƒ½æ˜¯ä¸€å¯¹ä¸€å­—ç¬¦ä¸”æ— ç©ºæ ¼ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isIsomorphic</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s.<span class="built_in">length</span>() != t.<span class="built_in">length</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        unordered_map&lt;<span class="type">char</span>, <span class="type">char</span>&gt; s2t;</span><br><span class="line">        unordered_map&lt;<span class="type">char</span>, <span class="type">char</span>&gt; t2s;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">char</span> ch = s[i], ch2 = t[i];</span><br><span class="line">            <span class="keyword">if</span> (s2t.<span class="built_in">count</span>(ch) &amp;&amp; s2t[ch] != ch2) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (t2s.<span class="built_in">count</span>(ch2) &amp;&amp; t2s[ch2] != ch) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            s2t[ch] = ch2;</span><br><span class="line">            t2s[ch2] = ch;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="1-7-æ•°ç»„ä¸­çš„k-diffæ•°å¯¹ï¼š532"><a href="#1-7-æ•°ç»„ä¸­çš„k-diffæ•°å¯¹ï¼š532" class="headerlink" title="1-7.æ•°ç»„ä¸­çš„k-diffæ•°å¯¹ï¼š532"></a>1-7.æ•°ç»„ä¸­çš„k-diffæ•°å¯¹ï¼š532</h2><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</p><p>resæ”¾å…¥çš„æ˜¯æ¯æ¬¡æ•°å¯¹ä¸­è¾ƒå°çš„é‚£ä¸ªæ•°ï¼Œunordered_setå¯ä»¥èµ·åˆ°å»é‡çš„ä¸€ä¸ªä½œç”¨ï¼Œè¿™æ ·å¯ä»¥å¾ˆå®¹æ˜“åœ°å¤„ç†k=0æ—¶çš„æƒ…å†µã€‚multisetè®°å½•nums/å¸¸æ•°resè®°å½•æœ€ç»ˆç­”æ¡ˆï¼Œéƒ½åœ¨å¤„ç†k=0æ—¶æ¯”è¾ƒå¤æ‚ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findPairs</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="type">int</span>&gt; visited;</span><br><span class="line">        unordered_set&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            <span class="keyword">if</span> (visited.<span class="built_in">count</span>(num - k)) &#123;</span><br><span class="line">                res.<span class="built_in">emplace</span>(num - k);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (visited.<span class="built_in">count</span>(num + k)) &#123;</span><br><span class="line">                res.<span class="built_in">emplace</span>(num);</span><br><span class="line">            &#125;</span><br><span class="line">            visited.<span class="built_in">emplace</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ•°ç»„æ’åº+åŒæŒ‡é’ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findPairs</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>(), res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; n &amp;&amp; j &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span> || nums[i - <span class="number">1</span>] != nums[i]) &#123;</span><br><span class="line">                <span class="keyword">while</span> (j &lt; n &amp;&amp; (nums[j] &lt; nums[i] + k || j &lt;= i)) &#123;</span><br><span class="line">                    j++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (j &lt; n &amp;&amp; nums[j] == nums[i] + k) &#123;</span><br><span class="line">                    res++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="1-8-ç»Ÿè®¡é‡å¤ä¸ªæ•°ï¼š466ï¼ˆå›°éš¾ï¼‰"><a href="#1-8-ç»Ÿè®¡é‡å¤ä¸ªæ•°ï¼š466ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="1-8.ç»Ÿè®¡é‡å¤ä¸ªæ•°ï¼š466ï¼ˆå›°éš¾ï¼‰"></a>1-8.ç»Ÿè®¡é‡å¤ä¸ªæ•°ï¼š466ï¼ˆå›°éš¾ï¼‰</h2><p>æ³•ä¸€ï¼šæš´åŠ›æ³•ï¼ˆè¶…æ—¶ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getMaxRepetitions</span><span class="params">(string s1, <span class="type">int</span> n1, string s2, <span class="type">int</span> n2)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> index = <span class="number">0</span>, repeat_count = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> s1_size = s1.<span class="built_in">size</span>(), s2_size = s2.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n1; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; s1_size; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (s1[j] == s2[index]) &#123;</span><br><span class="line">                    index++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (index == s2_size) &#123;</span><br><span class="line">                    index = <span class="number">0</span>;</span><br><span class="line">                    repeat_count++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> repeat_count / n2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ‰¾å‡ºå¾ªç¯èŠ‚</p><p>è¯¦è§å®˜æ–¹è§†é¢‘è®²è§£ã€‚ä½¿ç”¨<code>unordered_map&lt;int,pair&lt;int,int&gt;&gt;&gt;</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getMaxRepetitions</span><span class="params">(string s1, <span class="type">int</span> n1, string s2, <span class="type">int</span> n2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n1 == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> s1cnt = <span class="number">0</span>, index = <span class="number">0</span>, s2cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// recall æ˜¯æˆ‘ä»¬ç”¨æ¥æ‰¾å¾ªç¯èŠ‚çš„å˜é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå“ˆå¸Œæ˜ å°„</span></span><br><span class="line">        <span class="comment">// æˆ‘ä»¬å¦‚ä½•æ‰¾å¾ªç¯èŠ‚ï¼Ÿå‡è®¾æˆ‘ä»¬éå†äº† s1cnt ä¸ª s1ï¼Œæ­¤æ—¶åŒ¹é…åˆ°äº†ç¬¬ s2cnt ä¸ª s2 ä¸­çš„ç¬¬ index ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment">// å¦‚æœæˆ‘ä»¬ä¹‹å‰éå†äº† s1cnt&#x27; ä¸ª s1 æ—¶ï¼ŒåŒ¹é…åˆ°çš„æ˜¯ç¬¬ s2cnt&#x27; ä¸ª s2 ä¸­åŒæ ·çš„ç¬¬ index ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±æœ‰å¾ªç¯èŠ‚äº†</span></span><br><span class="line">        <span class="comment">// æˆ‘ä»¬ç”¨ (s1cnt&#x27;, s2cnt&#x27;, index) å’Œ (s1cnt, s2cnt, index) è¡¨ç¤ºä¸¤æ¬¡åŒ…å«ç›¸åŒ index çš„åŒ¹é…ç»“æœ</span></span><br><span class="line">        <span class="comment">// é‚£ä¹ˆå“ˆå¸Œæ˜ å°„ä¸­çš„é”®å°±æ˜¯ indexï¼Œå€¼å°±æ˜¯ (s1cnt&#x27;, s2cnt&#x27;) è¿™ä¸ªäºŒå…ƒç»„</span></span><br><span class="line">        <span class="comment">// å¾ªç¯èŠ‚å°±æ˜¯ï¼›</span></span><br><span class="line">        <span class="comment">//    - å‰ s1cnt&#x27; ä¸ª s1 åŒ…å«äº† s2cnt&#x27; ä¸ª s2</span></span><br><span class="line">        <span class="comment">//    - ä»¥åçš„æ¯ (s1cnt - s1cnt&#x27;) ä¸ª s1 åŒ…å«äº† (s2cnt - s2cnt&#x27;) ä¸ª s2</span></span><br><span class="line">        <span class="comment">// é‚£ä¹ˆè¿˜ä¼šå‰©ä¸‹ (n1 - s1cnt&#x27;) % (s1cnt - s1cnt&#x27;) ä¸ª s1, æˆ‘ä»¬å¯¹è¿™äº›ä¸ s2 è¿›è¡Œæš´åŠ›åŒ¹é…</span></span><br><span class="line">        <span class="comment">// æ³¨æ„ s2 è¦ä»ç¬¬ index ä¸ªå­—ç¬¦å¼€å§‹åŒ¹é…</span></span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; recall;</span><br><span class="line">        pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; pre_loop, in_loop;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="comment">// æˆ‘ä»¬å¤šéå†ä¸€ä¸ª s1ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°å¾ªç¯èŠ‚</span></span><br><span class="line">            ++s1cnt;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">char</span> ch: s1) &#123;</span><br><span class="line">                <span class="keyword">if</span> (ch == s2[index]) &#123;</span><br><span class="line">                    index += <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (index == s2.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                        ++s2cnt;</span><br><span class="line">                        index = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¿˜æ²¡æœ‰æ‰¾åˆ°å¾ªç¯èŠ‚ï¼Œæ‰€æœ‰çš„ s1 å°±ç”¨å®Œäº†</span></span><br><span class="line">            <span class="keyword">if</span> (s1cnt == n1) &#123;</span><br><span class="line">                <span class="keyword">return</span> s2cnt / n2;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å‡ºç°äº†ä¹‹å‰çš„ indexï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†å¾ªç¯èŠ‚</span></span><br><span class="line">            <span class="keyword">if</span> (recall.<span class="built_in">count</span>(index)) &#123;</span><br><span class="line">                <span class="keyword">auto</span> [s1cnt_prime, s2cnt_prime] = recall[index];</span><br><span class="line">                <span class="comment">// å‰ s1cnt&#x27; ä¸ª s1 åŒ…å«äº† s2cnt&#x27; ä¸ª s2</span></span><br><span class="line">                pre_loop = &#123;s1cnt_prime, s2cnt_prime&#125;;</span><br><span class="line">                <span class="comment">// ä»¥åçš„æ¯ (s1cnt - s1cnt&#x27;) ä¸ª s1 åŒ…å«äº† (s2cnt - s2cnt&#x27;) ä¸ª s2</span></span><br><span class="line">                in_loop = &#123;s1cnt - s1cnt_prime, s2cnt - s2cnt_prime&#125;;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                recall[index] = &#123;s1cnt, s2cnt&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ans å­˜å‚¨çš„æ˜¯ S1 åŒ…å«çš„ s2 çš„æ•°é‡ï¼Œè€ƒè™‘çš„ä¹‹å‰çš„ pre_loop å’Œ in_loop</span></span><br><span class="line">        <span class="type">int</span> ans = pre_loop.second + (n1 - pre_loop.first) / in_loop.first * in_loop.second;</span><br><span class="line">        <span class="comment">// S1 çš„æœ«å°¾è¿˜å‰©ä¸‹ä¸€äº› s1ï¼Œæˆ‘ä»¬æš´åŠ›è¿›è¡ŒåŒ¹é…</span></span><br><span class="line">        <span class="type">int</span> rest = (n1 - pre_loop.first) % in_loop.first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; rest; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">char</span> ch: s1) &#123;</span><br><span class="line">                <span class="keyword">if</span> (ch == s2[index]) &#123;</span><br><span class="line">                    ++index;</span><br><span class="line">                    <span class="keyword">if</span> (index == s2.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                        ++ans;</span><br><span class="line">                        index = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// S1 åŒ…å« ans ä¸ª s2ï¼Œé‚£ä¹ˆå°±åŒ…å« ans / n2 ä¸ª S2</span></span><br><span class="line">        <span class="keyword">return</span> ans / n2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="1-9-éšæœºé“¾è¡¨çš„å¤åˆ¶ï¼š138"><a href="#1-9-éšæœºé“¾è¡¨çš„å¤åˆ¶ï¼š138" class="headerlink" title="1-9.éšæœºé“¾è¡¨çš„å¤åˆ¶ï¼š138"></a>1-9.éšæœºé“¾è¡¨çš„å¤åˆ¶ï¼š138</h2><p>æ³¨æ„é¢˜å¹²è¦æ±‚ï¼Œè¿”å›çš„æ˜¯åŸé“¾è¡¨çš„æ·±æ‹·è´ï¼Œä¸èƒ½ç›´æ¥<code>return head;</code></p><blockquote><p>æ·±æ‹·è´ä¸æµ…æ‹·è´çš„åŒºåˆ«ï¼š</p><pre><code>å½“å‡ºç°ç±»çš„ç­‰å·èµ‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨æ‹·è´å‡½æ•°ï¼Œåœ¨æœªå®šä¹‰æ˜¾ç¤ºæ‹·è´æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šè°ƒç”¨**é»˜è®¤çš„æ‹·è´å‡½æ•°ï¼å³æµ…æ‹·è´**ï¼Œå®ƒèƒ½å¤Ÿå®Œæˆæˆå‘˜çš„ä¸€ä¸€å¤åˆ¶ã€‚å½“æ•°æ®æˆå‘˜ä¸­&lt;u&gt;æ²¡æœ‰æŒ‡é’ˆ&lt;/u&gt;æ—¶ï¼Œæµ…æ‹·è´æ˜¯å¯è¡Œçš„ã€‚ä½†å½“æ•°æ®æˆå‘˜ä¸­æœ‰æŒ‡é’ˆæ—¶ï¼Œå¦‚æœé‡‡ç”¨ç®€å•çš„æµ…æ‹·è´ï¼Œåˆ™ä¸¤ç±»ä¸­çš„ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªåœ°å€ï¼Œå½“å¯¹è±¡å¿«è¦ç»“æŸæ—¶ï¼Œä¼šè°ƒç”¨ä¸¤æ¬¡ææ„å‡½æ•°ï¼Œè€Œå¯¼è‡´**é‡æŒ‡é’ˆ**çš„é—®é¢˜ã€‚æ‰€ä»¥ï¼Œè¿™æ—¶å¿…éœ€é‡‡ç”¨æ·±æ‹·è´ã€‚æ·±æ‹·è´ä¸æµ…æ‹·è´ä¹‹é—´çš„åŒºåˆ«å°±åœ¨äºæ·±æ‹·è´ä¼šåœ¨å †å†…å­˜ä¸­**å¦å¤–ç”³è¯·ç©ºé—´æ¥å­˜å‚¨æ•°æ®**ï¼Œä»è€Œä¹Ÿå°±è§£å†³æ¥é‡æŒ‡é’ˆçš„é—®é¢˜ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå½“æ•°æ®æˆå‘˜ä¸­**æœ‰æŒ‡é’ˆ**æ—¶ï¼Œå¿…é¡»è¦ç”¨æ·±æ‹·è´æ›´åŠ å®‰å…¨ã€‚</code></pre></blockquote><p>æ³•ä¸€ï¼šå›æº¯+å“ˆå¸Œè¡¨+é€’å½’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">// Definition for a Node.</span></span><br><span class="line"><span class="comment">class Node &#123;</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">    int val;</span></span><br><span class="line"><span class="comment">    Node* next;</span></span><br><span class="line"><span class="comment">    Node* random;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Node(int _val) &#123;</span></span><br><span class="line"><span class="comment">        val = _val;</span></span><br><span class="line"><span class="comment">        next = NULL;</span></span><br><span class="line"><span class="comment">        random = NULL;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    unordered_map&lt;Node*, Node*&gt; cachedNode;</span><br><span class="line">    <span class="function">Node* <span class="title">copyRandomList</span><span class="params">(Node* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!cachedNode.<span class="built_in">count</span>(head)) &#123;</span><br><span class="line">            Node* temp = <span class="keyword">new</span> <span class="built_in">Node</span>(head-&gt;val);</span><br><span class="line">            cachedNode[head] = temp;</span><br><span class="line">            temp-&gt;next = <span class="built_in">copyRandomList</span>(head-&gt;next);</span><br><span class="line">            temp-&gt;random = <span class="built_in">copyRandomList</span>(head-&gt;random);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cachedNode[head];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šè¿­ä»£+èŠ‚ç‚¹æ‹†åˆ†</p><p>è¯¦è§å®˜æ–¹å›¾è§£ã€‚ç®€è€Œè¨€ä¹‹æ˜¯å°†A-&gt;B-&gt;Cæ‹†åˆ†ä¸ºA-&gt;Aâ€™-&gt;B-&gt;Bâ€™-&gt;C-&gt;Câ€™ï¼Œå†å˜æˆAâ€™-&gt;Bâ€™-&gt;Câ€™ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Node* <span class="title">copyRandomList</span><span class="params">(Node* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Node* node = head; node != <span class="literal">nullptr</span>; node = node-&gt;next-&gt;next) &#123;</span><br><span class="line">            Node* temp = <span class="keyword">new</span> <span class="built_in">Node</span>(node-&gt;val);</span><br><span class="line">            temp-&gt;next = node-&gt;next;</span><br><span class="line">            node-&gt;next = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Node* node = head; node != <span class="literal">nullptr</span>; node = node-&gt;next-&gt;next) &#123;</span><br><span class="line">            Node* temp = node-&gt;next;</span><br><span class="line">            temp-&gt;random = node-&gt;random ? node-&gt;random-&gt;next : <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Node* headNew = head-&gt;next;</span><br><span class="line">        <span class="keyword">for</span> (Node* node = head; node; node = node-&gt;next) &#123;</span><br><span class="line">            Node* temp = node-&gt;next;</span><br><span class="line">            node-&gt;next = node-&gt;next-&gt;next;</span><br><span class="line">            temp-&gt;next = temp-&gt;next ? temp-&gt;next-&gt;next : <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> headNew;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="1-10-åˆ†æ•°åˆ°å°æ•°ï¼š166"><a href="#1-10-åˆ†æ•°åˆ°å°æ•°ï¼š166" class="headerlink" title="1-10.åˆ†æ•°åˆ°å°æ•°ï¼š166"></a>1-10.åˆ†æ•°åˆ°å°æ•°ï¼š166</h2><p>å‚è€ƒã€Š2.1å­—ç¬¦ä¸²ç¯‡(2)ã€‹ã€‚è¿›é˜¶ï¼š<a href="https://leetcode.cn/problems/fraction-to-recurring-decimal/solutions/2486619/wu-xu-ha-xi-gua-yong-yu-ren-yi-jin-zhi-d-0cv7/">æ— éœ€å“ˆå¸Œ + é€‚ç”¨äºä»»æ„è¿›åˆ¶çš„åˆ†æ•°åˆ°å°æ•°â€”leetcode</a></p><hr><h1 id="2-å“ˆå¸Œè¡¨ä¸ç´¢å¼•"><a href="#2-å“ˆå¸Œè¡¨ä¸ç´¢å¼•" class="headerlink" title="2.å“ˆå¸Œè¡¨ä¸ç´¢å¼•"></a>2.å“ˆå¸Œè¡¨ä¸ç´¢å¼•</h1><h2 id="2-1-ä¸¤æ•°ä¹‹å’Œï¼š1"><a href="#2-1-ä¸¤æ•°ä¹‹å’Œï¼š1" class="headerlink" title="2-1.ä¸¤æ•°ä¹‹å’Œï¼š1"></a>2-1.ä¸¤æ•°ä¹‹å’Œï¼š1</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; hashtable;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">auto</span> it = hashtable.<span class="built_in">find</span>(target - nums[i]);</span><br><span class="line">            <span class="keyword">if</span> (it != hashtable.<span class="built_in">end</span>()) &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;it-&gt;second, i&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™æ’å…¥è¯¥æ•°å­—</span></span><br><span class="line">            hashtable[nums[i]] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;; <span class="comment">// å¿…é¡»è¦æœ‰ä¸€ä¸ªè¿”å›å†…å®¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>å“ˆå¸Œè¡¨çš„find()å‡½æ•°è¿”å›çš„æ˜¯è¿­ä»£å™¨ç±»å‹ã€‚</p></blockquote><h2 id="2-2-ä¸¤æ•°ä¹‹å’ŒIIâ€”è¾“å…¥æœ‰åºæ•°ç»„ï¼š167"><a href="#2-2-ä¸¤æ•°ä¹‹å’ŒIIâ€”è¾“å…¥æœ‰åºæ•°ç»„ï¼š167" class="headerlink" title="2-2.ä¸¤æ•°ä¹‹å’ŒIIâ€”è¾“å…¥æœ‰åºæ•°ç»„ï¼š167"></a>2-2.ä¸¤æ•°ä¹‹å’ŒIIâ€”è¾“å…¥æœ‰åºæ•°ç»„ï¼š167</h2><p>è¯¥é¢˜è¦æ±‚ç©ºé—´å¤æ‚åº¦ä¸º$O(1)$ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨å“ˆå¸Œè¡¨ã€‚</p><p>æ³•ä¸€ï¼šäºŒåˆ†æŸ¥æ‰¾</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; numbers, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; numbers.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="type">int</span> low = i + <span class="number">1</span>, high = numbers.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">                <span class="type">int</span> mid = (high - low) / <span class="number">2</span> + low;</span><br><span class="line">                <span class="keyword">if</span> (numbers[mid] == target - numbers[i]) &#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;i + <span class="number">1</span>, mid + <span class="number">1</span>&#125;;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (numbers[mid] &gt; target - numbers[i]) &#123;</span><br><span class="line">                    high = mid - <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    low = mid + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šåŒæŒ‡é’ˆï¼ˆæœ€ä¼˜ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; numbers, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> low = <span class="number">0</span>, high = numbers.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (numbers[low] + numbers[high] != target &amp;&amp; low &lt; high) &#123;</span><br><span class="line">            <span class="keyword">if</span> (numbers[low] + numbers[high] &lt; target) &#123;</span><br><span class="line">                low++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                high--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;low + <span class="number">1</span>, high + <span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="2-3-å­˜åœ¨é‡å¤å…ƒç´ IIï¼š219"><a href="#2-3-å­˜åœ¨é‡å¤å…ƒç´ IIï¼š219" class="headerlink" title="2-3.å­˜åœ¨é‡å¤å…ƒç´ IIï¼š219"></a>2-3.å­˜åœ¨é‡å¤å…ƒç´ IIï¼š219</h2><p>æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">containsNearbyDuplicate</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; index; <span class="comment">//&lt;å€¼numï¼Œç´¢å¼•i&gt;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (index.<span class="built_in">count</span>(nums[i]) &amp;&amp; i - index[nums[i]] &lt;= k) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            index[nums[i]] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ»‘åŠ¨çª—å£</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">containsNearbyDuplicate</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; k) &#123;</span><br><span class="line">                s.<span class="built_in">erase</span>(nums[i - k - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (s.<span class="built_in">count</span>(nums[i])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            s.<span class="built_in">emplace</span>(nums[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="2-4-å­˜åœ¨é‡å¤å…ƒç´ IIIï¼š220ï¼ˆå›°éš¾ï¼‰"><a href="#2-4-å­˜åœ¨é‡å¤å…ƒç´ IIIï¼š220ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="2-4.å­˜åœ¨é‡å¤å…ƒç´ IIIï¼š220ï¼ˆå›°éš¾ï¼‰"></a>2-4.å­˜åœ¨é‡å¤å…ƒç´ IIIï¼š220ï¼ˆå›°éš¾ï¼‰</h2><p>æ³•ä¸€ï¼šæ»‘åŠ¨çª—å£+æœ‰åºé›†åˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">containsNearbyAlmostDuplicate</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> indexDiff, <span class="type">int</span> valueDiff)</span> </span>&#123;</span><br><span class="line">        set&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="type">int</span> leftBoundary = <span class="built_in">max</span>(nums[i], INT_MIN + valueDiff) - valueDiff;</span><br><span class="line">            <span class="type">int</span> rightBoundary = <span class="built_in">min</span>(nums[i], INT_MAX - valueDiff) + valueDiff;</span><br><span class="line">            <span class="keyword">auto</span> it = s.<span class="built_in">lower_bound</span>(leftBoundary);</span><br><span class="line">            <span class="keyword">if</span> (it != s.<span class="built_in">end</span>() &amp;&amp; *it &lt;= rightBoundary) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            s.<span class="built_in">insert</span>(nums[i]);</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= indexDiff) &#123;</span><br><span class="line">                s.<span class="built_in">erase</span>(nums[i - indexDiff]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><pre><code>`s.lower_bound(leftBoundary)`å°†è¿”å›ç¬¬ä¸€ä¸ª&gt;=leftBoundaryçš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œå¦‚æœæœªæ‰¾åˆ°ï¼Œåˆ™è¿”å›ä¸€ä¸ªæŒ‡å‘æœ«å°¾çš„è¿­ä»£å™¨ã€‚</code></pre><p>æ³•äºŒï¼šæ»‘åŠ¨çª—å£+å“ˆå¸Œè¡¨+æ¡¶æ’åºï¼ˆæœ€ä¼˜è§£ï¼‰</p><pre><code>ä½¿ç”¨setæ—¶ï¼Œæ’å…¥æˆ–è€…åˆ é™¤ä¸€æ¬¡å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(log(min(n,IndexDiff)))$ï¼Œå“ˆå¸Œè¡¨ï¼‹æ¡¶æ’åºåˆ™ä¸º$O(1)$ã€‚</code></pre><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getIndex</span><span class="params">(<span class="type">int</span> x, <span class="type">long</span> w)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> x &lt; <span class="number">0</span> ? (x + <span class="number">1ll</span>) / w - <span class="number">1</span> : x / w; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">containsNearbyAlmostDuplicate</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> indexDiff, <span class="type">int</span> valueDiff)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="type">long</span> x = nums[i]; <span class="comment">// longå­˜å‚¨é¿å…æº¢å‡º</span></span><br><span class="line">            <span class="type">int</span> index = <span class="built_in">getIndex</span>(x, valueDiff + <span class="number">1ll</span>);</span><br><span class="line">            <span class="keyword">if</span> (mp.<span class="built_in">count</span>(index) ||</span><br><span class="line">                mp.<span class="built_in">count</span>(index - <span class="number">1</span>) &amp;&amp; <span class="built_in">abs</span>(x - mp[index - <span class="number">1</span>]) &lt;= valueDiff ||</span><br><span class="line">                mp.<span class="built_in">count</span>(index + <span class="number">1</span>) &amp;&amp; <span class="built_in">abs</span>(x - mp[index + <span class="number">1</span>]) &lt;= valueDiff) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mp[index] = x;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= indexDiff) &#123;</span><br><span class="line">                mp.<span class="built_in">erase</span>(<span class="built_in">getIndex</span>(nums[i - indexDiff], valueDiff + <span class="number">1ll</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å“ˆå¸Œè¡¨éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="å“ˆå¸Œè¡¨" scheme="https://sumikiru.top/tags/%E5%93%88%E5%B8%8C%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>5.é“¾è¡¨ç¯‡</title>
    <link href="https://sumikiru.top/posts/f83528c7.html"/>
    <id>https://sumikiru.top/posts/f83528c7.html</id>
    <published>2024-05-29T15:15:38.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å…³äºé“¾è¡¨"><a href="#å…³äºé“¾è¡¨" class="headerlink" title="å…³äºé“¾è¡¨"></a>å…³äºé“¾è¡¨</h1><p>å„ç§æ–¹æ³•çš„è¯¦ç»†å®ç°ï¼š<a href="https://zhuanlan.zhihu.com/p/136177205">é“¾è¡¨çš„åŸºæœ¬å®ç°â€”çŸ¥ä¹</a></p><p>ç†è®ºåŸºç¡€ï¼š<a href="https://programmercarl.com/%E9%93%BE%E8%A1%A8%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80.html#%E9%93%BE%E8%A1%A8%E7%9A%84%E7%B1%BB%E5%9E%8B">é“¾è¡¨â€”ä»£ç éšæƒ³å½•</a></p><p>å•é“¾è¡¨ï¼š</p><h5 id="1-æ„å»ºå•é“¾è¡¨"><a href="#1-æ„å»ºå•é“¾è¡¨" class="headerlink" title="(1)æ„å»ºå•é“¾è¡¨"></a>(1)æ„å»ºå•é“¾è¡¨</h5><p><img src="https://s2.loli.net/2024/03/18/WMjm4zDaEThZYCe.png" alt="firefox_BIFDvSSmwv"></p><blockquote><p>æ³¨ï¼š<a href="https://zhuanlan.zhihu.com/p/360838187">å•é“¾è¡¨ã€å¾ªç¯é“¾è¡¨ã€åŒé“¾è¡¨çš„è¡¨ç¤ºä¸å®ç°â€”çŸ¥ä¹</a></p><p><img src="C:\Users\huangjiakun\Pictures\ShareX\Screenshots\2024-03\firefox_MoglKjc02n.png" alt="firefox_MoglKjc02n"></p><p>åŒé“¾è¡¨ï¼Œå¾ªç¯é“¾è¡¨åŸç†ï¼š</p><p><img src="https://s2.loli.net/2024/03/18/te68uaFDYIHikJK.png" alt="firefox_paniklnKLw"></p><p><img title="" src="https://s2.loli.net/2024/03/18/BHoimFhuCv2aPEf.png" alt="firefox_qID1ULZZiK" width="307"></p></blockquote><p>å®šä¹‰å¹¶å®ç°ä¸€ä¸ªå¸¦è¡¨å¤´ç»“ç‚¹çš„é€šç”¨å•é“¾è¡¨ç±»LinkList,è¯¥å•é“¾è¡¨ç±»å¯ä»¥é€‚ç”¨äºæ•´æ•°ã€å®æ•°å’Œå­—ç¬¦æ•°æ®ç­‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Node&lt;T&gt; *next;</span><br><span class="line">    Node&lt;T&gt; *prev;</span><br><span class="line">    T data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">List</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">List</span>();<span class="comment">//é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">List</span>(<span class="type">const</span> List&amp; ln);<span class="comment">//æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    ~<span class="built_in">List</span>();<span class="comment">//ææ„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(T e)</span></span>;<span class="comment">//å‘é“¾è¡¨æ·»åŠ æ•°æ®</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ascSort</span><span class="params">()</span></span>;<span class="comment">//å‡åºæ’åº</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">remove</span><span class="params">(T index)</span></span>;<span class="comment">//ç§»é™¤æŸä¸ªç»“ç‚¹</span></span><br><span class="line">    <span class="function">T <span class="title">find</span><span class="params">(<span class="type">int</span> index)</span></span>;<span class="comment">//æŸ¥æ‰¾ç»“ç‚¹</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isEmpty</span><span class="params">()</span></span>;<span class="comment">//åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">size</span><span class="params">()</span></span>;<span class="comment">//é“¾è¡¨é•¿åº¦</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">show</span><span class="params">()</span></span>;<span class="comment">//æ˜¾ç¤ºé“¾è¡¨</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">resShow</span><span class="params">()</span></span>;<span class="comment">//é“¾è¡¨åå‘æ˜¾ç¤º</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">removeAll</span><span class="params">()</span></span>;<span class="comment">//åˆ é™¤å…¨éƒ¨ç»“ç‚¹</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Node&lt;T&gt; *head;</span><br><span class="line">    Node&lt;T&gt; *tail;</span><br><span class="line">    <span class="type">int</span> length;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å•é“¾è¡¨ç»“æ„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å•é“¾è¡¨</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    ListNode* next;</span><br><span class="line">    <span class="built_in">ListNode</span>() : <span class="built_in">val</span>(<span class="number">0</span>), <span class="built_in">next</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">    <span class="built_in">ListNode</span>(<span class="type">int</span> x) : <span class="built_in">val</span>(x), <span class="built_in">next</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">    <span class="built_in">ListNode</span>(<span class="type">int</span> x, ListNode* next) : <span class="built_in">val</span>(x), <span class="built_in">next</span>(next) &#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/03/18/EhoWkd7a1cDKniT.png" alt="firefox_1qQZVGZHEf"></p><h5 id="2-æ„é€ å‡½æ•°"><a href="#2-æ„é€ å‡½æ•°" class="headerlink" title="(2)æ„é€ å‡½æ•°"></a>(2)æ„é€ å‡½æ•°</h5><p>é»˜è®¤æ„é€ å‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">List&lt;T&gt;::<span class="built_in">List</span>()</span><br><span class="line">&#123;</span><br><span class="line">    head = <span class="keyword">new</span> Node&lt;T&gt;;</span><br><span class="line">    tail = <span class="keyword">new</span> Node&lt;T&gt;;</span><br><span class="line">    head-&gt;next = tail;</span><br><span class="line">    head-&gt;prev = <span class="literal">nullptr</span>;</span><br><span class="line">    tail-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">    tail-&gt;prev = head;</span><br><span class="line">    length = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‹·è´æ„é€ å‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">List&lt;T&gt;::<span class="built_in">List</span>(<span class="type">const</span> List &amp;ln)</span><br><span class="line">&#123;</span><br><span class="line">    head = <span class="keyword">new</span> Node&lt;T&gt;;</span><br><span class="line">    head-&gt;prev = <span class="literal">nullptr</span>;</span><br><span class="line">    tail = <span class="keyword">new</span> Node&lt;T&gt;;</span><br><span class="line">    head-&gt;next = tail;</span><br><span class="line">    tail-&gt;prev = head;</span><br><span class="line">    length = <span class="number">0</span>;</span><br><span class="line">    Node&lt;T&gt;* temp = ln.head;</span><br><span class="line">    <span class="keyword">while</span> (temp-&gt;next != ln.tail)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = temp-&gt;next;</span><br><span class="line">        tail-&gt;data = temp-&gt;data;</span><br><span class="line">        Node&lt;T&gt; *p = <span class="keyword">new</span> Node&lt;T&gt;;</span><br><span class="line">        p-&gt;prev = tail;</span><br><span class="line">        tail-&gt;next = p;</span><br><span class="line">        tail = p;</span><br><span class="line">        length++;</span><br><span class="line">    &#125;</span><br><span class="line">    tail-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="3-å¢ï¼šå‘é“¾è¡¨æ·»åŠ æ•°æ®-æ·»åŠ ç»“ç‚¹"><a href="#3-å¢ï¼šå‘é“¾è¡¨æ·»åŠ æ•°æ®-æ·»åŠ ç»“ç‚¹" class="headerlink" title="(3)å¢ï¼šå‘é“¾è¡¨æ·»åŠ æ•°æ®(æ·»åŠ ç»“ç‚¹)"></a>(3)å¢ï¼šå‘é“¾è¡¨æ·»åŠ æ•°æ®(æ·»åŠ ç»“ç‚¹)</h5><p><img src="https://s2.loli.net/2024/03/18/i8vzp4xsoSYVDQB.png" alt="firefox_DUiQ0BKvOa"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> List&lt;T&gt;::<span class="built_in">add</span>(T e)</span><br><span class="line">&#123;</span><br><span class="line">    Node&lt;T&gt;* temp = <span class="keyword">this</span>-&gt;tail;</span><br><span class="line">    tail-&gt;data = e;</span><br><span class="line">    tail-&gt;next = <span class="keyword">new</span> Node&lt;T&gt;;</span><br><span class="line">    Node&lt;T&gt; *p = tail;</span><br><span class="line">    tail = tail-&gt;next;</span><br><span class="line">    tail-&gt;prev = p;</span><br><span class="line">    tail-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">    length++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="4-æŸ¥ï¼šæŸ¥æ‰¾ç»“ç‚¹"><a href="#4-æŸ¥ï¼šæŸ¥æ‰¾ç»“ç‚¹" class="headerlink" title="(4)æŸ¥ï¼šæŸ¥æ‰¾ç»“ç‚¹"></a>(4)æŸ¥ï¼šæŸ¥æ‰¾ç»“ç‚¹</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">T List&lt;T&gt;::<span class="built_in">find</span>(<span class="type">int</span> index)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (length == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;List is empty&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (index &gt;= length)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Out of bounds&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">    T data;</span><br><span class="line">    Node&lt;T&gt; *p;</span><br><span class="line">    <span class="keyword">if</span> (index &lt; length / <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p = head-&gt;next;</span><br><span class="line">        <span class="keyword">while</span> (p-&gt;next != <span class="literal">nullptr</span> &amp;&amp; x++ != index)</span><br><span class="line">        &#123;</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        p = tail-&gt;prev;</span><br><span class="line">        <span class="keyword">while</span> (p-&gt;prev != <span class="literal">nullptr</span> &amp;&amp; x++ != index)</span><br><span class="line">        &#123;</span><br><span class="line">            p = p-&gt;prev;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p-&gt;data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="5-åˆ ï¼šåˆ é™¤ç»“ç‚¹"><a href="#5-åˆ ï¼šåˆ é™¤ç»“ç‚¹" class="headerlink" title="(5)åˆ ï¼šåˆ é™¤ç»“ç‚¹"></a>(5)åˆ ï¼šåˆ é™¤ç»“ç‚¹</h5><p><img src="https://s2.loli.net/2024/03/18/r6Y9Jvz1OqPSHB8.png" alt="firefox_uXUFIzsll9"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> List&lt;T&gt;::<span class="built_in">remove</span>(T index)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (length == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;List is empty&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Node&lt;T&gt; *p = head;</span><br><span class="line">    <span class="keyword">while</span> (p-&gt;next != <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;data == index)</span><br><span class="line">        &#123;</span><br><span class="line">            Node&lt;T&gt; *temp = p-&gt;prev;</span><br><span class="line">            temp-&gt;next = p-&gt;next;</span><br><span class="line">            p-&gt;next-&gt;prev = temp;</span><br><span class="line">            <span class="keyword">delete</span> p;</span><br><span class="line">            length--;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="6-åˆ é™¤æ‰€æœ‰ç»“ç‚¹"><a href="#6-åˆ é™¤æ‰€æœ‰ç»“ç‚¹" class="headerlink" title="(6)åˆ é™¤æ‰€æœ‰ç»“ç‚¹"></a>(6)åˆ é™¤æ‰€æœ‰ç»“ç‚¹</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> List&lt;T&gt;::<span class="built_in">removeAll</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (length == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Node&lt;T&gt; *p = head-&gt;next;</span><br><span class="line">    <span class="keyword">while</span> (p != tail)</span><br><span class="line">    &#123;</span><br><span class="line">        Node&lt;T&gt;* temp = p;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">    head-&gt;next = tail;</span><br><span class="line">    tail-&gt;prev = head;</span><br><span class="line">    length = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="7-å‡åºæ’åº"><a href="#7-å‡åºæ’åº" class="headerlink" title="(7)å‡åºæ’åº"></a>(7)å‡åºæ’åº</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> List&lt;T&gt;::<span class="built_in">ascSort</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (length &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">    Node&lt;T&gt; *p = head-&gt;next;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        Node&lt;T&gt; *q = p-&gt;next;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; length; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p-&gt;data &gt; q-&gt;data)</span><br><span class="line">            &#123;</span><br><span class="line">                T temp = q-&gt;data;</span><br><span class="line">                q-&gt;data = p-&gt;data;</span><br><span class="line">                p-&gt;data = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            q = q-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="8-åˆ¤æ–­æ˜¯å¦ä¸ºç©º"><a href="#8-åˆ¤æ–­æ˜¯å¦ä¸ºç©º" class="headerlink" title="(8)åˆ¤æ–­æ˜¯å¦ä¸ºç©º"></a>(8)åˆ¤æ–­æ˜¯å¦ä¸ºç©º</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">bool</span> List&lt;T&gt;::<span class="built_in">isEmpty</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> length == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="9-è·å–é“¾è¡¨é•¿åº¦"><a href="#9-è·å–é“¾è¡¨é•¿åº¦" class="headerlink" title="(9)è·å–é“¾è¡¨é•¿åº¦"></a>(9)è·å–é“¾è¡¨é•¿åº¦</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">int</span> List&lt;T&gt;::<span class="built_in">size</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="10-è¾“å‡ºé“¾è¡¨"><a href="#10-è¾“å‡ºé“¾è¡¨" class="headerlink" title="(10)è¾“å‡ºé“¾è¡¨"></a>(10)è¾“å‡ºé“¾è¡¨</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> List&lt;T&gt;::<span class="built_in">show</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (length == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;List is empty&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Node&lt;T&gt; *p = head-&gt;next;</span><br><span class="line">    <span class="keyword">while</span> (p != tail)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; p-&gt;data &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="11-åå‘è¾“å‡ºé“¾è¡¨"><a href="#11-åå‘è¾“å‡ºé“¾è¡¨" class="headerlink" title="(11)åå‘è¾“å‡ºé“¾è¡¨"></a>(11)åå‘è¾“å‡ºé“¾è¡¨</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> List&lt;T&gt;::<span class="built_in">resShow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (length == <span class="number">0</span>)<span class="keyword">return</span>;</span><br><span class="line">    Node&lt;T&gt; *p = tail-&gt;prev;</span><br><span class="line">    <span class="keyword">while</span> (p != head)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; p-&gt;data &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        p = p-&gt;prev;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="12-ææ„å‡½æ•°"><a href="#12-ææ„å‡½æ•°" class="headerlink" title="(12)ææ„å‡½æ•°"></a>(12)ææ„å‡½æ•°</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">List&lt;T&gt;::~<span class="built_in">List</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (length == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> head;</span><br><span class="line">        <span class="keyword">delete</span> tail;</span><br><span class="line">        head = <span class="literal">nullptr</span>;</span><br><span class="line">        tail = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (head-&gt;next != <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Node&lt;T&gt; *temp = head;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span> head;</span><br><span class="line">    head = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1-é“¾è¡¨çš„åˆ é™¤"><a href="#1-é“¾è¡¨çš„åˆ é™¤" class="headerlink" title="1.é“¾è¡¨çš„åˆ é™¤"></a>1.é“¾è¡¨çš„åˆ é™¤</h1><h4 id="1-1-ç§»é™¤é“¾è¡¨å…ƒç´ ï¼š203"><a href="#1-1-ç§»é™¤é“¾è¡¨å…ƒç´ ï¼š203" class="headerlink" title="1-1.ç§»é™¤é“¾è¡¨å…ƒç´ ï¼š203"></a>1-1.ç§»é™¤é“¾è¡¨å…ƒç´ ï¼š203</h4><p>æ³•ä¸€ï¼šé€’å½’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode() : val(0), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x, ListNode *next) : val(x), next(next) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeElements</span><span class="params">(ListNode* head, <span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">nullptr</span>) &#123;  <span class="comment">//é€’å½’ç»ˆæ­¢æ¡ä»¶:å½“å‰ç»“ç‚¹ä¸ºç©º</span></span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        head-&gt;next = <span class="built_in">removeElements</span>(head-&gt;next, val);</span><br><span class="line">        <span class="keyword">return</span> head-&gt;val == val ? head-&gt;next : head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šè¿­ä»£</p><p>å“‘èŠ‚ç‚¹dummyHeadï¼Œç”¨æ¥æ”¾ç½®åœ¨headçš„å‰é¢(<code>dummyHead-&gt;next = head</code>)ï¼Œç”¨æ¥è§£å†³å¤´èŠ‚ç‚¹headå¯èƒ½è¢«åˆ é™¤çš„æƒ…å†µã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeElements</span><span class="params">(ListNode* head, <span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">        ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>, head);</span><br><span class="line">        ListNode* temp = DummyHead; <span class="comment">// å¯¹åº”å½“å‰èŠ‚ç‚¹çš„ä¸´æ—¶èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">while</span> (temp-&gt;next) &#123;</span><br><span class="line">            <span class="keyword">if</span> (temp-&gt;next-&gt;val == val) &#123;</span><br><span class="line">                temp-&gt;next = temp-&gt;next-&gt;next;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                temp = temp-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> DummyHead-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="1-2-åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼š237"><a href="#1-2-åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼š237" class="headerlink" title="1-2.åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼š237"></a>1-2.åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼š237</h4><pre><code>åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹çš„å¸¸è§çš„æ–¹æ³•æ˜¯å®šä½åˆ°å¾…åˆ é™¤èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¿®æ”¹ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„ next æŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘å¾…åˆ é™¤èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå³å¯å®Œæˆåˆ é™¤æ“ä½œã€‚è€Œè¿™é“é¢˜ä¸­ï¼Œæ— æ³•å®šä½åˆ°è¯¥èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦æ¢ä¸€ç§æ–¹å¼ã€‚</code></pre><p>å’Œä¸‹ä¸€èŠ‚ç‚¹äº¤æ¢ï¼š(å°†è¦åˆ é™¤èŠ‚ç‚¹çš„å€¼å˜ä¸ºå…¶nextèŠ‚ç‚¹ï¼Œç„¶åå°†nextèŠ‚ç‚¹åˆ é™¤)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">deleteNode</span><span class="params">(ListNode* node)</span> </span>&#123;</span><br><span class="line">        node-&gt;val = node-&gt;next-&gt;val;</span><br><span class="line">        node-&gt;next = node-&gt;next-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="1-3-åˆ é™¤é“¾è¡¨çš„ç¬¬Nä¸ªèŠ‚ç‚¹ï¼š19"><a href="#1-3-åˆ é™¤é“¾è¡¨çš„ç¬¬Nä¸ªèŠ‚ç‚¹ï¼š19" class="headerlink" title="1-3.åˆ é™¤é“¾è¡¨çš„ç¬¬Nä¸ªèŠ‚ç‚¹ï¼š19"></a>1-3.åˆ é™¤é“¾è¡¨çš„ç¬¬Nä¸ªèŠ‚ç‚¹ï¼š19</h4><p>æ³•ä¸€ï¼šå…ˆè·å–é•¿åº¦ï¼Œç„¶åå®šä½åˆ°å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹ã€‚</p><p>é”™è§£ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode() : val(0), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x, ListNode *next) : val(x), next(next) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeNthFromEnd</span><span class="params">(ListNode* head, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–é“¾è¡¨é•¿åº¦</span></span><br><span class="line">        <span class="type">int</span> length = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (head) &#123;</span><br><span class="line">            ++length;</span><br><span class="line">            head = head-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å®šä½èŠ‚ç‚¹å¹¶åˆ é™¤</span></span><br><span class="line">        ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>, head);</span><br><span class="line">        ListNode* temp = DummyHead; <span class="comment">// ç¬¬0ä¸ªèŠ‚ç‚¹i=0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; length + <span class="number">1</span> - n;</span><br><span class="line">             i++) &#123; <span class="comment">// éå†å€’æ•°ç¬¬N+1ä¸ªèŠ‚ç‚¹å‰é¢çš„æ‰€æœ‰èŠ‚ç‚¹,æ³¨æ„iåˆå§‹å€¼ä¸º1</span></span><br><span class="line">            temp = temp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        temp-&gt;next = temp-&gt;next-&gt;next;</span><br><span class="line">        ListNode* ans = DummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> DummyHead;</span><br><span class="line">        <span class="keyword">return</span> ans; <span class="comment">// ä¸èƒ½ç›´æ¥è¿”å›head,å› ä¸ºä¹‹å‰çš„headå¯èƒ½æ˜¯è¦åˆ é™¤çš„é‚£ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åŸå› ï¼šåœ¨è·å–é•¿åº¦æ—¶ï¼Œheadå·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œå› æ­¤ä¹‹åçš„DummyHeadèŠ‚ç‚¹å°±å‡ºäº†é—®é¢˜ï¼Œæ­£ç¡®è§£æ³•åº”è¯¥æ˜¯å°†è·å–é“¾è¡¨é•¿åº¦å•ç‹¬å°è£…ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œæˆ–è€…æ˜¯æå‰å®šä¹‰å¥½DummyHeadã€‚</p><p>æ­£è§£ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeNthFromEnd</span><span class="params">(ListNode* head, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>, head); <span class="comment">// æ”¹åŠ¨</span></span><br><span class="line">        <span class="comment">// è·å–é“¾è¡¨é•¿åº¦</span></span><br><span class="line">        <span class="type">int</span> length = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (head) &#123;</span><br><span class="line">            ++length;</span><br><span class="line">            head = head-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å®šä½èŠ‚ç‚¹å¹¶åˆ é™¤</span></span><br><span class="line">        ListNode* temp = DummyHead; <span class="comment">// ç¬¬0ä¸ªèŠ‚ç‚¹i=0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; length + <span class="number">1</span> - n;</span><br><span class="line">             i++) &#123; <span class="comment">// éå†å€’æ•°ç¬¬N+1ä¸ªèŠ‚ç‚¹å‰é¢çš„æ‰€æœ‰èŠ‚ç‚¹,æ³¨æ„iåˆå§‹å€¼ä¸º1</span></span><br><span class="line">            temp = temp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        temp-&gt;next = temp-&gt;next-&gt;next;</span><br><span class="line">        ListNode* ans = DummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> DummyHead;</span><br><span class="line">        <span class="keyword">return</span> ans; <span class="comment">// ä¸èƒ½ç›´æ¥è¿”å›head,å› ä¸ºä¹‹å‰çš„headå¯èƒ½æ˜¯è¦åˆ é™¤çš„é‚£ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ ˆ(æ¬¡ä¼˜è§£ï¼Œéœ€è¦é¢å¤–ç©ºé—´)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeNthFromEnd</span><span class="params">(ListNode* head, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>, head);</span><br><span class="line">        stack&lt;ListNode*&gt; stk;</span><br><span class="line">        ListNode* temp = DummyHead;</span><br><span class="line">        <span class="keyword">while</span> (temp) &#123;</span><br><span class="line">            stk.<span class="built_in">push</span>(temp);</span><br><span class="line">            temp = temp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            stk.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode* prev = stk.<span class="built_in">top</span>();</span><br><span class="line">        prev-&gt;next = prev-&gt;next-&gt;next;</span><br><span class="line">        ListNode* ans = DummyHead-&gt;next; <span class="comment">// ä¸èƒ½ç›´æ¥ç”¨head</span></span><br><span class="line">        <span class="keyword">delete</span> DummyHead;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•ä¸‰ï¼šåŒæŒ‡é’ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeNthFromEnd</span><span class="params">(ListNode* head, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>, head);</span><br><span class="line">        ListNode* first = head;</span><br><span class="line">        ListNode* second = DummyHead;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            first = first-&gt;next; <span class="comment">// è®©firståˆ°è¾¾ç¬¬N+1ä¸ªèŠ‚ç‚¹ä½ç½®</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (first) &#123;</span><br><span class="line">            first = first-&gt;next;</span><br><span class="line">            second = second-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç°åœ¨secondå³ä¸ºå€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç°åœ¨æ›´æ”¹å…¶æŒ‡å‘</span></span><br><span class="line">        second-&gt;next = second-&gt;next-&gt;next;</span><br><span class="line">        ListNode* ans = DummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> DummyHead;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="2-é“¾è¡¨çš„éå†"><a href="#2-é“¾è¡¨çš„éå†" class="headerlink" title="2.é“¾è¡¨çš„éå†"></a>2.é“¾è¡¨çš„éå†</h1><h4 id="2-1-åŒé“¾è¡¨â€”æ‰å¹³åŒ–å¤šçº§åŒå‘é“¾è¡¨ï¼š430"><a href="#2-1-åŒé“¾è¡¨â€”æ‰å¹³åŒ–å¤šçº§åŒå‘é“¾è¡¨ï¼š430" class="headerlink" title="2-1.åŒé“¾è¡¨â€”æ‰å¹³åŒ–å¤šçº§åŒå‘é“¾è¡¨ï¼š430"></a>2-1.åŒé“¾è¡¨â€”æ‰å¹³åŒ–å¤šçº§åŒå‘é“¾è¡¨ï¼š430</h4><p>æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢(dfs)</p><p><img src="https://s2.loli.net/2024/03/20/pk6GJyB3iNE1ZfF.png" alt="firefox_iyrVl6hRKd"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">// Definition for a Node.</span></span><br><span class="line"><span class="comment">class Node &#123;</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">    int val;</span></span><br><span class="line"><span class="comment">    Node* prev;</span></span><br><span class="line"><span class="comment">    Node* next;</span></span><br><span class="line"><span class="comment">    Node* child;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Node* <span class="title">dfs</span><span class="params">(Node* node)</span> </span>&#123;</span><br><span class="line">        Node* last = <span class="literal">nullptr</span>; <span class="comment">// è®°å½•é“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">while</span> (node) &#123;</span><br><span class="line">            Node* next = node-&gt;next; <span class="comment">// è®°å½•ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸èƒ½ä¸€ç›´ç”¨node-&gt;nextä»£æ›¿</span></span><br><span class="line">            <span class="comment">// å¦‚æœé“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (node-&gt;child) &#123;</span><br><span class="line">                Node* child_last = <span class="built_in">dfs</span>(node-&gt;child);</span><br><span class="line">                <span class="comment">// å°†nodeä¸childç›¸è¿</span></span><br><span class="line">                node-&gt;next = node-&gt;child;</span><br><span class="line">                node-&gt;child-&gt;prev = node;</span><br><span class="line">                <span class="comment">// è‹¥node-&gt;nextä¸ä¸ºç©ºï¼Œå°±å°†lastä¸nextç›¸è¿</span></span><br><span class="line">                <span class="keyword">if</span> (next) &#123;</span><br><span class="line">                    child_last-&gt;next = next;</span><br><span class="line">                    next-&gt;prev = child_last;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// ç½®childä¸ºç©º</span></span><br><span class="line">                node-&gt;child = <span class="literal">nullptr</span>;</span><br><span class="line">                last = child_last;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                last = node;</span><br><span class="line">            &#125;</span><br><span class="line">            node = node-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> last;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Node* <span class="title">flatten</span><span class="params">(Node* head)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">dfs</span>(head);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="3-é“¾è¡¨çš„æ—‹è½¬ä¸åè½¬"><a href="#3-é“¾è¡¨çš„æ—‹è½¬ä¸åè½¬" class="headerlink" title="3.é“¾è¡¨çš„æ—‹è½¬ä¸åè½¬"></a>3.é“¾è¡¨çš„æ—‹è½¬ä¸åè½¬</h1><h4 id="3-1-æ—‹è½¬é“¾è¡¨ï¼š61"><a href="#3-1-æ—‹è½¬é“¾è¡¨ï¼š61" class="headerlink" title="3-1.æ—‹è½¬é“¾è¡¨ï¼š61"></a>3-1.æ—‹è½¬é“¾è¡¨ï¼š61</h4><p>æ³•ä¸€ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode() : val(0), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x, ListNode *next) : val(x), next(next) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">rotateRight</span><span class="params">(ListNode* head, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">0</span> || head == <span class="literal">nullptr</span> || head-&gt;next == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">        ListNode* it = head;</span><br><span class="line">        <span class="keyword">while</span> (it-&gt;next) &#123;</span><br><span class="line">            it = it-&gt;next;</span><br><span class="line">            len++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// lenè®°å½•é“¾è¡¨é•¿åº¦ï¼Œitç°åœ¨ä¸ºæœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="type">int</span> n = len - k % len; <span class="comment">// å®é™…ä¸Šåªéœ€è¦ç§»åŠ¨çš„è·ç¦»</span></span><br><span class="line">        <span class="keyword">if</span> (n == len) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        it-&gt;next = head;</span><br><span class="line">        <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">            <span class="comment">// æ‰¾åˆ°å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹ï¼Œå¹¶è®©å…¶ä½œä¸ºå¤´èŠ‚ç‚¹</span></span><br><span class="line">            it = it-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç°åœ¨itä¸ºå€’æ•°ç¬¬n+1ä¸ªèŠ‚ç‚¹ï¼Œç”¨ansè®°å½•ä¸‹æœ€ç»ˆçš„å¤´èŠ‚ç‚¹</span></span><br><span class="line">        ListNode* ans = it-&gt;next;</span><br><span class="line">        it-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="3-2-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼š24"><a href="#3-2-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼š24" class="headerlink" title="3-2.ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼š24"></a>3-2.ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼š24</h4><p>æ³•ä¸€ï¼šé€’å½’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode() : val(0), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x, ListNode *next) : val(x), next(next) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">swapPairs</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">nullptr</span> || head-&gt;next == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode* temp = head-&gt;next;</span><br><span class="line">        head-&gt;next = <span class="built_in">swapPairs</span>(temp-&gt;next);</span><br><span class="line">        temp-&gt;next = head;</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šè¿­ä»£</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">swapPairs</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>, head);</span><br><span class="line">        ListNode* temp = DummyHead;</span><br><span class="line">        <span class="keyword">while</span> (temp-&gt;next &amp;&amp; temp-&gt;next-&gt;next) &#123;</span><br><span class="line">            ListNode* node1 = temp-&gt;next;</span><br><span class="line">            ListNode* node2 = temp-&gt;next-&gt;next;</span><br><span class="line">            <span class="comment">// ä»¥tempä½œä¸ºä¸­ä»‹</span></span><br><span class="line">            temp-&gt;next = node2;</span><br><span class="line">            node1-&gt;next = node2-&gt;next;</span><br><span class="line">            node2-&gt;next = node1;</span><br><span class="line">            temp = node1; <span class="comment">// æ›´æ–°tempä¸ºä¸‹ä¸€ç»„çš„&quot;DummyHead&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        ListNode* ans = DummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> DummyHead;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="3-3-åè½¬é“¾è¡¨ï¼š206"><a href="#3-3-åè½¬é“¾è¡¨ï¼š206" class="headerlink" title="3-3.åè½¬é“¾è¡¨ï¼š206"></a>3-3.åè½¬é“¾è¡¨ï¼š206</h4><p>æ³•ä¸€ï¼šè¿­ä»£</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        ListNode* temp = head;</span><br><span class="line">        ListNode* prev = <span class="literal">nullptr</span>; <span class="comment">// tempçš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">while</span> (temp) &#123;</span><br><span class="line">            ListNode* next = temp-&gt;next; <span class="comment">// tempçš„åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment">// è®°å½•èŠ‚ç‚¹ä¾æ¬¡åç§»</span></span><br><span class="line">            temp-&gt;next = prev;</span><br><span class="line">            prev = temp;</span><br><span class="line">            temp = next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šé€’å½’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!head || !head-&gt;next) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode* newHead = <span class="built_in">reverseList</span>(head-&gt;next);</span><br><span class="line">        head-&gt;next-&gt;next = head;</span><br><span class="line">        head-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span> newHead;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="3-4-åè½¬é“¾è¡¨IIï¼š92"><a href="#3-4-åè½¬é“¾è¡¨IIï¼š92" class="headerlink" title="3-4.åè½¬é“¾è¡¨IIï¼š92"></a>3-4.åè½¬é“¾è¡¨IIï¼š92</h4><blockquote><p>æœ€ç®€å•çš„æ“ä½œå½“ç„¶æ˜¯ç›´æ¥ä¿®æ”¹å„ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚</p></blockquote><p>æ³•ä¸€ï¼šéå†ä¸¤æ¬¡</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reverseLinkedList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨é€’å½’åè½¬ä¸€ä¸ªé“¾è¡¨</span></span><br><span class="line">        ListNode* pre = <span class="literal">nullptr</span>;</span><br><span class="line">        ListNode* cur = head;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (cur != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            ListNode* next = cur-&gt;next;</span><br><span class="line">            cur-&gt;next = pre;</span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseBetween</span><span class="params">(ListNode* head, <span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å› ä¸ºå¤´èŠ‚ç‚¹æœ‰å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œä½¿ç”¨è™šæ‹Ÿå¤´èŠ‚ç‚¹å¯ä»¥é¿å…å¤æ‚çš„åˆ†ç±»è®¨è®º</span></span><br><span class="line">        ListNode* dummyNode = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">-1</span>);</span><br><span class="line">        dummyNode-&gt;next = head;</span><br><span class="line"></span><br><span class="line">        ListNode* pre = dummyNode;</span><br><span class="line">        <span class="comment">// ç¬¬ 1 æ­¥ï¼šä»è™šæ‹Ÿå¤´èŠ‚ç‚¹èµ° left - 1 æ­¥ï¼Œæ¥åˆ° left èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="comment">// å»ºè®®å†™åœ¨ for å¾ªç¯é‡Œï¼Œè¯­ä¹‰æ¸…æ™°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; left - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            pre = pre-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ 2 æ­¥ï¼šä» pre å†èµ° right - left + 1 æ­¥ï¼Œæ¥åˆ° right èŠ‚ç‚¹</span></span><br><span class="line">        ListNode* rightNode = pre;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; right - left + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            rightNode = rightNode-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ 3 æ­¥ï¼šåˆ‡æ–­å‡ºä¸€ä¸ªå­é“¾è¡¨ï¼ˆæˆªå–é“¾è¡¨ï¼‰</span></span><br><span class="line">        ListNode* leftNode = pre-&gt;next;</span><br><span class="line">        ListNode* curr = rightNode-&gt;next;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šåˆ‡æ–­é“¾æ¥</span></span><br><span class="line">        pre-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">        rightNode-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ 4 æ­¥ï¼šåŒç¬¬ 206 é¢˜ï¼Œåè½¬é“¾è¡¨çš„å­åŒºé—´</span></span><br><span class="line">        <span class="built_in">reverseLinkedList</span>(leftNode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ 5 æ­¥ï¼šæ¥å›åˆ°åŸæ¥çš„é“¾è¡¨ä¸­</span></span><br><span class="line">        pre-&gt;next = rightNode;</span><br><span class="line">        leftNode-&gt;next = curr;</span><br><span class="line">        <span class="keyword">return</span> dummyNode-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>å€¼å¾—æ³¨æ„çš„æ˜¯ç¬¬3æ­¥ï¼Œä»¥ä¸€ç§å·§å¦™çš„æ–¹å¼æˆªå–å‡ºäº†å­é“¾è¡¨ï¼Œä»è€Œä½¿é—®é¢˜ç®€åŒ–åˆ°é—®é¢˜3-3çš„æƒ…å½¢ã€‚</p></blockquote><p>æ³•äºŒï¼šåªéå†ä¸€æ¬¡(æœ€ä¼˜è§£)ï¼šå¤´æ’æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseBetween</span><span class="params">(ListNode* head, <span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">        ListNode* DummyHead=<span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">-1</span>,head);</span><br><span class="line">        ListNode* prev=DummyHead;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;left<span class="number">-1</span>;i++)&#123;</span><br><span class="line">            prev=prev-&gt;next;<span class="comment">//è®©prevæ¥åˆ°leftèŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line">        ListNode* curr=prev-&gt;next;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=left;i&lt;right;i++)&#123;</span><br><span class="line">            <span class="comment">//æ¯æ¬¡è®©å½“å‰çš„ç›®æ ‡èŠ‚ç‚¹currç½®å,nextå˜ä¸ºå­é“¾è¡¨é¦–ä½</span></span><br><span class="line">            <span class="comment">//prev-&gt;...-&gt;curr-&gt;next...å˜ä¸ºprev-&gt;...-&gt;next-&gt;curr...,è¯¦è§å®˜æ–¹å›¾è§£</span></span><br><span class="line">            ListNode* next=curr-&gt;next;</span><br><span class="line">            curr-&gt;next=next-&gt;next;</span><br><span class="line">            next-&gt;next=prev-&gt;next;</span><br><span class="line">            prev-&gt;next=next;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode* ans=DummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> DummyHead;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šè§£å†³åè½¬é“¾è¡¨è¿™ä¸€ç±»é—®é¢˜ï¼Œè¦å–„ç”¨prev,curr,nexté“¾è¡¨èŠ‚ç‚¹ï¼Œä»¥åŠDummyHeadã€‚</p><h4 id="3-5-Kä¸ªä¸€ç»„åè½¬é“¾è¡¨ï¼š25ï¼ˆå›°éš¾ï¼‰"><a href="#3-5-Kä¸ªä¸€ç»„åè½¬é“¾è¡¨ï¼š25ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="3-5.Kä¸ªä¸€ç»„åè½¬é“¾è¡¨ï¼š25ï¼ˆå›°éš¾ï¼‰"></a>3-5.Kä¸ªä¸€ç»„åè½¬é“¾è¡¨ï¼š25ï¼ˆå›°éš¾ï¼‰</h4><p>myReverse()ç±»æ¯”3-4å¤´æ’æ³•ä¸­çš„reverseBetween()ï¼Œå‰è€…æ˜¯å·²çŸ¥å¤´èŠ‚ç‚¹å’Œå°¾èŠ‚ç‚¹ï¼Œåè€…æ˜¯çŸ¥é“å¤´èŠ‚ç‚¹ã€èµ·å§‹ä½ç½®leftå’Œç»ˆæ­¢ä½ç½®right.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ç¿»è½¬ä¸€ä¸ªå­é“¾è¡¨ï¼Œå¹¶ä¸”è¿”å›æ–°çš„å¤´ä¸å°¾</span></span><br><span class="line">    <span class="function">pair&lt;ListNode*, ListNode*&gt; <span class="title">myReverse</span><span class="params">(ListNode* head, ListNode* tail)</span> </span>&#123;</span><br><span class="line">        ListNode* pre = tail-&gt;next;</span><br><span class="line">        ListNode* p = head;</span><br><span class="line">        <span class="keyword">while</span> (pre != tail) &#123;</span><br><span class="line">            ListNode* nex = p-&gt;next;</span><br><span class="line">            p-&gt;next = pre;</span><br><span class="line">            pre = p;</span><br><span class="line">            p = nex;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;tail, head&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseKGroup</span><span class="params">(ListNode* head, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">-1</span>, head);</span><br><span class="line">        ListNode* prev = DummyHead;</span><br><span class="line">        <span class="keyword">while</span> (head) &#123;</span><br><span class="line">            ListNode* tail = prev;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = k; i &gt; <span class="number">0</span>; i--) &#123; <span class="comment">// è¿™é‡Œä¸èƒ½ä½¿ç”¨while(k--),å› ä¸ºä¼šæ”¹å˜kçš„å€¼,å½±å“åˆ°ä¸‹ä¸€æ¬¡å¾ªç¯</span></span><br><span class="line">                tail = tail-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (tail == <span class="literal">nullptr</span>) &#123; <span class="comment">// å·²ç»åˆ°è¾¾æœ«å°¾</span></span><br><span class="line">                    ListNode* ans = DummyHead-&gt;next;</span><br><span class="line">                    <span class="keyword">delete</span> DummyHead;</span><br><span class="line">                    <span class="keyword">return</span> ans;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¾ªç¯ç»“æŸåï¼Œtailä¸ºå½“å‰è¦åè½¬å­é“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment">// prevä¸ºåè½¬å­é“¾è¡¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¹‹å‰çš„é‚£ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            ListNode* next = tail-&gt;next;</span><br><span class="line">            <span class="comment">// åè½¬å­é“¾è¡¨</span></span><br><span class="line">            pair&lt;ListNode*, ListNode*&gt; result = <span class="built_in">myReverse</span>(head, tail);</span><br><span class="line">            head = result.first;</span><br><span class="line">            tail = result.second;</span><br><span class="line">            <span class="comment">// æŠŠå­é“¾è¡¨é‡æ–°æ¥å›åŸé“¾è¡¨</span></span><br><span class="line">            prev-&gt;next = head;</span><br><span class="line">            tail-&gt;next = next;</span><br><span class="line">            prev = tail;</span><br><span class="line">            head = tail-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode* ans = DummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> DummyHead;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å®˜æ–¹é¢˜è§£ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ç¿»è½¬ä¸€ä¸ªå­é“¾è¡¨ï¼Œå¹¶ä¸”è¿”å›æ–°çš„å¤´ä¸å°¾</span></span><br><span class="line">    <span class="function">pair&lt;ListNode*, ListNode*&gt; <span class="title">myReverse</span><span class="params">(ListNode* head, ListNode* tail)</span> </span>&#123;</span><br><span class="line">        ListNode* prev = tail-&gt;next;</span><br><span class="line">        ListNode* p = head;</span><br><span class="line">        <span class="keyword">while</span> (prev != tail) &#123;</span><br><span class="line">            ListNode* nex = p-&gt;next;</span><br><span class="line">            p-&gt;next = prev;</span><br><span class="line">            prev = p;</span><br><span class="line">            p = nex;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;tail, head&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseKGroup</span><span class="params">(ListNode* head, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        ListNode* hair = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        hair-&gt;next = head;</span><br><span class="line">        ListNode* pre = hair;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (head) &#123;</span><br><span class="line">            ListNode* tail = pre;</span><br><span class="line">            <span class="comment">// æŸ¥çœ‹å‰©ä½™éƒ¨åˆ†é•¿åº¦æ˜¯å¦å¤§äºç­‰äº k</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">                tail = tail-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (!tail) &#123;</span><br><span class="line">                    <span class="keyword">return</span> hair-&gt;next;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ListNode* nex = tail-&gt;next;</span><br><span class="line">            <span class="comment">// è¿™é‡Œæ˜¯ C++17 çš„å†™æ³•ï¼Œä¹Ÿå¯ä»¥å†™æˆ</span></span><br><span class="line">            <span class="comment">// pair&lt;ListNode*, ListNode*&gt; result = myReverse(head, tail);</span></span><br><span class="line">            <span class="comment">// head = result.first;</span></span><br><span class="line">            <span class="comment">// tail = result.second;</span></span><br><span class="line">            <span class="built_in">tie</span>(head, tail) = <span class="built_in">myReverse</span>(head, tail);</span><br><span class="line">            <span class="comment">// æŠŠå­é“¾è¡¨é‡æ–°æ¥å›åŸé“¾è¡¨</span></span><br><span class="line">            pre-&gt;next = head;</span><br><span class="line">            tail-&gt;next = nex;</span><br><span class="line">            pre = tail;</span><br><span class="line">            head = tail-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> hair-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å›¾è§£ï¼š<a href="https://leetcode.cn/problems/reverse-nodes-in-k-group/solutions/1/di-gui-java-by-reedfan-2/">åŠ›æ‰£ï¼ˆLeetCodeï¼‰â€”reedfan</a></p><p><img src="https://s2.loli.net/2024/03/23/KFI7V3HMYPnWix9.png" alt="firefox_hd33huMeCd"></p><h1 id="4-é“¾è¡¨é«˜ç²¾åº¦åŠ æ³•"><a href="#4-é“¾è¡¨é«˜ç²¾åº¦åŠ æ³•" class="headerlink" title="4.é“¾è¡¨é«˜ç²¾åº¦åŠ æ³•"></a>4.é“¾è¡¨é«˜ç²¾åº¦åŠ æ³•</h1><h4 id="4-1-ä¸¤æ•°ç›¸åŠ ï¼š2"><a href="#4-1-ä¸¤æ•°ç›¸åŠ ï¼š2" class="headerlink" title="4-1.ä¸¤æ•°ç›¸åŠ ï¼š2"></a>4-1.ä¸¤æ•°ç›¸åŠ ï¼š2</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        ListNode* ans = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        ListNode* head = ans;</span><br><span class="line">        <span class="type">int</span> value = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l1 || l2) &#123;</span><br><span class="line">            <span class="type">int</span> val1 = l1 ? l1-&gt;val : <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> val2 = l2 ? l2-&gt;val : <span class="number">0</span>;</span><br><span class="line">            value += val1 + val2;</span><br><span class="line">            ans-&gt;val = value % <span class="number">10</span>;</span><br><span class="line">            value /= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">if</span> (l1) &#123;</span><br><span class="line">                l1 = l1-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (l2) &#123;</span><br><span class="line">                l2 = l2-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (l1 || l2) &#123;</span><br><span class="line">                ans-&gt;next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(value);</span><br><span class="line">                ans = ans-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (value) &#123;</span><br><span class="line">            ans-&gt;next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å…³é”®åœ¨äºç¬¬7-9è¡Œçš„å¤„ç†ï¼Œè¿™æ ·å¯ä»¥å°½å¯èƒ½ç®€åŒ–ä»£ç ã€‚è¿™é‡Œç»™å‡ºå¯¹æ¯”ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> pre = <span class="number">0</span>; <span class="comment">//è¿›ä½</span></span><br><span class="line">        ListNode res = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">-1</span>);</span><br><span class="line">        ListNode p = res;</span><br><span class="line">        <span class="keyword">while</span> (l1 != null &amp;&amp; l2 != null) &#123;</span><br><span class="line">            <span class="type">int</span> cur = l1.val + l2.val + pre;</span><br><span class="line">            <span class="keyword">if</span> (cur &gt;= <span class="number">10</span>) &#123; <span class="comment">// è¿›ä½</span></span><br><span class="line">                pre = <span class="number">1</span>;</span><br><span class="line">                cur %= <span class="number">10</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                pre = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p.next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(cur);</span><br><span class="line">            p = p.next;</span><br><span class="line">            l1 = l1.next;</span><br><span class="line">            l2 = l2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (l1 != null) &#123;</span><br><span class="line">            <span class="type">int</span> cur = l1.val + pre;</span><br><span class="line">            <span class="keyword">if</span> (cur &gt;= <span class="number">10</span>) &#123; <span class="comment">// è¿›ä½</span></span><br><span class="line">                pre = <span class="number">1</span>;</span><br><span class="line">                cur %= <span class="number">10</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                pre = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p.next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(cur);</span><br><span class="line">            p = p.next;</span><br><span class="line">            l1 = l1.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (l2 != null) &#123;</span><br><span class="line">            <span class="type">int</span> cur = l2.val + pre;</span><br><span class="line">            <span class="keyword">if</span> (cur &gt;= <span class="number">10</span>) &#123; <span class="comment">// è¿›ä½</span></span><br><span class="line">                pre = <span class="number">1</span>;</span><br><span class="line">                cur %= <span class="number">10</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                pre = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p.next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(cur);</span><br><span class="line">            p = p.next;</span><br><span class="line">            l2 = l2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pre == <span class="number">1</span>) &#123;</span><br><span class="line">            p.next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-2-ä¸¤æ•°ç›¸åŠ IIï¼š445"><a href="#4-2-ä¸¤æ•°ç›¸åŠ IIï¼š445" class="headerlink" title="4-2.ä¸¤æ•°ç›¸åŠ IIï¼š445"></a>4-2.ä¸¤æ•°ç›¸åŠ IIï¼š445</h4><p>æ³•ä¸€ï¼šå…ˆåè½¬é“¾è¡¨ï¼Œå†ç›¸åŠ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addListNodes</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        ListNode* dummy = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        ListNode* current = dummy;</span><br><span class="line">        <span class="type">int</span> carry = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l1 || l2 || carry) &#123;</span><br><span class="line">            <span class="type">int</span> sum = (l1 ? l1-&gt;val : <span class="number">0</span>) + (l2 ? l2-&gt;val : <span class="number">0</span>) + carry;</span><br><span class="line">            carry = sum / <span class="number">10</span>;</span><br><span class="line">            current-&gt;next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(sum % <span class="number">10</span>);</span><br><span class="line">            current = current-&gt;next;</span><br><span class="line">            <span class="keyword">if</span> (l1) &#123;</span><br><span class="line">                l1 = l1-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (l2) &#123;</span><br><span class="line">                l2 = l2-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummy-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        ListNode* curr = head;</span><br><span class="line">        ListNode* prev = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">while</span> (curr) &#123;</span><br><span class="line">            ListNode* next = curr-&gt;next;</span><br><span class="line">            curr-&gt;next = prev;</span><br><span class="line">            prev = curr;</span><br><span class="line">            curr = next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        l1 = <span class="built_in">reverseList</span>(l1);</span><br><span class="line">        l2 = <span class="built_in">reverseList</span>(l2);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">reverseList</span>(<span class="built_in">addListNodes</span>(l1, l2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šç”¨æ ˆ/æ•°ç»„(ç»ƒä¹ æ„ä¹‰ä¸å¤§,ä½†æ˜¯æœ€ä¼˜è§£)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; s1, s2;</span><br><span class="line">        <span class="keyword">while</span> (l1) &#123;</span><br><span class="line">            s1.<span class="built_in">push</span>(l1 -&gt; val);</span><br><span class="line">            l1 = l1 -&gt; next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (l2) &#123;</span><br><span class="line">            s2.<span class="built_in">push</span>(l2 -&gt; val);</span><br><span class="line">            l2 = l2 -&gt; next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> carry = <span class="number">0</span>;</span><br><span class="line">        ListNode* ans = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">while</span> (!s1.<span class="built_in">empty</span>() <span class="keyword">or</span> !s2.<span class="built_in">empty</span>() <span class="keyword">or</span> carry != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> a = s1.<span class="built_in">empty</span>() ? <span class="number">0</span> : s1.<span class="built_in">top</span>();</span><br><span class="line">            <span class="type">int</span> b = s2.<span class="built_in">empty</span>() ? <span class="number">0</span> : s2.<span class="built_in">top</span>();</span><br><span class="line">            <span class="keyword">if</span> (!s1.<span class="built_in">empty</span>()) s1.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (!s2.<span class="built_in">empty</span>()) s2.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="type">int</span> cur = a + b + carry;</span><br><span class="line">            carry = cur / <span class="number">10</span>;</span><br><span class="line">            cur %= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">auto</span> curnode = <span class="keyword">new</span> <span class="built_in">ListNode</span>(cur);</span><br><span class="line">            curnode -&gt; next = ans;</span><br><span class="line">            ans = curnode;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="5-é“¾è¡¨çš„åˆå¹¶"><a href="#5-é“¾è¡¨çš„åˆå¹¶" class="headerlink" title="5.é“¾è¡¨çš„åˆå¹¶"></a>5.é“¾è¡¨çš„åˆå¹¶</h1><h4 id="5-1-åˆæˆä¸¤ä¸ªæœ‰åºé“¾è¡¨ï¼š21"><a href="#5-1-åˆæˆä¸¤ä¸ªæœ‰åºé“¾è¡¨ï¼š21" class="headerlink" title="5-1.åˆæˆä¸¤ä¸ªæœ‰åºé“¾è¡¨ï¼š21"></a>5-1.åˆæˆä¸¤ä¸ªæœ‰åºé“¾è¡¨ï¼š21</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">mergeTwoLists</span><span class="params">(ListNode* list1, ListNode* list2)</span> </span>&#123;</span><br><span class="line">        ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        ListNode* curr = DummyHead;</span><br><span class="line">        <span class="type">int</span> value = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (list1 &amp;&amp; list2) &#123;</span><br><span class="line">            value = <span class="built_in">min</span>(list1-&gt;val, list2-&gt;val);</span><br><span class="line">            curr-&gt;next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(value);</span><br><span class="line">            curr = curr-&gt;next; <span class="comment">// è®°å¾—æ›´æ–°curr</span></span><br><span class="line">            <span class="keyword">if</span> (list1-&gt;val &lt;= list2-&gt;val) &#123;</span><br><span class="line">                list1 = list1-&gt;next;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                list2 = list2-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (list1 || list2) &#123;</span><br><span class="line">            curr-&gt;next = list1 ? list1 : list2;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ListNode* ans = DummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> DummyHead;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="5-2-åˆå¹¶Kä¸ªå‡åºé“¾è¡¨ï¼š23ï¼ˆå›°éš¾ï¼‰"><a href="#5-2-åˆå¹¶Kä¸ªå‡åºé“¾è¡¨ï¼š23ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="5-2.åˆå¹¶Kä¸ªå‡åºé“¾è¡¨ï¼š23ï¼ˆå›°éš¾ï¼‰"></a>5-2.åˆå¹¶Kä¸ªå‡åºé“¾è¡¨ï¼š23ï¼ˆå›°éš¾ï¼‰</h4><h6 id="æ³•ä¸€ï¼šåˆ†æ²»åˆå¹¶ï¼ˆæœ€ä¼˜è§£ï¼‰"><a href="#æ³•ä¸€ï¼šåˆ†æ²»åˆå¹¶ï¼ˆæœ€ä¼˜è§£ï¼‰" class="headerlink" title="æ³•ä¸€ï¼šåˆ†æ²»åˆå¹¶ï¼ˆæœ€ä¼˜è§£ï¼‰"></a>æ³•ä¸€ï¼šåˆ†æ²»åˆå¹¶ï¼ˆæœ€ä¼˜è§£ï¼‰</h6><p>ä¸¤ä¸ªä¸€ç»„è¿›è¡Œåˆå¹¶</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">mergeTwoLists</span><span class="params">(ListNode* a, ListNode* b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ((!a) || (!b))</span><br><span class="line">            <span class="keyword">return</span> a ? a : b;</span><br><span class="line">        ListNode head, *tail = &amp;head, *aPtr = a, *bPtr = b;</span><br><span class="line">        <span class="keyword">while</span> (aPtr &amp;&amp; bPtr) &#123;</span><br><span class="line">            <span class="keyword">if</span> (aPtr-&gt;val &lt; bPtr-&gt;val) &#123;</span><br><span class="line">                tail-&gt;next = aPtr;</span><br><span class="line">                aPtr = aPtr-&gt;next;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tail-&gt;next = bPtr;</span><br><span class="line">                bPtr = bPtr-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            tail = tail-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        tail-&gt;next = (aPtr ? aPtr : bPtr);</span><br><span class="line">        <span class="keyword">return</span> head.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ListNode* <span class="title">merge</span><span class="params">(vector&lt;ListNode*&gt;&amp; lists, <span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">            <span class="keyword">return</span> lists[left];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (left &gt; right) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">mergeTwoLists</span>(<span class="built_in">merge</span>(lists, left, mid), <span class="built_in">merge</span>(lists, mid + <span class="number">1</span>, right));   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ListNode* <span class="title">mergeKLists</span><span class="params">(vector&lt;ListNode*&gt;&amp; lists)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">merge</span>(lists, <span class="number">0</span>, lists.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>æ³¨ï¼šmergeTwoLists()ä¸¤ç§å†™æ³•çš„æ—¶ç©ºå¼€é”€å·®å¼‚åˆ†æ</strong></p><p>æ–¹æ³•ä¸€ï¼ˆ30ms,30MBï¼‰:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">mergeTwoLists</span><span class="params">(ListNode* list1, ListNode* list2)</span> </span>&#123;</span><br><span class="line">    ListNode* DummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">    ListNode* curr = DummyHead;</span><br><span class="line">    <span class="type">int</span> value = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (list1 &amp;&amp; list2) &#123;</span><br><span class="line">        value = <span class="built_in">min</span>(list1-&gt;val, list2-&gt;val);</span><br><span class="line">        curr-&gt;next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(value);</span><br><span class="line">        curr = curr-&gt;next; <span class="comment">// è®°å¾—æ›´æ–°curr</span></span><br><span class="line">        <span class="keyword">if</span> (list1-&gt;val &lt;= list2-&gt;val) &#123;</span><br><span class="line">            list1 = list1-&gt;next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            list2 = list2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (list1 || list2) &#123;</span><br><span class="line">        curr-&gt;next = list1 ? list1 : list2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ListNode* ans = DummyHead-&gt;next;</span><br><span class="line">    <span class="keyword">delete</span> DummyHead;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼ˆ11ms,16MBï¼‰:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">mergeTwoLists</span><span class="params">(ListNode* a, ListNode* b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((!a) || (!b))</span><br><span class="line">        <span class="keyword">return</span> a ? a : b;</span><br><span class="line">    ListNode head, *tail = &amp;head, *aPtr = a, *bPtr = b;<span class="comment">//æ³¨æ„è¿™é‡Œçš„headæ˜¯ListNodeå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">while</span> (aPtr &amp;&amp; bPtr) &#123;</span><br><span class="line">        <span class="keyword">if</span> (aPtr-&gt;val &lt; bPtr-&gt;val) &#123;</span><br><span class="line">            tail-&gt;next = aPtr;</span><br><span class="line">            aPtr = aPtr-&gt;next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tail-&gt;next = bPtr;</span><br><span class="line">            bPtr = bPtr-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        tail = tail-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    tail-&gt;next = (aPtr ? aPtr : bPtr);</span><br><span class="line">    <span class="keyword">return</span> head.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åŒæ ·çš„æ—¶ç©ºå¤æ‚åº¦ï¼Œä¸ºä»€ä¹ˆç¬¬äºŒç§æ–¹æ³•å¼€é”€æ›´å°ï¼Ÿ</p></blockquote><p>å› ä¸ºç¬¬ä¸€ç§æ–¹æ³•åœ¨åˆå¹¶é“¾è¡¨çš„è¿‡ç¨‹ä¸­ï¼Œåˆ›å»ºäº†æ–°çš„èŠ‚ç‚¹æ¥å­˜å‚¨åˆå¹¶åçš„ç»“æœï¼Œè¿™å¯¼è‡´äº†é¢å¤–çš„ç©ºé—´å¼€é”€ï¼›åŒæ—¶ï¼Œæ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­éƒ½éœ€è¦åŠ¨æ€åˆ†é…æ–°çš„èŠ‚ç‚¹ï¼Œè¿™å¯¼è‡´é€Ÿåº¦æ›´æ…¢ã€‚ç¬¬äºŒç§æ–¹æ³•åªæ˜¯åœ¨åŸæœ‰èŠ‚ç‚¹çš„åŸºç¡€ä¸Šè¿›è¡Œè¿æ¥ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°çš„èŠ‚ç‚¹ã€‚</p><h6 id="æ³•äºŒï¼šä¼˜å…ˆé˜Ÿåˆ—"><a href="#æ³•äºŒï¼šä¼˜å…ˆé˜Ÿåˆ—" class="headerlink" title="æ³•äºŒï¼šä¼˜å…ˆé˜Ÿåˆ—"></a>æ³•äºŒï¼šä¼˜å…ˆé˜Ÿåˆ—</h6><p>è¿™æ ·å°±ç›¸å½“äºå…ˆæŠŠæ‰€æœ‰é“¾è¡¨èŠ‚ç‚¹çš„å€¼æŒ¨ä¸ªæ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œç„¶åè®©å…¶è‡ªè¡Œè¿›è¡Œå¿«é€Ÿæ’åºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Status</span> &#123;</span><br><span class="line">        <span class="type">int</span> val;</span><br><span class="line">        ListNode *ptr;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Status &amp;rhs) <span class="type">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> val &gt; rhs.val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    priority_queue &lt;Status&gt; q;</span><br><span class="line"></span><br><span class="line">    <span class="function">ListNode* <span class="title">mergeKLists</span><span class="params">(vector&lt;ListNode*&gt;&amp; lists)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> node: lists) &#123;</span><br><span class="line">            <span class="keyword">if</span> (node) q.<span class="built_in">push</span>(&#123;node-&gt;val, node&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode head, *tail = &amp;head;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">auto</span> f = q.<span class="built_in">top</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            tail-&gt;next = f.ptr; </span><br><span class="line">            tail = tail-&gt;next;</span><br><span class="line">            <span class="keyword">if</span> (f.ptr-&gt;next) q.<span class="built_in">push</span>(&#123;f.ptr-&gt;next-&gt;val, f.ptr-&gt;next&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> head.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>é‡è½½è¿ç®—ç¬¦â€™&lt;â€™ï¼Œç”¨äºè‡ªå®šä¹‰ç±»å‹Statusçš„æ¯”è¾ƒè§„åˆ™ï¼Œä½¿å¾—åœ¨ä¼˜å…ˆé˜Ÿåˆ—ä¸­å¯ä»¥æŒ‰ç…§<code>val</code>çš„å€¼è¿›è¡Œé™åºæ’åˆ—ã€‚(è‡ªå®šä¹‰æ¯”è¾ƒå™¨)</p></blockquote><p>å…³äºä¼˜å…ˆé˜Ÿåˆ—priority_queueï¼Œè¯¦è§ã€Š0.å¸¸ç”¨STLç”¨æ³•ã€‹çš„2-5.</p>]]></content>
    
    
    <summary type="html">é“¾è¡¨éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="é“¾è¡¨" scheme="https://sumikiru.top/tags/%E9%93%BE%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>4.æ ˆä¸é€’å½’ç¯‡</title>
    <link href="https://sumikiru.top/posts/8a02a46e.html"/>
    <id>https://sumikiru.top/posts/8a02a46e.html</id>
    <published>2024-05-17T14:41:50.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-ç”¨æ ˆè®¿é—®æœ€åè‹¥å¹²å…ƒç´ "><a href="#1-ç”¨æ ˆè®¿é—®æœ€åè‹¥å¹²å…ƒç´ " class="headerlink" title="1.ç”¨æ ˆè®¿é—®æœ€åè‹¥å¹²å…ƒç´ "></a>1.ç”¨æ ˆè®¿é—®æœ€åè‹¥å¹²å…ƒç´ </h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stack.<span class="built_in">push_back</span>(<span class="built_in">move</span>(name));</span><br></pre></td></tr></table></figure><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ<code>move(name)</code> ä½¿ç”¨äº† C++ ä¸­çš„ <code>std::move</code> å‡½æ•°ã€‚<code>std::move</code> æ˜¯ä¸€ä¸ªç”¨äº<u>å°†å¯¹è±¡è½¬æ¢ä¸ºå³å€¼å¼•ç”¨</u>çš„å‡½æ•°ï¼Œå®ƒå…è®¸å°†å¯¹è±¡çš„æ‰€æœ‰æƒè½¬ç§»ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼Œé€šå¸¸ç”¨äºåœ¨ç§»åŠ¨è¯­ä¹‰ä¸­ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ<code>move(name)</code> å¯èƒ½æ˜¯åœ¨å°† <code>name</code> å¯¹è±¡çš„æ‰€æœ‰æƒè½¬ç§»ç»™ <code>stack</code> å®¹å™¨ï¼Œè¿™æ ·åšé€šå¸¸å¯ä»¥<mark>æé«˜æ€§èƒ½ï¼Œé¿å…ä¸å¿…è¦çš„æ‹·è´æ“ä½œ</mark>ã€‚</p><h4 id="1-1-æ–‡ä»¶çš„æœ€é•¿ç»å¯¹è·¯å¾„ï¼š388"><a href="#1-1-æ–‡ä»¶çš„æœ€é•¿ç»å¯¹è·¯å¾„ï¼š388" class="headerlink" title="1-1.æ–‡ä»¶çš„æœ€é•¿ç»å¯¹è·¯å¾„ï¼š388"></a>1-1.æ–‡ä»¶çš„æœ€é•¿ç»å¯¹è·¯å¾„ï¼š388</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lengthLongestPath</span><span class="params">(string input)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>, pos = <span class="number">0</span>, n = input.<span class="built_in">length</span>();</span><br><span class="line">        stack&lt;<span class="type">int</span>&gt;st;<span class="comment">//ç”¨æ¥è®°å½•æ¯ä¸€æ®µçš„é•¿åº¦</span></span><br><span class="line">        <span class="comment">// posä½œä¸ºæŒ‡é’ˆ</span></span><br><span class="line">        <span class="keyword">while</span> (pos &lt; n) &#123;</span><br><span class="line">            <span class="comment">// æ£€æµ‹å½“å‰æ–‡ä»¶æ·±åº¦</span></span><br><span class="line">            <span class="type">int</span> depth = <span class="number">1</span>;</span><br><span class="line">            <span class="comment">//&#x27;\t&#x27;æ˜¯ä¸€ä¸ªç¬¦å·ï¼Œè¿™é‡Œä¸æ˜¯&#x27;\&#x27;å’Œ&#x27;t&#x27;</span></span><br><span class="line">            <span class="keyword">while</span> (pos &lt; n &amp;&amp; input[pos] == <span class="string">&#x27;\t&#x27;</span>) &#123;</span><br><span class="line">                ++pos;</span><br><span class="line">                ++depth;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ç»Ÿè®¡å½“å‰æ–‡ä»¶åçš„é•¿åº¦</span></span><br><span class="line">            <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">            <span class="type">bool</span> isFile = <span class="literal">false</span>; <span class="comment">// è®°å½•æ˜¯å¦ä¸ºæ–‡ä»¶åè€Œéç›®å½•å</span></span><br><span class="line">            <span class="keyword">while</span> (pos &lt; n &amp;&amp; input[pos] != <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (input[pos] == <span class="string">&#x27;.&#x27;</span>) &#123;</span><br><span class="line">                    isFile = <span class="literal">true</span>; <span class="comment">// å› ä¸ºæ­¤æ—¶åé¢å¿…å®šæ˜¯.ext</span></span><br><span class="line">                &#125;</span><br><span class="line">                ++len;</span><br><span class="line">                ++pos;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è·³è¿‡æ¢è¡Œç¬¦</span></span><br><span class="line">            ++pos;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// é‡åˆ°ä¸€æ¬¡æ¢è¡Œç¬¦ä¹‹åçš„æ“ä½œï¼Œå¯¹æ ˆstè¿›è¡Œæ“ä½œ</span></span><br><span class="line">            <span class="keyword">while</span> (st.<span class="built_in">size</span>() &gt;= depth) &#123;</span><br><span class="line">                st.<span class="built_in">pop</span>();<span class="comment">//å›é€€ä¸€ä¸ªæ–‡ä»¶å±‚çº§</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!st.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                len += st.<span class="built_in">top</span>() + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (isFile) &#123;</span><br><span class="line">                ans = <span class="built_in">max</span>(ans, len);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                st.<span class="built_in">emplace</span>(len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p><code>stack.emplace(a)</code> çš„æ„æ€æ˜¯åœ¨æ ˆé¡¶åˆ›å»ºä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œå¹¶å°†å‚æ•° <code>a</code> ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°ï¼Œç”¨äºæ„é€ è¿™ä¸ªæ–°çš„å…ƒç´ ã€‚<code>push_back()</code>ï¼Œ<code>emplace_back()</code>ç­‰æœ€ç»ˆè°ƒç”¨çš„éƒ½æ˜¯<code>emplace_back()</code>ï¼Œæ€§èƒ½å¹¶æ— åŒºåˆ«ã€‚</p></blockquote><p>å…³äºemplace():<a href="https://www.jianshu.com/p/caad33287dc3">emplace/emplace_back - ç®€ä¹¦</a></p><h1 id="2-æ ˆä¸è®¡ç®—å™¨"><a href="#2-æ ˆä¸è®¡ç®—å™¨" class="headerlink" title="2.æ ˆä¸è®¡ç®—å™¨"></a>2.æ ˆä¸è®¡ç®—å™¨</h1><h5 id="2-1-é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ï¼š150"><a href="#2-1-é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ï¼š150" class="headerlink" title="2-1.é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ï¼š150"></a>2-1.é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ï¼š150</h5><blockquote><p>   é€†æ³¢å…°è¡¨è¾¾å¼ä¸¥æ ¼éµå¾ªã€Œä»å·¦åˆ°å³ã€çš„è¿ç®—ã€‚è®¡ç®—é€†æ³¢å…°è¡¨è¾¾å¼çš„å€¼æ—¶ï¼Œä½¿ç”¨ä¸€ä¸ªæ ˆå­˜å‚¨æ“ä½œæ•°ï¼Œä»å·¦åˆ°å³éå†é€†æ³¢å…°è¡¨è¾¾å¼ï¼Œè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><p>1.å¦‚æœé‡åˆ°æ“ä½œæ•°ï¼Œåˆ™å°†æ“ä½œæ•°å…¥æ ˆï¼›</p><p>2.å¦‚æœé‡åˆ°è¿ç®—ç¬¦ï¼Œåˆ™å°†ä¸¤ä¸ªæ“ä½œæ•°å‡ºæ ˆï¼Œå…¶ä¸­<mark>å…ˆå‡ºæ ˆçš„æ˜¯å³æ“ä½œæ•°</mark>ï¼Œåå‡ºæ ˆçš„æ˜¯å·¦æ“ä½œæ•°ï¼Œä½¿ç”¨è¿ç®—ç¬¦å¯¹ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œè¿ç®—ï¼Œå°†è¿ç®—å¾—åˆ°çš„æ–°æ“ä½œæ•°å…¥æ ˆã€‚</p><p>   æ•´ä¸ªé€†æ³¢å…°è¡¨è¾¾å¼éå†å®Œæ¯•ä¹‹åï¼Œæ ˆå†…åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œè¯¥å…ƒç´ å³ä¸ºé€†æ³¢å…°è¡¨è¾¾å¼çš„å€¼ã€‚[â€œ13â€,â€5â€,â€/â€œ]åˆ™è¡¨ç¤º13/5.</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">isNumber</span><span class="params">(string&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> !(s == <span class="string">&quot;+&quot;</span> || s == <span class="string">&quot;-&quot;</span> || s == <span class="string">&quot;*&quot;</span> || s == <span class="string">&quot;/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">evalRPN</span><span class="params">(vector&lt;string&gt;&amp; tokens)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = tokens.<span class="built_in">size</span>();</span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; stk;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            string&amp; token = tokens[i];</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isNumber</span>(token)) &#123;</span><br><span class="line">                stk.<span class="built_in">emplace</span>(<span class="built_in">stoi</span>(token));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//æ³¨æ„num2å’Œnum1çš„å…ˆåé¡ºåº</span></span><br><span class="line">                <span class="type">int</span> num2 = stk.<span class="built_in">top</span>();</span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="type">int</span> num1 = stk.<span class="built_in">top</span>();</span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">switch</span> (token[<span class="number">0</span>]) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                        stk.<span class="built_in">emplace</span>(num1 + num2);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                        stk.<span class="built_in">emplace</span>(num1 - num2);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">                        stk.<span class="built_in">emplace</span>(num1 * num2);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">                        stk.<span class="built_in">emplace</span>(num1 / num2);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stk.<span class="built_in">top</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„<code>emplace()</code>ä¹Ÿå¯ä»¥æ”¹ç”¨<code>push()</code>ã€‚ä¸ºä»€ä¹ˆä¸æ˜¯<code>emplace_back()/push_back()</code>çš„åŸå› ï¼š<code>emplace()/push()</code>å¯¹åº”<u>stack/queue</u>ï¼Œ<code>emplace_back()/push_back()</code>å¯¹åº”<u>list/vector</u>(åŒ…æ‹¬stringè¿™ç§ç‰¹æ®Šçš„å­—ç¬¦æ•°ç»„)ã€‚</p><h5 id="2-2-åŸºæœ¬è®¡ç®—å™¨II-227"><a href="#2-2-åŸºæœ¬è®¡ç®—å™¨II-227" class="headerlink" title="2-2.åŸºæœ¬è®¡ç®—å™¨II:227"></a>2-2.åŸºæœ¬è®¡ç®—å™¨II:227</h5><p>æœ¬é¢˜ä¸éœ€è¦å…ˆå°†ä¸­ç¼€è¡¨è¾¾å¼è½¬ä¸ºåç¼€è¡¨è¾¾å¼ï¼Œå› ä¸ºå…¨æ˜¯æ­£æ•´æ•°å¹¶ä¸”æ²¡æœ‰æ‹¬å·ã€‚è¯¥é¢˜æœ¬è´¨ä¸Šæ˜¯ç”¨æ ˆæ¥å¤„ç†ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨stack/vectorã€‚</p><p>1.ä½¿ç”¨stack:ï¼ˆæ˜“é”™ç‚¹è¾ƒå¤šï¼Œéœ€è¦æ³¨æ„ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">calculate</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; stk;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> sign = <span class="string">&#x27;+&#x27;</span>; <span class="comment">// è®°å½•æ•°å­—å‰çš„ç¬¦å·ï¼Œé»˜è®¤ä¸ºæ­£</span></span><br><span class="line">        <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isdigit</span>(s[i])) &#123;</span><br><span class="line">                num = num * <span class="number">10</span> + <span class="built_in">int</span>(s[i] - <span class="string">&#x27;0&#x27;</span>); <span class="comment">// å°å¿ƒæº¢å‡º</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">isdigit</span>(s[i]) &amp;&amp; s[i] != <span class="string">&#x27; &#x27;</span> || i == n - <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// è®°å¾—è€ƒè™‘ç©ºæ ¼å’Œæœ«ä½çš„ç‰¹æ®Šæƒ…å†µ</span></span><br><span class="line">                <span class="keyword">switch</span> (sign) &#123; <span class="comment">// æ˜¯signè€Œä¸æ˜¯s[i],å¦åˆ™ç¬¬ä¸€ä¸ªæ•°å­—æ— æ³•å­˜æ”¾</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                    stk.<span class="built_in">push</span>(num);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                    stk.<span class="built_in">push</span>(-num);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">                    stk.<span class="built_in">top</span>() *= num;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">                    stk.<span class="built_in">top</span>() /= num;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// å¤„ç†å®Œè¿ç®—ç¬¦ä»¥åï¼Œæ›´æ–°ç¬¦å·å’Œæ•°å­—</span></span><br><span class="line">                sign = s[i];</span><br><span class="line">                num = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!stk.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            sum += stk.<span class="built_in">top</span>();</span><br><span class="line">            stk.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š<code>num = num * 10 + s[i] - &#39;0&#39;;</code>ä¼šå¯¼è‡´æº¢å‡ºï¼Œå› ä¸ºè¿™æ—¶çš„è¿ç®—é¡ºåºæ˜¯å…ˆå°†num*10åŠ ä¸Šè½¬ä¸ºintçš„s[i]ï¼Œä¹‹åå†å‡å»â€™0â€™è½¬ä¸ºçš„intå€¼ã€‚è€Œ<code>int(s[i]-&#39;0&#39;)</code>åˆ™èƒ½å¤Ÿé¿å…æº¢å‡ºã€‚</p></blockquote><p>2.ä½¿ç”¨vector:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">calculate</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; stk;</span><br><span class="line">        <span class="type">char</span> preSign = <span class="string">&#x27;+&#x27;</span>;</span><br><span class="line">        <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isdigit</span>(s[i])) &#123;</span><br><span class="line">                num = num * <span class="number">10</span> + <span class="built_in">int</span>(s[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">isdigit</span>(s[i]) &amp;&amp; s[i] != <span class="string">&#x27; &#x27;</span> || i == n - <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">switch</span> (preSign) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                        stk.<span class="built_in">push_back</span>(num);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                        stk.<span class="built_in">push_back</span>(-num);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">                        stk.<span class="built_in">back</span>() *= num;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        stk.<span class="built_in">back</span>() /= num;</span><br><span class="line">                &#125;</span><br><span class="line">                preSign = s[i];</span><br><span class="line">                num = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">accumulate</span>(stk.<span class="built_in">begin</span>(), stk.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å¯¹æ¯”å¯ä»¥çœ‹å‡ºï¼ŒäºŒè€…è°ƒç”¨çš„æ–¹æ³•ç•¥æœ‰ä¸åŒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">    %%éœ€è¦ä½¿ç”¨â€œ â€åŒå¼•å·å°†ï¼ˆï¼‰è¿›è¡Œæ‹¬èµ·æ¥ï¼Œå¹¶ç»™å‡ºä¸€ä¸ªå‘½åï¼Œå¦åˆ™æ‹¬å·ä¸å¯ç”¨</span><br><span class="line">    subgraph vector</span><br><span class="line">        A(&quot;push_back()&quot;)</span><br><span class="line">        B[&quot;back()&quot;] </span><br><span class="line">        C[&quot;accumulate()&quot;]</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    subgraph stack</span><br><span class="line">        D(&quot;push()&quot;)</span><br><span class="line">        E[&quot;top()&quot;]</span><br><span class="line">        å¾ªç¯ç´¯åŠ </span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    A&lt;--&gt;D</span><br><span class="line">    B&lt;--&gt;E</span><br><span class="line">    C&lt;--&gt;å¾ªç¯ç´¯åŠ </span><br></pre></td></tr></table></figure><h4 id="2-3-åŸºæœ¬è®¡ç®—å™¨ï¼š224ï¼ˆå›°éš¾ï¼‰"><a href="#2-3-åŸºæœ¬è®¡ç®—å™¨ï¼š224ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="2-3.åŸºæœ¬è®¡ç®—å™¨ï¼š224ï¼ˆå›°éš¾ï¼‰"></a>2-3.åŸºæœ¬è®¡ç®—å™¨ï¼š224ï¼ˆå›°éš¾ï¼‰</h4><p>ç›¸æ¯”ä¸Šä¸€é“é¢˜ï¼Œå…¶å®å°±æ˜¯å¤šäº†æ‹¬å·å’Œè´Ÿæ•°ï¼Œæœ¬è´¨æ˜¯æ ¹æ®â€™+â€™åˆ†æ®µå­˜å…¥æ ˆä¸­å¹¶è®¡ç®—ã€‚è¿™ç±»é¢˜å¦‚æœé‡‡å–å…ˆè½¬ä¸ºé€†æ³¢å…°è¡¨è¾¾å¼ã€å†è®¡ç®—ç»“æœçš„æ–¹æ³•ï¼Œä¼šä½¿å¾—ä»£ç éå¸¸åºæ‚ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">calculate</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; stk; <span class="comment">// è¿™é‡Œstkå­˜å‚¨çš„ä¸æ˜¯æ“ä½œæ•°ï¼Œè€Œæ˜¯ç¬¦å·ops</span></span><br><span class="line">        stk.<span class="built_in">push</span>(<span class="number">1</span>);    <span class="comment">// é»˜è®¤ä¸ºæ­£å·ï¼Œæ‰€ä»¥æå‰å­˜å‚¨1è¿›å»</span></span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>, pos = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> sign = <span class="number">1</span>; <span class="comment">// é»˜è®¤ä¸ºæ­£æ•°.signå€¼åªèƒ½æ˜¯+1æˆ–è€…-1</span></span><br><span class="line">        <span class="keyword">while</span> (pos &lt; n) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (s[pos]) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">                pos++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                sign = stk.<span class="built_in">top</span>();</span><br><span class="line">                pos++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                sign = -stk.<span class="built_in">top</span>();</span><br><span class="line">                pos++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;(&#x27;</span>:</span><br><span class="line">                stk.<span class="built_in">push</span>(sign);</span><br><span class="line">                pos++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;)&#x27;</span>:</span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">                pos++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>: <span class="comment">// æ˜¯æ•°å­—</span></span><br><span class="line">                <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span> (pos &lt; n &amp;&amp; <span class="built_in">isdigit</span>(s[pos])) &#123;</span><br><span class="line">                    num = num * <span class="number">10</span> + <span class="built_in">int</span>(s[pos++] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                ans += sign * num;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>è¿›é˜¶æ€è€ƒï¼šå­˜åœ¨ä¹˜é™¤æ³•ï¼Œå¹¶ä¸”â€™+â€™å¯ä»¥ç”¨ä½œä¸€å…ƒè¿ç®—ç¬¦(ä¾‹å¦‚<code>&quot;+1&quot;</code>å’Œ<code>&quot;+(2+3)&quot;</code>æœ‰æ•ˆ)</p></blockquote><h1 id="3-æ ˆä¸æ‹¬å·åŒ¹é…"><a href="#3-æ ˆä¸æ‹¬å·åŒ¹é…" class="headerlink" title="3.æ ˆä¸æ‹¬å·åŒ¹é…"></a>3.æ ˆä¸æ‹¬å·åŒ¹é…</h1><h4 id="3-1-æœ‰æ•ˆçš„æ‹¬å·ï¼š20"><a href="#3-1-æœ‰æ•ˆçš„æ‹¬å·ï¼š20" class="headerlink" title="3-1.æœ‰æ•ˆçš„æ‹¬å·ï¼š20"></a>3-1.æœ‰æ•ˆçš„æ‹¬å·ï¼š20</h4><p>éš¾åº¦ä¸é«˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="type">char</span>&gt; stk;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> pos = <span class="number">0</span>; pos &lt; n; pos++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[pos] == <span class="string">&#x27;(&#x27;</span> || s[pos] == <span class="string">&#x27;[&#x27;</span> || s[pos] == <span class="string">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class="line">                stk.<span class="built_in">emplace</span>(s[pos]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (stk.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (s[pos] == <span class="string">&#x27;)&#x27;</span> &amp;&amp; stk.<span class="built_in">top</span>() != <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (s[pos] == <span class="string">&#x27;]&#x27;</span> &amp;&amp; stk.<span class="built_in">top</span>() != <span class="string">&#x27;[&#x27;</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (s[pos] == <span class="string">&#x27;&#125;&#x27;</span> &amp;&amp; stk.<span class="built_in">top</span>() != <span class="string">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stk.<span class="built_in">empty</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="3-2-å‡½æ•°çš„ç‹¬å æ—¶é—´ï¼š636"><a href="#3-2-å‡½æ•°çš„ç‹¬å æ—¶é—´ï¼š636" class="headerlink" title="3-2.å‡½æ•°çš„ç‹¬å æ—¶é—´ï¼š636"></a>3-2.å‡½æ•°çš„ç‹¬å æ—¶é—´ï¼š636</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">exclusiveTime</span><span class="params">(<span class="type">int</span> n, vector&lt;string&gt;&amp; logs)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">res</span><span class="params">(n)</span></span>;</span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; stk;</span><br><span class="line">        <span class="type">int</span> lastTimeStamp = <span class="number">0</span>; <span class="comment">// ä¸Šä¸€ä¸ªæ•°çš„æ—¶é—´æˆ³</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; log : logs) &#123;</span><br><span class="line">            <span class="comment">// é”™è¯¯ï¼šæ•°å­—å¯èƒ½ä¸æ­¢ä¸€ä½</span></span><br><span class="line">            <span class="comment">// int id = log[0] - &#x27;0&#x27;;</span></span><br><span class="line">            <span class="comment">// char StartOrEnd = log[3];</span></span><br><span class="line">            <span class="comment">// int timeStamp = log[(int)log.size() - 1];</span></span><br><span class="line">            <span class="type">int</span> id, timeStamp;</span><br><span class="line">            <span class="type">char</span> StartOrEnd[<span class="number">6</span>];</span><br><span class="line">            <span class="built_in">sscanf</span>(log.<span class="built_in">c_str</span>(), <span class="string">&quot;%d:%[^:]:%d&quot;</span>, &amp;id, StartOrEnd, &amp;timeStamp);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æœ¬è´¨æ˜¯æ‹¬å·åŒ¹é…</span></span><br><span class="line">            <span class="keyword">if</span> (StartOrEnd[<span class="number">0</span>] == <span class="string">&#x27;s&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!stk.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                    res[stk.<span class="built_in">top</span>()] += timeStamp - lastTimeStamp;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// å­˜åœ¨æ ˆé‡Œçš„éƒ½æ˜¯startéƒ¨åˆ†æœªè¢«endåŒ¹é…æ¶ˆé™¤çš„éƒ¨åˆ†å¯¹åº”çš„id</span></span><br><span class="line">                stk.<span class="built_in">push</span>(id);</span><br><span class="line">                <span class="comment">// æ¯æ¬¡å¾ªç¯ç»“æŸæ›´æ–°æ—¶é—´æˆ³</span></span><br><span class="line">                lastTimeStamp = timeStamp;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res[stk.<span class="built_in">top</span>()] += timeStamp - lastTimeStamp + <span class="number">1</span>;</span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="comment">// ä¸ºäº†ç»Ÿä¸€æ—¶é—´æˆ³æ ‡å‡†ï¼Œendçš„5ç›¸å½“äºstartçš„6.ç¡®ä¿end-endæ­£å¸¸</span></span><br><span class="line">                lastTimeStamp = timeStamp + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šå…³äº<code>sscanf(log.c_str(), &quot;%d:%[^:]:%d&quot;, &amp;id, StartOrEnd, &amp;timeStamp);</code>ï¼Œè¿™é‡Œçš„ç§Ÿç”¨ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„spilt()å‡½æ•°ï¼Œç”¨äºå°†å­—ç¬¦ä¸²æ ¹æ®â€™:â€™åˆ†å‰²æˆä¸åŒçš„éƒ¨åˆ†ã€‚sscanf()çš„åŠŸèƒ½ç±»ä¼¼äºæ­£åˆ™è¡¨è¾¾å¼çš„regexï¼Œèƒœåœ¨<u>è½»é‡çº§å’Œé«˜æ•ˆ</u>ï¼Œä½†æ˜¯æ²¡æœ‰å…¶å¼ºå¤§ã€‚å…³äºæ­£åˆ™è¡¨è¾¾å¼regexï¼Œè¯¦è§ã€Š2.1å­—ç¬¦ä¸²ç¯‡(2)â€”-å…³äºæ­£åˆ™ã€‹ã€‚å½“å­—ç¬¦ä¸²å¾ˆé•¿æ—¶ï¼Œregexä¼šæ¶‰åŠæ›´å¤šçš„å†…å­˜é‡Šæ”¾å’Œåˆ†é…ï¼Œå¹¶ä¸”éœ€è¦æ›´å¤šçš„æ—¶é—´å¼€é”€ï¼Œå¯èƒ½å¯¼è‡´<u>è¶…æ—¶æˆ–å†…å­˜å ç”¨è¿‡é«˜</u>ã€‚</p><p>sscanfè¯­æ³•ä¸ºï¼š<code>int sscanf(const char *str, const char *format, T* dividePart1ptr, T* dividePart2ptr, ...);</code>ï¼Œå¹¶å°†åˆ†å‰²å‡ºçš„å„ä¸ªéƒ¨åˆ†èµ‹å€¼åˆ°å„ä¸ªdividePartä¸Šã€‚è¯¦ç»†è®²è§£ï¼š<a href="https://zhuanlan.zhihu.com/p/370029604">sscanfçš„ç”¨æ³•</a></p><p><code>c_str()</code>æ˜¯ä¸€ä¸ªç”¨äºå°†C++å­—ç¬¦ä¸²è½¬æ¢ä¸ºCé£æ ¼çš„å­—ç¬¦ä¸²ï¼ˆä»¥nullç»“å°¾çš„å­—ç¬¦æ•°ç»„ï¼‰çš„æˆå‘˜å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªæŒ‡å‘ä»¥nullç»“å°¾çš„å­—ç¬¦æ•°ç»„çš„<mark>æŒ‡é’ˆ</mark>ï¼Œè¯¥å­—ç¬¦æ•°ç»„åŒ…å«äº†ä¸C++å­—ç¬¦ä¸²ç›¸å¯¹åº”çš„å­—ç¬¦åºåˆ—ã€‚æ¯”å¦‚ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">char</span> *cStyleStringPointer = myString.<span class="built_in">c_str</span>();</span><br></pre></td></tr></table></figure><p>ç°åœ¨å†æ¥å°†ä¹‹å‰sscanfä»£ç è½¬æ¢ä¸ºregexä»£ç ï¼Œå¦‚ä¸‹ï¼š(åœ¨æœ¬é¢˜ä¸­ä¼šè¶…æ—¶)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">regex <span class="title">pattern</span><span class="params">(<span class="string">&quot;(\\d+):(\\w+):(\\d+)&quot;</span>)</span></span>;</span><br><span class="line">smatch matches;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">regex_search</span>(log, matches, pattern)) &#123;</span><br><span class="line">    id = <span class="built_in">stoi</span>(matches[<span class="number">1</span>]);</span><br><span class="line">    string temp = matches[<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">strcpy</span>(StartOrEnd, temp.<span class="built_in">c_str</span>());</span><br><span class="line">    timeStamp = <span class="built_in">stoi</span>(matches[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨åˆå¸¦æ¥äº†æ–°çš„çŸ¥è¯†ç‚¹ï¼šæ˜¯å¦å¯ä»¥å°†ç¬¬6è¡Œä»£ç å†™ä½œ<code>StartEnd = temp.c_str();</code>?ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œæ­£å¦‚å‰é¢æ‰€è¯´ï¼Œ<code>c_str()</code>è¿”å›çš„æ˜¯<mark>ä»¥nullç»“å°¾</mark>çš„å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆï¼Œè€ŒStartEndåªæ˜¯ä¸ªæ™®é€šå­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆï¼Œä½¿ç”¨<code>strcpy()</code>åˆ™å¯ä»¥ä¿è¯å°†<code>temp</code>ä¸­çš„å†…å®¹å¤åˆ¶åˆ°<code>StartOrEnd</code>ä¸­ï¼Œå¹¶ä¸”æœ€åæœ‰ä¸€ä¸ª<u>å­—ç¬¦ä¸²ç»“æŸç¬¦</u>ã€‚</p><p>   åŒç†ï¼Œç¬¬5å’Œç¬¬6è¡Œä¹Ÿå¯ä»¥ç›´æ¥æ”¹ä¸º<code>StartEnd = matches[2];</code>ï¼Œå‰æè¦æ±‚å£°æ˜çš„æ˜¯<code>string StartEnd;</code>ï¼Œå› ä¸ºå­—ç¬¦ä¸²ä¹Ÿç›¸å½“äºæ˜¯ä¸€ä¸ªä»¥nullç»“å°¾çš„å­—ç¬¦æ•°ç»„ã€‚</p><hr><p>å®˜æ–¹é¢˜è§£ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">exclusiveTime</span><span class="params">(<span class="type">int</span> n, vector&lt;string&gt;&amp; logs)</span> </span>&#123;</span><br><span class="line">        stack&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; st; <span class="comment">// &#123;idx, å¼€å§‹è¿è¡Œçš„æ—¶é—´&#125;</span></span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">res</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; log : logs) &#123;</span><br><span class="line">            <span class="type">char</span> type[<span class="number">10</span>];</span><br><span class="line">            <span class="type">int</span> idx, timestamp;</span><br><span class="line">            <span class="built_in">sscanf</span>(log.<span class="built_in">c_str</span>(), <span class="string">&quot;%d:%[^:]:%d&quot;</span>, &amp;idx, type, &amp;timestamp);</span><br><span class="line">            <span class="keyword">if</span> (type[<span class="number">0</span>] == <span class="string">&#x27;s&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!st.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                    res[st.<span class="built_in">top</span>().first] += timestamp - st.<span class="built_in">top</span>().second;</span><br><span class="line">                &#125;</span><br><span class="line">                st.<span class="built_in">emplace</span>(idx, timestamp);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">auto</span> t = st.<span class="built_in">top</span>();</span><br><span class="line">                st.<span class="built_in">pop</span>();</span><br><span class="line">                res[t.first] += timestamp - t.second + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (!st.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                    st.<span class="built_in">top</span>().second = timestamp + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="3-3-æ ‡ç­¾éªŒè¯å™¨ï¼š591ï¼ˆå›°éš¾ï¼‰"><a href="#3-3-æ ‡ç­¾éªŒè¯å™¨ï¼š591ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="3-3.æ ‡ç­¾éªŒè¯å™¨ï¼š591ï¼ˆå›°éš¾ï¼‰"></a>3-3.æ ‡ç­¾éªŒè¯å™¨ï¼š591ï¼ˆå›°éš¾ï¼‰</h4><p>æ³•ä¸€ï¼šæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</p><p>é”™è§£ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(string code)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ECMAScript</span></span><br><span class="line">        <span class="comment">// std::regex</span></span><br><span class="line">        <span class="comment">// pattern(&quot;&lt;([A-Z]&#123;1,9&#125;?&gt;)[^&lt;]*(&lt;!\[CDATA\[(.+?)\]\]&gt;)*[^&lt;]*&lt;\/\1&quot;);</span></span><br><span class="line">        <span class="comment">// leetcodeéœ€è¦å°†è½¬ä¹‰å­—ç¬¦\å†è¿›è¡Œä¸€æ¬¡è½¬ä¹‰</span></span><br><span class="line">        <span class="function">std::regex <span class="title">pattern</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">            <span class="string">&quot;&lt;([A-Z]&#123;1,9&#125;?&gt;)[^&lt;]*(&lt;!\\[CDATA\\[(.*?)\\]\\]&gt;)*[^&lt;]*&lt;\\/\\1&quot;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">if</span> (std::<span class="built_in">regex_match</span>(code, pattern)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>   è¿™æ ·çš„ä»£ç å­˜åœ¨ç¼ºé™·ï¼Œæ¯”å¦‚code=<code>&quot;&lt;A&gt;&lt;A&gt;/A&gt;&lt;/A&gt;&lt;/A&gt;&quot;</code>æˆ–è€…<code>&quot;&lt;HTML&gt;&lt;DIV&gt;/A&gt;&lt;/DIV&gt;&lt;/HTML&gt;&quot;</code>æˆ–è€…<code>&quot;&lt;A&gt;&lt;B&gt;&lt;C&gt;&lt;D&gt;&lt;E&gt;&lt;F&gt;&lt;G&gt;&lt;/G&gt;&lt;H&gt;&lt;/H&gt;&lt;/F&gt;&lt;/E&gt;&lt;/D&gt;&lt;/C&gt;&lt;/B&gt;&lt;/A&gt;&quot;</code>ä»£ç è¿”å›falseï¼Œè€Œå®é™…åº”è¯¥è¿”å›trueã€‚å¦‚æœæ”¹ä¸ºregex_search()ä½¿ç”¨å±€éƒ¨åŒ¹é…è€Œéå®Œå…¨åŒ¹é…ï¼Œåˆ™ä¼šå¯¼è‡´<code>&quot;&lt;HTMLQQQ&gt;&lt;DIV&gt;/A&gt;&lt;/DIV&gt;&lt;/HTML&gt;&quot;</code>è¿”å›äº†trueã€‚</p><p><strong>æ”¹è¿›ç¬¬ä¸€æ­¥ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(string code)</span> </span>&#123;</span><br><span class="line">        <span class="function">std::regex <span class="title">pattern</span><span class="params">(<span class="string">&quot;&lt;([A-Z]&#123;1,9&#125;?&gt;)[^&lt;]*(&lt;!\\[CDATA\\[(.*?)\\]\\]&gt;)*[^&lt;]*&lt;\\/\\1&quot;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (std::<span class="built_in">regex_search</span>(code, pattern) &amp;&amp; code.<span class="built_in">length</span>() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            code = std::<span class="built_in">regex_replace</span>(code, pattern, <span class="string">&quot;#&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> code == <span class="string">&quot;#&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>   æ³¨æ„ä¸€ç‚¹ï¼Œ<code>&quot;&lt;DIV&gt;&lt;UV&gt;&lt;![CDATA[&lt;GK&gt;&lt;![CDATA[&lt;![CDATA[OQA]]&gt;]]&gt;&lt;/GK&gt;]]&gt;&lt;/UV&gt;&lt;/DIV&gt;&quot;</code>åº”è¯¥è¿”å›false!å› ä¸º<code>&lt;![CDATA[CDATA_CONTENT]]&gt;</code>ï¼Œ<code>CDATA_CONTENT</code> çš„èŒƒå›´è¢«å®šä¹‰æˆ <code>&lt;![CDATA[</code> å’Œ<strong>åç»­çš„ç¬¬ä¸€ä¸ª</strong> <code>]]&gt;</code>ä¹‹é—´çš„å­—ç¬¦ã€‚å› æ­¤è¿˜éœ€è¦è¿›ä¸€æ­¥æ”¹è¿›ã€‚</p><p><strong>æ”¹è¿›ç¬¬äºŒæ­¥ï¼š(æ­£è§£)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(string code)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å…ˆå¤„ç†æ‰cdata</span></span><br><span class="line">        <span class="function">std::regex <span class="title">CDATApattern</span><span class="params">(<span class="string">&quot;&lt;!\\[CDATA\\[(.*?)\\]\\]&gt;&quot;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (std::<span class="built_in">regex_search</span>(code, CDATApattern)) &#123;</span><br><span class="line">            code = std::<span class="built_in">regex_replace</span>(code, CDATApattern, <span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å†è§£å†³å¯èƒ½åµŒå¥—çš„æ ‡ç­¾</span></span><br><span class="line">        <span class="function">std::regex <span class="title">pattern</span><span class="params">(<span class="string">&quot;&lt;([A-Z]&#123;1,9&#125;?&gt;)[^&lt;]*&amp;*[^&lt;]*&lt;\\/\\1&quot;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (std::<span class="built_in">regex_search</span>(code, pattern)) &#123;</span><br><span class="line">            code = std::<span class="built_in">regex_replace</span>(code, pattern, <span class="string">&quot;#&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> code == <span class="string">&quot;#&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤è§£é¢˜å®Œæ¯•ï¼Œä¸è¿‡æ—¶ç©ºå¼€é”€è¾ƒå¤§ã€‚</p><p><img src="C:\Users\huangjiakun\Pictures\Marktextå…¨å±€å›¾ç‰‡\f74d34754b8e317524894d4974f1dee69f4eb0df.png" alt=""></p><p><img src="C:\Users\huangjiakun\Pictures\Marktextå…¨å±€å›¾ç‰‡\ab2a014851d62419a59e526f6a328a69263aaefa.png" alt=""></p><p>æ³•äºŒï¼šæ ˆ+å­—ç¬¦ä¸²éå†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(string code)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = code.<span class="built_in">size</span>();</span><br><span class="line">        stack&lt;string&gt; tags;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (code[i] == <span class="string">&#x27;&lt;&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i == n - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (code[i + <span class="number">1</span>] == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">                    <span class="type">int</span> j = code.<span class="built_in">find</span>(<span class="string">&#x27;&gt;&#x27;</span>, i);</span><br><span class="line">                    <span class="keyword">if</span> (j == string::npos) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    string tagname = code.<span class="built_in">substr</span>(i + <span class="number">2</span>, j - (i + <span class="number">2</span>));</span><br><span class="line">                    <span class="keyword">if</span> (tags.<span class="built_in">empty</span>() || tags.<span class="built_in">top</span>() != tagname) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    tags.<span class="built_in">pop</span>();</span><br><span class="line">                    i = j + <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (tags.<span class="built_in">empty</span>() &amp;&amp; i != n) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code[i + <span class="number">1</span>] == <span class="string">&#x27;!&#x27;</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (tags.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    string cdata = code.<span class="built_in">substr</span>(i + <span class="number">2</span>, <span class="number">7</span>);</span><br><span class="line">                    <span class="keyword">if</span> (cdata != <span class="string">&quot;[CDATA[&quot;</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">int</span> j = code.<span class="built_in">find</span>(<span class="string">&quot;]]&gt;&quot;</span>, i);</span><br><span class="line">                    <span class="keyword">if</span> (j == string::npos) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    i = j + <span class="number">3</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="type">int</span> j = code.<span class="built_in">find</span>(<span class="string">&#x27;&gt;&#x27;</span>, i);</span><br><span class="line">                    <span class="keyword">if</span> (j == string::npos) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    string tagname = code.<span class="built_in">substr</span>(i + <span class="number">1</span>, j - (i + <span class="number">1</span>));</span><br><span class="line">                    <span class="keyword">if</span> (tagname.<span class="built_in">size</span>() &lt; <span class="number">1</span> || tagname.<span class="built_in">size</span>() &gt; <span class="number">9</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (!<span class="built_in">all_of</span>(tagname.<span class="built_in">begin</span>(), tagname.<span class="built_in">end</span>(),</span><br><span class="line">                                [](<span class="type">unsigned</span> <span class="type">char</span> c) &#123; <span class="keyword">return</span> <span class="built_in">isupper</span>(c); &#125;)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    tags.<span class="built_in">push</span>(<span class="built_in">move</span>(tagname));</span><br><span class="line">                    i = j + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (tags.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ++i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> tags.<span class="built_in">empty</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="3-4-æœ€é•¿æœ‰æ•ˆæ‹¬å·ï¼š32ï¼ˆå›°éš¾ï¼‰"><a href="#3-4-æœ€é•¿æœ‰æ•ˆæ‹¬å·ï¼š32ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="3-4.æœ€é•¿æœ‰æ•ˆæ‹¬å·ï¼š32ï¼ˆå›°éš¾ï¼‰"></a>3-4.æœ€é•¿æœ‰æ•ˆæ‹¬å·ï¼š32ï¼ˆå›°éš¾ï¼‰</h4><p>ç†è§£é¢˜æ„ï¼Œæœ‰æ•ˆæ‹¬å·å­ä¸²å½¢å¼ä¸ºï¼š1ã€â€()()â€;2ã€â€(())â€â€¦å…¶å®å°±æ˜¯æ»¡è¶³3-1.ç¬¬20é¢˜çš„é‚£ç§å­—ç¬¦ä¸²ã€‚</p><p>æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">longestValidParentheses</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dp</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123; <span class="comment">// dp[0]å¿…å®šä¸º0</span></span><br><span class="line">            <span class="comment">// s[i]==&#x27;(&#x27;æ—¶dp[i]å¿…å®šä¸º0</span></span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (s[i - <span class="number">1</span>] == <span class="string">&#x27;(&#x27;</span>) &#123; <span class="comment">//&quot;...()&quot;å‹</span></span><br><span class="line">                    dp[i] = (i &gt;= <span class="number">2</span> ? dp[i - <span class="number">2</span>] + <span class="number">2</span> : <span class="number">2</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &gt; dp[i - <span class="number">1</span>] &amp;&amp; s[i - dp[i - <span class="number">1</span>] - <span class="number">1</span>] == <span class="string">&#x27;(&#x27;</span>) &#123; <span class="comment">//&quot;...))&quot;å‹   </span></span><br><span class="line">                    dp[i] = dp[i - <span class="number">1</span>] + ((i - dp[i - <span class="number">1</span>]) &gt;= <span class="number">2</span> ? dp[i - dp[i - <span class="number">1</span>] - <span class="number">2</span>] + <span class="number">2</span> : <span class="number">2</span>);      </span><br><span class="line">                &#125;</span><br><span class="line">                ans = <span class="built_in">max</span>(ans, dp[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">longestValidParentheses</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; stk; <span class="comment">// å­˜å‚¨çš„æ˜¯æœ€åä¸€ä¸ªæ— æ³•åŒ¹é…çš„æ‹¬å·å¯¹åº”çš„ä¸‹æ ‡</span></span><br><span class="line">        <span class="comment">// å¦‚æœä¸€å¼€å§‹æ ˆä¸ºç©ºï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå·¦æ‹¬å·çš„æ—¶å€™æˆ‘ä»¬ä¼šå°†å…¶æ”¾å…¥æ ˆä¸­ï¼Œ</span></span><br><span class="line">        <span class="comment">// è¿™æ ·å°±ä¸æ»¡è¶³æåŠçš„ã€Œæœ€åä¸€ä¸ªæ²¡æœ‰è¢«åŒ¹é…çš„å³æ‹¬å·çš„ä¸‹æ ‡ã€ï¼Œ</span></span><br><span class="line">        <span class="comment">// ä¸ºäº†ä¿æŒç»Ÿä¸€ï¼Œæˆ‘ä»¬åœ¨ä¸€å¼€å§‹çš„æ—¶å€™å¾€æ ˆä¸­æ”¾å…¥ä¸€ä¸ªå€¼ä¸º-1çš„å…ƒç´ ã€‚</span></span><br><span class="line">        stk.<span class="built_in">push</span>(<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                stk.<span class="built_in">push</span>(i);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                stk.<span class="built_in">pop</span>();<span class="comment">//-1çš„ä½œç”¨ä½“ç°åœ¨è¿™é‡Œï¼Œä¸€å¼€å§‹ä¸º&#x27;)&#x27;æ—¶é¿å…å‡ºé”™</span></span><br><span class="line">                <span class="keyword">if</span> (stk.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                    stk.<span class="built_in">push</span>(i);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    ans = <span class="built_in">max</span>(ans, i - stk.<span class="built_in">top</span>());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•ä¸‰ï¼šåŒè®¡æ•°å™¨ï¼Œè¿‘ä¼¼äºåŒæŒ‡é’ˆï¼ˆæœ€ä¼˜ï¼Œä¸éœ€è¦é¢å¤–ç©ºé—´ï¼‰</p><p>leftç»Ÿè®¡å·¦æ‹¬å·æ•°ï¼Œrightç»Ÿè®¡å³æ‹¬å·æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">longestValidParentheses</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">size</span>(), left = <span class="number">0</span>, right = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                left++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">                ans = <span class="built_in">max</span>(ans, <span class="number">2</span> * right);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (right &gt; left) &#123;</span><br><span class="line">                left = right = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        left = right = <span class="number">0</span>; <span class="comment">// é‡ç½®ï¼Œä¸ºä¸‹ä¸€æ¬¡éå†åšå‡†å¤‡</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                left++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (left == right) &#123;</span><br><span class="line">                ans = <span class="built_in">max</span>(ans, <span class="number">2</span> * left);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (left &gt; right) &#123;</span><br><span class="line">                left = right = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="4-é€’å½’-äº†è§£"><a href="#4-é€’å½’-äº†è§£" class="headerlink" title="4.é€’å½’(äº†è§£)"></a>4.é€’å½’(äº†è§£)</h1><h4 id="4-1-è¿·ä½ è¯­æ³•åˆ†æå™¨ï¼š385"><a href="#4-1-è¿·ä½ è¯­æ³•åˆ†æå™¨ï¼š385" class="headerlink" title="4-1.è¿·ä½ è¯­æ³•åˆ†æå™¨ï¼š385"></a>4-1.è¿·ä½ è¯­æ³•åˆ†æå™¨ï¼š385</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">NestedInteger <span class="title">deserialize</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s[index] == <span class="string">&#x27;[&#x27;</span>) &#123;</span><br><span class="line">            index++;</span><br><span class="line">            NestedInteger ni;</span><br><span class="line">            <span class="keyword">while</span> (s[index] != <span class="string">&#x27;]&#x27;</span>) &#123;</span><br><span class="line">                ni.<span class="built_in">add</span>(<span class="built_in">deserialize</span>(s));</span><br><span class="line">                <span class="keyword">if</span> (s[index] == <span class="string">&#x27;,&#x27;</span>) &#123;</span><br><span class="line">                    index++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            index++;</span><br><span class="line">            <span class="keyword">return</span> ni;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">bool</span> negative = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (s[index] == <span class="string">&#x27;-&#x27;</span>) &#123;</span><br><span class="line">                negative = <span class="literal">true</span>;</span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (index &lt; s.<span class="built_in">size</span>() &amp;&amp; <span class="built_in">isdigit</span>(s[index])) &#123;</span><br><span class="line">                num = num * <span class="number">10</span> + s[index] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (negative) &#123;</span><br><span class="line">                num *= <span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">NestedInteger</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>341ã€394ç•¥ã€‚å°±æ˜¯åˆ©ç”¨ç»™çš„æ¥å£çš„æ–¹æ³•è§£é¢˜ã€‚</p>]]></content>
    
    
    <summary type="html">æ ˆä¸é€’å½’éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="æ ˆ" scheme="https://sumikiru.top/tags/%E6%A0%88/"/>
    
    <category term="é€’å½’" scheme="https://sumikiru.top/tags/%E9%80%92%E5%BD%92/"/>
    
  </entry>
  
  <entry>
    <title>3.æ•°ä¸ä½ç¯‡</title>
    <link href="https://sumikiru.top/posts/f83528c7.html"/>
    <id>https://sumikiru.top/posts/f83528c7.html</id>
    <published>2024-04-25T13:06:58.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-æ•°å­—çš„ä½æ“ä½œ"><a href="#1-æ•°å­—çš„ä½æ“ä½œ" class="headerlink" title="1.æ•°å­—çš„ä½æ“ä½œ"></a>1.æ•°å­—çš„ä½æ“ä½œ</h1><h2 id="1-1-å›æ–‡"><a href="#1-1-å›æ–‡" class="headerlink" title="1-1.å›æ–‡"></a>1-1.å›æ–‡</h2><h3 id="1-1-1-å›æ–‡æ•°ï¼š9"><a href="#1-1-1-å›æ–‡æ•°ï¼š9" class="headerlink" title="1-1-1.å›æ–‡æ•°ï¼š9"></a>1-1-1.å›æ–‡æ•°ï¼š9</h3><p>æ³•ä¸€ï¼šå¸¸è§„è§£æ³•ï¼Œä½†æ˜¯éœ€è¦è€ƒè™‘æ•´æ•°æº¢å‡ºé—®é¢˜</p><p>æ³•äºŒï¼šåè½¬ä¸€åŠæ•°å­—</p><p>æ–¹æ³•ä¸æ³•ä¸€ç±»ä¼¼ï¼Œä½†æ˜¯è¿™æ ·å¯ä»¥é¿å…è€ƒè™‘æº¢å‡ºé—®é¢˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span> || (x % <span class="number">10</span> == <span class="number">0</span> &amp;&amp; x)) &#123;</span><br><span class="line">            <span class="comment">//å› ä¸ºæœ€ç»ˆreturnéƒ¨åˆ†åŠ å…¥äº†x==res/10çš„æƒ…å†µï¼Œæ‰€ä»¥éœ€è¦(x % 10 == 0 &amp;&amp; x)</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (x &gt; res) &#123;</span><br><span class="line">            <span class="type">int</span> digit = x % <span class="number">10</span>;</span><br><span class="line">            x /= <span class="number">10</span>;</span><br><span class="line">            res = res * <span class="number">10</span> + digit;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å½“æ•°å­—é•¿åº¦ä¸ºå¥‡æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ revertedNumber/10 å»é™¤å¤„äºä¸­ä½çš„æ•°å­—ã€‚</span></span><br><span class="line">        <span class="comment">// ä¾‹å¦‚ï¼Œå½“è¾“å…¥ä¸º 12321 æ—¶ï¼Œåœ¨ while å¾ªç¯çš„æœ«å°¾æˆ‘ä»¬å¯ä»¥å¾—åˆ° x = 12ï¼ŒrevertedNumber = 123ï¼Œ</span></span><br><span class="line">        <span class="comment">// ç”±äºå¤„äºä¸­ä½çš„æ•°å­—ä¸å½±å“å›æ–‡ï¼ˆå®ƒæ€»æ˜¯ä¸è‡ªå·±ç›¸ç­‰ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†å…¶å»é™¤ã€‚</span></span><br><span class="line">        <span class="keyword">return</span> x == res || x == res / <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="1-1-2-å¯»æ‰¾æœ€è¿‘çš„å›æ–‡æ•°ï¼š564ï¼ˆå›°éš¾ï¼‰"><a href="#1-1-2-å¯»æ‰¾æœ€è¿‘çš„å›æ–‡æ•°ï¼š564ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="1-1-2.å¯»æ‰¾æœ€è¿‘çš„å›æ–‡æ•°ï¼š564ï¼ˆå›°éš¾ï¼‰"></a>1-1-2.å¯»æ‰¾æœ€è¿‘çš„å›æ–‡æ•°ï¼š564ï¼ˆå›°éš¾ï¼‰</h3><p>æ¨¡æ‹Ÿï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ULL = <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;ULL&gt; <span class="title">getCandidates</span><span class="params">(<span class="type">const</span> string&amp; n)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> len = n.<span class="built_in">length</span>();</span><br><span class="line">        <span class="comment">// å€™é€‰æ•°ç»„ï¼Œç¬¦åˆè¿™4ä¸­æƒ…å†µçš„æ•°å­—</span></span><br><span class="line">        vector&lt;ULL&gt; candidates = &#123;</span><br><span class="line">            (ULL)<span class="built_in">pow</span>(<span class="number">10</span>, len - <span class="number">1</span>) - <span class="number">1</span>,</span><br><span class="line">            (ULL)<span class="built_in">pow</span>(<span class="number">10</span>, len) + <span class="number">1</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">        ULL selfPrefix = <span class="built_in">stoull</span>(n.<span class="built_in">substr</span>(<span class="number">0</span>, (len + <span class="number">1</span>) / <span class="number">2</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i : &#123;selfPrefix - <span class="number">1</span>, selfPrefix, selfPrefix + <span class="number">1</span>&#125;) &#123;</span><br><span class="line">            <span class="comment">// iåªåœ¨è¿™ä¸‰ä¸ªæ•°ä¹‹é—´éå†</span></span><br><span class="line">            <span class="comment">// prefixå°±æ˜¯åŸæ•°å­—çš„å‰åŠéƒ¨åˆ†</span></span><br><span class="line">            string prefix = <span class="built_in">to_string</span>(i);</span><br><span class="line">            string candidate = prefix + <span class="built_in">string</span>(prefix.<span class="built_in">rbegin</span>() + (len &amp; <span class="number">1</span>), prefix.<span class="built_in">rend</span>());</span><br><span class="line">            candidates.<span class="built_in">push_back</span>(<span class="built_in">stoull</span>(candidate));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> candidates;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">nearestPalindromic</span><span class="params">(string n)</span> </span>&#123;</span><br><span class="line">        ULL selfNumber = <span class="built_in">stoull</span>(n), ans = <span class="number">-1</span>;</span><br><span class="line">        <span class="type">const</span> vector&lt;ULL&gt;&amp; candidates = <span class="built_in">getCandidates</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; candidate : candidates) &#123;</span><br><span class="line">            <span class="keyword">if</span> (candidate != selfNumber) &#123;</span><br><span class="line">                <span class="keyword">if</span> (ans == <span class="number">-1</span> ||</span><br><span class="line">                    <span class="built_in">llabs</span>(candidate - selfNumber) &lt; <span class="built_in">llabs</span>(ans - selfNumber) ||</span><br><span class="line">                    <span class="built_in">llabs</span>(candidate - selfNumber) == <span class="built_in">llabs</span>(ans - selfNumber) &amp;&amp; candidate &lt; ans) &#123;</span><br><span class="line">                    ans = candidate;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">to_string</span>(ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€ç§ï¼štypedef</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> myInt1;</span><br><span class="line"><span class="keyword">typedef</span> std::vector&lt;<span class="type">int</span>&gt; IntVector1;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒç§ï¼šusing åˆ«åå£°æ˜</span></span><br><span class="line"><span class="keyword">using</span> myInt2 = <span class="type">int</span>;</span><br><span class="line"><span class="keyword">using</span> IntVector2 = std::vector&lt;<span class="type">int</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸‰ç§ï¼šusing æ¨¡æ¿åˆ«å</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">using</span> myIntVector = std::vector&lt;T&gt;;</span><br></pre></td></tr></table></figure><ol><li><p><code>using ULL = unsigned long long;</code>ï¼šå…³äºåˆ«åæœ‰ä¸‰ç§å†™æ³•ï¼Œtypedefã€usingåˆ«åå£°æ˜ã€usingæ¨¡æ¿å£°æ˜ã€‚</p><p>ç±»å‹åˆ«åï¼ˆtype aliasï¼‰ã€<code>#define</code> å®å’Œ <code>const</code> å¸¸é‡çš„åŒºåˆ«ï¼š<br><img src="https://s2.loli.net/2024/03/02/KH47ykvXJzDcOGq.png" alt=""><br><img src="https://s2.loli.net/2024/03/02/ENLYWubxaqS8IvM.png" alt=""></p></li><li><p><code>string(prefix.rbegin() + (len &amp; 1), prefix.rend());</code>ï¼š<br>+<code>len&amp;1</code>æ˜¯æŒ‡ï¼Œå¦‚æœé•¿åº¦lenä¸ºå•æ•°ï¼ˆlen&amp;1==1ï¼Œæ¶‰åŠä½è¿ç®—ï¼Œå¥‡æ•°çš„äºŒè¿›åˆ¶æœ«ä½ä¸º1ï¼‰ï¼Œåˆ™ä»ä¸‹æ ‡1å¼€å§‹æ·»åŠ ï¼Œå¦åˆ™ä»0å¼€å§‹ã€‚<code>string(startIterater,endIterater);</code></p></li><li><p>stoull()ã€llabs():ä¸åœ¨èµ˜è¿°ï¼Œæ³¨æ„å¹¶æ²¡æœ‰ullabs()çš„ç”¨æ³•ã€‚è¿˜æœ‰ä¸€ç‚¹å€¼å¾—æ³¨æ„ï¼Œåº”è¯¥ä½¿ç”¨unsigned long longè€Œélong long,æ˜¯å› ä¸ºå¦‚æœè¾“å…¥ä¸ºï¼šâ€999999999999999999â€,å¯¹äº13è¡Œè¿™å¥ <code>candidates.push_back(stol(candidate)); stol</code> ä¼šäº§ç”Ÿæº¢å‡ºï¼ŒåŸå› æ˜¯candidateè¶…è¿‡ long longï¼Œæ˜¯ä¸¤ä¸ªå¤§æ•°ç›¸åŠ æ¥è¿‘ 2^65äº†ã€‚</p></li></ol><h2 id="1-2-xçš„å¹‚"><a href="#1-2-xçš„å¹‚" class="headerlink" title="1-2.xçš„å¹‚"></a>1-2.xçš„å¹‚</h2><h3 id="1-2-1-2çš„å¹‚ï¼š231"><a href="#1-2-1-2çš„å¹‚ï¼š231" class="headerlink" title="1-2-1.2çš„å¹‚ï¼š231"></a>1-2-1.2çš„å¹‚ï¼š231</h3><p>æ³•ä¸€ï¼šä½è¿ç®—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfTwo</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> &amp;&amp; (n &amp; (n - <span class="number">1</span>)) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfTwo</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> &amp;&amp; (n &amp; -n) == n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šåˆ¤æ–­æ˜¯å¦ä¸ºæœ€å¤§çš„2çš„å¹‚çš„çº¦æ•°ï¼ˆå–å·§ï¼Œäº†è§£ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> <span class="keyword">constexpr</span> <span class="type">int</span> BIG = <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfTwo</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> &amp;&amp; BIG % n == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³¨:<code>1&lt;&lt;30</code>æ˜¯æŒ‡äºŒè¿›åˆ¶æ•°1å·¦ç§»30ä½å˜æˆ$2^{31}$ã€‚</p><h3 id="å…³äºå¸¸é‡"><a href="#å…³äºå¸¸é‡" class="headerlink" title="å…³äºå¸¸é‡"></a>å…³äºå¸¸é‡</h3><p>   constexprç”¨äºå£°æ˜å¸¸é‡è¡¨è¾¾å¼,constç”¨äºå£°æ˜å¸¸é‡ã€‚<code>1&lt;&lt;30</code>æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œå› ä¸ºå®ƒåœ¨<u>ç¼–è¯‘æ—¶å°±èƒ½å¾—åˆ°è®¡ç®—ç»“æœ</u>ã€‚å¹¶ä¸”è¿™é‡Œå¿…é¡»åŠ ä¸Šstaticä½¿å¾—BIGè¢«å£°æ˜ä¸º<mark>é™æ€å¸¸é‡</mark>ï¼Œè®©æ‰€æœ‰Solutionçš„å®ä¾‹éƒ½å…±äº«åŒä¸€ä»½BIGã€‚</p><hr><p>Q:å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼æ˜¯ä¸æ˜¯è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºç»“æœï¼Ÿ</p><p>A:è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li><p><strong>éç¼–è¯‘æ—¶è®¡ç®—</strong>ï¼šå¦‚æœä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼å¯ä»¥åœ¨ç¼–è¯‘æ—¶å°±è®¡ç®—å‡ºç»“æœï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºçš„ã€‚ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘é˜¶æ®µå¯¹è¿™äº›è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ã€‚</p></li><li><p><strong>ä¾èµ–è¿è¡Œæ—¶ä¿¡æ¯</strong>ï¼šå¦‚æœä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ä¾èµ–äºåœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šçš„ä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥ã€åŠ¨æ€åˆ†é…çš„å†…å­˜åœ°å€ç­‰ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºçš„ã€‚</p></li><li><p><strong>å‡½æ•°è°ƒç”¨</strong>ï¼šå¦‚æœä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ä¸­åŒ…å«å‡½æ•°è°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯è™šå‡½æ•°è°ƒç”¨æˆ–è€…ä¾èµ–äºåŠ¨æ€å¤šæ€æ€§çš„è°ƒç”¨ï¼Œé‚£ä¹ˆå®ƒé€šå¸¸æ˜¯åœ¨è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºç»“æœçš„ã€‚</p></li><li><p><strong>æ¡ä»¶è¡¨è¾¾å¼</strong>ï¼šå¦‚æœä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼åŒ…å«æ¡ä»¶è¿ç®—ç¬¦ï¼ˆå¦‚<code>? :</code>ï¼‰ï¼Œå¹¶ä¸”æ¡ä»¶æ˜¯åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šçš„ï¼Œé‚£ä¹ˆå®ƒä¹Ÿæ˜¯åœ¨è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºç»“æœçš„ã€‚</p></li></ol><p>æ¯”å¦‚<code>1&lt;&lt;x</code>,<code>pow(3,19)</code>,<code>a&gt;15?true:false</code>éƒ½æ˜¯åœ¨è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºç»“æœã€‚ç¬¬ä¸€ä¸ªå¯¹åº”ç¬¬2ç‚¹ï¼Œxåœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šï¼›ç¬¬äºŒä¸ªå¯¹åº”ç¬¬3ç‚¹ï¼ŒåŒ…å«äº†pow()å‡½æ•°è°ƒç”¨;ç¬¬ä¸‰ä¸ªå¯¹åº”ç¬¬4ç‚¹ï¼ŒåŒ…å«äº†æ¡ä»¶è¿ç®—ç¬¦çš„åŒæ—¶åŒ…å«äº†è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šçš„æ¡ä»¶a&gt;15.</p><p>è€Œè¯¸å¦‚<code>20&gt;15</code>,<code>4+3</code>,<code>110&lt;&lt;24</code>è¿™ç±»ï¼Œåˆ™æ˜¯ç¼–è¯‘æ—¶å°±èƒ½è®¡ç®—å‡ºç»“æœã€‚</p><hr><p>constexprå’Œconstçš„è¯¦ç»†åŒºåˆ«ï¼š<a href="https://zhuanlan.zhihu.com/p/635720513">constexprå’Œconst</a></p><p>   æ€»çš„æ¥è¯´ï¼Œconst æ˜¯ä¸€ä¸ªç”¨äºæŒ‡å®šå¸¸é‡çš„å…³é”®å­—ï¼Œè€Œ constexpr åˆ™æ˜¯ä¸€ä¸ªç”¨äºæŒ‡å®šå¸¸é‡è¡¨è¾¾å¼çš„å…³é”®å­—ã€‚ä½¿ç”¨ constexpr å¯ä»¥è®©ç¼–è¯‘å™¨è¿›è¡Œä¼˜åŒ–å’Œæ£€æŸ¥ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œè¿è¡Œæ•ˆç‡ã€‚ </p><h3 id="1-2-2-4çš„å¹‚ï¼š342"><a href="#1-2-2-4çš„å¹‚ï¼š342" class="headerlink" title="1-2-2.4çš„å¹‚ï¼š342"></a>1-2-2.4çš„å¹‚ï¼š342</h3><p>æ³•ä¸€ï¼šä½è¿ç®—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfFour</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> &amp;&amp; (n &amp; (n - <span class="number">1</span>)) == <span class="number">0</span> &amp;&amp; (n &amp; <span class="number">0xaaaaaaaa</span>) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šå–æ¨¡</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfFour</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> &amp;&amp; (n &amp; (n - <span class="number">1</span>)) == <span class="number">0</span> &amp;&amp; n % <span class="number">3</span> == <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å°è¯•å†™å‡ºåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸º8çš„å¹‚æ¬¡æ–¹ã€‚</p><h3 id="1-2-3-3çš„å¹‚ï¼š326"><a href="#1-2-3-3çš„å¹‚ï¼š326" class="headerlink" title="1-2-3.3çš„å¹‚ï¼š326"></a>1-2-3.3çš„å¹‚ï¼š326</h3><p>æ³•ä¸€ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºæœ€å¤§çš„3çš„å¹‚çš„çº¦æ•°ï¼ˆå–å·§ï¼Œäº†è§£ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> BIG = <span class="number">1162261467</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfThree</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> &amp;&amp; BIG % n == <span class="number">0</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šè¯•é™¤æ³•ï¼ˆæ—¶é—´å¤æ‚åº¦è¾ƒé«˜ï¼‰</p><p>ä¸æ–­é™¤ä»¥3ç›´åˆ°n=1:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfThree</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (n &amp;&amp; n % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            n /= <span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n == <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="1-3-é¢ å€’äºŒè¿›åˆ¶ä½ï¼š190"><a href="#1-3-é¢ å€’äºŒè¿›åˆ¶ä½ï¼š190" class="headerlink" title="1-3.é¢ å€’äºŒè¿›åˆ¶ä½ï¼š190"></a>1-3.é¢ å€’äºŒè¿›åˆ¶ä½ï¼š190</h2><p><code>uint32_t</code>æ˜¯æ— ç¬¦å·32ä½æ•´æ•°ç±»å‹ï¼ŒèŒƒå›´åœ¨$0$~$2^{32}-1$ï¼Œå®šä¹‰åœ¨å¤´æ–‡ä»¶<code>&lt;cstdint&gt;</code>ä¸­ã€‚</p><p>æ³•ä¸€ï¼šé€ä½é¢ å€’</p><p>æ¯æ¬¡æŠŠ res å·¦ç§»ï¼ŒæŠŠ n çš„äºŒè¿›åˆ¶æœ«å°¾æ•°å­—ï¼Œæ‹¼æ¥åˆ°ç»“æœ res çš„æœ«å°¾ã€‚ç„¶åæŠŠ n å³ç§»ã€‚</p><p>ä»¥8ä½äºŒè¿›åˆ¶ä¸ºä¾‹ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center">i</th><th style="text-align:center">n</th><th style="text-align:center">n&amp;1</th><th style="text-align:center">res</th></tr></thead><tbody><tr><td style="text-align:center">â€”-</td><td style="text-align:center">11001001</td><td style="text-align:center">1</td><td style="text-align:center">â€”-</td></tr><tr><td style="text-align:center">0</td><td style="text-align:center">01100100</td><td style="text-align:center">0</td><td style="text-align:center">1,0000000</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">00110010</td><td style="text-align:center">0</td><td style="text-align:center">10,000000</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">00011001</td><td style="text-align:center">1</td><td style="text-align:center">100,00000</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">00001100</td><td style="text-align:center">0</td><td style="text-align:center">1001,0000</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">00000110</td><td style="text-align:center">0</td><td style="text-align:center">10010,000</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">00000011</td><td style="text-align:center">1</td><td style="text-align:center">100100,00</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">00000001</td><td style="text-align:center">1</td><td style="text-align:center">1001001,0</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">00000000</td><td style="text-align:center">â€”-</td><td style="text-align:center">10010011</td></tr></tbody></table></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">uint32_t</span> <span class="title">reverseBits</span><span class="params">(<span class="type">uint32_t</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">uint32_t</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; n &gt; <span class="number">0</span> &amp;&amp; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">            res |= (n &amp; <span class="number">1</span>) &lt;&lt; (<span class="number">31</span> - i);</span><br><span class="line">            <span class="comment">//å¦‚n&amp;1==1æ—¶,nä¸ºå¥‡æ•°.åŒæ—¶ä¹Ÿèƒ½åˆ¤æ–­å‡ºnæœ«ä½ä¸º1,æ‰€ä»¥n&amp;1ä¹Ÿä»£è¡¨æœ«ä½</span></span><br><span class="line">            <span class="comment">//æœ«ä½å³ç§»31-iä½ï¼Œåé¢è¡¥ä¸Š0å¹¶ä¸resè¿›è¡Œä½æˆ–æ“ä½œ</span></span><br><span class="line">            n &gt;&gt;= <span class="number">1</span>; <span class="comment">// nå·¦ç§»1ä½ï¼Œç›¸å½“äºå»é™¤ä¹‹å‰çš„æœ«ä½</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">uint32_t</span> <span class="title">reverseBits</span><span class="params">(<span class="type">uint32_t</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">uint32_t</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; n &gt; <span class="number">0</span> &amp;&amp; i &lt; <span class="number">32</span>; i++) &#123;<span class="comment">//å»æ‰n&gt;0çš„æ¡ä»¶</span></span><br><span class="line">            res = (res &lt;&lt; <span class="number">1</span>) | (n &amp; <span class="number">1</span>);</span><br><span class="line">            n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šä½è¿ç®—åˆ†æ²»(æœ€ä¼˜)</p><p>   ç±»ä¼¼å½’å¹¶æ’åºï¼Œå…¶æ€æƒ³æ˜¯åˆ†è€Œæ²»ä¹‹ï¼ŒæŠŠæ•°å­—åˆ†ä¸ºä¸¤åŠï¼Œç„¶åäº¤æ¢è¿™ä¸¤åŠçš„é¡ºåºï¼›ç„¶åæŠŠå‰åä¸¤ä¸ªåŠæ®µéƒ½å†åˆ†æˆä¸¤åŠï¼Œäº¤æ¢å†…éƒ¨é¡ºåºâ€¦â€¦ç›´è‡³æœ€åäº¤æ¢é¡ºåºçš„æ—¶å€™ï¼Œäº¤æ¢çš„æ•°å­—åªæœ‰ 1 ä½ã€‚</p><p><img src="https://s2.loli.net/2024/03/03/o8rGDi5tnCQw6e1.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M1 = <span class="number">0x55555555</span>; <span class="comment">// 01010101010101010101010101010101</span></span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M2 = <span class="number">0x33333333</span>; <span class="comment">// 00110011001100110011001100110011</span></span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M4 = <span class="number">0x0f0f0f0f</span>; <span class="comment">// 00001111000011110000111100001111</span></span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M8 = <span class="number">0x00ff00ff</span>; <span class="comment">// 00000000111111110000000011111111</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">uint32_t</span> <span class="title">reverseBits</span><span class="params">(<span class="type">uint32_t</span> n)</span> </span>&#123;</span><br><span class="line">        n = n &gt;&gt; <span class="number">1</span> &amp; M1 | (n &amp; M1) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        n = n &gt;&gt; <span class="number">2</span> &amp; M2 | (n &amp; M2) &lt;&lt; <span class="number">2</span>;</span><br><span class="line">        n = n &gt;&gt; <span class="number">4</span> &amp; M4 | (n &amp; M4) &lt;&lt; <span class="number">4</span>;</span><br><span class="line">        n = n &gt;&gt; <span class="number">8</span> &amp; M8 | (n &amp; M8) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">return</span> n &gt;&gt; <span class="number">16</span> | n &lt;&lt; <span class="number">16</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å…³äºåˆ†æ²»ç®—æ³•ï¼š<a href="https://zhuanlan.zhihu.com/p/510267724">åˆ†æ²»ç®—æ³•</a></p><h3 id="1-3-1-ä½1çš„ä¸ªæ•°ï¼š191"><a href="#1-3-1-ä½1çš„ä¸ªæ•°ï¼š191" class="headerlink" title="1-3-1.ä½1çš„ä¸ªæ•°ï¼š191"></a>1-3-1.ä½1çš„ä¸ªæ•°ï¼š191</h3><p>æ³•ä¸€ï¼šéå†æ¯ä¸ªäºŒè¿›åˆ¶ä½</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">hammingWeight</span><span class="params">(<span class="type">uint32_t</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (n &amp; (<span class="number">1</span> &lt;&lt; i)) &#123; <span class="comment">// 1å·¦ç§»iä½</span></span><br><span class="line">                num++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šä¼˜åŒ–</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">hammingWeight</span><span class="params">(<span class="type">uint32_t</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n) &#123;</span><br><span class="line">            n &amp;= n - <span class="number">1</span>;</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>n&amp;(n-1)</code>å¯ä»¥ç”¨æ¥åˆ¤æ–­æœ‰å‡ ä¸ª1ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…¶å€¼æ˜¯å¦ä¸º0æ¥åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯2çš„å¹‚(è¯¦è§1-2-2)ã€‚ä¹Ÿæœ‰å†…ç½®å‡½æ•°<code>__builtin_popcount(n)</code>ï¼Œæ—¶é—´å¤æ‚åº¦$O(1)$ã€‚</p><h3 id="1-3-2-æ•°å­—çš„è¡¥æ•°ï¼š476-ä½ä½å–å"><a href="#1-3-2-æ•°å­—çš„è¡¥æ•°ï¼š476-ä½ä½å–å" class="headerlink" title="1-3-2.æ•°å­—çš„è¡¥æ•°ï¼š476(ä½ä½å–å)"></a>1-3-2.æ•°å­—çš„è¡¥æ•°ï¼š476(ä½ä½å–å)</h3><p>æ³•ä¸€:å¸¸è§„ä½è¿ç®—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findComplement</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        uint t = (uint)<span class="number">1</span> &lt;&lt; <span class="number">31</span>;</span><br><span class="line">        <span class="keyword">while</span> ((t &amp; num) == <span class="number">0</span>) &#123;</span><br><span class="line">            num |= t;</span><br><span class="line">            t &gt;&gt;= <span class="number">1</span>; <span class="comment">// tå³ç§»ä¸€ä½</span></span><br><span class="line">            <span class="comment">//ç›¸å½“äºå¯¹numä»é«˜ä½åˆ°åœ°ä½é€ä¸ªéå†,æŠŠnumç¬¬ä¸€ä¸ª1å‰é¢çš„0éƒ½æ”¹ä¸º1</span></span><br><span class="line">            <span class="comment">// è¿™æ ·numå–åæ‰æ˜¯æ­£ç¡®çš„</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ~num; <span class="comment">// å–å</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>t:1000â€¦000-&gt;0100â€¦000-&gt;â€¦-&gt;0000â€¦0001(å¦‚æœä¸€ç›´å¾ªç¯)</p><p>num(5):000â€¦0101-&gt;100â€¦0101-&gt;â€¦-&gt;111â€¦1101-&gt;(å–å)000â€¦0010(32ä½äºŒè¿›åˆ¶æ•°)-&gt;2</p><p>æ³¨æ„ï¼Œ<code>==</code>çš„ä¼˜å…ˆçº§æ¯”<code>&amp;</code>é«˜ï¼Œæ‰€ä»¥<code>t&amp;num</code>å¿…é¡»å¸¦ä¸Šæ‹¬å·ã€‚</p><p><code>(uint)1&lt;&lt;31</code>ä¹Ÿå¯ä»¥å†™ä¸º<code>1u&lt;&lt;31</code>ã€‚uintç›¸å½“äºunsigned int.</p><hr><p>æˆ–è€…ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findComplement</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        uint mask = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (mask &lt; num) &#123;</span><br><span class="line">            mask &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">            mask |= <span class="number">1</span>;<span class="comment">//maskæ¯”è¾ƒç‰¹æ®Šï¼Œè¿™é‡Œmask++;ä¹Ÿå¯ä»¥</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mask ^ num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç”±äºmaskåªå«æœ‰1ä¸ªâ€œ1â€,å› æ­¤mask&lt;numä¹Ÿå°±æ˜¯maskçš„â€œ1â€ç›¸æ¯”numä¸­çš„æœ€é«˜ä½1ï¼Œæ€»æ˜¯åœ¨åŒä½æˆ–è€…æ›´ä½ä½ï¼Œå³è¿˜åœ¨éå†numä¸­ã€‚000â€¦1000&lt;000â€¦1011</p><hr><p>æ³•äºŒï¼šä½è¿ç®—åˆ†æ²»</p><p>æ—¶é—´å¤æ‚åº¦ä¸º$O(log log num)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findComplement</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> t = num;</span><br><span class="line">        t |= t &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        t |= t &gt;&gt; <span class="number">2</span>;</span><br><span class="line">        t |= t &gt;&gt; <span class="number">4</span>;</span><br><span class="line">        t |= t &gt;&gt; <span class="number">8</span>;</span><br><span class="line">        t |= t &gt;&gt; <span class="number">16</span>;</span><br><span class="line">        <span class="keyword">return</span> ~num &amp; t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>æ³¨</strong>ï¼šåˆ†æ²»ç›®çš„æ˜¯æŠŠtå„ä½ä½ä¸ºé›¶æ•°å–åï¼Œæœ€ç»ˆå˜ä¸ºä¸numå¯¹åº”ä½ä½å…¨1çš„32ä½äºŒè¿›åˆ¶æ•°ã€‚</p><p>t:0000â€¦0101-&gt;0000â€¦0111(<mark>å¥‡ä½ä¸”ä½ä½çš„0å˜ä¸º1</mark>)-&gt;â€¦-&gt;0000â€¦0111</p><p>~num=1111â€¦1010,åˆ™<code>~num&amp;t=num^t</code>=0000â€¦0010</p><p>åœ¨ä½è¿ç®—ä¸­ï¼Œ<code>^</code> è¡¨ç¤º<u>æŒ‰ä½å¼‚æˆ–</u>è¿ç®—ï¼Œå®ƒçš„ç»“æœæ˜¯å¯¹åº”ä½ä¸åŒåˆ™ä¸º1ï¼Œç›¸åŒåˆ™ä¸º0ã€‚è€Œ <code>&amp;</code> è¡¨ç¤º<u>æŒ‰ä½ä¸</u>è¿ç®—ï¼Œå®ƒçš„ç»“æœæ˜¯å¯¹åº”ä½éƒ½ä¸º1æ—¶ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚</p><h3 id="1-3-3-æ±‰æ˜è·ç¦»ï¼š461"><a href="#1-3-3-æ±‰æ˜è·ç¦»ï¼š461" class="headerlink" title="1-3-3.æ±‰æ˜è·ç¦»ï¼š461"></a>1-3-3.æ±‰æ˜è·ç¦»ï¼š461</h3><p>æ±‰æ˜è·ç¦»æŒ‡ä¸¤ä¸ªæ•°å­—å¯¹åº”çš„<mark>äºŒè¿›åˆ¶ä½ä¸åŒ</mark>çš„ä½ç½®çš„æ•°ç›®ã€‚è¯¥é¢˜å…¶å®æ˜¯1-3-1å’Œ1-3-2çš„ç»“åˆ</p><p>æ³•ä¸€ï¼š(æœ€ä¼˜)å†…ç½®å‡½æ•°ï¼Œæ—¶é—´å¤æ‚åº¦O(1)ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">hammingDistance</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> __builtin_popcount(x ^ y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šBrian Kernighanç®—æ³•(åŸºç¡€ä½è¿ç®—ç»“åˆ)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">hammingDistance</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> t = x ^ y;<span class="comment">//æŒ‰ä½å¼‚æˆ–,ä¸åŒçš„åœ°æ–¹å…¨å˜ä¸º1</span></span><br><span class="line">        <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (t) &#123;</span><br><span class="line">            t &amp;= t - <span class="number">1</span>;<span class="comment">//ç”¨æ¥åˆ¤æ–­æœ‰å‡ ä¸ª1</span></span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ–è€…:ç§»ä½å®ç°ä½è®¡æ•°</p><p>åªæ˜¯æ¢ä¸€ç§æ–¹å¼ç»Ÿè®¡1çš„ä¸ªæ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">hammingDistance</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> t = x ^ y; <span class="comment">// æŒ‰ä½å¼‚æˆ–,ä¸åŒçš„åœ°æ–¹å…¨å˜ä¸º1</span></span><br><span class="line">        <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (t) &#123;</span><br><span class="line">            count += t &amp; <span class="number">1</span>;<span class="comment">//tæœ«ä½ä¸º1,åˆ™t&amp;1=1,countåŠ 1</span></span><br><span class="line">            t &gt;&gt;= <span class="number">1</span>;<span class="comment">//ç›¸å½“äºå»é™¤æœ«ä½,é¦–ä½è¡¥0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•ä¸‰ï¼šä½è¿ç®—åˆ†æ²»</p><p><img src="https://s2.loli.net/2024/03/05/yXfnBWUePE2uRHz.png" alt=""></p><p>ä¸¤ä¸¤åˆ‡åˆ†ç»Ÿè®¡ï¼šæ©ç å¯¹æ•°å€¼è¿›è¡Œåˆ‡åˆ†ï¼Œè¿ç»­çš„0ç”¨äºè¿›ä½ï¼Œè¿ç»­çš„1æ˜¯è¿ç®—ä½ã€‚äº”æ¬¡è¿ç®—åˆ†åˆ«ç±»ä¼¼äºæ˜¯äºŒè¿›åˆ¶æ•°åŠ æ³•ï¼Œå››è¿›åˆ¶æ•°åŠ æ³•ï¼Œåå…­è¿›åˆ¶æ•°åŠ æ³•å’Œä¸‰åäºŒè¿›åˆ¶æ•°åŠ æ³•ã€‚å¦‚01111011-&gt;01 10 01 10(1212)-&gt;0011 0011(33)-&gt;00000110(6)ï¼Œä¸ªæ•°å³ä¸º6ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M1 = <span class="number">0x55555555</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M2 = <span class="number">0x33333333</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M4 = <span class="number">0x0f0f0f0f</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M8 = <span class="number">0x00ff00ff</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> M16 = <span class="number">0x0000ffff</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">hammingDistance</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = x ^ y;</span><br><span class="line">        n = ((n &gt;&gt; <span class="number">1</span>) &amp; M1) + (n &amp; M1);</span><br><span class="line">        n = ((n &gt;&gt; <span class="number">2</span>) &amp; M2) + (n &amp; M2);</span><br><span class="line">        n = ((n &gt;&gt; <span class="number">4</span>) &amp; M4) + (n &amp; M4);</span><br><span class="line">        n = ((n &gt;&gt; <span class="number">8</span>) &amp; M8) + (n &amp; M8);</span><br><span class="line">        n = ((n &gt;&gt; <span class="number">16</span>) &amp; M16) + (n &amp; M16);</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å…³äºè¿ç®—ç¬¦ä¼˜å…ˆçº§"><a href="#å…³äºè¿ç®—ç¬¦ä¼˜å…ˆçº§" class="headerlink" title="å…³äºè¿ç®—ç¬¦ä¼˜å…ˆçº§"></a>å…³äºè¿ç®—ç¬¦ä¼˜å…ˆçº§</h3><p>æœ€å¥½æ˜¯æ‰‹åŠ¨åŠ å…¥æ‹¬å·æ§åˆ¶è¿ç®—é¡ºåºã€‚æ€»ä¼˜å…ˆçº§ï¼šç®—æœ¯è¿ç®—&gt;å…³ç³»è¿ç®—&gt;é€»è¾‘è¿ç®—ã€‚</p><p>ç®—æœ¯è¿ç®—ï¼ˆåŠ + å‡- ä¹˜* é™¤/ å–ä½™%ï¼‰ï¼Œå…³ç³»è¿ç®—ï¼ˆ&gt; &gt;= &lt; &lt;= != ==) ï¼Œé€»è¾‘è¿ç®— ï¼ˆä¸æˆ–éï¼‰</p><p><img title="" src="https://s2.loli.net/2024/03/05/56LdGaltPXoRqpU.png" alt="" width="430"></p><h3 id="å¸¸è§ä½è¿ç®—æŠ€å·§"><a href="#å¸¸è§ä½è¿ç®—æŠ€å·§" class="headerlink" title="å¸¸è§ä½è¿ç®—æŠ€å·§"></a>å¸¸è§ä½è¿ç®—æŠ€å·§</h3><ol><li><p><code>n &amp; M1</code>:å°†äºŒè¿›åˆ¶æ•°nä¸­çš„å¥‡æ•°ä½çš„1ä¿ç•™ï¼Œä¸¢å¼ƒå¶æ•°ä½ã€‚å¦‚n=00011001â€¦01110101-&gt;00010001â€¦01010001ã€‚<code>(n&gt;&gt;2)&amp;M2</code>åŒç†ã€‚</p></li><li><p><code>(n &gt;&gt; 1) &amp; M1 | (n &amp; M1) &lt;&lt; 1</code>ï¼šäº¤æ¢ç›¸é‚»ä¸¤ä¸ªæ•°çš„ä½ç½®ã€‚<code>(n &gt;&gt; 2) &amp; M2 | (n &amp; M2) &lt;&lt; 2</code>åˆ™æ˜¯ä¸¤ä¸ªä¸ºä¸€ç»„ï¼Œäº’ç›¸äº¤æ¢å„ç»„ã€‚å¦‚0011-&gt;1100</p></li><li><p><code>((n &gt;&gt; 1) &amp; M1) + (n &amp; M1)</code>ï¼šå°†nä¸­çš„ç›¸é‚»ä¸¤ä½ç›¸åŠ ï¼Œå¦‚10110101-&gt;1211(å³01110101).<code>((n &gt;&gt; 2) &amp; M2) + (n &amp; M2)</code>åŒç†ï¼Œå¦‚1211(å³01 11 01 01)-&gt;32(å³0011 0010)</p></li><li><p><code>t &amp; 1</code>ï¼šåˆ¤æ–­tæ˜¯å¦ä¸ºå¥‡æ•°,å¦‚æœä¸ºå¥‡æ•°åˆ™ç»“æœä¸º1ã€‚/è·å–tæœ«ä½æ•°å­—ã€‚<code>(t&gt;&gt;i) &amp; 1</code>åˆ™ç”¨æ¥è·å–ç¬¬iä½çš„å€¼ï¼ˆä»å³å¾€å·¦æ•°ç¬¬iä½ï¼‰ã€‚</p></li><li><p><code>t &amp; (t-1)</code>ï¼šæ¯åœ¨å¾ªç¯å†…æ‰§è¡Œä¸€æ¬¡å¹¶è®¡æ•°+1ï¼Œåˆ™å¾ªç¯å®Œæˆå°±å¯ä»¥ç»Ÿè®¡å‡ºäºŒè¿›åˆ¶æ•°ä¸­1çš„ä¸ªæ•°ã€‚</p></li></ol><hr><h3 id="1-3-4-æ±‰æ˜è·ç¦»æ€»å’Œ-477"><a href="#1-3-4-æ±‰æ˜è·ç¦»æ€»å’Œ-477" class="headerlink" title="1-3-4.æ±‰æ˜è·ç¦»æ€»å’Œ:477"></a>1-3-4.æ±‰æ˜è·ç¦»æ€»å’Œ:477</h3><p>æœ€ä¼˜è§£ï¼šé€ä½ç»Ÿè®¡</p><p>å…ˆçœ‹æ‰€æœ‰æ•°å­—çš„ç¬¬ä¸€ä½ï¼Œç„¶åå†ç¬¬äºŒä½â€¦è€Œéå…ˆè®¡ç®—å‡ºä¸¤ä¸¤ä¹‹é—´çš„æ±‰æ˜è·ç¦»ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">totalHammingDistance</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>, size = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">                n += (num &gt;&gt; i) &amp; <span class="number">1</span>; <span class="comment">// nåŠ ä¸Šnumç¬¬iä½çš„å€¼(ä»å³å¾€å·¦ç¬¬iä½)</span></span><br><span class="line">                <span class="comment">//ç¬¬iä½çš„å€¼åªå¯èƒ½æ˜¯0/1ï¼Œå› æ­¤nè®°å½•ä¸‹å‡ºç°è¿‡1çš„æ¬¡æ•°</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//ç¬¬iä½ä¸€å…±nä¸ª1ï¼Œsize-nä¸ª0</span></span><br><span class="line">            ans += n * (size - n);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="1-3-5-äº¤æ›¿ä½äºŒè¿›åˆ¶æ•°ï¼š693"><a href="#1-3-5-äº¤æ›¿ä½äºŒè¿›åˆ¶æ•°ï¼š693" class="headerlink" title="1-3-5.äº¤æ›¿ä½äºŒè¿›åˆ¶æ•°ï¼š693"></a>1-3-5.äº¤æ›¿ä½äºŒè¿›åˆ¶æ•°ï¼š693</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">hasAlternatingBits</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        uint a = n ^ (n &gt;&gt; <span class="number">1</span>);<span class="comment">//longä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯intä¸è¡Œ</span></span><br><span class="line">        <span class="keyword">return</span> (a &amp; (a + <span class="number">1</span>)) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>a=n^(n&gt;&gt;1)</code>:aé™¤å»å‰å¯¼çš„0ä¹‹å¤–ï¼Œå…¶å®ƒæ•°ä½å…¨éƒ¨éƒ½æ˜¯1ã€‚å› ä¸ºå¦‚æœaæ˜¯ä½ä½äºŒè¿›åˆ¶ä½äº¤æ›¿å‡ºç°çš„è¯ï¼Œé‚£å³ç§»ä¸€ä½å°±æ˜¯åŸæ¥æ˜¯0çš„ç§»åˆ°äº†åŸæ¥æ˜¯1çš„ä½ç½®ä¸Šï¼›å†å¼‚æˆ–ï¼Œå°±å…¨éƒ¨éƒ½æ˜¯1äº†ã€‚</p><p><code>a&amp;(a+1)</code>:äºŒè¿›åˆ¶ä½å…¨éƒ¨éƒ½æ˜¯1çš„aåŠ ä¸Š1,å¾—åˆ°çš„äºŒè¿›åˆ¶æ•°a+1å¤šäº†æœ€å‰é¢ä¸€ä¸ªæ•°ä½1å…¶å®ƒéƒ½æ˜¯0,å†ä¸å…¨éƒ¨æ˜¯0çš„aè¿›è¡Œ&amp;ä½ä¸è¿ç®—è‚¯å®šæ˜¯0ã€‚</p><h2 id="1-4-æ•°å­¦æ€ç»´ï¼ˆ-ï¼‰"><a href="#1-4-æ•°å­¦æ€ç»´ï¼ˆ-ï¼‰" class="headerlink" title="1-4.æ•°å­¦æ€ç»´ï¼ˆ*ï¼‰"></a>1-4.æ•°å­¦æ€ç»´ï¼ˆ*ï¼‰</h2><h3 id="1-4-1-å¯æ€œçš„å°çŒªï¼š458"><a href="#1-4-1-å¯æ€œçš„å°çŒªï¼š458" class="headerlink" title="1-4-1.å¯æ€œçš„å°çŒªï¼š458"></a>1-4-1.å¯æ€œçš„å°çŒªï¼š458</h3><p>æ•°å­¦åˆ†æ+baseè¿›åˆ¶ï¼š</p><p><a href="https://leetcode.cn/problems/poor-pigs/solutions/1/hua-jie-suan-fa-458-ke-lian-de-xiao-zhu-by-guanpen/">ç”»è§£ç®—æ³•:458.å¯æ€œçš„å°çŒª</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">poorPigs</span><span class="params">(<span class="type">int</span> buckets, <span class="type">int</span> minutesToDie, <span class="type">int</span> minutesToTest)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> base = minutesToTest / minutesToDie + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">ceil</span>(<span class="built_in">log</span>(buckets) / <span class="built_in">log</span>(base) - <span class="number">1e-5</span>);<span class="comment">//æ˜¯1e-5å³10^(-5)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>ceil()</code>:å‘ä¸Šå–æ•´å‡½æ•°ã€‚</p><p>å‡å»1e-5:ç›®çš„æ˜¯è®©<code>log(buckets) / log(base)</code>å‡å»ä¸€ä¸ªå³å°çš„å€¼ä»¥é¿å…<mark>èˆå…¥è¯¯å·®</mark>ï¼Œä¹Ÿå¯ä»¥æ˜¯1e-7ç­‰ç­‰ã€‚å› ä¸ºå½“buckets=125,minutesToDie=1,minutesToTest=4æ—¶ï¼Œç»“æœåº”è¯¥æ˜¯3ï¼Œè€Œä¸è€ƒè™‘èˆå…¥è¯¯å·®ï¼Œåˆ™ç­”æ¡ˆä¼šæ˜¯4ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ<code>log(buckets) / log(base)</code>çš„ç»“æœé€šå¸¸æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œä½†ç”±äºæµ®ç‚¹æ•°è®¡ç®—çš„ç²¾åº¦é™åˆ¶ï¼Œå¯èƒ½ä¼šå‡ºç°å¾®å°çš„èˆå…¥è¯¯å·®ã€‚é€šè¿‡å‡å» 1e-5ï¼Œå¯ä»¥ç¡®ä¿ç»“æœå‘ä¸‹å–æ•´ï¼Œé¿å…ç”±äºèˆå…¥è¯¯å·®è€Œå¯¼è‡´çš„è®¡ç®—ç»“æœé”™è¯¯ã€‚è¿™æ ·åšå¯ä»¥æ›´æ¥è¿‘æ­£ç¡®çš„æ•´æ•°ç»“æœã€‚</p><h3 id="1-4-2-å„ä½ç›¸åŠ ï¼š258"><a href="#1-4-2-å„ä½ç›¸åŠ ï¼š258" class="headerlink" title="1-4-2.å„ä½ç›¸åŠ ï¼š258"></a>1-4-2.å„ä½ç›¸åŠ ï¼š258</h3><p>è¯¦ç»†æ€è·¯ï¼š<a href="https://leetcode.cn/problems/add-digits/solutions/1/xiang-xi-tong-su-de-si-lu-fen-xi-duo-jie-fa-by-5-7/">åŠ›æ‰£ï¼ˆLeetCode)</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">addDigits</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> (num - <span class="number">1</span>) % <span class="number">9</span> + <span class="number">1</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="1-4-3-ç¯æ³¡å¼€å…³ï¼š319"><a href="#1-4-3-ç¯æ³¡å¼€å…³ï¼š319" class="headerlink" title="1-4-3.ç¯æ³¡å¼€å…³ï¼š319"></a>1-4-3.ç¯æ³¡å¼€å…³ï¼š319</h3><p>è¯¦ç»†æ€è·¯ï¼š<a href="https://leetcode.cn/problems/bulb-switcher/solutions/1102293/gong-shui-san-xie-jing-dian-shu-lun-tui-upnnb/">ã€å®«æ°´ä¸‰å¶ã€‘ç»å…¸æ•°è®ºæ¨è®ºé¢˜</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">bulbSwitch</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sqrt</span>(n + <span class="number">0.5</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç­”æ¡ˆä¸º$\lfloor \sqrt{n} \rfloor$ï¼Œå…¶ä¸­ $\lfloor \cdot \rfloor$ è¡¨ç¤ºå‘ä¸‹å–æ•´ã€‚</p><p>åŠ ä¸Š0.5ï¼šç”±äº $\sqrt{n}$æ¶‰åŠåˆ°æµ®ç‚¹æ•°è¿ç®—ï¼Œä¸ºäº†ä¿è¯ä¸å‡ºç°ç²¾åº¦é—®é¢˜ï¼ˆé¿å…<mark>èˆå…¥è¯¯å·®</mark>ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®— $\sqrt{n + \dfrac{1}{2}}$â€‹ï¼Œè¿™æ ·å¯ä»¥ä¿è¯è®¡ç®—å‡ºæ¥çš„ç»“æœå‘ä¸‹å–æ•´åœ¨32ä½æ•´æ•°èŒƒå›´å†…ä¸€å®šæ­£ç¡®ã€‚å…¶å®åŠ ä¸Šä¸€ä¸ªè¾ƒå°çš„æ•°ä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚1e-5ã€‚</p><p>   ç»¼ä¸Šï¼Œå¯¹äº<u>returnæµ®ç‚¹æ•°ç±»å‹</u>ä¸”<u>å‡½æ•°è¿”å›å€¼ç±»å‹ä¸ºint</u>çš„ï¼Œå¾€å¾€éœ€è¦å‘ä¸Šæˆ–è€…å‘ä¸‹å–æ•´ã€‚ä¸ºé¿å…èˆå…¥è¯¯å·®ï¼Œéœ€è¦å¼•å…¥è¾ƒå°çš„æ•°ï¼Œæ¯”å¦‚1e-5($10^{-5}$)ï¼Œæ˜¯åŠ æ˜¯å‡æ ¹æ®é¢˜ç›®åˆ¤æ–­ã€‚</p><h2 id="1-5-è¿›åˆ¶è½¬æ¢"><a href="#1-5-è¿›åˆ¶è½¬æ¢" class="headerlink" title="1-5.è¿›åˆ¶è½¬æ¢"></a>1-5.è¿›åˆ¶è½¬æ¢</h2><h3 id="1-5-1-æ•°å­—è½¬æ¢ä¸º16è¿›åˆ¶æ•°ï¼š405"><a href="#1-5-1-æ•°å­—è½¬æ¢ä¸º16è¿›åˆ¶æ•°ï¼š405" class="headerlink" title="1-5-1.æ•°å­—è½¬æ¢ä¸º16è¿›åˆ¶æ•°ï¼š405"></a>1-5-1.æ•°å­—è½¬æ¢ä¸º16è¿›åˆ¶æ•°ï¼š405</h3><p>ä½è¿ç®—ï¼Œå…³é”®åœ¨äº<code>int val = (num &gt;&gt; (4 * i)) &amp; 0xf</code>å°†äºŒè¿›åˆ¶æ•°åˆ†ç»„ä»¥åå†ä¸€ä¸€è¿ç®—ã€‚å¦‚æœè¿™é‡Œæ˜¯è½¬ä¸º8è¿›åˆ¶æ•°ï¼Œåˆ™æ¯ä¸‰ä¸ªæ•°ä¸ºä¸€ç»„ï¼ŒåŒç†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">toHex</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (num == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        string ans = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="comment">// 32ä½çš„äºŒè¿›åˆ¶æ•°ä¸€å…±8ç»„ï¼Œæ¯ç»„4ä¸ªæ•°num&gt;&gt;(4*i)å¯ä»¥å°†ç¬¬iç»„çš„å››ä¸ªæ•°ç§»åˆ°æœ«å°¾</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">7</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="type">int</span> val = (num &gt;&gt; (<span class="number">4</span> * i)) &amp; <span class="number">0xf</span>;<span class="comment">//ä¸€ä¸ªvalå¯¹åº”åå…­è¿›åˆ¶çš„ä¸€ä¸ªæ•°å­—0-9/å­—æ¯a-f</span></span><br><span class="line">            <span class="keyword">if</span> (ans.<span class="built_in">length</span>() &gt; <span class="number">0</span> || val &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="type">char</span> digit = val &lt; <span class="number">10</span> ? (<span class="type">char</span>)(val + <span class="string">&#x27;0&#x27;</span>) : (<span class="type">char</span>)(<span class="string">&#x27;a&#x27;</span> + val - <span class="number">10</span>);</span><br><span class="line">                ans.<span class="built_in">push_back</span>(digit);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><p><code>ans.length()&gt;0</code>ç”¨äºé¿å…å‡ºç°å‰ç½®0.</p></li><li><p>æ±‚è´Ÿæ•´æ•°çš„è¡¥ç :å°†å…¶åŸç <u>é™¤ç¬¦å·ä½å¤–</u>çš„æ‰€æœ‰ä½å–åï¼ˆ0å˜1ï¼Œ1å˜0ï¼Œç¬¦å·ä½ä¸º1ä¸å˜ï¼‰ååŠ 1ã€‚</p></li><li><p>è¯¥é¢˜è¿˜è¦æ³¨æ„ä¸€ç‚¹ï¼Œ<code>val+&#39;0&#39;</code>åªé€‚ç”¨äºval&lt;10æ—¶çš„æƒ…å†µï¼Œå› ä¸º<code>&#39;a&#39;!=&#39;9&#39;+1</code>ï¼Œå®ƒä»¬å¯¹åº”çš„ASCIIç å¹¶ä¸æ˜¯è¿ç»­çš„ã€‚</p></li></ul><h3 id="1-5-2-Excelè¡¨åˆ—åç§°ï¼š168"><a href="#1-5-2-Excelè¡¨åˆ—åç§°ï¼š168" class="headerlink" title="1-5-2.Excelè¡¨åˆ—åç§°ï¼š168"></a>1-5-2.Excelè¡¨åˆ—åç§°ï¼š168</h3><p>æœ¬è´¨ä¸º10è¿›åˆ¶è½¬26è¿›åˆ¶ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">convertToTitle</span><span class="params">(<span class="type">int</span> columnNumber)</span> </span>&#123;</span><br><span class="line">        string ans = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span> (columnNumber &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            --columnNumber;</span><br><span class="line">            <span class="type">char</span> c = columnNumber % <span class="number">26</span> + <span class="string">&#x27;A&#x27;</span>;<span class="comment">//ä»æœ«ä½ä»åå¾€å‰æ·»åŠ å­—ç¬¦</span></span><br><span class="line">            ans.<span class="built_in">push_back</span>(c);</span><br><span class="line">            columnNumber /= <span class="number">26</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(ans.<span class="built_in">begin</span>(), ans.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="1-6-æ•°å­—å˜æ¢-ç»Ÿè®¡-æ•°å­¦åˆ†æ"><a href="#1-6-æ•°å­—å˜æ¢-ç»Ÿè®¡-æ•°å­¦åˆ†æ" class="headerlink" title="1-6.æ•°å­—å˜æ¢/ç»Ÿè®¡ + æ•°å­¦åˆ†æ"></a>1-6.æ•°å­—å˜æ¢/ç»Ÿè®¡ + æ•°å­¦åˆ†æ</h2><h3 id="1-6-1-æœ€å¤§å˜æ¢ï¼š670"><a href="#1-6-1-æœ€å¤§å˜æ¢ï¼š670" class="headerlink" title="1-6-1.æœ€å¤§å˜æ¢ï¼š670"></a>1-6-1.æœ€å¤§å˜æ¢ï¼š670</h3><p><u>æœ€æ¥è¿‘å³è¾¹ä¸”æœ€å¤§</u>çš„æ•°æ˜¯s[maxIndex]ä¸<u>æœ€æ¥è¿‘å·¦è¾¹ä¸”éæœ€å¤§</u>çš„æ•°s[index]è¿›è¡Œäº¤æ¢ã€‚ä½†æ˜¯å¦‚æœè¿™æ ·å¾—å‡ºçš„maxIndex&lt;indexï¼Œé‚£ä¹ˆç»“æœä¼šå‡ºç°é—®é¢˜ã€‚å› æ­¤éœ€è¦é¢å¤–å¼•å…¥index2æ¥è®°å½•æ¯ä¸€æ¬¡å¾ªç¯å®Œæˆåçš„maxIndexï¼Œindex2=maxIndex.</p><p>è´ªå¿ƒï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maximumSwap</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        string s = <span class="built_in">to_string</span>(num);</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">size</span>(), maxIndex = n - <span class="number">1</span>, index1 = <span class="number">-1</span>, index2 = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[maxIndex] &lt; s[i]) &#123;</span><br><span class="line">                maxIndex = i;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s[i] &lt; s[maxIndex]) &#123;</span><br><span class="line">                index1 = i;</span><br><span class="line">                index2 = maxIndex;<span class="comment">//æ¯”å¦‚98368,maxIndex=0,éœ€è¦é¢å¤–çš„index2è®°å½•</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (index1 &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(s[index1], s[index2]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">stoi</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="1-6-2-æ•°å­—1çš„ä¸ªæ•°ï¼š233ï¼ˆå›°éš¾ï¼‰"><a href="#1-6-2-æ•°å­—1çš„ä¸ªæ•°ï¼š233ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="1-6-2.æ•°å­—1çš„ä¸ªæ•°ï¼š233ï¼ˆå›°éš¾ï¼‰"></a>1-6-2.æ•°å­—1çš„ä¸ªæ•°ï¼š233ï¼ˆå›°éš¾ï¼‰</h3><p>è§£é¢˜æ€è·¯ï¼š<a href="https://leetcode.cn/problems/number-of-digit-one/solutions/1/233-shu-zi-1-de-ge-shu-qing-xi-tu-jie-by-pgb1/">æ•°å­— 1 çš„ä¸ªæ•°ï¼ˆæ¸…æ™°å›¾è§£ï¼‰</a></p><script type="math/tex; mode=display">res+=\left \{\begin{array}{}&high \times digit\ ,\ &cur = 0\ ;\\&high \times digit + low + 1 \ ,\ &cur = 1\ ;\\&(high + 1) \times digit\ ,\ &cur\gt1\ ;\\\end{array}\right.</script><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countDigitOne</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">long</span> digit = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> high = n / <span class="number">10</span>, cur = n % <span class="number">10</span>, low = <span class="number">0</span>, res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (high != <span class="number">0</span> || cur != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur == <span class="number">0</span>) &#123;</span><br><span class="line">                res += high * digit;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cur == <span class="number">1</span>) &#123;</span><br><span class="line">                res += high * digit + low + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res += (high + <span class="number">1</span>) * digit;</span><br><span class="line">            &#125;</span><br><span class="line">            low += cur * digit;</span><br><span class="line">            cur = high % <span class="number">10</span>;</span><br><span class="line">            high /= <span class="number">10</span>;</span><br><span class="line">            digit *= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="1-6-3-ç»Ÿè®¡å„ä½æ•°å­—éƒ½ä¸åŒçš„æ•°å­—ä¸ªæ•°ï¼š357"><a href="#1-6-3-ç»Ÿè®¡å„ä½æ•°å­—éƒ½ä¸åŒçš„æ•°å­—ä¸ªæ•°ï¼š357" class="headerlink" title="1-6-3.ç»Ÿè®¡å„ä½æ•°å­—éƒ½ä¸åŒçš„æ•°å­—ä¸ªæ•°ï¼š357"></a>1-6-3.ç»Ÿè®¡å„ä½æ•°å­—éƒ½ä¸åŒçš„æ•°å­—ä¸ªæ•°ï¼š357</h3><p>ä½¿ç”¨æ•°å­—çš„æ’åˆ—ç»„åˆ$A^{n}_{k}â€‹=\frac{n!}{(nâˆ’k)!}$</p><blockquote><p>å«æœ‰ $dï¼ˆ2 \le d \le 10ï¼‰$ä½æ•°çš„å„ä½æ•°å­—éƒ½ä¸åŒçš„æ•°å­—$x$çš„ä¸ªæ•°å¯ä»¥ç”±å…¬å¼$9 \times A<em>9^{d-1}$è®¡ç®—ï¼Œç¬¬ä¸€ä½åªèƒ½ä»1-9ä¸­é€‰æ‹©ï¼Œåé¢çš„d-1ä½ä»å‰©ä¸‹çš„9ä¸ªæ•°ä¹‹ä¸­é€‰ï¼Œå³$A_9^{d-1}$ä¸ªã€‚æ€»ä¸ªæ•°å…¶å®å°±æ˜¯$res = 10 + 9 \times (A^{1}</em>{9}+A^{2}<em>{9}+â€¦+A^{n-1}</em>{9})$</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countNumbersWithUniqueDigits</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> res = <span class="number">10</span>, CurrentNum = <span class="number">9</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            CurrentNum *= <span class="number">9</span> - i;</span><br><span class="line">            res += CurrentNum;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="2-å¿«é€Ÿå¹‚"><a href="#2-å¿«é€Ÿå¹‚" class="headerlink" title="2.å¿«é€Ÿå¹‚"></a>2.å¿«é€Ÿå¹‚</h1><h2 id="2-1-å®ç°pow-x-n-ï¼š50"><a href="#2-1-å®ç°pow-x-n-ï¼š50" class="headerlink" title="2-1.å®ç°pow(x,n)ï¼š50"></a>2-1.å®ç°pow(x,n)ï¼š50</h2><p>è§£é¢˜æ€è·¯ï¼š<a href="https://leetcode.cn/problems/powx-n/solutions/1/50-powx-n-kuai-su-mi-qing-xi-tu-jie-by-jyd/">å¿«é€Ÿå¹‚ï¼Œæ¸…æ™°å›¾è§£</a></p><p>å…³äºå¿«é€Ÿå¹‚ï¼š<a href="https://zhuanlan.zhihu.com/p/95902286">å¿«é€Ÿå¹‚-Pecco</a></p><p>å¿«é€Ÿå¹‚æœ¬è´¨æ˜¯åˆ†æ²»ç®—æ³•ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p><p>æ³•ä¸€ï¼šé€’å½’ï¼ˆéœ€è¦é¢å¤–æ ˆç©ºé—´ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">double</span> <span class="title">quilkMul</span><span class="params">(<span class="type">double</span> x, <span class="type">long</span> <span class="type">long</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (N == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">double</span> y = <span class="built_in">quilkMul</span>(x, N / <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> N % <span class="number">2</span> == <span class="number">0</span> ? y * y : y * y * x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">double</span> <span class="title">myPow</span><span class="params">(<span class="type">double</span> x, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> N = n;</span><br><span class="line">        <span class="keyword">return</span> N &gt;= <span class="number">0</span> ? <span class="built_in">quilkMul</span>(x, N) : <span class="number">1.0</span> / <span class="built_in">quilkMul</span>(x, -N);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šè¿­ä»£ï¼ˆæ¶‰åŠä½è¿ç®—åˆ†æï¼‰</p><p>åˆ¤æ–­<code>N%2==1</code>ä¹Ÿå¯ä»¥å†™ä¸º<code>N&amp;1==1</code>,<code>N/=2</code>å¯ä»¥å†™ä¸º<code>N&gt;&gt;=1</code>,æ›´èƒ½ä½“ç°ä½è¿ç®—æ€æƒ³ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">double</span> <span class="title">quilkMul</span><span class="params">(<span class="type">double</span> x, <span class="type">long</span> <span class="type">long</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="type">double</span> ans = <span class="number">1.0</span>;</span><br><span class="line">        <span class="comment">// è´¡çŒ®çš„åˆå§‹å€¼ä¸º x</span></span><br><span class="line">        <span class="type">double</span> x_contribute = x;</span><br><span class="line">        <span class="comment">// åœ¨å¯¹ N è¿›è¡ŒäºŒè¿›åˆ¶æ‹†åˆ†çš„åŒæ—¶è®¡ç®—ç­”æ¡ˆ</span></span><br><span class="line">        <span class="keyword">while</span> (N &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (N % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœ N äºŒè¿›åˆ¶è¡¨ç¤ºçš„æœ€ä½ä½ä¸º 1ï¼Œé‚£ä¹ˆéœ€è¦è®¡å…¥è´¡çŒ®</span></span><br><span class="line">                ans *= x_contribute;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å°†è´¡çŒ®ä¸æ–­åœ°å¹³æ–¹</span></span><br><span class="line">            x_contribute *= x_contribute;</span><br><span class="line">            <span class="comment">// èˆå¼ƒ N äºŒè¿›åˆ¶è¡¨ç¤ºçš„æœ€ä½ä½ï¼Œè¿™æ ·æˆ‘ä»¬æ¯æ¬¡åªè¦åˆ¤æ–­æœ€ä½ä½å³å¯</span></span><br><span class="line">            N /= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">double</span> <span class="title">myPow</span><span class="params">(<span class="type">double</span> x, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> N = n;</span><br><span class="line">        <span class="keyword">return</span> N &gt;= <span class="number">0</span> ? <span class="built_in">quilkMul</span>(x, N) : <span class="number">1.0</span> / <span class="built_in">quilkMul</span>(x, -N);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨äº†<code>long long N = n;</code>ï¼Œå› ä¸ºåœ¨n=INT_MINæ—¶ï¼Œ-n=-INT_MIN=INT_MIN(INT_MIN=$-2^{31}$,INT_MAX=$2^{31}-1$)ï¼Œä½¿ç”¨long longå­˜å‚¨èƒ½é¿å…è¿™ä¸€éº»çƒ¦ã€‚</p></blockquote><h3 id="2-2-è¶…çº§æ¬¡æ–¹ï¼š372"><a href="#2-2-è¶…çº§æ¬¡æ–¹ï¼š372" class="headerlink" title="2-2.è¶…çº§æ¬¡æ–¹ï¼š372"></a>2-2.è¶…çº§æ¬¡æ–¹ï¼š372</h3><p>æ³•ä¸€ï¼šå€’åºéå†+å¿«é€Ÿå¹‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">pow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ•°å­—å¤ªå¤§ï¼Œä¸ä½¿ç”¨longå®¹æ˜“è¶…å‡ºèŒƒå›´</span></span><br><span class="line">        <span class="type">long</span> ans = <span class="number">1</span>;</span><br><span class="line">        <span class="type">long</span> N = n;</span><br><span class="line">        <span class="type">long</span> x_contribute = x;</span><br><span class="line">        <span class="keyword">while</span> (N &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (N &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// åŒ…æ‹¬ä¹‹åçš„å¤šæ¬¡å¯¹1337å–æ¨¡éƒ½æ˜¯ä¸ºäº†é¿å…æº¢å‡º</span></span><br><span class="line">                ans = ans * x_contribute % <span class="number">1337</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            x_contribute = x_contribute * x_contribute % <span class="number">1337</span>;</span><br><span class="line">            N &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">superPow</span><span class="params">(<span class="type">int</span> a, vector&lt;<span class="type">int</span>&gt;&amp; b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (a == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> res = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = b.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            res = res * <span class="built_in">pow</span>(a, b[i]) % <span class="number">1337</span>;</span><br><span class="line">            a = <span class="built_in">pow</span>(a, <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½¢å¦‚<code>x_contribute = x_contribute * x_contribute % 1337;</code>ä¸èƒ½å†™æˆ<code>x_contribute *= x_contribute % 1337;</code>å› ä¸ºä¸€ä¸ªæœ€ç»ˆæ˜¯å¹³æ–¹å¯¹1337å–çš„æ¨¡ï¼Œå¦ä¸€ä¸ªæ˜¯è‡ªèº«å¯¹1337å–æ¨¡ä»¥åçš„å€¼å†ä¹˜ä»¥è‡ªèº«ï¼Œè¿™æ ·ä¼šå¯¼è‡´æº¢å‡ºï¼ˆæ³¨æ„è¿ç®—é¡ºåºï¼‰ã€‚</p><p>æ³•äºŒï¼šæ­£åºéå†+ç§¦ä¹éŸ¶ç®—æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">pow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> n)</span> </span>&#123; <span class="comment">// æ•°å­—å¤ªå¤§ï¼Œä¸ä½¿ç”¨longå®¹æ˜“è¶…å‡ºèŒƒå›´</span></span><br><span class="line">        <span class="type">long</span> ans = <span class="number">1</span>;</span><br><span class="line">        <span class="type">long</span> N = n;</span><br><span class="line">        <span class="type">long</span> x_contribute = x;</span><br><span class="line">        <span class="keyword">while</span> (N &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (N &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// åŒ…æ‹¬ä¹‹åçš„å¤šæ¬¡å¯¹1337å–æ¨¡éƒ½æ˜¯ä¸ºäº†é¿å…æº¢å‡º</span></span><br><span class="line">                ans = ans * x_contribute % <span class="number">1337</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            x_contribute = x_contribute * x_contribute % <span class="number">1337</span>;</span><br><span class="line">            N &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">superPow</span><span class="params">(<span class="type">int</span> a, vector&lt;<span class="type">int</span>&gt;&amp; b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (a == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> res = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : b) &#123; <span class="comment">// åŒºåˆ«ä»…åœ¨äºforå¾ªç¯</span></span><br><span class="line">            res = <span class="built_in">pow</span>(res, <span class="number">10</span>) * <span class="built_in">pow</span>(a, num) % <span class="number">1337</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="2-3-ä¸¤æ•°ç›¸é™¤ï¼š29"><a href="#2-3-ä¸¤æ•°ç›¸é™¤ï¼š29" class="headerlink" title="2-3.ä¸¤æ•°ç›¸é™¤ï¼š29"></a>2-3.ä¸¤æ•°ç›¸é™¤ï¼š29</h3><blockquote><p>ç±»ä¼¼å¿«é€Ÿå¹‚é€šè¿‡ä¹˜æ³•å®ç°å¹‚ï¼Œè¿™é‡Œä½¿ç”¨â€œå¿«é€Ÿä¹˜â€ç®—æ³•é€šè¿‡åŠ æ³•å®ç°ä¹˜æ³•ã€‚</p></blockquote><p>å¿«é€Ÿä¹˜+ç±»äºŒåˆ†æŸ¥æ‰¾</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">divide</span><span class="params">(<span class="type">int</span> dividend, <span class="type">int</span> divisor)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä¸‰ç§ç‰¹æ®Šæƒ…å†µ</span></span><br><span class="line">        <span class="comment">//  è€ƒè™‘è¢«é™¤æ•°ä¸ºæœ€å°å€¼çš„æƒ…å†µ</span></span><br><span class="line">        <span class="keyword">if</span> (dividend == INT_MIN) &#123;</span><br><span class="line">            <span class="keyword">if</span> (divisor == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> INT_MIN;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (divisor == <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> INT_MAX;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è€ƒè™‘é™¤æ•°ä¸ºæœ€å°å€¼çš„æƒ…å†µ</span></span><br><span class="line">        <span class="keyword">if</span> (divisor == INT_MIN) &#123;</span><br><span class="line">            <span class="keyword">return</span> dividend == INT_MIN ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è€ƒè™‘è¢«é™¤æ•°ä¸º 0 çš„æƒ…å†µ</span></span><br><span class="line">        <span class="keyword">if</span> (dividend == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸€èˆ¬æƒ…å†µï¼Œä½¿ç”¨ç±»äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line">        <span class="comment">//  å°†æ‰€æœ‰çš„æ­£æ•°å–ç›¸åæ•°ï¼Œè¿™æ ·å°±åªéœ€è¦è€ƒè™‘ä¸€ç§æƒ…å†µ</span></span><br><span class="line">        <span class="type">bool</span> rev = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (dividend &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            dividend = -dividend;</span><br><span class="line">            rev = !rev;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (divisor &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            divisor = -divisor;</span><br><span class="line">            rev = !rev;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; candidates = &#123;divisor&#125;;</span><br><span class="line">        <span class="comment">// æ³¨æ„æº¢å‡º</span></span><br><span class="line">        <span class="keyword">while</span> (candidates.<span class="built_in">back</span>() &gt;= dividend - candidates.<span class="built_in">back</span>()) &#123;</span><br><span class="line">            candidates.<span class="built_in">push_back</span>(candidates.<span class="built_in">back</span>() + candidates.<span class="built_in">back</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = candidates.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (candidates[i] &gt;= dividend) &#123;</span><br><span class="line">                ans += (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">                dividend -= candidates[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> rev ? -ans : ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/03/10/vhsgej4YJL8tq9O.png" alt=""></p><p><img src="https://s2.loli.net/2024/03/10/jgRMEvPXiGp4klB.png" alt=""></p><blockquote><p>å°†æ‰€æœ‰æ­£æ•°å–ç›¸åæ•°ï¼šç¡®ä¿éƒ½æ˜¯è´Ÿæ•°ï¼Œä»è€Œé¿å…æº¢å‡ºï¼Œå› ä¸ºéƒ½è½¬ä¸ºæ­£æ•°ä¼šå¯¼è‡´INT_MINè¿™ä¸ªè¾¹ç•Œéš¾ä»¥å¤„ç†ã€‚</p></blockquote><p>å¿«é€Ÿä¹˜ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// å¿«é€Ÿä¹˜</span></span><br><span class="line">    <span class="keyword">auto</span> quickAdd = [](<span class="type">int</span> y, <span class="type">int</span> z, <span class="type">int</span> x) &#123;</span><br><span class="line">        <span class="comment">// x å’Œ y æ˜¯è´Ÿæ•°ï¼Œz æ˜¯æ­£æ•°</span></span><br><span class="line">        <span class="comment">// éœ€è¦åˆ¤æ–­ z * y &gt;= x æ˜¯å¦æˆç«‹</span></span><br><span class="line">        <span class="type">int</span> result = <span class="number">0</span>, add = y;</span><br><span class="line">        <span class="keyword">while</span> (z) &#123;</span><br><span class="line">            <span class="keyword">if</span> (z &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// éœ€è¦ä¿è¯ result + add &gt;= x</span></span><br><span class="line">                <span class="keyword">if</span> (result &lt; x - add) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                result += add;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (z != <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// éœ€è¦ä¿è¯ add + add &gt;= x</span></span><br><span class="line">                <span class="keyword">if</span> (add &lt; x - add) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                add += add;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä¸èƒ½ä½¿ç”¨é™¤æ³•</span></span><br><span class="line">            z &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>yå¯¹åº”é™¤æ•°divisorï¼Œzå¯¹åº”ä¸­ç‚¹midï¼Œxå¯¹åº”è¢«é™¤æ•°dividend.</p>]]></content>
    
    
    <summary type="html">ä½è¿ç®—éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="ä½è¿ç®—" scheme="https://sumikiru.top/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/"/>
    
  </entry>
  
  <entry>
    <title>2.2å­—ç¬¦ä¸²ç¯‡(3)</title>
    <link href="https://sumikiru.top/posts/1f30e95.html"/>
    <id>https://sumikiru.top/posts/1f30e95.html</id>
    <published>2024-04-05T19:31:58.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="7-å­—ç¬¦ä¸²å­åºåˆ—é—®é¢˜"><a href="#7-å­—ç¬¦ä¸²å­åºåˆ—é—®é¢˜" class="headerlink" title="7.å­—ç¬¦ä¸²å­åºåˆ—é—®é¢˜"></a>7.å­—ç¬¦ä¸²å­åºåˆ—é—®é¢˜</h1><p>å¯ä»¥ç”¨åŒæŒ‡é’ˆ/åŠ¨æ€è§„åˆ’å®Œæˆã€‚</p><p>å¦‚392ã€524é¢˜</p><p>æ³¨ï¼šcompareæ–¹æ³•æ¨¡æ¿<code>str1.compare(str2);</code>ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²å“ªä¸ªçš„<mark>å­—ç¬¦åº</mark>æ›´å°ï¼ˆè€Œéé•¿åº¦ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">std::string str1 = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">std::string str2 = <span class="string">&quot;def&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> result = str1.<span class="built_in">compare</span>(str2);<span class="comment">//è¿”å›è´Ÿæ•°</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœ <code>str1</code> å°äº <code>str2</code>ï¼Œåˆ™ <code>result</code> å°†ä¸ºè´Ÿæ•°ã€‚</li><li>å¦‚æœ <code>str1</code> ç­‰äº <code>str2</code>ï¼Œåˆ™ <code>result</code> å°†ä¸º 0ã€‚</li><li>å¦‚æœ <code>str1</code> å¤§äº <code>str2</code>ï¼Œåˆ™ <code>result</code> å°†ä¸ºæ­£æ•°ã€‚</li></ul><hr><p>åˆ¤æ–­sæ˜¯å¦æ˜¯tçš„å­å­—ç¬¦ä¸² </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isSubsequence</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> sPos=<span class="number">0</span>,tPos=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> n=s.<span class="built_in">length</span>(),m=t.<span class="built_in">length</span>();</span><br><span class="line">        <span class="keyword">while</span>(sPos&lt;n&amp;&amp;tPos&lt;m)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[sPos]==t[tPos])&#123;</span><br><span class="line">                sPos++;</span><br><span class="line">            &#125;</span><br><span class="line">            tPos++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sPos==n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="8-é«˜ç²¾åº¦è¿ç®—"><a href="#8-é«˜ç²¾åº¦è¿ç®—" class="headerlink" title="8.é«˜ç²¾åº¦è¿ç®—"></a>8.é«˜ç²¾åº¦è¿ç®—</h1><h2 id="8-1-åŠ ä¸€ï¼š66"><a href="#8-1-åŠ ä¸€ï¼š66" class="headerlink" title="8-1.åŠ ä¸€ï¼š66"></a>8-1.åŠ ä¸€ï¼š66</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">plusOne</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; digits)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = digits.<span class="built_in">size</span>(), pos = n - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (pos &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (digits[pos] != <span class="number">9</span>) &#123;</span><br><span class="line">                digits[pos]++;</span><br><span class="line">                <span class="keyword">return</span> digits;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                digits[pos--] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å…¨æ˜¯9çš„æƒ…å†µ</span></span><br><span class="line">        digits.<span class="built_in">emplace_back</span>(<span class="number">0</span>);</span><br><span class="line">        digits[<span class="number">0</span>] = <span class="number">1</span>; <span class="comment">//å…¶ä»–æ•°å­—å·²ç»åœ¨whileå¾ªç¯ä¸­è¢«æ”¹æˆ9äº†</span></span><br><span class="line">        <span class="keyword">return</span> digits;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="8-2-äºŒè¿›åˆ¶æ±‚å’Œï¼š67"><a href="#8-2-äºŒè¿›åˆ¶æ±‚å’Œï¼š67" class="headerlink" title="8-2.äºŒè¿›åˆ¶æ±‚å’Œï¼š67"></a>8-2.äºŒè¿›åˆ¶æ±‚å’Œï¼š67</h2><p>æ³•ä¸€ï¼šæ¨¡æ‹Ÿ(æœ€ä¼˜)</p><p>å…³é”®åœ¨äºå¤šæ¬¡è¿›è¡Œreverseæ–¹ä¾¿è¿ç®—å’Œè¿›ä½ï¼›åŒæ—¶è¿›ä½æ•°carryçš„å¤„ç†ä¹Ÿå¾ˆå·§å¦™ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">addBinary</span><span class="params">(string a, string b)</span> </span>&#123;</span><br><span class="line">        string ans;</span><br><span class="line">        <span class="built_in">reverse</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">reverse</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> n = <span class="built_in">max</span>(a.<span class="built_in">size</span>(), b.<span class="built_in">size</span>()), carry = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            carry += i &lt; a.<span class="built_in">size</span>() ? (a[i] == <span class="string">&#x27;1&#x27;</span>) : <span class="number">0</span>;</span><br><span class="line">            carry += i &lt; b.<span class="built_in">size</span>() ? (b[i] == <span class="string">&#x27;1&#x27;</span>) : <span class="number">0</span>;</span><br><span class="line">            ans += carry % <span class="number">2</span> ? <span class="string">&quot;1&quot;</span> : <span class="string">&quot;0&quot;</span>;</span><br><span class="line">            carry /= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (carry) &#123;</span><br><span class="line">            ans += <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(ans.<span class="built_in">begin</span>(), ans.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šä½è¿ç®—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">addBinary</span><span class="params">(string a, string b)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨bitsetæ¥å¤„ç†äºŒè¿›åˆ¶ç›¸åŠ </span></span><br><span class="line">        <span class="function">bitset&lt;10000&gt; <span class="title">x</span><span class="params">(a)</span></span>;</span><br><span class="line">        <span class="function">bitset&lt;10000&gt; <span class="title">y</span><span class="params">(b)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (y.<span class="built_in">any</span>()) &#123;</span><br><span class="line">            <span class="comment">// è®¡ç®—å½“å‰ä½çš„å’Œå’Œè¿›ä½</span></span><br><span class="line">            bitset&lt;10000&gt; sum = x ^ y;</span><br><span class="line">            bitset&lt;10000&gt; carry = (x &amp; y) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// æ›´æ–°xå’Œy</span></span><br><span class="line">            x = sum;</span><br><span class="line">            y = carry;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†bitsetè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶å»é™¤å‰å¯¼é›¶</span></span><br><span class="line">        string ans = x.<span class="built_in">to_string</span>();</span><br><span class="line">        <span class="type">size_t</span> startPos = ans.<span class="built_in">find</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (startPos != string::npos) &#123;  <span class="comment">//èƒ½æ‰¾åˆ°</span></span><br><span class="line">            <span class="keyword">return</span> ans.<span class="built_in">substr</span>(startPos);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><p>æ ¹æ®é¢˜å¹²ï¼Œç”±äº<code>1 &lt;= a.length, b.length &lt;= 10^4</code>ï¼Œå› æ­¤aå¯èƒ½ä½æ•°å¾ˆé•¿ï¼Œéœ€è¦å¾ˆé•¿çš„äºŒè¿›åˆ¶æ•°æ¥å­˜å‚¨ï¼Œå¸¸è§„çš„<code>int x=stoi(a,0,2)</code>ä¼šå¯¼è‡´æº¢å‡ºï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨1e4ä½çš„bitsetæ¥å­˜å‚¨è½¬æ¢çš„a.aä¸éœ€è¦è½¬æ¢ä¸ºå…¶ä»–å‚æ•°ï¼Œstringæˆ–è€…intç­‰ç­‰éƒ½å¯ä»¥ç›´æ¥è½¬æ¢ä¸ºbitsetã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœaä»…ä»…æ˜¯ä¸€ä¸ªintå‹æ•´æ•°ï¼Œé‚£ä¹ˆåªéœ€è¦<code>bitset&lt;32&gt;</code>å³å¯ï¼Œå› ä¸ºintèŒƒå›´åœ¨$-2^{31}$ åˆ° $2^{31} - 1$ï¼Œ</p></li><li><p>whileå¾ªç¯ä¸­åº”è¯¥ä½¿ç”¨y.any()è€Œéyï¼šåœ¨C++ä¸­ï¼Œ<code>std::bitset</code> ç±»å‹çš„å¯¹è±¡ä¸å¯ä»¥éšå¼åœ°è¢«è½¬æ¢ä¸º <code>bool</code> ç±»å‹ã€‚å¦‚æœ <code>y</code> æ˜¯ä¸€ä¸ª <code>std::bitset</code> å¯¹è±¡ï¼Œ<code>y</code> ä¼šè¢«ç”¨ä½œä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼æ—¶ï¼Œå®ƒæ— æ³•éšå¼åœ°è½¬æ¢ä¸º <code>bool</code>ã€‚ä½¿ç”¨ <code>y.any()</code> æ˜¯ä¸€ç§æ›´æ˜ç¡®çš„æ–¹å¼æ¥è¡¨è¾¾å¾ªç¯çš„ç»ˆæ­¢æ¡ä»¶ï¼Œå› ä¸ºå®ƒç›´æ¥æ£€æŸ¥ <code>std::bitset</code> <u>æ˜¯å¦æœ‰ä»»ä½•</u>éé›¶ä½ï¼Œæ‰€æœ‰ä½å‡ä¸º0æ—¶ä¸ºfalseé€€å‡ºå¾ªç¯ã€‚</p></li><li><p><code>(x&amp;y)&lt;&lt;1</code>:å¤„ç†è¿›ä½ã€‚</p><ol><li><p><code>x &amp; y</code>: è¿™æ˜¯ <code>x</code> å’Œ <code>y</code> çš„æŒ‰ä½ä¸è¿ç®—ã€‚åœ¨äºŒè¿›åˆ¶ä¸­ï¼Œæ¯ä¸€ä½ä¸Šçš„ç»“æœæ˜¯å–ä¸¤ä¸ªæ•°å¯¹åº”ä½ä¸Šçš„é€»è¾‘ä¸ï¼ˆANDï¼‰è¿ç®—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ <code>x</code> çš„æŸä¸€ä½æ˜¯1ï¼Œè€Œ <code>y</code> çš„ç›¸åŒä½ç½®ä¹Ÿæ˜¯1ï¼Œé‚£ä¹ˆç»“æœçš„ç›¸åº”ä½å°±æ˜¯1ï¼›å¦åˆ™ä¸º0ã€‚</p></li><li><p><code>(x &amp; y) &lt;&lt; 1</code>: è¿™æ˜¯å°†ä¸Šè¿°æŒ‰ä½ä¸è¿ç®—çš„ç»“æœå·¦ç§»ä¸€ä½ã€‚å·¦ç§»è¿ç®—æ˜¯å°†äºŒè¿›åˆ¶æ•°çš„æ¯ä¸€ä½å‘å·¦ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ï¼Œå³ä¾§ç©ºå‡ºçš„ä½è¡¥0ã€‚å› æ­¤ï¼Œ<code>(x &amp; y) &lt;&lt; 1</code> å°±æ˜¯å°† <code>(x &amp; y)</code> çš„æ‰€æœ‰ä½éƒ½å‘å·¦ç§»åŠ¨ä¸€ä½ã€‚</p></li></ol></li><li><p><code>x.to_string()</code>:xä¸ºbitsetç±»å‹çš„å¯¹è±¡ã€‚<code>x.to_string()</code> æ˜¯ç”¨äºè°ƒç”¨å¯¹è±¡çš„æˆå‘˜å‡½æ•°ï¼Œè€Œ <code>to_string(x)</code> æ˜¯ç”¨äºå°†åŸºæœ¬æ•°æ®ç±»å‹(æ¯”å¦‚int)è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p></li><li><p><code>size_t startPos = ans.find(&#39;1&#39;)</code>:å­—ç¬¦ä¸²ä¸­çš„findæ–¹æ³•åœ¨æ‰¾å¯»åˆ°ç¬¬ä¸€ä¸ªâ€˜1â€™åï¼Œè¿”å›size_tç±»å‹çš„ç»“æœã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™è¿”å›<code>std::string::npos</code>ã€‚<code>size_t</code> æ˜¯ä¸€ç§æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œé€šå¸¸ç”¨äºè¡¨ç¤ºå¯¹è±¡çš„å¤§å°ã€ç´¢å¼•æˆ–é•¿åº¦ã€‚å®ƒæ˜¯é€šè¿‡åŒ…å«å¤´æ–‡ä»¶ <code>&lt;cstddef&gt;</code>ï¼ˆæˆ– <code>&lt;stddef.h&gt;</code>ï¼Œåœ¨Cè¯­è¨€ä¸­ï¼‰æ¥å¼•å…¥çš„ã€‚</p><p>C++æ ‡å‡†è§„å®šäº† <code>size_t</code> çš„å±æ€§ï¼Œå®ƒè¢«å®šä¹‰ä¸ºä¸€ä¸ªè¶³å¤Ÿå¤§ä»¥å®¹çº³ç¨‹åºä¸­å¯èƒ½çš„æœ€å¤§å¯¹è±¡å¤§å°çš„æ— ç¬¦å·æ•´æ•°ç±»å‹ã€‚å› æ­¤ï¼Œ<code>size_t</code> çš„å¤§å°åœ¨ä¸åŒçš„å¹³å°å’Œç¼–è¯‘å™¨ä¸­å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†é€šå¸¸è¶³å¤Ÿå¤§ä»¥æ»¡è¶³å®é™…éœ€æ±‚ã€‚</p></li><li><p><code>ans.substr(startPos);</code>ï¼šsubstræ–¹æ³•å¯ä»¥åªæ¥å—ä¸€ä¸ªå‚æ•°pos,è¡¨ç¤ºè¿™ä¸ªå­å­—ç¬¦ä¸²æ—¶ä»posè¿™ä¸ªä½ç½®å¼€å§‹ä¸€ç›´åˆ°æœ€å(è¿™æ—¶å€™ä¸ç”¨å†ç‰¹åœ°è¯´æ˜é•¿åº¦length)</p></li><li><p><code>stoi(a,0,2)æˆ–è€…stoi(a,nullptr,2)</code>:å°†å­—ç¬¦ä¸²aè½¬æ¢ä¸º2è¿›åˆ¶çš„æ•°ï¼Œå¹¶ç”¨intè¡¨è¾¾ã€‚æ¯”å¦‚a=â€10101111â€ï¼Œåˆ™è½¬æ¢ä¸ºint x=101011111ã€‚<code>0</code>æˆ–è€…<code>nullptr</code> æ˜¯ç”¨äºå­˜å‚¨è½¬æ¢é”™è¯¯ä½ç½®çš„æŒ‡é’ˆã€‚å¦‚æœè½¬æ¢è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œ<code>stoi</code> å‡½æ•°ä¼šå°†é”™è¯¯çš„ä½ç½®å­˜å‚¨åœ¨è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ã€‚åœ¨è¿™é‡Œï¼Œ<code>0</code>æˆ–è€…<code>nullptr</code>è¡¨ç¤ºä¸å­˜å‚¨é”™è¯¯ä½ç½®ã€‚2è¡¨ç¤ºåŸºæ•°ï¼Œå³è½¬æ¢ä¸ºå‡ è¿›åˆ¶ã€‚</p></li></ul><h2 id="8-3-å­—ç¬¦ä¸²ç›¸åŠ ï¼š415ã€å­—ç¬¦ä¸²ç›¸ä¹˜ï¼š43"><a href="#8-3-å­—ç¬¦ä¸²ç›¸åŠ ï¼š415ã€å­—ç¬¦ä¸²ç›¸ä¹˜ï¼š43" class="headerlink" title="8-3.å­—ç¬¦ä¸²ç›¸åŠ ï¼š415ã€å­—ç¬¦ä¸²ç›¸ä¹˜ï¼š43"></a>8-3.å­—ç¬¦ä¸²ç›¸åŠ ï¼š415ã€å­—ç¬¦ä¸²ç›¸ä¹˜ï¼š43</h2><p>ç±»ä¼¼8-2ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ³•</p><p>å­—ç¬¦ä¸²ç›¸ä¹˜æ³•äºŒï¼šä¼˜åŒ–ç«–å¼</p><p><img src="https://s2.loli.net/2024/01/29/vsTbwaM5f2H6Pum.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">multiply</span><span class="params">(string num1, string num2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (num1 == <span class="string">&quot;0&quot;</span> || num2 == <span class="string">&quot;0&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> n = num1.<span class="built_in">length</span>() + num2.<span class="built_in">length</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">res</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = num1.<span class="built_in">length</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = num2.<span class="built_in">length</span>() - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                <span class="type">int</span> sum = res[i + j + <span class="number">1</span>] + (num1[i] - <span class="string">&#x27;0&#x27;</span>) * (num2[j] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">                res[i + j + <span class="number">1</span>] = sum % <span class="number">10</span>;</span><br><span class="line">                res[i + j] += sum / <span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        string ans = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span> &amp;&amp; res[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>; <span class="comment">//å»æ‰å‰ç½®0</span></span><br><span class="line">            &#125;</span><br><span class="line">            ans += <span class="built_in">to_string</span>(res[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¹Ÿå¯ä»¥å…ˆåƒå‰é¢çš„é¢˜ä¸€æ ·åè½¬å­—ç¬¦ä¸²ä»¥åå†ä»å‰å¾€åç®—ï¼Œä¹‹åå†å€’å›æ¥ã€‚</p><h2 id="8-4-ç´¯åŠ æ•°ï¼š306"><a href="#8-4-ç´¯åŠ æ•°ï¼š306" class="headerlink" title="8-4.ç´¯åŠ æ•°ï¼š306"></a>8-4.ç´¯åŠ æ•°ï¼š306</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h1 id="9-å­—ç¬¦ä¸²å˜æ¢"><a href="#9-å­—ç¬¦ä¸²å˜æ¢" class="headerlink" title="9.å­—ç¬¦ä¸²å˜æ¢"></a>9.å­—ç¬¦ä¸²å˜æ¢</h1><h2 id="9-1-Zå­—å½¢å˜æ¢ï¼š6"><a href="#9-1-Zå­—å½¢å˜æ¢ï¼š6" class="headerlink" title="9-1.Zå­—å½¢å˜æ¢ï¼š6"></a>9-1.Zå­—å½¢å˜æ¢ï¼š6</h2><p>æ³•ä¸€ï¼šå‹ç¼©çŸ©é˜µå­˜å‚¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">convert</span><span class="params">(string s, <span class="type">int</span> numRows)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">length</span>(), r = numRows;</span><br><span class="line">        <span class="keyword">if</span> (r == <span class="number">1</span> || r == n) &#123;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;string&gt; <span class="title">mat</span><span class="params">(r)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x = <span class="number">0</span>, t = r * <span class="number">2</span> - <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">            mat[x] += s[i];<span class="comment">//xè®°å½•è¡Œæ•°</span></span><br><span class="line">            i % t &lt; r - <span class="number">1</span> ? ++x : --x;<span class="comment">//ç¬¬i%tè¡Œè¯»å–ç»“æŸå°±ç»§ç»­ä¸‹ä¸€è¡Œ</span></span><br><span class="line">        &#125;</span><br><span class="line">        string ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; row : mat) &#123;</span><br><span class="line">            ans += row;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šç›´æ¥æ„é€ </p><p>è§‚å¯Ÿä¸‹æ ‡è§„å¾‹ï¼š</p><p><img src="https://s2.loli.net/2024/02/03/g97q4Kv86TSiy1b.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">convert</span><span class="params">(string s, <span class="type">int</span> numRows)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">length</span>(), r = numRows;</span><br><span class="line">        <span class="keyword">if</span> (r == <span class="number">1</span> || r == n) &#123;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;</span><br><span class="line">        string ans;</span><br><span class="line">        <span class="type">int</span> t = r * <span class="number">2</span> - <span class="number">2</span>; <span class="comment">//ä½¿å¾—s[t]æ˜¯ç¬¬äºŒä¸ªç«–ç›´åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j + i &lt; n; j += t) &#123; <span class="comment">//éå†ç¬¬iè¡Œçš„å…ƒç´ </span></span><br><span class="line">                ans += s[j + i];</span><br><span class="line">                <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; i &lt; r - <span class="number">1</span> &amp;&amp; j + t - i &lt; n) &#123;</span><br><span class="line">                    ans += s[j + t - i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="9-2-æ–‡æœ¬å·¦å³å¯¹é½ï¼š68"><a href="#9-2-æ–‡æœ¬å·¦å³å¯¹é½ï¼š68" class="headerlink" title="9-2.æ–‡æœ¬å·¦å³å¯¹é½ï¼š68"></a>9-2.æ–‡æœ¬å·¦å³å¯¹é½ï¼š68</h2><p>è´ªå¿ƒç®—æ³•+æ¨¡æ‹Ÿ</p><p>è¯¦è§ï¼š<a href="https://leetcode.cn/problems/text-justification/solutions/181651/text-justification-by-ikaruga/">å¹³å‡åˆ†å¸ƒé¢å¤–ç©ºæ ¼</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">fillWords</span><span class="params">(vector&lt;string&gt;&amp; words, <span class="type">int</span> bg, <span class="type">int</span> ed, <span class="type">int</span> maxWidth,</span></span></span><br><span class="line"><span class="params"><span class="function">                     <span class="type">bool</span> lastLine = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> wordCount = ed - bg + <span class="number">1</span>;<span class="comment">//endå‡å»beginåå†åŠ 1</span></span><br><span class="line">        <span class="type">int</span> spaceCount =</span><br><span class="line">            maxWidth + <span class="number">1</span> - wordCount; <span class="comment">// é™¤å»æ¯ä¸ªå•è¯å°¾éƒ¨ç©ºæ ¼ï¼Œ + 1</span></span><br><span class="line">                                      <span class="comment">// æ˜¯æœ€åä¸€ä¸ªå•è¯çš„å°¾éƒ¨ç©ºæ ¼çš„ç‰¹æ®Šå¤„ç†</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = bg; i &lt;= ed; i++) &#123;</span><br><span class="line">            spaceCount -= words[i].<span class="built_in">size</span>(); <span class="comment">// é™¤å»æ‰€æœ‰å•è¯çš„é•¿åº¦</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> spaceSuffix = <span class="number">1</span>; <span class="comment">// è¯å°¾ç©ºæ ¼</span></span><br><span class="line">        <span class="type">int</span> spaceAvg = (wordCount == <span class="number">1</span>)</span><br><span class="line">                           ? <span class="number">1</span></span><br><span class="line">                           : spaceCount / (wordCount - <span class="number">1</span>); <span class="comment">// é¢å¤–ç©ºæ ¼çš„å¹³å‡å€¼</span></span><br><span class="line">        <span class="type">int</span> spaceExtra = (wordCount == <span class="number">1</span>)</span><br><span class="line">                             ? <span class="number">0</span></span><br><span class="line">                             : spaceCount % (wordCount - <span class="number">1</span>); <span class="comment">// é¢å¤–ç©ºæ ¼çš„ä½™æ•°</span></span><br><span class="line">        string ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = bg; i &lt; ed; i++) &#123;</span><br><span class="line">            ans += words[i]; <span class="comment">// å¡«å…¥å•è¯</span></span><br><span class="line">            <span class="keyword">if</span> (lastLine) &#123;  <span class="comment">// ç‰¹æ®Šå¤„ç†æœ€åä¸€è¡Œ</span></span><br><span class="line">                <span class="built_in">fill_n</span>(<span class="built_in">back_inserter</span>(ans), <span class="number">1</span>, <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">fill_n</span>(<span class="built_in">back_inserter</span>(ans),</span><br><span class="line">                   spaceSuffix + spaceAvg + ((i - bg) &lt; spaceExtra),</span><br><span class="line">                   <span class="string">&#x27; &#x27;</span>); <span class="comment">// æ ¹æ®è®¡ç®—ç»“æœè¡¥ä¸Šç©ºæ ¼</span></span><br><span class="line">        &#125;</span><br><span class="line">        ans += words[ed]; <span class="comment">// å¡«å…¥æœ€åä¸€ä¸ªå•è¯</span></span><br><span class="line">        <span class="built_in">fill_n</span>(<span class="built_in">back_inserter</span>(ans), maxWidth - ans.<span class="built_in">size</span>(), <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        <span class="comment">// è¡¥ä¸Šè¿™ä¸€è¡Œæœ€åçš„ç©ºæ ¼</span></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">fullJustify</span><span class="params">(vector&lt;string&gt;&amp; words, <span class="type">int</span> maxWidth)</span> </span>&#123;</span><br><span class="line">        vector&lt;string&gt; ans;</span><br><span class="line">        <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> bg = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; words.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            cnt += words[i].<span class="built_in">size</span>() + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i + <span class="number">1</span> == words.<span class="built_in">size</span>() ||</span><br><span class="line">                cnt + words[i + <span class="number">1</span>].<span class="built_in">size</span>() &gt;</span><br><span class="line">                    maxWidth) &#123; <span class="comment">// å¦‚æœæ˜¯æœ€åä¸€ä¸ªå•è¯ï¼Œæˆ–è€…åŠ ä¸Šä¸‹ä¸€ä¸ªè¯å°±è¶…è¿‡é•¿åº¦äº†ï¼Œå³å¯å‡‘æˆä¸€è¡Œ</span></span><br><span class="line">                ans.<span class="built_in">push_back</span>(</span><br><span class="line">                    <span class="built_in">fillWords</span>(words, bg, i, maxWidth, i + <span class="number">1</span> == words.<span class="built_in">size</span>()));</span><br><span class="line">                bg = i + <span class="number">1</span>;</span><br><span class="line">                cnt = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="10-å­—ç¬¦ä¸²åŒ¹é…-éš¾åº¦è¾ƒé«˜"><a href="#10-å­—ç¬¦ä¸²åŒ¹é…-éš¾åº¦è¾ƒé«˜" class="headerlink" title="10.å­—ç¬¦ä¸²åŒ¹é…(éš¾åº¦è¾ƒé«˜)"></a>10.å­—ç¬¦ä¸²åŒ¹é…(éš¾åº¦è¾ƒé«˜)</h1><h2 id="10-1-æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡-28"><a href="#10-1-æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡-28" class="headerlink" title="10-1.æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡:28"></a>10-1.æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡:28</h2><p>æ³•ä¸€ï¼šæš´åŠ›åŒ¹é…</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">strStr</span><span class="params">(string haystack, string needle)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = haystack.<span class="built_in">size</span>(), m = needle.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i + m &lt;= n; i++) &#123;</span><br><span class="line">            <span class="type">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (haystack[i + j] != needle[j]) &#123;</span><br><span class="line">                    flag = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨substrä¸ä¹‹åŒç†ï¼š</p><p><code>substr()</code>çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$,ç©ºé—´å¤æ‚åº¦æ˜¯$O(1)$.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">strStr</span><span class="params">(string haystack, string needle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; haystack.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (haystack[i] == needle[<span class="number">0</span>]) &#123; <span class="comment">//ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦ç›¸ç­‰å†å†³å®šæ˜¯ä¸æ˜¯è¦å°è¯•åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">                string x = haystack.<span class="built_in">substr</span>(i, needle.<span class="built_in">size</span>());</span><br><span class="line">                <span class="keyword">if</span> (x == needle) &#123;</span><br><span class="line">                    <span class="keyword">return</span> i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šKMPç®—æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">strStr</span><span class="params">(string haystack, string needle)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = haystack.<span class="built_in">size</span>(), m = needle.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next</span><span class="params">(m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt; m; i++) &#123; <span class="comment">//è®¡ç®—å‡ºnextæ•°ç»„</span></span><br><span class="line">            <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; needle[i] != needle[j]) &#123;</span><br><span class="line">                j = next[j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (needle[i] == needle[j]) &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            next[i] = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; n; i++) &#123; <span class="comment">//æ ¹æ®nextæ•°ç»„è¿›è¡ŒåŒ¹é…</span></span><br><span class="line">            <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; haystack[i] != needle[j]) &#123;</span><br><span class="line">                j = next[j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (haystack[i] == needle[j]) &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (j == m) &#123;</span><br><span class="line">                <span class="keyword">return</span> i - m + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å…³äºKMP"><a href="#å…³äºKMP" class="headerlink" title="å…³äºKMP"></a>å…³äºKMP</h2><p><img src="https://s2.loli.net/2024/02/03/SAhEnMkz5LfJD1W.png" alt=""></p><p><img src="https://s2.loli.net/2024/02/03/B6Z1blgJqCnyRpv.png" title="" alt="" width="473"></p><h2 id="å¸¸è§å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•"><a href="#å¸¸è§å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•" class="headerlink" title="å¸¸è§å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•"></a>å¸¸è§å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•</h2><p>è®²è§£ï¼š<a href="https://zhuanlan.zhihu.com/p/159879354">å­—ç¬¦ä¸²åŒ¹é…ä¹‹Sundayã€KMPå’ŒBMç®—æ³•å…¥é—¨çº§è®²è§£</a></p><ol><li><p><strong>æš´åŠ›åŒ¹é…ç®—æ³•ï¼ˆBrute Forceï¼‰</strong>ï¼šä¹Ÿç§°ä¸ºæœ´ç´ å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼Œå®ƒé€šè¿‡é€ä¸ªæ¯”è¾ƒæ–‡æœ¬å’Œæ¨¡å¼ä¸²çš„å­—ç¬¦æ¥è¿›è¡ŒåŒ¹é…ã€‚</p></li><li><p><strong>KMPç®—æ³•</strong>ï¼šKMPç®—æ³•åˆ©ç”¨æ¨¡å¼ä¸²è‡ªèº«çš„ç‰¹ç‚¹ï¼Œé€šè¿‡æ„å»ºéƒ¨åˆ†åŒ¹é…è¡¨ï¼ˆnextæ•°ç»„ï¼‰æ¥å®ç°å¿«é€ŸåŒ¹é…ã€‚</p></li><li><p><strong>Boyer-Mooreç®—æ³•</strong>ï¼šè¯¥ç®—æ³•é€šè¿‡ä»å³å¾€å·¦æ¯”è¾ƒæ¨¡å¼ä¸²å’Œæ–‡æœ¬ä¸²ï¼Œåˆ©ç”¨åå­—ç¬¦è§„åˆ™å’Œå¥½åç¼€è§„åˆ™æ¥å¿«é€Ÿå®šä½åŒ¹é…ä½ç½®ã€‚</p></li><li><p><strong>Rabin-Karpç®—æ³•</strong>ï¼šRabin-Karpç®—æ³•åˆ©ç”¨å“ˆå¸Œå‡½æ•°æ¥å¿«é€Ÿæ¯”è¾ƒæ–‡æœ¬ä¸­çš„å­ä¸²å’Œæ¨¡å¼ä¸²ï¼Œä»¥ç¡®å®šæ˜¯å¦éœ€è¦è¿›è¡Œè¿›ä¸€æ­¥çš„ç²¾ç¡®æ¯”è¾ƒï¼ˆé¦–å…ˆæ˜¯è®¡ç®—ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œç„¶åé€šè¿‡æ¯”è¾ƒè¿™ä¸¤ä¸ªå“ˆå¸Œå€¼çš„å¤§å°æ¥åˆ¤æ–­æ˜¯å¦å‡ºç°åŒ¹é…ï¼‰ã€‚</p></li><li><p><strong>Sundayç®—æ³•</strong>ï¼šSundayç®—æ³•æ˜¯ä¸€ç§ç®€å•è€Œé«˜æ•ˆçš„å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼Œå®ƒåˆ©ç”¨é¢„å¤„ç†æ¨¡å¼ä¸²å¾—åˆ°çš„åç§»è¡¨ï¼Œä»¥ä¾¿åœ¨åŒ¹é…å¤±è´¥æ—¶å¿«é€Ÿç§»åŠ¨æ¨¡å¼ä¸²ã€‚</p></li></ol><hr><h2 id="10-2-é‡å¤å åŠ å­—ç¬¦ä¸²åŒ¹é…ï¼š686"><a href="#10-2-é‡å¤å åŠ å­—ç¬¦ä¸²åŒ¹é…ï¼š686" class="headerlink" title="10-2.é‡å¤å åŠ å­—ç¬¦ä¸²åŒ¹é…ï¼š686"></a>10-2.é‡å¤å åŠ å­—ç¬¦ä¸²åŒ¹é…ï¼š686</h2><p>æ³•ä¸€ï¼šKMP.</p><p>æ—¶é—´å¤æ‚åº¦ï¼š$O(n+m)$ï¼Œç©ºé—´å¤æ‚åº¦ï¼š$O(m)$ã€‚</p><p>è¯¥é¢˜ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">strStr</span><span class="params">(string haystack, string needle)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = haystack.<span class="built_in">size</span>(), m = needle.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next</span><span class="params">(m)</span></span>;</span><br><span class="line">        <span class="comment">// è®¡ç®—å‡ºnextæ•°ç»„</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; needle[i] != needle[j]) &#123;</span><br><span class="line">                j = next[j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (needle[i] == needle[j]) &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            next[i] = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ ¹æ®nextæ•°å€¼è¿›è¡ŒåŒ¹é…</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i - j &lt; n; i++) &#123; <span class="comment">// b å¼€å§‹åŒ¹é…çš„ä½ç½®æ˜¯å¦è¶…è¿‡ç¬¬ä¸€ä¸ªå åŠ çš„ a</span></span><br><span class="line">            <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; haystack[i % n] != needle[j]) &#123; <span class="comment">//i%n,å› ä¸ºå¯èƒ½æ˜¯å¤šä¸ªhaystacké‡å¤</span></span><br><span class="line">                j = next[j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (haystack[i % n] == needle[j]) &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (j == m) &#123;</span><br><span class="line">                <span class="keyword">return</span> i - m + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">repeatedStringMatch</span><span class="params">(string a, string b)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> an = a.<span class="built_in">size</span>(), bn = b.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> index = <span class="built_in">strStr</span>(a, b);</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (an - index &gt;= bn) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (bn + index - an - <span class="number">1</span>) / an + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šRabin-Karpç®—æ³•</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n+m)ï¼Œç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚</p><p>å…³äºRabin-Karpçš„è®²è§£:<a href="https://zhuanlan.zhihu.com/p/563551141?utm_id=0">Rabinâ€“Karp ç®—æ³•</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BASE 256</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MODULUS 101</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RabinKarp</span><span class="params">(<span class="type">char</span> t[], <span class="type">char</span> p[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> t_len = <span class="built_in">strlen</span>(t);</span><br><span class="line">    <span class="type">int</span> p_len = <span class="built_in">strlen</span>(p);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å“ˆå¸Œæ»šåŠ¨ä¹‹ç”¨</span></span><br><span class="line">    <span class="type">int</span> h = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; p_len - <span class="number">1</span>; i++)</span><br><span class="line">        h = (h * BASE) % MODULUS;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> t_hash = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> p_hash = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; p_len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        t_hash = (BASE * t_hash + t[i]) % MODULUS;</span><br><span class="line">        p_hash = (BASE * p_hash + p[i]) % MODULUS;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= t_len - p_len)</span><br><span class="line">    &#123;</span><br><span class="line">         <span class="comment">// è€ƒè™‘åˆ°å“ˆå¸Œç¢°æ’çš„å¯èƒ½æ€§ï¼Œè¿˜éœ€è¦ç”¨ memcmp å†æ¯”å¯¹ä¸€ä¸‹</span></span><br><span class="line">        <span class="keyword">if</span> (t_hash == p_hash &amp;&amp; <span class="built_in">memcmp</span>(p, t + i, p_len) == <span class="number">0</span>)</span><br><span class="line">            cout &lt;&lt; p &lt;&lt; <span class="string">&quot; is found at index &quot;</span> &lt;&lt; i &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å“ˆå¸Œæ»šåŠ¨</span></span><br><span class="line">        t_hash = (BASE * (t_hash - t[i] * h) + t[i + p_len]) % MODULUS;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é˜²æ­¢å‡ºç°è´Ÿæ•°</span></span><br><span class="line">        <span class="keyword">if</span> (t_hash &lt; <span class="number">0</span>)</span><br><span class="line">            t_hash = t_hash + MODULUS;</span><br><span class="line"></span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\huangjiakun\Pictures\Marktextå…¨å±€å›¾ç‰‡\09710814ec32b4e67959fb730df10269ff888601.png" alt=""></p><p>è¯¥é¢˜ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">strStr</span><span class="params">(string haystack, string needle)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = haystack.<span class="built_in">size</span>(), m = needle.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> k1 = <span class="number">1e9</span> + <span class="number">7</span>;  <span class="comment">// é€‰æ‹©ä¸€ä¸ªè¾ƒå¤§çš„è´¨æ•°ä½œä¸ºæ¨¡æ•°</span></span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> k2 = <span class="number">1337</span>;  <span class="comment">// å¦é€‰ä¸€ä¸ªè¾ƒå°çš„è´¨æ•°</span></span><br><span class="line">        <span class="built_in">srand</span>((<span class="type">unsigned</span>)<span class="built_in">time</span>(<span class="literal">NULL</span>));  <span class="comment">// åˆå§‹åŒ–éšæœºæ•°ç§å­</span></span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> kMod1 = <span class="built_in">rand</span>() % k1 + k1;  <span class="comment">// ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ä½œä¸ºæ¨¡æ•°</span></span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> kMod2 = <span class="built_in">rand</span>() % k2 + k2;  <span class="comment">// ç”Ÿæˆå¦ä¸€ä¸ªéšæœºæ•°ä½œä¸ºæ¨¡æ•°</span></span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> hash_needle = <span class="number">0</span>;  <span class="comment">// åˆå§‹åŒ–æ¨¡å¼ä¸²çš„å“ˆå¸Œå€¼</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> c : needle) &#123;</span><br><span class="line">            hash_needle = (hash_needle * kMod2 + c) % kMod1;  <span class="comment">// è®¡ç®—æ¨¡å¼ä¸²çš„å“ˆå¸Œå€¼</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> hash_haystack = <span class="number">0</span>, extra = <span class="number">1</span>;  <span class="comment">// åˆå§‹åŒ–æ–‡æœ¬ä¸²çš„å“ˆå¸Œå€¼å’Œé¢å¤–å˜é‡</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            hash_haystack = (hash_haystack * kMod2 + haystack[i % n]) % kMod1;  <span class="comment">// è®¡ç®—æ–‡æœ¬ä¸²çš„å“ˆå¸Œå€¼</span></span><br><span class="line">            extra = (extra * kMod2) % kMod1;  <span class="comment">// æ›´æ–°é¢å¤–å˜é‡</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = m - <span class="number">1</span>; (i - m + <span class="number">1</span>) &lt; n; i++) &#123;</span><br><span class="line">            hash_haystack = (hash_haystack * kMod2 + haystack[i % n]) % kMod1;  <span class="comment">// æ›´æ–°æ–‡æœ¬ä¸²çš„å“ˆå¸Œå€¼</span></span><br><span class="line">            <span class="keyword">if</span> (hash_haystack == hash_needle) &#123;  <span class="comment">// æ£€æŸ¥å“ˆå¸Œå€¼æ˜¯å¦åŒ¹é…</span></span><br><span class="line">                <span class="keyword">return</span> i - m + <span class="number">1</span>;  <span class="comment">// è¿”å›åŒ¹é…ä½ç½®</span></span><br><span class="line">            &#125;</span><br><span class="line">            hash_haystack = (hash_haystack - extra * haystack[(i - m + <span class="number">1</span>) % n]) % kMod1;  <span class="comment">// æ›´æ–°æ–‡æœ¬ä¸²çš„å“ˆå¸Œå€¼</span></span><br><span class="line">            hash_haystack = (hash_haystack + kMod1) % kMod1;  <span class="comment">// å¤„ç†è´Ÿæ•°æƒ…å†µ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">// æœªæ‰¾åˆ°åŒ¹é…ï¼Œè¿”å›-1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">repeatedStringMatch</span><span class="params">(string a, string b)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> an = a.<span class="built_in">size</span>(), bn = b.<span class="built_in">size</span>();  <span class="comment">// è·å–å­—ç¬¦ä¸²aå’Œbçš„é•¿åº¦</span></span><br><span class="line">        <span class="type">int</span> index = <span class="built_in">strStr</span>(a, b);  <span class="comment">// è°ƒç”¨strStrå‡½æ•°æŸ¥æ‰¾båœ¨aä¸­çš„åŒ¹é…ä½ç½®</span></span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">-1</span>) &#123;  <span class="comment">// å¦‚æœæœªæ‰¾åˆ°åŒ¹é…ä½ç½®</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">// è¿”å›-1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (an - index &gt;= bn) &#123;  <span class="comment">// å¦‚æœåŒ¹é…ä½ç½®ä¹‹åçš„é•¿åº¦å¤§äºç­‰äºbçš„é•¿åº¦</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;  <span class="comment">// è¿”å›1ï¼Œè¡¨ç¤ºaæœ¬èº«å°±åŒ…å«äº†è‡³å°‘ä¸€ä¸ªb</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (bn + index - an - <span class="number">1</span>) / an + <span class="number">2</span>;  <span class="comment">// è¿”å›é‡å¤æ‹¼æ¥aåèƒ½å¤ŸåŒ…å«bçš„æœ€å°æ¬¡æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="10-3-é‡å¤çš„å­å­—ç¬¦ä¸²ï¼š459"><a href="#10-3-é‡å¤çš„å­å­—ç¬¦ä¸²ï¼š459" class="headerlink" title="10-3.é‡å¤çš„å­å­—ç¬¦ä¸²ï¼š459"></a>10-3.é‡å¤çš„å­å­—ç¬¦ä¸²ï¼š459</h2><h2 id="10-4-æœ€çŸ­å›æ–‡ä¸²ï¼š214ï¼ˆå›°éš¾ï¼‰"><a href="#10-4-æœ€çŸ­å›æ–‡ä¸²ï¼š214ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="10-4.æœ€çŸ­å›æ–‡ä¸²ï¼š214ï¼ˆå›°éš¾ï¼‰"></a>10-4.æœ€çŸ­å›æ–‡ä¸²ï¼š214ï¼ˆå›°éš¾ï¼‰</h2><h1 id="11-ä¸­å¿ƒæ‹“å±•æ³•"><a href="#11-ä¸­å¿ƒæ‹“å±•æ³•" class="headerlink" title="11.ä¸­å¿ƒæ‹“å±•æ³•"></a>11.ä¸­å¿ƒæ‹“å±•æ³•</h1><p>ä¸­å¿ƒæ‹“å±•æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ä»¥å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼ˆæˆ–è€…æ¯ä¸¤ä¸ªå­—ç¬¦ä¹‹é—´ï¼‰ä¸ºä¸­å¿ƒï¼Œå‘ä¸¤è¾¹æ‰©å±•ï¼Œä»¥<u>å¯»æ‰¾æœ€é•¿çš„å›æ–‡ä¸²</u>ã€‚è¿™ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦è¾ƒä½ï¼Œå› ä¸ºåœ¨ä¸­å¿ƒæ‹“å±•æ—¶ï¼Œåªéœ€è¦çº¿æ€§çš„æ—¶é—´ã€‚</p><p>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>éå†å­—ç¬¦ä¸²ï¼Œä»¥æ¯ä¸ªå­—ç¬¦ï¼ˆæˆ–è€…æ¯ä¸¤ä¸ªå­—ç¬¦ä¹‹é—´ï¼‰ä¸ºä¸­å¿ƒï¼Œå‘ä¸¤è¾¹æ‰©å±•ï¼Œç›´åˆ°ä¸å†æ»¡è¶³å›æ–‡ä¸²çš„æ¡ä»¶ã€‚</li><li>åœ¨æ‰©å±•çš„è¿‡ç¨‹ä¸­ï¼Œè®°å½•ä¸‹æœ€é•¿çš„å›æ–‡ä¸²çš„èµ·å§‹ä½ç½®å’Œé•¿åº¦ã€‚</li></ol><p>ä¸­å¿ƒæ‹“å±•æ³•åœ¨è§£å†³å›æ–‡ä¸²ç›¸å…³é—®é¢˜æ—¶éå¸¸æœ‰æ•ˆï¼Œä¾‹å¦‚åœ¨å¯»æ‰¾æœ€é•¿å›æ–‡å­ä¸²æˆ–è€…ç»Ÿè®¡å›æ–‡å­ä¸²çš„ä¸ªæ•°æ—¶ï¼Œè¯¥æ–¹æ³•å¯ä»¥æä¾›è¾ƒé«˜çš„æ•ˆç‡ã€‚</p><h2 id="11-1-æœ€é•¿å›æ–‡å­ä¸²ï¼š5"><a href="#11-1-æœ€é•¿å›æ–‡å­ä¸²ï¼š5" class="headerlink" title="11-1.æœ€é•¿å›æ–‡å­ä¸²ï¼š5"></a>11-1.æœ€é•¿å›æ–‡å­ä¸²ï¼š5</h2><p>æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">longestPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> maxLen = <span class="number">1</span>, begin = <span class="number">0</span>;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dp</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n));</span><br><span class="line">        <span class="comment">// è¾¹ç•Œæ¡ä»¶P(i,i)=true</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            dp[i][i] = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æšä¸¾å­ä¸²é•¿åº¦L</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> L = <span class="number">2</span>; L &lt;= n; L++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">                <span class="type">int</span> j = L + i - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= n) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (s[i] != s[j]) &#123;</span><br><span class="line">                    dp[i][j] = <span class="literal">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (j - i &lt; <span class="number">3</span>) &#123; <span class="comment">//(j-1)-(i+1)&lt;=0</span></span><br><span class="line">                        dp[i][j] = <span class="literal">true</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        dp[i][j] = dp[i + <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åªè¦ dp[i][j] == true æˆç«‹ï¼Œå°±è¡¨ç¤ºå­ä¸² s[i..j]</span></span><br><span class="line">                <span class="comment">// æ˜¯å›æ–‡ï¼Œæ­¤æ—¶è®°å½•å›æ–‡é•¿åº¦å’Œèµ·å§‹ä½ç½®</span></span><br><span class="line">                <span class="keyword">if</span> (dp[i][j]) &#123;</span><br><span class="line">                    maxLen = <span class="built_in">max</span>(maxLen, j - i + <span class="number">1</span>);</span><br><span class="line">                    begin = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.<span class="built_in">substr</span>(begin, maxLen);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šä¸­å¿ƒæ‰©å±•æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">expandAroundCenter</span><span class="params">(<span class="type">const</span> string&amp; s, <span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (left &gt;= <span class="number">0</span> &amp;&amp; right &lt; s.<span class="built_in">size</span>() &amp;&amp; s[left] == s[right]) &#123;</span><br><span class="line">            <span class="comment">// æ»¡è¶³å›æ–‡æ¡ä»¶ï¼Œå‘ä¸¤è¾¹æ‰©å±•</span></span><br><span class="line">            --left;</span><br><span class="line">            ++right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;left + <span class="number">1</span>, right - <span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">longestPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> start = <span class="number">0</span>, end = <span class="number">0</span>; <span class="comment">// ä»æœ€å·¦ä¾§è¾¹ç•Œå¼€å§‹</span></span><br><span class="line">        <span class="comment">// å¦‚æœä»æœ€å³ä¾§è¾¹ç•Œï¼Œåˆ™startå’Œendåˆå§‹å€¼åº”ä¸ºs.size;åŒæ—¶auto [left2,right2]=expandAroundCenter(s,i-1,i);</span></span><br><span class="line">        <span class="comment">// ç„¶åiä»s.size()-1åå‘éå†nter(s,i-1,i);</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">auto</span> [left1, right1] = <span class="built_in">expandAroundCenter</span>(s, i, i);     <span class="comment">// a&#x27;b&#x27;a</span></span><br><span class="line">            <span class="keyword">auto</span> [left2, right2] = <span class="built_in">expandAroundCenter</span>(s, i, i + <span class="number">1</span>); <span class="comment">// a&#x27;bb&#x27;a</span></span><br><span class="line">            <span class="keyword">if</span> (right1 - left1 &gt; end - start) &#123;</span><br><span class="line">                start = left1;</span><br><span class="line">                end = right1;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (right2 - left2 &gt; end - start) &#123;</span><br><span class="line">                start = left2;</span><br><span class="line">                end = right2;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.<span class="built_in">substr</span>(start, end - start + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•ä¸‰ï¼šManacherç®—æ³•(äº†è§£)</p><h2 id="11-2-ç»Ÿè®¡å›æ–‡å­ä¸²æ•°ç›®ï¼š647"><a href="#11-2-ç»Ÿè®¡å›æ–‡å­ä¸²æ•°ç›®ï¼š647" class="headerlink" title="11-2.ç»Ÿè®¡å›æ–‡å­ä¸²æ•°ç›®ï¼š647"></a>11-2.ç»Ÿè®¡å›æ–‡å­ä¸²æ•°ç›®ï¼š647</h2><p>ä¸‰ä¸ªæ–¹æ³•ç±»ä¼¼11-1ï¼Œè¿™é‡Œå±•ç¤ºä¸­å¿ƒæ‰©å±•æ³•ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">expandAroundCenter</span><span class="params">(<span class="type">const</span> string&amp; s, <span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (left &gt;= <span class="number">0</span> &amp;&amp; right &lt; s.<span class="built_in">size</span>() &amp;&amp; s[left] == s[right]) &#123;</span><br><span class="line">            --left;</span><br><span class="line">            ++right;</span><br><span class="line">            ++ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countSubstrings</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            ans +=<span class="built_in">expandAroundCenter</span>(s, i, i) + <span class="built_in">expandAroundCenter</span>(s, i, i + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å­—ç¬¦ä¸²è¿›é˜¶éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="string" scheme="https://sumikiru.top/tags/string/"/>
    
  </entry>
  
  <entry>
    <title>2.1å­—ç¬¦ä¸²ç¯‡(2)</title>
    <link href="https://sumikiru.top/posts/283bba67.html"/>
    <id>https://sumikiru.top/posts/283bba67.html</id>
    <published>2024-04-05T19:27:48.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="6-æ•°å­—ä¸å­—ç¬¦ä¸²ä¹‹é—´è½¬æ¢"><a href="#6-æ•°å­—ä¸å­—ç¬¦ä¸²ä¹‹é—´è½¬æ¢" class="headerlink" title="6.æ•°å­—ä¸å­—ç¬¦ä¸²ä¹‹é—´è½¬æ¢"></a>6.æ•°å­—ä¸å­—ç¬¦ä¸²ä¹‹é—´è½¬æ¢</h1><p>299:ä½¿ç”¨é¢å¤–ä¸¤ä¸ªæ•°ç»„è®°å½•Bulls,cows</p><h2 id="6-1-ç›¸å¯¹åæ¬¡ï¼š506"><a href="#6-1-ç›¸å¯¹åæ¬¡ï¼š506" class="headerlink" title="6-1.ç›¸å¯¹åæ¬¡ï¼š506"></a>6-1.ç›¸å¯¹åæ¬¡ï¼š506</h2><p><code>make_pair(a,b)</code>:å½¢æˆè¯¸å¦‚<code>pair&lt;int,int&gt;</code>çš„å½¢å¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">findRelativeRanks</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; score)</span> </span>&#123;</span><br><span class="line">        vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; arr;</span><br><span class="line">        <span class="type">int</span> n = score.<span class="built_in">size</span>();</span><br><span class="line">        string rankTop[<span class="number">3</span>] = &#123;<span class="string">&quot;Gold Medal&quot;</span>, <span class="string">&quot;Silver Medal&quot;</span>, <span class="string">&quot;Bronze Medal&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            arr.<span class="built_in">emplace_back</span>(</span><br><span class="line">                <span class="built_in">make_pair</span>(-score[i], i)); <span class="comment">//-score[i]ä»¥ä¿è¯sortæ’åºæ—¶ç”±å¤§åˆ°å°</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>());<span class="comment">//æ ¹æ®arr[index].firstçš„å¤§å°æ’åº</span></span><br><span class="line">        <span class="function">vector&lt;string&gt; <span class="title">res</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; <span class="number">3</span>) &#123;</span><br><span class="line">                res[arr[i].second] = rankTop[i];<span class="comment">//arr[i].secondè®°å½•åŸä¸‹æ ‡</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res[arr[i].second] = <span class="built_in">to_string</span>(i + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨C++ä¸­ï¼Œ<code>arr</code>å¯ä»¥æ˜¯ä»»ä½•<u>æ”¯æŒéšæœºè®¿é—®è¿­ä»£å™¨çš„å®¹å™¨</u>ç±»å‹ï¼Œä¾‹å¦‚ï¼š</p><ul><li><code>std::vector</code></li><li><code>std::array</code></li><li><code>std::deque</code></li><li><code>std::string</code></li><li>å†…ç½®æ•°ç»„ï¼ˆä¾‹å¦‚<code>int arr[5]</code>ï¼‰</li></ul><p>è¿™äº›ç±»å‹éƒ½æ”¯æŒ<code>begin()</code>å’Œ<code>end()</code>æˆå‘˜å‡½æ•°ï¼Œå› æ­¤å¯ä»¥ä½œä¸º<code>sort</code>å‡½æ•°çš„å‚æ•°ã€‚</p><hr><p><code>vector</code>ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯<code>pair</code>ç±»å‹æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>sort</code>å‡½æ•°ã€‚å› ä¸º<code>vector&lt;pair&lt;T1, T2&gt;&gt;</code>æ”¯æŒéšæœºè®¿é—®è¿­ä»£å™¨ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½œä¸º<code>sort</code>å‡½æ•°çš„å‚æ•°,æ’åºé»˜è®¤æ˜¯æŒ‰ç…§<code>pair</code>çš„<mark>ç¬¬ä¸€ä¸ª</mark>å…ƒç´ è¿›è¡Œæ¯”è¾ƒçš„ã€‚å¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ ç›¸ç­‰ï¼Œåˆ™ä¼šæ¯”è¾ƒç¬¬äºŒä¸ªå…ƒç´ ã€‚</p><hr><p>æ³•äºŒï¼šä½¿ç”¨map(ä¸æ˜¯unordered_map),å®ƒèƒ½å¤Ÿå®ç°è‡ªä¸»æ’åº</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">findRelativeRanks</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; score)</span> </span>&#123;</span><br><span class="line">        map&lt;<span class="type">int</span>, <span class="type">int</span>, greater&lt;<span class="type">int</span>&gt;&gt; mp; <span class="comment">//ç”±å¤§åˆ°å°,çœ‹ç¬¬ä¸€ä¸ªint</span></span><br><span class="line">        <span class="type">int</span> n = score.<span class="built_in">size</span>();</span><br><span class="line">        string rankTop[<span class="number">3</span>] = &#123;<span class="string">&quot;Gold Medal&quot;</span>, <span class="string">&quot;Silver Medal&quot;</span>, <span class="string">&quot;Bronze Medal&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            mp[score[i]] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;string&gt; <span class="title">res</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">auto</span> it = mp.<span class="built_in">begin</span>(); <span class="comment">// itæ˜¯è¿­ä»£å™¨</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; <span class="number">3</span>) &#123;</span><br><span class="line">                res[(*it).second] = rankTop[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res[(*it).second] = <span class="built_in">to_string</span>(i + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•ä¸‰ï¼šä½¿ç”¨set,æ–¹æ³•ä¸ä½¿ç”¨mapç±»ä¼¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">findRelativeRanks</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; score)</span> </span>&#123;</span><br><span class="line">        set&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, greater&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;&gt; s; <span class="comment">//ç”±å¤§åˆ°å°</span></span><br><span class="line">        <span class="type">int</span> n = score.<span class="built_in">size</span>();</span><br><span class="line">        string rankTop[<span class="number">3</span>] = &#123;<span class="string">&quot;Gold Medal&quot;</span>, <span class="string">&quot;Silver Medal&quot;</span>, <span class="string">&quot;Bronze Medal&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            s.<span class="built_in">emplace</span>(score[i], i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;string&gt; <span class="title">res</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">auto</span> it = s.<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; <span class="number">3</span>) &#123;</span><br><span class="line">                res[(*it).second] = rankTop[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res[(*it).second] = <span class="built_in">to_string</span>(i + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯:1.set<mark>ä¸å­˜åœ¨</mark>ç±»ä¼¼s[i]çš„è¡¨ç¤ºå½¢å¼</p><p>2.å‘setä¸­åŠ å…¥å…ƒç´ åº”è¯¥ä½¿ç”¨<code>emplace</code>è€Œéempalce_back</p><p>3.å…ƒç´ å½¢å¼ä¸ºpairæ—¶ï¼Œå®šä¹‰åº”è¯¥ä¸º<code>set&lt;pair&lt;int, int&gt;, greater&lt;pair&lt;int, int&gt;&gt;&gt; s</code>ï¼Œè¿™é‡Œçš„æ’åºå†™æ³•ä¸æ˜¯greater<int>!<code>greater&lt;int&gt;</code>è¡¨ç¤º<mark>æŒ‰ç…§é”®å€¼</mark>è¿›è¡Œé™åºæ’åºï¼Œåªæœ‰mapã€vectorè¿™ç§å…ƒç´ å¯¹åº”é”®å€¼æ‰æ˜¯å›ºå®šçš„ï¼Œsetåˆ™éšæ—¶æ”¹å˜å…ƒç´ çš„ä½ç½®ï¼Œåœ¨å…ƒç´ ä¸ºintç±»å‹æ—¶greater<int>æ²¡æœ‰é—®é¢˜ï¼Œä½†åœ¨pair<int,int>ç±»å‹æ—¶ï¼Œä¼šå‡ºé”™ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>greater&lt;pair&lt;int, int&gt;&gt;</code>è€Œä¸æ˜¯<code>greater&lt;int&gt;</code>ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦æŒ‰ç…§åˆ†æ•°é™åºæ’åˆ—ï¼Œå¹¶ä¸”åœ¨åˆ†æ•°ç›¸åŒæ—¶ï¼ŒæŒ‰ç…§ç´¢å¼•å‡åºæ’åˆ—ã€‚ä½¿ç”¨<code>greater&lt;pair&lt;int, int&gt;&gt;</code>å¯ä»¥ç¡®ä¿é¦–å…ˆæŒ‰ç…§åˆ†æ•°é™åºæ’åˆ—ï¼Œç„¶åæŒ‰ç…§ç´¢å¼•å‡åºæ’åˆ—ã€‚ </p><hr><p>é¸½å·¢åŸç†ï¼š539æ³•äºŒã€‚ç”±é¸½å·¢åŸç†å¯çŸ¥ï¼Œå¦‚æœ timePoints çš„é•¿åº¦è¶…è¿‡ 1440ï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šæœ‰ä¸¤ä¸ªç›¸åŒçš„æ—¶é—´ï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥è¿”å› 0.</p><h2 id="6-2-æ­£åˆ™è¡¨è¾¾å¼ï¼š537"><a href="#6-2-æ­£åˆ™è¡¨è¾¾å¼ï¼š537" class="headerlink" title="6-2.æ­£åˆ™è¡¨è¾¾å¼ï¼š537"></a>6-2.æ­£åˆ™è¡¨è¾¾å¼ï¼š537</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">string <span class="title">complexNumberMultiply</span><span class="params">(string num1, string num2)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…&quot;+&quot;å’Œ&quot;i&quot;</span></span><br><span class="line">    <span class="function">regex <span class="title">re</span><span class="params">(<span class="string">&quot;\\+|i&quot;</span>)</span></span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¹å¤æ•°å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²ï¼Œå­˜å‚¨åˆ°vectorä¸­</span></span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">complex1</span><span class="params">(sregex_token_iterator(num1.begin(), num1.end(), re, <span class="number">-1</span>), std::sregex_token_iterator())</span></span>;</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">complex2</span><span class="params">(sregex_token_iterator(num2.begin(), num2.end(), re, <span class="number">-1</span>), std::sregex_token_iterator())</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†åˆ†å‰²åçš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°éƒ¨åˆ†å’Œè™šæ•°éƒ¨åˆ†</span></span><br><span class="line">    <span class="type">int</span> real1 = <span class="built_in">stoi</span>(complex1[<span class="number">0</span>]);</span><br><span class="line">    <span class="type">int</span> imag1 = <span class="built_in">stoi</span>(complex1[<span class="number">1</span>]);</span><br><span class="line">    <span class="type">int</span> real2 = <span class="built_in">stoi</span>(complex2[<span class="number">0</span>]);</span><br><span class="line">    <span class="type">int</span> imag2 = <span class="built_in">stoi</span>(complex2[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—ä¸¤ä¸ªå¤æ•°çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">to_string</span>(real1 * real2 - imag1 * imag2) + <span class="string">&quot;+&quot;</span> + <span class="built_in">to_string</span>(real1 * imag2 + imag1 * real2) + <span class="string">&quot;i&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="å…³äºæ­£åˆ™"><a href="#å…³äºæ­£åˆ™" class="headerlink" title="å…³äºæ­£åˆ™"></a>å…³äºæ­£åˆ™</h2><p>1.<strong>regex</strong>:<code>regex</code>æ˜¯C++æ ‡å‡†åº“ä¸­ç”¨äºå¤„ç†æ­£åˆ™è¡¨è¾¾å¼çš„ç±»ã€‚å®ƒå…è®¸ä½ ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥è¿›è¡Œå­—ç¬¦ä¸²çš„åŒ¹é…ã€æœç´¢å’Œæ›¿æ¢æ“ä½œã€‚é€šè¿‡ä½¿ç”¨<code>regex</code>ç±»ï¼Œä½ å¯ä»¥åœ¨C++ä¸­æ‰§è¡Œä¸æ­£åˆ™è¡¨è¾¾å¼ç›¸å…³çš„æ“ä½œï¼Œä¾‹å¦‚æŸ¥æ‰¾æ¨¡å¼åŒ¹é…ã€æå–éƒ¨åˆ†å­—ç¬¦ä¸²ã€æ›¿æ¢æ–‡æœ¬ç­‰ã€‚éœ€è¦å¤´æ–‡ä»¶<code>&lt;regex&gt;</code></p><p>2.<strong>sregex_token_iterator</strong>:<code>sregex_token_iterator</code>æ˜¯C++æ ‡å‡†åº“ä¸­ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸Šæ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼åˆ†è¯æ“ä½œçš„è¿­ä»£å™¨ã€‚å®ƒå…è®¸ä½ åœ¨å­—ç¬¦ä¸²ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥è¿›è¡Œåˆ†è¯ï¼Œä»è€Œå°†å­—ç¬¦ä¸²åˆ†å‰²ä¸ºç¬¦åˆç‰¹å®šæ¨¡å¼çš„å­å­—ç¬¦ä¸²ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>sregex_token_iterator</code>æ¥å°†å¤æ•°å­—ç¬¦ä¸²æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²ä¸ºæ•´æ•°éƒ¨åˆ†å’Œè™šæ•°éƒ¨åˆ†ã€‚</p><p><mark>è¯­æ³•</mark>ï¼šsregex_token_iterator(èµ·å§‹ä½ç½®ï¼Œç»ˆæ­¢ä½ç½®ï¼Œæ­£åˆ™, è¿”å›çš„åŒ¹é…ç±»å‹ï¼ˆ-1æ˜¯è¿”å›æœªåŒ¹é…çš„éƒ¨åˆ†ï¼Œå³åˆ†éš”æ“ä½œï¼‰)ã€‚</p><p>ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨çš„é¦–åœ°å€ï¼Œ<code>std::sregex_token_iterator()</code>ä¼šè¿”å›ä¸€ä¸ªendã€‚vectorç”¨è¿™ä¸¤ä¸ªè¿­ä»£å™¨æ„é€ å¾—åˆ°ç¬¦åˆåŒ¹é…çš„åºåˆ—</p><p>3.<strong>æ­£åˆ™åŒ¹é…</strong>ï¼š<a href="https://www.cnblogs.com/yongchao/p/17165643.html">æ­£åˆ™è¡¨è¾¾å¼-èœé¸Ÿæ•™ç¨‹ - Theseusâ€˜Ship - åšå®¢å›­</a></p><p><a href="https://www.cnblogs.com/chen-cs/p/13387914.html">C++ æ­£åˆ™è¡¨è¾¾å¼ - Chenæ²‰å°˜ - åšå®¢å›­</a></p><p><a href="https://blog.51cto.com/u_12071646/3752288">[ç¬”è®°]c++åŸºç¡€å®è·µã€ŠäºŒã€‹regexæ­£åˆ™è¡¨è¾¾å¼_51CTOåšå®¢_c++ æ­£åˆ™è¡¨è¾¾å¼</a></p><p>4.<code>&quot;\\+|i&quot;</code> è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ<code>\\+</code> åŒ¹é…åŠ å· â€œ+â€ï¼Œ<code>|</code> è¡¨ç¤ºæˆ–ï¼Œ<code>i</code> åŒ¹é…å­—ç¬¦ â€œiâ€ã€‚å› æ­¤ï¼Œè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯ä»¥ç”¨äºåŒ¹é…å¤æ•°å­—ç¬¦ä¸²ä¸­çš„åŠ å·å’Œè™šæ•°å•ä½ â€œiâ€ã€‚</p><p>  <code>&quot;(-?\\d+)/(\\d+)([+-])(-?\\d+)/(\\d+)&quot;</code>è¡¨ç¤ºä¸¤ä¸ªåˆ†æ•°ç›¸åŠ ã€‚</p><ul><li><code>-?</code>ï¼šè¡¨ç¤ºåŒ¹é…ä¸€ä¸ªå¯é€‰çš„å‡å·ï¼ˆè´Ÿå·ï¼‰ã€‚<code>-</code> è¡¨ç¤ºå‡å·ï¼Œ<code>?</code> è¡¨ç¤ºå‰é¢çš„å­—ç¬¦ï¼ˆè¿™é‡Œæ˜¯å‡å·ï¼‰åœ¨æ–‡æœ¬ä¸­å¯ä»¥å‡ºç° 0 æ¬¡æˆ– 1 æ¬¡ã€‚</li><li><code>\\d+</code>ï¼šè¡¨ç¤ºåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—ã€‚<code>\\d</code> è¡¨ç¤ºä¸€ä¸ªæ•°å­—ï¼Œ<code>+</code> è¡¨ç¤ºå‰é¢çš„å…ƒç´ ï¼ˆè¿™é‡Œæ˜¯æ•°å­—ï¼‰å¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚(<code>\\.</code>ç”¨æ¥è¡¨ç¤ºå°æ•°ç‚¹)</li><li><code>[+-]</code> æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼Œç”¨äºåŒ¹é…åŠ å·(+)æˆ–å‡å·(-)ã€‚åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œæ–¹æ‹¬å· <code>[]</code> ç”¨äºè¡¨ç¤ºä¸€ä¸ªå­—ç¬¦é›†ï¼Œå…¶ä¸­åˆ—å‡ºçš„å­—ç¬¦ä¹‹ä¸€éƒ½å¯ä»¥åŒ¹é…æˆåŠŸã€‚å› æ­¤ï¼Œ<code>[+-]</code> è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªåŠ å·æˆ–å‡å·ã€‚</li></ul><p>5.<strong>smatch</strong>:<code>smatch</code> æ˜¯ C++ æ ‡å‡†åº“ä¸­çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„ç»“æœã€‚å®ƒæ˜¯ <code>std::match_results</code> ç±»å‹çš„åˆ«åï¼Œç”¨äºä¿å­˜æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„ç»“æœå’Œå­åŒ¹é…çš„ä½ç½®ä¿¡æ¯ã€‚å½“ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…æ—¶ï¼ŒåŒ¹é…ç»“æœä¼šè¢«å­˜å‚¨åœ¨ <code>smatch</code> å¯¹è±¡ä¸­ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•æˆ–è¿­ä»£å™¨æ¥è®¿é—®åŒ¹é…çš„å­å­—ç¬¦ä¸²ã€‚åœ¨T592ä¸­ï¼Œä½¿ç”¨ <code>smatch</code> å¯¹è±¡æ¥å­˜å‚¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„ç»“æœï¼Œå¹¶ä»ä¸­æå–åˆ†æ•°çš„åˆ†å­ã€åˆ†æ¯ä»¥åŠæ“ä½œç¬¦ç­‰ä¿¡æ¯ã€‚</p><p>  <code>matches[5].str()</code> è¡¨ç¤ºä» <code>smatch</code> å¯¹è±¡ä¸­è·å–ç¬¬ 5 ä¸ªåŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶ä½œä¸º <code>std::string</code> ç±»å‹è¿”å›ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>matches[5]</code> ç”¨äºè®¿é—®æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ä¸­çš„ç¬¬ 5 ä¸ªæ•è·ç»„ï¼Œå³ç¬¬ 5 ä¸ªæ‹¬å·å†…åŒ¹é…çš„å†…å®¹ã€‚åœ¨T592ä¸­ï¼Œ<code>matches[5].str()</code> ç”¨äºè·å–ç¬¬ 5 ä¸ªæ•è·ç»„çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼<code>(\\d+)</code>ï¼Œè¿™ä¸ªæ•è·ç»„å¯¹åº”äºåˆ†æ•°çš„åˆ†æ¯ã€‚</p><p>  <code>matches.prefix().str()</code> è¡¨ç¤ºä» <code>smatch</code> å¯¹è±¡ä¸­è·å–<mark>åŒ¹é…çš„å­å­—ç¬¦ä¸²ä¹‹å‰</mark>çš„éƒ¨åˆ†ï¼Œå¹¶å°†å…¶ä½œä¸º <code>std::string</code> ç±»å‹è¿”å›ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>matches.prefix()</code> ç”¨äºè·å–åŒ¹é…å­å­—ç¬¦ä¸²ä¹‹å‰çš„éƒ¨åˆ†ï¼Œç„¶åé€šè¿‡ <code>str()</code> æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚</p><p>  <code>matches.suffix().str()</code>åˆ™è¡¨ç¤ºä¹‹åçš„é‚£éƒ¨åˆ†ã€‚</p><p>6.<strong>ç”¨æ‹¬å·å°†æ­£åˆ™è¡¨è¾¾å¼åˆ†æˆå¤šç»„</strong></p><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨æ‹¬å·å¯ä»¥å°†åŒ¹é…çš„éƒ¨åˆ†åˆ†ç»„ï¼Œè¿™æ ·åšæœ‰å‡ ä¸ªå¥½å¤„ï¼š</p><ul><li><p><strong>æå–å­åŒ¹é…</strong>ï¼šæ‹¬å·å¯ä»¥å°†åŒ¹é…çš„éƒ¨åˆ†åˆ†æˆå¤šä¸ªç»„ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿åœ°ä»æ•´ä¸ªåŒ¹é…ä¸­æå–å‡ºæˆ‘ä»¬æ„Ÿå…´è¶£çš„éƒ¨åˆ†ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ‹¬å·å°†åˆ†æ•°çš„åˆ†å­ã€åˆ†æ¯ä»¥åŠæ“ä½œç¬¦åˆ†æˆäº†å¤šä¸ªç»„ï¼Œæ–¹ä¾¿åç»­çš„å¤„ç†ã€‚</p></li><li><p><strong>æ–¹ä¾¿åç»­å¤„ç†</strong>ï¼šåˆ†ç»„å¯ä»¥è®©æˆ‘ä»¬æ›´æ–¹ä¾¿åœ°å¯¹åŒ¹é…åˆ°çš„å†…å®¹è¿›è¡Œåç»­å¤„ç†ï¼Œæ¯”å¦‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æå–å‡ºåˆ†æ•°çš„åˆ†å­å’Œåˆ†æ¯ï¼Œç„¶åè¿›è¡ŒåŠ å‡æ³•è¿ç®—ã€‚</p></li><li><p><strong>æ•è·åŒ¹é…ä¿¡æ¯</strong>ï¼šåˆ†ç»„å¯ä»¥æ•è·åŒ¹é…çš„ä¿¡æ¯ï¼Œæ–¹ä¾¿åç»­çš„å¼•ç”¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>matches[1]</code>ã€<code>matches[2]</code>ã€<code>matches[3]</code> ç­‰æ¥å¼•ç”¨ä¸åŒçš„åŒ¹é…ç»„ã€‚</p></li></ul><p>å› æ­¤ï¼Œä½¿ç”¨æ‹¬å·å°†æ­£åˆ™è¡¨è¾¾å¼çš„éƒ¨åˆ†åˆ†æˆå¤šä¸ªç»„å¯ä»¥ä½¿ä»£ç æ›´æ¸…æ™°ã€æ›´æ˜“äºç†è§£ï¼Œå¹¶ä¸”æ–¹ä¾¿åç»­çš„å¤„ç†å’Œæå–ã€‚</p><p>7.<strong>regex_search</strong>:<code>regex_search(expression, matches, pattern)</code>ç”¨äºåœ¨å­—ç¬¦ä¸² <code>expression</code> ä¸­æœç´¢æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ <code>pattern</code> çš„éƒ¨åˆ†ï¼Œå¹¶å°†åŒ¹é…çš„ç»“æœå­˜å‚¨åœ¨ <code>matches</code> å¯¹è±¡ä¸­ï¼Œä»¥ä¾¿åç»­çš„å¤„ç†å’Œæå–ã€‚</p><p>8.<strong>regex_match</strong>:<code>regex_match(string code, regex pattern)</code>ç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä¸ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¼šå°è¯•ä½¿ç”¨ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼patternæ¥åŒ¹é…è¾“å…¥çš„ä»£ç å­—ç¬¦ä¸²codeï¼Œå¹¶è¿”å›boolå€¼ã€‚</p><p>9.<strong>ç›¸å…³å­¦ä¹ ç½‘ç«™</strong>ï¼š<a href="https://r2coding.com/#/?id=æ­£åˆ™è¡¨è¾¾å¼">Road 2 Coding</a></p><p>æ­£åˆ™è¡¨è¾¾å¼æµ‹è¯•ç½‘ç«™ï¼š<a href="https://regex101.com/">regex101</a></p><blockquote><p>åœ¨å¯¹æ€§èƒ½æ•æ„Ÿçš„ç¨‹åºä¸­å°½é‡é¿å…ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå°½é‡ä½¿ç”¨æ›´åŠ é«˜æ•ˆã€æ›´åŠ ç®€å•çš„å­—ç¬¦ä¸²åŒ¹é…æ–¹æ¡ˆæ¥æé«˜ç¨‹åºæ€§èƒ½ã€‚åœ¨C++ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨<u>ECMAScriptè¯­æ³•</u>ä½œä¸ºé»˜è®¤è¯­æ³•ã€‚è¿™æ„å‘³ç€å®ƒä½¿ç”¨ç±»ä¼¼äºJavaScriptå’ŒPythonçš„æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•ã€‚ä½†C++çš„æ­£åˆ™è¡¨è¾¾å¼ä¸å…¶ä»–è¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼ç›¸æ¯”ï¼Œ<u>ç¼ºå°‘äº†ç‹¬å æ¨¡å¼</u>ï¼Œåªæœ‰è´ªå©ªæ¨¡å¼å’Œéè´ªå©ªæ¨¡å¼(æ‡’æƒ°æ¨¡å¼)ï¼Œè¿™ä½¿å¾—åŒ¹é…æ‰€æ¶ˆè€—çš„æ—¶é—´æ›´é•¿ã€‚</p><p>ECMAScriptè¯­æ³•ï¼š<a href="https://zhuanlan.zhihu.com/p/634341574">Modern C++ å­¦ä¹ ç¬”è®°â€”â€”æ­£åˆ™è¡¨è¾¾å¼</a></p><p><a href="https://zhuanlan.zhihu.com/p/38278481/">è—åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„é™·é˜±â€”çŸ¥ä¹</a></p><p><a href="https://www.cnblogs.com/lixuwu/p/16201714.html">æ­£åˆ™è¡¨è¾¾å¼å¼•èµ·çš„æ€§èƒ½ä¸‹é™â€”åšå®¢å›­</a></p></blockquote><hr><h2 id="æ­£åˆ™è§„åˆ™æ±‡æ€»"><a href="#æ­£åˆ™è§„åˆ™æ±‡æ€»" class="headerlink" title="æ­£åˆ™è§„åˆ™æ±‡æ€»"></a>æ­£åˆ™è§„åˆ™æ±‡æ€»</h2><hr><h2 id="6-3-åˆ†æ•°åŠ å‡è¿ç®—ï¼š592"><a href="#6-3-åˆ†æ•°åŠ å‡è¿ç®—ï¼š592" class="headerlink" title="6-3.åˆ†æ•°åŠ å‡è¿ç®—ï¼š592"></a>6-3.åˆ†æ•°åŠ å‡è¿ç®—ï¼š592</h2><p>æ³•ä¸€ï¼šæ¨¡æ‹Ÿï¼Œéå†æ•´ä¸ªå­—ç¬¦ä¸²</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">fractionAddition</span><span class="params">(string expression)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = expression.<span class="built_in">size</span>(), index = <span class="number">0</span>;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> x = <span class="number">0</span>, y = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (index &lt; n) &#123;</span><br><span class="line">            <span class="comment">//åˆ†å­</span></span><br><span class="line">            <span class="type">long</span> <span class="type">long</span> x1 = <span class="number">0</span>, sign = <span class="number">1</span>; <span class="comment">// x1è®°å½•å½“å‰æ•°å­—,signè®°å½•æ­£è´Ÿå·</span></span><br><span class="line">            <span class="keyword">if</span> (expression[index] == <span class="string">&#x27;-&#x27;</span> || expression[index] == <span class="string">&#x27;+&#x27;</span>) &#123;</span><br><span class="line">                sign = expression[index] == <span class="string">&#x27;-&#x27;</span> ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (index &lt; n &amp;&amp; <span class="built_in">isdigit</span>(expression[index])) &#123; <span class="comment">// index&lt;nåˆ«å¿˜äº†</span></span><br><span class="line">                x1 = x1 * <span class="number">10</span> + expression[index] - <span class="string">&#x27;0&#x27;</span>;       <span class="comment">//æ›´æ–°x1</span></span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//é‡åˆ°â€œ/â€</span></span><br><span class="line">            x1 *= sign; <span class="comment">//æœ€åæŠŠç¬¦å·å¸¦ä¸Š</span></span><br><span class="line">            index++;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//åˆ†æ¯.å†æ¬¡é‡åˆ°+/-æ—¶åˆ™ç»“æŸ</span></span><br><span class="line">            <span class="type">long</span> <span class="type">long</span> y1 = <span class="number">0</span>; <span class="comment">//åˆ†æ¯ä¸å¯èƒ½æœ‰ç¬¦å·ï¼Œæ‰€ä»¥æ— éœ€sign</span></span><br><span class="line">            <span class="keyword">while</span> (index &lt; n &amp;&amp; <span class="built_in">isdigit</span>(expression[index])) &#123;</span><br><span class="line">                y1 = y1 * <span class="number">10</span> + expression[index] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ›´æ–°å½“å‰æ•°å­—(å†æ¬¡é‡åˆ°â€œ+/-â€æ—¶),x/y+=x1/y1</span></span><br><span class="line">            x = x * y1 + x1 * y;</span><br><span class="line">            y *= y1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;0/1&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> g = <span class="built_in">gcd</span>(<span class="built_in">abs</span>(x), y); <span class="comment">//è·å–æœ€å¤§å…¬çº¦æ•°ï¼Œç”¨æ¥åŒ–ç®€åˆ†æ•°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">to_string</span>(x / g) + <span class="string">&quot;/&quot;</span> + <span class="built_in">to_string</span>(y / g);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šæ­£åˆ™åŒ¹é…,è¯¥è§£æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º$ O(n^2)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º $O(1)$,ä½†æ³•ä¸€æ—¶é—´å¤æ‚åº¦ä»…ä¸º$O(n+logâ¡C)$ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;regex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">performOperation</span><span class="params">(<span class="type">int</span> num1, <span class="type">int</span> den1, <span class="type">int</span> num2, <span class="type">int</span> den2, <span class="type">char</span> op)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> numerator, denominator;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="string">&#x27;+&#x27;</span>) &#123;</span><br><span class="line">            numerator = num1 * den2 + num2 * den1;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            numerator = num1 * den2 - num2 * den1;</span><br><span class="line">        &#125;</span><br><span class="line">        denominator = den1 * den2;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">toLowestTerms</span>(numerator, denominator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">toLowestTerms</span><span class="params">(<span class="type">int</span> numerator, <span class="type">int</span> denominator)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> divisor = <span class="built_in">gcd</span>(<span class="built_in">abs</span>(numerator), <span class="built_in">abs</span>(denominator));</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">to_string</span>(numerator / divisor) + <span class="string">&quot;/&quot;</span> +</span><br><span class="line">               <span class="built_in">to_string</span>(denominator / divisor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">fractionAddition</span><span class="params">(string expression)</span> </span>&#123;</span><br><span class="line">        <span class="function">regex <span class="title">pattern</span><span class="params">(<span class="string">&quot;(-?\\d+)/(\\d+)([+-])(-?\\d+)/(\\d+)&quot;</span>)</span></span>;</span><br><span class="line">        smatch matches;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">regex_search</span>(expression, matches, pattern)) &#123;</span><br><span class="line">            <span class="type">int</span> num1 = std::<span class="built_in">stoi</span>(matches[<span class="number">1</span>].<span class="built_in">str</span>());</span><br><span class="line">            <span class="type">int</span> den1 = std::<span class="built_in">stoi</span>(matches[<span class="number">2</span>].<span class="built_in">str</span>());</span><br><span class="line">            <span class="type">int</span> num2 = std::<span class="built_in">stoi</span>(matches[<span class="number">4</span>].<span class="built_in">str</span>());</span><br><span class="line">            <span class="type">int</span> den2 = std::<span class="built_in">stoi</span>(matches[<span class="number">5</span>].<span class="built_in">str</span>());</span><br><span class="line">            <span class="type">char</span> op = matches[<span class="number">3</span>].<span class="built_in">str</span>()[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">            expression = matches.<span class="built_in">prefix</span>().<span class="built_in">str</span>() +</span><br><span class="line">                         <span class="built_in">performOperation</span>(num1, den1, num2, den2, op) +</span><br><span class="line">                         matches.<span class="built_in">suffix</span>().<span class="built_in">str</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> expression;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å…³äºæœ€å¤§å…¬çº¦æ•°gcdå’Œæœ€å°å…¬å€æ•°lcm:</p><p>(Greatest Common Divisorã€Least Common Multiple)</p><p>éœ€è¦çš„å¤´æ–‡ä»¶ä¸º<code>&lt;numeric&gt;</code></p><h2 id="6-4-åˆ†æ•°åˆ°å°æ•°-åˆ†æ•°ä¹˜é™¤è¿ç®—-ï¼š166"><a href="#6-4-åˆ†æ•°åˆ°å°æ•°-åˆ†æ•°ä¹˜é™¤è¿ç®—-ï¼š166" class="headerlink" title="6-4.åˆ†æ•°åˆ°å°æ•°(åˆ†æ•°ä¹˜é™¤è¿ç®—)ï¼š166"></a>6-4.åˆ†æ•°åˆ°å°æ•°(åˆ†æ•°ä¹˜é™¤è¿ç®—)ï¼š166</h2><p>ä¸¤ä¸ªæ•´æ•°ç›¸é™¤ï¼Œç»“æœä¸€å®šæ˜¯æœ‰ç†æ•°ï¼Œä¸€å®šæœ‰å¾ªç¯ã€‚ä½¿ç”¨äº†å“ˆå¸Œè¡¨å­˜å‚¨ç«–å¼æ¨¡æ‹Ÿè¿‡ç¨‹ä¸­å‡ºç°è¿‡çš„ä½™æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">fractionToDecimal</span><span class="params">(<span class="type">int</span> numerator, <span class="type">int</span> denominator)</span> </span>&#123;</span><br><span class="line">        <span class="type">long</span> numeratorLong = numerator;</span><br><span class="line">        <span class="type">long</span> denominatorLong = denominator;</span><br><span class="line">        <span class="keyword">if</span> (numeratorLong % denominatorLong == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">to_string</span>(numeratorLong / denominatorLong);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        string ans;</span><br><span class="line">        <span class="keyword">if</span> (numeratorLong &lt; <span class="number">0</span> ^ denominatorLong &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ•´æ•°éƒ¨åˆ†</span></span><br><span class="line">        numeratorLong = <span class="built_in">abs</span>(numeratorLong);</span><br><span class="line">        denominatorLong = <span class="built_in">abs</span>(denominatorLong);</span><br><span class="line">        <span class="type">long</span> integerPart = numeratorLong / denominatorLong;</span><br><span class="line">        ans += <span class="built_in">to_string</span>(integerPart);</span><br><span class="line">        ans.<span class="built_in">push_back</span>(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°æ•°éƒ¨åˆ†</span></span><br><span class="line">        string fractionPart;</span><br><span class="line">        unordered_map&lt;<span class="type">long</span>, <span class="type">int</span>&gt; remainderIndexMap;</span><br><span class="line">        <span class="type">long</span> remainder = numeratorLong % denominatorLong;</span><br><span class="line">        <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (remainder != <span class="number">0</span> &amp;&amp; !remainderIndexMap.<span class="built_in">count</span>(remainder)) &#123;</span><br><span class="line">            remainderIndexMap[remainder] = index;</span><br><span class="line">            remainder *= <span class="number">10</span>;</span><br><span class="line">            fractionPart += <span class="built_in">to_string</span>(remainder / denominatorLong);</span><br><span class="line">            remainder %= denominatorLong;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (remainder != <span class="number">0</span>) &#123; <span class="comment">// æœ‰å¾ªç¯èŠ‚</span></span><br><span class="line">            <span class="type">int</span> insertIndex = remainderIndexMap[remainder];</span><br><span class="line">            fractionPart = fractionPart.<span class="built_in">substr</span>(<span class="number">0</span>,insertIndex) + <span class="string">&#x27;(&#x27;</span> + fractionPart.<span class="built_in">substr</span>(insertIndex);</span><br><span class="line">            fractionPart.<span class="built_in">push_back</span>(<span class="string">&#x27;)&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ans += fractionPart;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="6-5-æ±‚è§£æ–¹ç¨‹ï¼š640"><a href="#6-5-æ±‚è§£æ–¹ç¨‹ï¼š640" class="headerlink" title="6-5.æ±‚è§£æ–¹ç¨‹ï¼š640"></a>6-5.æ±‚è§£æ–¹ç¨‹ï¼š640</h2><p><img src="https://s2.loli.net/2024/01/23/NfTy7ME3SJHCcKV.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">solveEquation</span><span class="params">(string equation)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> index = <span class="number">0</span>, n = equation.<span class="built_in">size</span>(), sign1 = <span class="number">1</span>; <span class="comment">// sign1è®°å½•ç­‰å¼å³è¾¹ç³»æ•°</span></span><br><span class="line">        <span class="type">int</span> factor = <span class="number">0</span>, val = <span class="number">0</span>; <span class="comment">//è®°å½•å˜é‡çš„ç³»æ•°ï¼Œå¸¸é‡å€¼</span></span><br><span class="line">        <span class="keyword">while</span> (index &lt; n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (equation[index] == <span class="string">&#x27;=&#x27;</span>) &#123;</span><br><span class="line">                sign1 = <span class="number">-1</span>; <span class="comment">//ç­‰å¼å³è¾¹é»˜è®¤ç³»æ•°ä¸ºè´Ÿ</span></span><br><span class="line">                index++;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> sign2 = sign1, number = <span class="number">0</span>;</span><br><span class="line">            <span class="type">bool</span> valid = <span class="literal">false</span>; <span class="comment">//è®°å½•numberæ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">            <span class="keyword">if</span> (equation[index] == <span class="string">&#x27;-&#x27;</span> ||</span><br><span class="line">                equation[index] == <span class="string">&#x27;+&#x27;</span>) &#123; <span class="comment">//å»æ‰å‰é¢çš„ç¬¦å·</span></span><br><span class="line">                sign2 = (equation[index] == <span class="string">&#x27;-&#x27;</span>) ? -sign1 : sign1;</span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (index &lt; n &amp;&amp; <span class="built_in">isdigit</span>(equation[index])) &#123;</span><br><span class="line">                number = number * <span class="number">10</span> + equation[index] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                index++;</span><br><span class="line">                valid = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (index &lt; n &amp;&amp; equation[index] == <span class="string">&#x27;x&#x27;</span>) &#123; <span class="comment">//å˜é‡</span></span><br><span class="line">                factor += valid ? sign2 * number : sign2;</span><br><span class="line">                index++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">//æ•°å€¼</span></span><br><span class="line">                val += sign2 * number;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!factor) &#123;  <span class="comment">//factor * x + val = 0</span></span><br><span class="line">            <span class="keyword">return</span> val == <span class="number">0</span> ? <span class="string">&quot;Infinite solutions&quot;</span> : <span class="string">&quot;No solution&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x=&quot;</span> + <span class="built_in">to_string</span>(-val / factor);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="6-6-å¤–è§‚æ•°åˆ—ï¼š38"><a href="#6-6-å¤–è§‚æ•°åˆ—ï¼š38" class="headerlink" title="6-6.å¤–è§‚æ•°åˆ—ï¼š38"></a>6-6.å¤–è§‚æ•°åˆ—ï¼š38</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">countAndSay</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        string prev = <span class="string">&quot;1&quot;</span>; <span class="comment">//è®°å½•ä¸‹å‰ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆï¼Œé»˜è®¤ä¸ºç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²&quot;1&quot;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            string curr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="type">int</span> start = <span class="number">0</span>, pos = <span class="number">0</span>;<span class="comment">//åŒæŒ‡é’ˆ</span></span><br><span class="line">            <span class="keyword">while</span> (pos &lt; prev.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="keyword">while</span> (pos &lt; prev.<span class="built_in">size</span>() &amp;&amp; prev[pos] == prev[start]) &#123;</span><br><span class="line">                    pos++;</span><br><span class="line">                &#125;</span><br><span class="line">                curr += <span class="built_in">to_string</span>(pos - start) + prev[start];</span><br><span class="line">                start = pos; <span class="comment">//æ›´æ–°start</span></span><br><span class="line">            &#125;</span><br><span class="line">            prev = curr; <span class="comment">//æ›´æ–°prevä¸ºä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>6-6.è‡ªå®šä¹‰å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°ï¼š8</p><p>æ³•ä¸€ï¼šä¾æ¬¡éå†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">strToInt</span><span class="params">(string str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (str.<span class="built_in">empty</span>()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> index = <span class="number">0</span>, n = str.<span class="built_in">size</span>(), sign = <span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// å¤„ç†å‰ç½®ç©ºæ ¼</span></span><br><span class="line">        <span class="keyword">while</span> (index &lt; n &amp;&amp; str[index] == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">            ++index;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¤„ç†ç¬¦å·ï¼Œåº”è¯¥ç»§ç»­å‘åï¼Œå› ä¸º+-12çš„ç»“æœåº”ä¸º0</span></span><br><span class="line">        <span class="keyword">if</span> (index &lt; n &amp;&amp; (str[index] == <span class="string">&#x27;+&#x27;</span> || str[index] == <span class="string">&#x27;-&#x27;</span>)) &#123;</span><br><span class="line">            sign = str[index++] == <span class="string">&#x27;+&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¤„ç†æ•°å­—</span></span><br><span class="line">        <span class="keyword">while</span> (index &lt; n &amp;&amp; <span class="built_in">isdigit</span>(str[index])) &#123;</span><br><span class="line">            <span class="type">int</span> digit = str[index++] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ˜¯å¦æº¢å‡º</span></span><br><span class="line">            <span class="keyword">if</span> (res &gt; (INT_MAX - digit) / <span class="number">10</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> sign == <span class="number">1</span> ? INT_MAX : INT_MIN;</span><br><span class="line">            &#125;</span><br><span class="line">            res = res * <span class="number">10</span> + digit;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res * sign;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æœ¬é¢˜å…³é”®ï¼šå¤„ç†æ•´æ•°æº¢å‡ºçš„æƒ…å†µï¼ŒåŸé¢˜ï¼šå¦‚æœæ•´æ•°æ•°è¶…è¿‡ 32 ä½æœ‰ç¬¦å·æ•´æ•°èŒƒå›´ $[âˆ’2^{31},  2^{31} âˆ’ 1]$ ï¼Œéœ€è¦æˆªæ–­è¿™ä¸ªæ•´æ•°ï¼Œä½¿å…¶ä¿æŒåœ¨è¿™ä¸ªèŒƒå›´å†…ã€‚å…·ä½“æ¥è¯´ï¼Œå°äº $2^{31}$ çš„æ•´æ•°åº”è¯¥è¢«å›ºå®šä¸º $2^{31}$ ï¼Œå¤§äº $2^{31}âˆ’ 1$ çš„æ•´æ•°åº”è¯¥è¢«å›ºå®šä¸º $2^{31}âˆ’ 1 $ã€‚</p><hr><p>æ³•äºŒï¼šè‡ªåŠ¨æœº</p><p><img src="https://s2.loli.net/2024/01/24/TAa7d6Hgjy4iYqC.png" alt=""></p><p><img src="https://s2.loli.net/2024/01/24/QxOmc2DHh3U51nf.png" alt=""></p><p><img src="https://s2.loli.net/2024/01/24/d13ieFt2Aa4SQIX.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Automaton</span> &#123;</span><br><span class="line">    string state = <span class="string">&quot;start&quot;</span>;</span><br><span class="line">    unordered_map&lt;string, vector&lt;string&gt;&gt; table = &#123;</span><br><span class="line">        &#123;<span class="string">&quot;start&quot;</span>, &#123;<span class="string">&quot;start&quot;</span>, <span class="string">&quot;signed&quot;</span>, <span class="string">&quot;in_number&quot;</span>, <span class="string">&quot;end&quot;</span>&#125;&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;signed&quot;</span>, &#123;<span class="string">&quot;end&quot;</span>, <span class="string">&quot;end&quot;</span>, <span class="string">&quot;in_number&quot;</span>, <span class="string">&quot;end&quot;</span>&#125;&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;in_number&quot;</span>, &#123;<span class="string">&quot;end&quot;</span>, <span class="string">&quot;end&quot;</span>, <span class="string">&quot;in_number&quot;</span>, <span class="string">&quot;end&quot;</span>&#125;&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;end&quot;</span>, &#123;<span class="string">&quot;end&quot;</span>, <span class="string">&quot;end&quot;</span>, <span class="string">&quot;end&quot;</span>, <span class="string">&quot;end&quot;</span>&#125;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get_col</span><span class="params">(<span class="type">char</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isspace</span>(c)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">&#x27;+&#x27;</span> <span class="keyword">or</span> c == <span class="string">&#x27;-&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isdigit</span>(c)) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> sign = <span class="number">1</span>;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">get</span><span class="params">(<span class="type">char</span> c)</span> </span>&#123;</span><br><span class="line">        state = table[state][<span class="built_in">get_col</span>(c)];</span><br><span class="line">        <span class="keyword">if</span> (state == <span class="string">&quot;in_number&quot;</span>) &#123;</span><br><span class="line">            ans = ans * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            ans = sign == <span class="number">1</span> ? <span class="built_in">min</span>(ans, (<span class="type">long</span> <span class="type">long</span>)INT_MAX) : <span class="built_in">min</span>(ans, -(<span class="type">long</span> <span class="type">long</span>)INT_MIN);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (state == <span class="string">&quot;signed&quot;</span>)</span><br><span class="line">            sign = c == <span class="string">&#x27;+&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">myAtoi</span><span class="params">(string str)</span> </span>&#123;</span><br><span class="line">        Automaton automaton;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> c : str)</span><br><span class="line">            automaton.<span class="built_in">get</span>(c);</span><br><span class="line">        <span class="keyword">return</span> automaton.sign * automaton.ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å…³äºè‡ªåŠ¨æœº"><a href="#å…³äºè‡ªåŠ¨æœº" class="headerlink" title="å…³äºè‡ªåŠ¨æœº"></a>å…³äºè‡ªåŠ¨æœº</h2><p>åœ¨C++ä¸­ï¼Œè‡ªåŠ¨æœºé€šå¸¸æŒ‡çš„æ˜¯æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆFinite State Machineï¼ŒFSMï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§æŠ½è±¡çš„æ•°å­¦æ¨¡å‹ï¼Œç”¨äºæè¿°ç³»ç»Ÿçš„çŠ¶æ€åŠçŠ¶æ€ä¹‹é—´çš„è½¬ç§»ã€‚</p><p>ä¸€ä¸ªç®€å•çš„æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>ä¸€ç»„çŠ¶æ€ï¼šæè¿°ç³»ç»Ÿå¯èƒ½å¤„äºçš„çŠ¶æ€ã€‚</li><li>ä¸€ç»„è½¬ç§»ï¼šæè¿°çŠ¶æ€ä¹‹é—´çš„è½¬ç§»æ¡ä»¶ã€‚</li><li>åˆå§‹çŠ¶æ€ï¼šæè¿°ç³»ç»Ÿçš„åˆå§‹çŠ¶æ€ã€‚</li><li>ç»ˆæ­¢çŠ¶æ€ï¼šæè¿°ç³»ç»Ÿçš„ç»“æŸçŠ¶æ€ã€‚</li></ul><p>åœ¨C++ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»å’Œæšä¸¾ç±»å‹æ¥å®ç°æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†ä¸€ä¸ªæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼Œç”¨äºæ¨¡æ‹Ÿä¸€ä¸ªç®€å•çš„ç¯çš„çŠ¶æ€å˜åŒ–ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æšä¸¾ç±»å‹è¡¨ç¤ºç¯çš„çŠ¶æ€</span></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">LightState</span> &#123;</span><br><span class="line">    OFF,</span><br><span class="line">    ON,</span><br><span class="line">    DIM</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LightStateMachine</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    LightState state;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">LightStateMachine</span>() : <span class="built_in">state</span>(LightState::OFF) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">transition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (state) &#123;</span><br><span class="line">            <span class="keyword">case</span> LightState::OFF:</span><br><span class="line">                state = LightState::ON;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> LightState::ON:</span><br><span class="line">                state = LightState::DIM;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> LightState::DIM:</span><br><span class="line">                state = LightState::OFF;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">LightState <span class="title">getState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LightStateMachine light;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Initial state: &quot;</span> &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(light.<span class="built_in">getState</span>()) &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    light.<span class="built_in">transition</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;State after transition: &quot;</span> &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(light.<span class="built_in">getState</span>()) &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    light.<span class="built_in">transition</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;State after transition: &quot;</span> &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(light.<span class="built_in">getState</span>()) &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº <code>LightStateMachine</code>ï¼Œç”¨äºæ¨¡æ‹Ÿç¯çš„çŠ¶æ€å˜åŒ–ã€‚é€šè¿‡è°ƒç”¨ <code>transition</code> æ–¹æ³•ï¼ŒçŠ¶æ€æœºä¼šæ ¹æ®å½“å‰çŠ¶æ€è¿›è¡Œè½¬ç§»ï¼Œå¹¶å¯ä»¥é€šè¿‡ <code>getState</code> æ–¹æ³•è·å–å½“å‰çŠ¶æ€ã€‚</p><h2 id="6-6-æ•´æ•°è½¬ç½—é©¬æ•°å­—ï¼š12"><a href="#6-6-æ•´æ•°è½¬ç½—é©¬æ•°å­—ï¼š12" class="headerlink" title="6-6.æ•´æ•°è½¬ç½—é©¬æ•°å­—ï¼š12"></a>6-6.æ•´æ•°è½¬ç½—é©¬æ•°å­—ï¼š12</h2><p>æ³•ä¸€ï¼šæ¨¡æ‹Ÿ</p><p>æ³¨æ„ï¼Œè¿™é‡Œ<mark>ä¸èƒ½</mark>ç”¨unordered_mapï¼Œå› ä¸ºå…¶éå†çš„æ—¶å€™æ˜¯ä¹±åºçš„ï¼Œåº”è¯¥ç”¨èƒ½è®¾ç½®æ’åˆ—è§„åˆ™çš„mapï¼Œç”¨<code>greater&lt;int&gt;</code>ä¿è¯ç”±å¤§åˆ°å°éå†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">const</span> map&lt;<span class="type">int</span>, string, greater&lt;<span class="type">int</span>&gt;&gt; valueSymbols = &#123;</span><br><span class="line">        &#123;<span class="number">1000</span>, <span class="string">&quot;M&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">900</span>,  <span class="string">&quot;CM&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">500</span>,  <span class="string">&quot;D&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">400</span>,  <span class="string">&quot;CD&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">100</span>,  <span class="string">&quot;C&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">90</span>,   <span class="string">&quot;XC&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">50</span>,   <span class="string">&quot;L&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">40</span>,   <span class="string">&quot;XL&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">10</span>,   <span class="string">&quot;X&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">9</span>,    <span class="string">&quot;IX&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">5</span>,    <span class="string">&quot;V&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">4</span>,    <span class="string">&quot;IV&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="number">1</span>,    <span class="string">&quot;I&quot;</span>&#125;,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="comment">//ä½¿ç”¨äº†greater&lt;int&gt;æ‰èƒ½ä¿è¯éå†é¡ºåºæ˜¯æŒ‰ç…§å½“å‰1000-&gt;500-&gt;...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">intToRoman</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        string roman;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; [value, symbol] : valueSymbols) &#123; <span class="comment">//æ³¨æ„autoå‰é¢è¿™é‡Œéœ€è¦åŠ ä¸Šconst</span></span><br><span class="line">            <span class="keyword">while</span> (num &gt;= value) &#123;</span><br><span class="line">                num -= value;</span><br><span class="line">                roman += symbol;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (num == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> roman;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ å‡ä¸ºpairç±»å‹ã€‚éå†æ•°ç»„çš„é¡ºåºå¹¶ä¸æ˜¯ä¹±åºã€‚pairæ•°ç»„é™¤äº†ç¬¬ä¸€è¡Œçš„å®šä¹‰ä»¥å¤–ï¼Œå…¶ä»–ä»£ç å‡ ä¹æ²¡æœ‰åŒºåˆ«ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> pair&lt;<span class="type">int</span>, string&gt; valueSymbols[] = &#123;</span><br><span class="line">    &#123;<span class="number">1000</span>, <span class="string">&quot;M&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">900</span>,  <span class="string">&quot;CM&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">500</span>,  <span class="string">&quot;D&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">400</span>,  <span class="string">&quot;CD&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">100</span>,  <span class="string">&quot;C&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">90</span>,   <span class="string">&quot;XC&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">50</span>,   <span class="string">&quot;L&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">40</span>,   <span class="string">&quot;XL&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">10</span>,   <span class="string">&quot;X&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">9</span>,    <span class="string">&quot;IX&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">5</span>,    <span class="string">&quot;V&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">4</span>,    <span class="string">&quot;IV&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="number">1</span>,    <span class="string">&quot;I&quot;</span>&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">intToRoman</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        string roman;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> &amp;[value, symbol] : valueSymbols) &#123;</span><br><span class="line">            <span class="keyword">while</span> (num &gt;= value) &#123;</span><br><span class="line">                num -= value;</span><br><span class="line">                roman += symbol;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (num == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> roman;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šç¡¬ç¼–ç æ•°å­—</p><p><img src="https://s2.loli.net/2024/01/24/wqVmOtoUaXb4H7A.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> string thousands[] = &#123;<span class="string">&quot;&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;MM&quot;</span>, <span class="string">&quot;MMM&quot;</span>&#125;;</span><br><span class="line"><span class="type">const</span> string hundreds[]  = &#123;<span class="string">&quot;&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;CC&quot;</span>, <span class="string">&quot;CCC&quot;</span>, <span class="string">&quot;CD&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;DC&quot;</span>, <span class="string">&quot;DCC&quot;</span>, <span class="string">&quot;DCCC&quot;</span>, <span class="string">&quot;CM&quot;</span>&#125;;</span><br><span class="line"><span class="type">const</span> string tens[]      = &#123;<span class="string">&quot;&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;XX&quot;</span>, <span class="string">&quot;XXX&quot;</span>, <span class="string">&quot;XL&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;LX&quot;</span>, <span class="string">&quot;LXX&quot;</span>, <span class="string">&quot;LXXX&quot;</span>, <span class="string">&quot;XC&quot;</span>&#125;;</span><br><span class="line"><span class="type">const</span> string ones[]      = &#123;<span class="string">&quot;&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;II&quot;</span>, <span class="string">&quot;III&quot;</span>, <span class="string">&quot;IV&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;VI&quot;</span>, <span class="string">&quot;VII&quot;</span>, <span class="string">&quot;VIII&quot;</span>, <span class="string">&quot;IX&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">intToRoman</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> thousands[num / <span class="number">1000</span>] + hundreds[num % <span class="number">1000</span> / <span class="number">100</span>] + tens[num % <span class="number">100</span> / <span class="number">10</span>] + ones[num % <span class="number">10</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="6-7-æ¯”è¾ƒç‰ˆæœ¬å·ï¼š165"><a href="#6-7-æ¯”è¾ƒç‰ˆæœ¬å·ï¼š165" class="headerlink" title="6-7.æ¯”è¾ƒç‰ˆæœ¬å·ï¼š165"></a>6-7.æ¯”è¾ƒç‰ˆæœ¬å·ï¼š165</h2><p>æ³¨æ„å…¶ä¸­ç»†èŠ‚å³å¯ï¼ŒåŒæŒ‡é’ˆæ³•ï¼Œå°½å¯èƒ½ç®€åŒ–ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">compareVersion</span><span class="params">(string version1, string version2)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> pos1 = <span class="number">0</span>, pos2 = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> n1 = version1.<span class="built_in">length</span>(), n2 = version2.<span class="built_in">length</span>();</span><br><span class="line">        <span class="keyword">while</span> (pos1 &lt; n1 || pos2 &lt; n2) &#123; <span class="comment">//ç”¨æˆ–ï¼Œéœ€è¦æŠŠä¸¤ä¸ªéƒ½éå†å®Œ</span></span><br><span class="line">            <span class="type">long</span> <span class="type">int</span> v1 = <span class="number">0</span>, v2 = <span class="number">0</span>; <span class="comment">//ç‰ˆæœ¬å·å¯èƒ½æ˜¯&quot;1.2147483647&quot;</span></span><br><span class="line">            <span class="keyword">while</span> (pos1 &lt; n1 &amp;&amp; version1[pos1] != <span class="string">&#x27;.&#x27;</span>) &#123;</span><br><span class="line">                v1 = v1 * <span class="number">10</span> + version1[pos1++] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (pos2 &lt; n2 &amp;&amp; version2[pos2] != <span class="string">&#x27;.&#x27;</span>) &#123;</span><br><span class="line">                v2 = v2 * <span class="number">10</span> + version2[pos2++] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (v1 != v2) &#123;</span><br><span class="line">                <span class="keyword">return</span> v1 &gt; v2 ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            pos1++;</span><br><span class="line">            pos2++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>stoi(stringVar)</code>ä¸­ï¼ŒstringVarä¸èƒ½ä¸ºç©ºã€‚</p><h2 id="6-8-ç¥å¥‡å­—ç¬¦ä¸²ï¼š481"><a href="#6-8-ç¥å¥‡å­—ç¬¦ä¸²ï¼š481" class="headerlink" title="6-8.ç¥å¥‡å­—ç¬¦ä¸²ï¼š481"></a>6-8.ç¥å¥‡å­—ç¬¦ä¸²ï¼š481</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">magicalString</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        string s = <span class="string">&quot;\1\2\2&quot;</span>; <span class="comment">//éœ€è¦ç”¨åæ–œæ </span></span><br><span class="line">        <span class="comment">// å€¼å°±æ˜¯ 1,2,2ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ç”¨ s[i] å½“ä½œä¸ªæ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; s.<span class="built_in">length</span>() &lt; n; ++i) &#123;</span><br><span class="line">            s += <span class="built_in">string</span>(s[i], s.<span class="built_in">back</span>() ^ <span class="number">3</span>);</span><br><span class="line">            <span class="comment">// 1^3=2, 2^3=1ï¼Œè¿™æ ·å°±èƒ½åœ¨ 1 å’Œ 2 ä¹‹é—´è½¬æ¢</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">count</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">begin</span>() + n, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ol><li><p><code>string s = &quot;\1\2\2&quot;;</code>å’Œ<code>string s = &quot;122&quot;;</code>çš„åŒºåˆ«:åœ¨C++ä¸­ï¼Œå­—ç¬¦ä¸²å­—é¢å€¼ä¸­çš„è½¬ä¹‰åºåˆ—æ˜¯ä»¥åæ–œæ ï¼ˆ<code>\</code>ï¼‰å¼€å¤´çš„å­—ç¬¦åºåˆ—ã€‚<code>&quot;\1\2\2&quot;</code> å’Œ <code>&quot;122&quot;</code> çš„åŒºåˆ«åœ¨äº<mark>è½¬ä¹‰åºåˆ—</mark>çš„ä½¿ç”¨ã€‚<code>&quot;\1\2\2&quot;</code>ï¼šè¿™ä¸ªå­—ç¬¦ä¸²åŒ…å«äº†è½¬ä¹‰åºåˆ— <code>\1</code>ã€<code>\2</code> å’Œ <code>\2</code>ã€‚è¿™äº›æ˜¯å…«è¿›åˆ¶è½¬ä¹‰åºåˆ—ï¼Œä»£è¡¨ç‰¹å®šçš„ASCIIå­—ç¬¦ã€‚å…·ä½“è€Œè¨€ï¼Œ<code>\1</code> å¯¹åº”ASCIIå€¼1ï¼Œ<code>\2</code> å¯¹åº”ASCIIå€¼2ã€‚å› æ­¤ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å®é™…ä¸Šæ˜¯åŒ…å«äº†ä¸‰ä¸ªå­—ç¬¦ï¼Œåˆ†åˆ«æ˜¯1ã€2å’Œ2ã€‚<code>&quot;122&quot;</code>è¿™ä¸ªå­—ç¬¦ä¸²æ²¡æœ‰ä½¿ç”¨å…«è¿›åˆ¶è½¬ä¹‰åºåˆ—ï¼Œå®ƒåªåŒ…å«äº†ä¸‰ä¸ªå­—ç¬¦ï¼Œåˆ†åˆ«æ˜¯â€™1â€™ã€â€™2â€™å’Œâ€™2â€™ã€‚å‰è€…çš„s[i]å¯ä»¥ç›´æ¥ç”¨æ¥å½“åšä¸ªæ•°ã€‚</p></li><li><p><code>s += string(s[i], s.back()^3)</code>ï¼š<code>string(int count,char value);</code>è¿™æ˜¯è¡¨ç¤ºsåŠ ä¸Šä¸€ä¸ªåŒ…å«valueå­—ç¬¦ï¼Œä¸”é•¿åº¦ä¸ºcountçš„å­—ç¬¦ä¸²ã€‚æ¯”å¦‚<code>s+=string(&#39;\2&#39;, 1)</code>å°±æ˜¯<code>s+=&quot;11&quot;</code>,å¸¸è§„å†™æ³•æ˜¯<code>string(2, &#39;1&#39;)</code>;</p></li><li><p><code>s.back()^3</code>:s.back()å°±æ˜¯å­—ç¬¦ä¸²sçš„æœ€åä¸€ä¸ªå­—ç¬¦ã€‚<code>^3</code>ç”¨äºå®ç°1ä¸2çš„ä¸æ–­åˆ‡æ¢ï¼Œ1^3=2, 2^3=1.(äºŒè¿›åˆ¶è¿ç®—)</p></li><li><p><code>count(s.begin(), s.begin()+n, 1)</code>:è®¡æ•°ç‰¹å®šåŒºé—´å†…æœ‰å¤šå°‘ä¸ªå€¼ä¸º1çš„å­—ç¬¦ã€‚æ¨¡æ¿<code>count(T.begin(),T.end(),value)</code>ã€‚</p></li></ol><hr><p>ç°åœ¨ä¸ç”¨åæ–œæ ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">magicalString</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        string s = <span class="string">&quot;122&quot;</span>; <span class="comment">//ä¸ç”¨åæ–œæ </span></span><br><span class="line">        <span class="comment">// è¿™æ ·å°±ä¸å¯ä»¥ç›´æ¥ç”¨ s[i] å½“ä½œä¸ªæ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; s.<span class="built_in">length</span>() &lt; n; ++i) &#123;</span><br><span class="line">            s += <span class="built_in">string</span>(s[i]-<span class="string">&#x27;0&#x27;</span>, (s.<span class="built_in">back</span>()-<span class="string">&#x27;0&#x27;</span>) ^ <span class="number">3</span> +<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            <span class="comment">// 1^3=2, 2^3=1ï¼Œè¿™æ ·å°±èƒ½åœ¨ 1 å’Œ 2 ä¹‹é—´è½¬æ¢</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">count</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">begin</span>() + n, <span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å­—ç¬¦ä¸²è¿›é˜¶éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="string" scheme="https://sumikiru.top/tags/string/"/>
    
  </entry>
  
  <entry>
    <title>2.0å­—ç¬¦ä¸²ç¯‡</title>
    <link href="https://sumikiru.top/posts/10e5d792.html"/>
    <id>https://sumikiru.top/posts/10e5d792.html</id>
    <published>2024-04-05T18:51:21.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å…³äºstringå’Œcstring"><a href="#å…³äºstringå’Œcstring" class="headerlink" title="å…³äºstringå’Œcstring"></a>å…³äºstringå’Œcstring</h1><p><code>&lt;string&gt;</code> å’Œ <code>&lt;cstring&gt;</code> æ˜¯ C++ ä¸­çš„ä¸¤ä¸ªä¸åŒçš„å¤´æ–‡ä»¶ï¼Œå®ƒä»¬æœ‰ä¸åŒçš„ä½œç”¨å’ŒåŠŸèƒ½ï¼š</p><ul><li><p><code>&lt;string&gt;</code> å¤´æ–‡ä»¶åŒ…å«äº† C++ æ ‡å‡†åº“ä¸­çš„å­—ç¬¦ä¸²ç±» <code>std::string</code>ï¼Œä»¥åŠä¸å­—ç¬¦ä¸²ç›¸å…³çš„ä¸€äº›å‡½æ•°å’Œæ“ä½œç¬¦é‡è½½ã€‚è¿™ä¸ªå¤´æ–‡ä»¶ç”¨äºå¤„ç† C++ ä¸­çš„å­—ç¬¦ä¸²æ“ä½œï¼Œæä¾›äº†æ›´å¤šçš„å­—ç¬¦ä¸²å¤„ç†åŠŸèƒ½å’Œä¾¿åˆ©ã€‚</p></li><li><p><code>&lt;cstring&gt;</code> å¤´æ–‡ä»¶æ˜¯ C æ ‡å‡†åº“ä¸­çš„å¤´æ–‡ä»¶ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€äº› C è¯­è¨€å­—ç¬¦ä¸²æ“ä½œçš„å‡½æ•°ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²å¤åˆ¶ã€è¿æ¥ã€æ¯”è¾ƒç­‰ã€‚åœ¨ C++ ä¸­ï¼Œè¿™äº›å‡½æ•°é€šå¸¸è¢«åŒ…å«åœ¨ <code>std</code> å‘½åç©ºé—´ä¸­ï¼Œæ¯”å¦‚ <code>std::strcpy</code>ã€<code>std::strcat</code> ç­‰ã€‚</p></li></ul><p>æ€»çš„æ¥è¯´ï¼Œ<code>&lt;string&gt;</code> æ›´é€‚åˆç”¨äº C++ ä¸­çš„å­—ç¬¦ä¸²æ“ä½œï¼Œè€Œ <code>&lt;cstring&gt;</code> åˆ™æ›´é€‚åˆç”¨äº C é£æ ¼çš„å­—ç¬¦ä¸²æ“ä½œã€‚</p><hr><h1 id="å…³äºstringåŒ…å«çš„å¸¸è§å‡½æ•°"><a href="#å…³äºstringåŒ…å«çš„å¸¸è§å‡½æ•°" class="headerlink" title="å…³äºstringåŒ…å«çš„å¸¸è§å‡½æ•°"></a>å…³äºstringåŒ…å«çš„å¸¸è§å‡½æ•°</h1><ul><li><code>length()</code> æˆ– <code>size()</code>: è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</li><li><code>append(str)</code>: åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ å¦ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li><li><code>insert(pos, str)</code>: åœ¨æŒ‡å®šä½ç½®æ’å…¥å¦ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li><li><code>erase(pos, len)</code>: ä»æŒ‡å®šä½ç½®åˆ é™¤æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ã€‚</li><li><code>find(str)</code>: æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„å­å­—ç¬¦ä¸²ã€‚</li><li><code>substr(pos, len)</code>: è¿”å›ä»æŒ‡å®šä½ç½®å¼€å§‹çš„æŒ‡å®šé•¿åº¦çš„å­å­—ç¬¦ä¸²ã€‚</li><li><code>compare(str)</code>: æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚</li><li><code>replace(pos, len, str)</code>: ç”¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢æŒ‡å®šä½ç½®çš„æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ã€‚</li><li><code>push_back()ã€pop_back()</code>:ç±»ä¼¼æ•°ç»„çš„æ“ä½œæ–¹å¼ï¼Œå¯¹å­—ç¬¦ä¸²ä¾ç„¶ä½¿ç”¨ã€‚</li></ul><hr><p>å¼‚æˆ–ï¼š<code>^</code>.è¿ç®—è§„åˆ™ï¼š<code>N^0=N;N^N=0;</code></p><p>åˆ¤æ–­å¤§å°å†™ï¼š<code>islower</code>ã€<code>isupper</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">detectCapitalUse</span><span class="params">(string word)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (word.<span class="built_in">size</span>() &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">islower</span>(word[<span class="number">0</span>]) &amp;&amp; <span class="built_in">isupper</span>(word[<span class="number">1</span>])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//æ’é™¤å½¢å¦‚uSAçš„æƒ…å†µ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; word.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">islower</span>(word[i]) ^ <span class="built_in">islower</span>(word[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="comment">//é™¤äº†ç¬¬ä¸€ä¸ªå­—æ¯ä»¥å¤–çš„å­—æ¯å¤§å°å†™ä¸ä¸€è‡´</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è½¬ä¸ºå°å†™ï¼š<code>tolower</code>/è½¬ä¸ºå¤§å†™:<code>toupper</code>(æ³¨æ„ï¼Œè¿”å›å€¼ç±»å‹ä¸ºintã€‚å¯ä»¥å†™ä½œ<code>char ch = tolower(c);</code>æˆ–è€…<code>auto ch = char(tolower(c));</code>)ã€‚å¦‚æœæ˜¯æ•°å­—ï¼Œåˆ™æ— å˜åŒ–ï¼Œ<mark>å¯ä»¥æ¥å—æ•°å­—</mark></p><p>æ£€æŸ¥ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯å­—æ¯æˆ–æ•°å­—:<code>isalnum</code>,éœ€è¦å¤´æ–‡ä»¶<code>&lt;cctype&gt;</code>.å¦‚æœåˆ¤æ–­æ˜¯å¦ä¸ºå­—æ¯:<code>isalpha</code>,åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—:<code>isdigit</code>.ä¹Ÿæ˜¯éœ€è¦å¤´æ–‡ä»¶<code>&lt;cctype&gt;</code></p><p>å®šä¹‰bä¸ºaçš„é€†åºå­—ç¬¦ä¸²ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string b(a.rbgin(),a.rend());</span><br></pre></td></tr></table></figure><h1 id="1-å›æ–‡ä¸²çš„å®šä¹‰"><a href="#1-å›æ–‡ä¸²çš„å®šä¹‰" class="headerlink" title="1.å›æ–‡ä¸²çš„å®šä¹‰"></a>1.å›æ–‡ä¸²çš„å®šä¹‰</h1><h2 id="éªŒè¯å›æ–‡ä¸²ï¼š125"><a href="#éªŒè¯å›æ–‡ä¸²ï¼š125" class="headerlink" title="éªŒè¯å›æ–‡ä¸²ï¼š125"></a>éªŒè¯å›æ–‡ä¸²ï¼š125</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        string schange;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> ch : s) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isalnum</span>(ch)) &#123;</span><br><span class="line">                schange += <span class="built_in">tolower</span>(ch); <span class="comment">//é˜²æ­¢å¤§å°å†™å¹²æ‰°ä¹‹åçš„ç›¸ç­‰åˆ¤æ–­</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">string <span class="title">schangeReverse</span><span class="params">(schange.rbegin(), schange.rend())</span></span>;</span><br><span class="line">        <span class="keyword">return</span> schange == schangeReverse;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç©ºé—´ä¼˜åŒ–:ä½¿ç”¨åŒæŒ‡é’ˆï¼Œåœ¨åŸå­—ç¬¦ä¸²ä¸Šç›´æ¥åˆ¤æ–­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n=s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> left=<span class="number">0</span>,right=n<span class="number">-1</span>;</span><br><span class="line">        <span class="comment">//æ¯æ¬¡å°†æŒ‡é’ˆç§»åˆ°ä¸‹ä¸€ä¸ªå­—æ¯å­—ç¬¦æˆ–æ•°å­—å­—ç¬¦ï¼Œå†åˆ¤æ–­è¿™ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦æ˜¯å¦ç›¸åŒ</span></span><br><span class="line">        <span class="keyword">while</span>(left&lt;right)&#123;</span><br><span class="line">            <span class="keyword">while</span>(left&lt;right&amp;&amp;!<span class="built_in">isalnum</span>(s[left]))&#123;</span><br><span class="line">                ++left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(left&lt;right&amp;&amp;!<span class="built_in">isalnum</span>(s[right]))&#123;</span><br><span class="line">                --right;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(left&lt;right)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">tolower</span>(s[left])!=<span class="built_in">tolower</span>(s[right]))&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ++left;</span><br><span class="line">                --right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å–å­—ç¬¦ä¸²strä»ç´¢å¼• 0 å¼€å§‹ã€é•¿åº¦ä¸º index çš„å­å­—ç¬¦ä¸²ï¼š(æ³¨æ„åŒ…æ‹¬çš„æ˜¯str[0]åˆ°str[i-1]çš„éƒ¨åˆ†ï¼)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.<span class="built_in">substr</span>(<span class="number">0</span>, index);</span><br></pre></td></tr></table></figure><h1 id="2-å…¬å…±å‰ç¼€"><a href="#2-å…¬å…±å‰ç¼€" class="headerlink" title="2.å…¬å…±å‰ç¼€"></a>2.å…¬å…±å‰ç¼€</h1><h2 id="æœ€é•¿å…¬å…±å‰ç¼€ï¼š14"><a href="#æœ€é•¿å…¬å…±å‰ç¼€ï¼š14" class="headerlink" title="æœ€é•¿å…¬å…±å‰ç¼€ï¼š14"></a>æœ€é•¿å…¬å…±å‰ç¼€ï¼š14</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//çºµå‘æ‰«æ</span></span><br><span class="line"><span class="comment">//ä»å‰å¾€åéå†æ‰€æœ‰å­—ç¬¦ä¸²çš„æ¯ä¸€åˆ—ï¼Œæ¯”è¾ƒç›¸åŒåˆ—ä¸Šçš„å­—ç¬¦æ˜¯å¦ç›¸åŒï¼Œ</span></span><br><span class="line"><span class="comment">//å¦‚æœç›¸åŒåˆ™ç»§ç»­å¯¹ä¸‹ä¸€åˆ—è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸ç›¸åŒåˆ™å½“å‰åˆ—ä¸å†å±äºå…¬å…±å‰ç¼€ï¼Œ</span></span><br><span class="line"><span class="comment">//å½“å‰åˆ—ä¹‹å‰çš„éƒ¨åˆ†ä¸ºæœ€é•¿å…¬å…±å‰ç¼€ã€‚</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">longestCommonPrefix</span><span class="params">(vector&lt;string&gt;&amp; strs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!strs.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; strs[<span class="number">0</span>].<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; strs.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (strs[<span class="number">0</span>][i] != strs[j][i]) &#123;</span><br><span class="line">                    <span class="keyword">return</span> strs[<span class="number">0</span>].<span class="built_in">substr</span>(<span class="number">0</span>, i) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> strs[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="3-å•è¯"><a href="#3-å•è¯" class="headerlink" title="3.å•è¯"></a>3.å•è¯</h1><h2 id="åˆ¤æ–­å•è¯æ•°ï¼š434"><a href="#åˆ¤æ–­å•è¯æ•°ï¼š434" class="headerlink" title="åˆ¤æ–­å•è¯æ•°ï¼š434"></a>åˆ¤æ–­å•è¯æ•°ï¼š434</h2><p>å…³é”®åœ¨äºçœ‹è¯¥å­—ç¬¦çš„<u>å‰ä¸€ä¸ª</u>å­—ç¬¦s[i-1]æ˜¯å¦ä¸ºç©º(è¿™æ ·å¯ä»¥éå†åˆ°æ‰€æœ‰å­—ç¬¦è€Œä¸”ä¸éœ€è¦é¢å¤–åˆ¤æ–­)ï¼Œè€Œä¸æ˜¯çœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦s[i+1]æ˜¯å¦ä¸ºç©º</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countSegments</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] != <span class="string">&#x27; &#x27;</span> &amp;&amp; (i == <span class="number">0</span> || s[i - <span class="number">1</span>] == <span class="string">&#x27; &#x27;</span>)) &#123;</span><br><span class="line">                <span class="comment">// i==0å¿…é¡»å†™åœ¨s[i-1]å‰é¢ï¼Œå¦åˆ™ä¼šæº¢å‡º</span></span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="4-å­—ç¬¦ä¸²çš„åè½¬"><a href="#4-å­—ç¬¦ä¸²çš„åè½¬" class="headerlink" title="4.å­—ç¬¦ä¸²çš„åè½¬"></a>4.å­—ç¬¦ä¸²çš„åè½¬</h1><h2 id="åè½¬å­—ç¬¦ä¸²s"><a href="#åè½¬å­—ç¬¦ä¸²s" class="headerlink" title="åè½¬å­—ç¬¦ä¸²s"></a>åè½¬å­—ç¬¦ä¸²s</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverseString</span><span class="params">(vector&lt;<span class="type">char</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ³•ä¸€</span></span><br><span class="line">    <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n / <span class="number">2</span> - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(s[i], s[n - <span class="number">1</span> - i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ³•äºŒï¼šè‡ªå¸¦æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());</span><br><span class="line">    <span class="comment">//æ³•ä¸‰ï¼šåŒæŒ‡é’ˆ</span></span><br><span class="line">    <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> left = <span class="number">0</span>, right = n - <span class="number">1</span>; left &lt; right; ++left, --right) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(s[left], s[right]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šå…³äºmin()ï¼Œä¸¤ä¸ªå‚æ•°éƒ½å¿…é¡»æ˜¯intç±»å‹ï¼Œè€Œs.size()æ˜¯unsigned intç±»å‹ï¼Œéœ€è¦è½¬æ¢ï¼(æˆ–è€…ä¸€å¼€å§‹å°±å†™æˆ<code>int n=s.size()</code>ï¼Œç„¶ååé¢ç”¨nä»£æ›¿)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">reverse</span>(s.<span class="built_in">begin</span>() + i, s.<span class="built_in">begin</span>() + <span class="built_in">min</span>(i + k, (<span class="type">int</span>)s.<span class="built_in">size</span>()));</span><br></pre></td></tr></table></figure><p>åè½¬å­—ç¬¦ä¸²ä¸­çš„å„ä¸ªå•è¯ï¼š557(è¿›é˜¶ï¼šåŒ…æ‹¬å‰ç½®åç½®ä»¥åä¸­é—´ä¸å¤šä¸ªç©ºæ ¼æ—¶ï¼Œstringstreamèƒ½å¤Ÿå¾ˆå¥½è§£å†³,åªä¸è¿‡ç”¨åˆ°äº†é¢å¤–ç©ºé—´anså’Œtå¹¶éåŸåœ°è§£æ³•,æ—¶é—´å¤æ‚åº¦ä¸ºO(n * m + k)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚åŸåœ°è§£æ³•åº”è¯¥ç”¨åŒæŒ‡é’ˆ)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">string <span class="title">reverseWords</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">    <span class="function">stringstream <span class="title">ss</span><span class="params">(s)</span></span>;</span><br><span class="line">    string t, ans;</span><br><span class="line">    <span class="keyword">while</span> (ss &gt;&gt; t) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(t.<span class="built_in">begin</span>(), t.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">if</span> (!ans.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            ans += <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ans += t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="5-ç»Ÿè®¡å­—ç¬¦ä¸²-å“ˆå¸Œè¡¨"><a href="#5-ç»Ÿè®¡å­—ç¬¦ä¸²-å“ˆå¸Œè¡¨" class="headerlink" title="5.ç»Ÿè®¡å­—ç¬¦ä¸²(å“ˆå¸Œè¡¨)"></a>5.ç»Ÿè®¡å­—ç¬¦ä¸²(å“ˆå¸Œè¡¨)</h1><h2 id="5-1-å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå”¯ä¸€å­—ç¬¦ï¼š387"><a href="#5-1-å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå”¯ä¸€å­—ç¬¦ï¼š387" class="headerlink" title="5-1.å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå”¯ä¸€å­—ç¬¦ï¼š387"></a>5-1.å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå”¯ä¸€å­—ç¬¦ï¼š387</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">firstUniqChar</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">    unordered_map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; count;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> ch : s) &#123;</span><br><span class="line">        count[ch]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (count[s[i]] == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç”¨find()å’Œrfind():(ç©ºé—´å¤æ‚åº¦ä¸º$O(1)$,æ—¶é—´å¤æ‚åº¦$O(n^2)$)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">firstUniqChar</span><span class="params">(string s)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>( i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s.<span class="built_in">find</span>(s[i]) == s.<span class="built_in">rfind</span>(s[i]))<span class="comment">//find()æ—¶é—´å¤æ‚åº¦O(n)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–ï¼šè®°å½•é¢‘æ•°æ”¹ä¸ºè®°å½•<strong>ç´¢å¼•</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">firstUniqChar</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">        unordered_map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; position;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (position.<span class="built_in">count</span>(s[i])) &#123; <span class="comment">//è¯¥å­—ç¬¦å·²ç»å‡ºç°è¿‡è‡³å°‘ä¸€æ¬¡</span></span><br><span class="line">                position[s[i]] = <span class="number">-1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                position[s[i]] = i; <span class="comment">//åªå‡ºç°ç¬¬ä¸€æ¬¡çš„ï¼Œè®°å½•ä¸‹å¯¹åº”ç´¢å¼•</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> first = n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; [_, pos] : position) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pos != <span class="number">-1</span>) &#123;</span><br><span class="line">                first = <span class="built_in">min</span>(first, pos);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> first == n ? <span class="number">-1</span> : first;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šï¼ˆç”¨çº¯æ•°ç»„æ›´å¿«ï¼Œå°½ç®¡æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ç›¸åŒï¼Œä½†æ˜¯å“ˆå¸Œè¡¨ç‰µæ¶‰åˆ°å»ºè¡¨ã€å“ˆå¸Œç¢°æ’ç­‰ç­‰ï¼‰</p><p>æ–¹æ³•äºŒï¼šä½¿ç”¨é˜Ÿåˆ—queueï¼ˆæ—¶é—´ç©ºé—´å¤æ‚åº¦åŒæ³•ä¸€ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">firstUniqChar</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">        unordered_map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; position;</span><br><span class="line">        queue&lt;pair&lt;<span class="type">char</span>, <span class="type">int</span>&gt;&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (position.<span class="built_in">count</span>(s[i])) &#123; <span class="comment">//è¯¥å­—ç¬¦å·²ç»å‡ºç°è¿‡è‡³å°‘ä¸€æ¬¡</span></span><br><span class="line">                position[s[i]] = <span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">while</span> (!q.<span class="built_in">empty</span>() &amp;&amp; position[q.<span class="built_in">front</span>().first] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    q.<span class="built_in">pop</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                position[s[i]] = i; <span class="comment">//åªå‡ºç°ç¬¬ä¸€æ¬¡çš„ï¼Œè®°å½•ä¸‹å¯¹åº”ç´¢å¼•</span></span><br><span class="line">                q.<span class="built_in">emplace</span>(s[i], i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> q.<span class="built_in">empty</span>() ? <span class="number">-1</span> : q.<span class="built_in">front</span>().second;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>emplace()</code> æ˜¯ C++ ä¸­å®¹å™¨ç±»çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œç”¨äºåœ¨å®¹å™¨ä¸­å°±åœ°æ„é€ å…ƒç´ ï¼Œè€Œä¸æ˜¯é€šè¿‡æ‹·è´æˆ–ç§»åŠ¨æ„é€ å‡½æ•°ã€‚</p><p>å¯¹äº<mark>å®¹å™¨ç±»</mark>ï¼ˆå¦‚ <code>std::vector</code>ã€<code>std::map</code>ã€<code>std::unordered_map</code> ç­‰ï¼‰ï¼Œ<code>emplace()</code> å‡½æ•°æ¥å—æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œå¹¶åœ¨å®¹å™¨ä¸­ç›´æ¥æ„é€ ä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯å°†ä¸€ä¸ªå·²ç»æ„é€ å¥½çš„å¯¹è±¡æ’å…¥å®¹å™¨ã€‚</p><p>è¿™ç§å°±åœ°æ„é€ çš„æ–¹å¼å¯ä»¥é¿å…é¢å¤–çš„æ‹·è´æˆ–ç§»åŠ¨æ“ä½œï¼Œæé«˜ä»£ç çš„æ•ˆç‡ã€‚å®ƒå¯¹äºå¤§å‹å¯¹è±¡æˆ–è€…ä¸å¯å¤åˆ¶/ç§»åŠ¨çš„å¯¹è±¡ç‰¹åˆ«æœ‰ç”¨ã€‚</p><hr><h3 id="æ³¨ï¼šå…³äºå“ˆå¸Œè¡¨"><a href="#æ³¨ï¼šå…³äºå“ˆå¸Œè¡¨" class="headerlink" title="æ³¨ï¼šå…³äºå“ˆå¸Œè¡¨"></a>æ³¨ï¼šå…³äºå“ˆå¸Œè¡¨</h3><p>ç»Ÿè®¡å‡ºç°æ¬¡æ•°(æ—¶é—´å¤æ‚åº¦$O(1)$)ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">position.<span class="built_in">count</span>(s[i]);</span><br></pre></td></tr></table></figure><p>å†…éƒ¨å®šä¹‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">unordered_map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; mp = &#123;</span><br><span class="line">        &#123;<span class="string">&#x27;I&#x27;</span>, <span class="number">1</span>&#125;,  </span><br><span class="line">        &#123;<span class="string">&#x27;V&#x27;</span>, <span class="number">5</span>&#125;,   </span><br><span class="line">        &#123;<span class="string">&#x27;X&#x27;</span>, <span class="number">10</span>&#125;,   </span><br><span class="line">        &#123;<span class="string">&#x27;L&#x27;</span>, <span class="number">50</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;C&#x27;</span>, <span class="number">100</span>&#125;, </span><br><span class="line">        &#123;<span class="string">&#x27;D&#x27;</span>, <span class="number">500</span>&#125;, </span><br><span class="line">        &#123;<span class="string">&#x27;M&#x27;</span>, <span class="number">1000</span>&#125;,</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><p>éå†å…ƒç´ ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span>&amp; [_, pos] : position) &#123;</span><br><span class="line">     <span class="keyword">if</span> (pos != <span class="number">-1</span>) &#123;</span><br><span class="line">          first = <span class="built_in">min</span>(first, pos);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä½¿ç”¨äº† C++17 ä¸­çš„ç»“æ„åŒ–ç»‘å®šï¼ˆstructured bindingsï¼‰è¯­æ³•ï¼Œç”¨äºéå†åä¸º <code>position</code> çš„å®¹å™¨ä¸­çš„å…ƒç´ ã€‚éå†çš„é¡ºåºå¹¶ä¸æ˜¯unordered_mapä¸­å…ƒç´ çš„æ’å…¥é¡ºåºï¼Œç”±äºunordered_map<mark>æ²¡æœ‰ä¿è¯</mark>å…ƒç´ çš„æ’å…¥é¡ºåºï¼Œéå†é¡ºåºä¸ºä¹±åºï¼Œä»è€Œå½±å“ç»“æœã€‚è¿™æ˜¯å› ä¸º <code>std::unordered_map</code> ä½¿ç”¨å“ˆå¸Œè¡¨å®ç°ï¼Œå…ƒç´ çš„å­˜å‚¨ä½ç½®æ˜¯æ ¹æ®å“ˆå¸Œå€¼è®¡ç®—å¾—åˆ°çš„ï¼Œè€Œä¸æ˜¯æŒ‰ç…§æ’å…¥é¡ºåºæˆ–å…¶ä»–ç‰¹å®šé¡ºåºã€‚</p><p>åœ¨æ¯æ¬¡å¾ªç¯è¿­ä»£ä¸­ï¼Œ<code>auto&amp; [_, pos]</code> å°†å®¹å™¨ä¸­çš„é”®å€¼å¯¹è§£æ„ä¸ºä¸¤ä¸ªå˜é‡ <code>_</code> å’Œ <code>pos</code>ã€‚è¿™é‡Œä½¿ç”¨ <code>_</code> è¡¨ç¤º<u>ä¸éœ€è¦ä½¿ç”¨</u>çš„å˜é‡ï¼Œè€Œ <code>pos</code> åˆ™è¡¨ç¤ºå®¹å™¨ä¸­çš„å€¼ã€‚</p><p>è¿™ä¸¤ä¸ªforå¾ªç¯ç­‰ä»·ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span>&amp; [_,strArray]:mp)&#123;</span><br><span class="line">    res.<span class="built_in">emplace_back</span>(strArray);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = mp.<span class="built_in">begin</span>(); it != mp.<span class="built_in">end</span>(); ++it) &#123;</span><br><span class="line">     res.<span class="built_in">emplace_back</span>(it-&gt;second);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨ï¼šunordered_map&lt;string, vector&lt;string&gt;&gt; mp;</span></span><br><span class="line"><span class="comment">//vector&lt;vector&lt;string&gt;&gt; res;è¯¦ç»†å¯è§49é¢˜</span></span><br></pre></td></tr></table></figure><p>å“ˆå¸Œè¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹ä¸ºpair</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">unordered_map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line">vector&lt;pair&lt;<span class="type">char</span>, <span class="type">int</span>&gt;&gt; cnt;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span>&amp; it : mp) &#123; <span class="comment">// itçš„ç±»å‹æ˜¯pair&lt;char,int&gt;</span></span><br><span class="line">     cnt.<span class="built_in">emplace_back</span>(it);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰æ¯”è¾ƒæ–¹æ³•(è¿™é‡Œsecondå€¼å¤§çš„æ’åœ¨å‰é¢)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span>(cnt.<span class="built_in">begin</span>(), cnt.<span class="built_in">end</span>(),</span><br><span class="line">     [](<span class="type">const</span> pair&lt;<span class="type">char</span>, <span class="type">int</span>&gt;&amp; a, <span class="type">const</span> pair&lt;<span class="type">char</span>, <span class="type">int</span>&gt;&amp; b) &#123;</span><br><span class="line">         <span class="keyword">return</span> a.second &gt; b.second;</span><br><span class="line">     &#125;);</span><br></pre></td></tr></table></figure><hr><h2 id="5-2-å­—ç¬¦ä¸²æ‰¾ä¸åŒï¼š389ã€242"><a href="#5-2-å­—ç¬¦ä¸²æ‰¾ä¸åŒï¼š389ã€242" class="headerlink" title="5-2.å­—ç¬¦ä¸²æ‰¾ä¸åŒï¼š389ã€242"></a>5-2.å­—ç¬¦ä¸²æ‰¾ä¸åŒï¼š389ã€242</h2><p>ä¸€ã€è®¡æ•°ï¼šé¦–å…ˆéå†å­—ç¬¦ä¸² sï¼Œå¯¹å…¶ä¸­çš„æ¯ä¸ªå­—ç¬¦éƒ½å°†è®¡æ•°å€¼åŠ  1ï¼›ç„¶åéå†å­—ç¬¦ä¸² tï¼Œå¯¹å…¶ä¸­çš„æ¯ä¸ªå­—ç¬¦éƒ½å°†è®¡æ•°å€¼å‡ 1ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œä½†æ³•ä¸€ç©ºé—´å¤æ‚åº¦è¾ƒé«˜ã€‚(å¦‚æœæ˜¯Unicodeå­—ç¬¦å°±è€è€å®å®ç”¨è¿™ç§æ–¹æ³•)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">char</span> <span class="title">findTheDifference</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = t.<span class="built_in">size</span>(), n1 = s.<span class="built_in">size</span>();</span><br><span class="line">        unordered_map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; count;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n1; i++) &#123;</span><br><span class="line">            count[t[i]]++;</span><br><span class="line">            count[s[i]]--;</span><br><span class="line">        &#125;</span><br><span class="line">        count[t[n - <span class="number">1</span>]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; [pos, cnt] : count) &#123;<span class="comment">//posæ˜¯key,cntæ˜¯å€¼ã€‚éƒ½ç”¨åˆ°äº†ä¸èƒ½å†™ä¸º_</span></span><br><span class="line">            <span class="keyword">if</span> (cnt != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> pos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>äºŒã€æ±‚å’Œ:å°†å­—ç¬¦ä¸² s ä¸­æ¯ä¸ªå­—ç¬¦çš„ ASCII ç çš„å€¼æ±‚å’Œï¼Œå¾—åˆ° $A_s$â€‹ï¼›å¯¹å­—ç¬¦ä¸² t åŒæ ·çš„æ–¹æ³•å¾—åˆ° $A_t$ã€‚ä¸¤è€…çš„å·®å€¼ $A_t-A_s$â€‹ å³ä»£è¡¨äº†è¢«æ·»åŠ çš„å­—ç¬¦ã€‚</p><p>ä¸‰ã€<mark>ä½è¿ç®—</mark>:å°†ä¸¤ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™é—®é¢˜è½¬æ¢æˆæ±‚å­—ç¬¦ä¸²ä¸­å‡ºç°<u>å¥‡æ•°æ¬¡</u>çš„å­—ç¬¦ã€‚(136é¢˜ä¹Ÿæ˜¯ä½è¿ç®—ï¼Œç”¨åˆ°äº†å¼‚æˆ–<code>^</code>)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">char</span> <span class="title">findTheDifference</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> ch: s) &#123;</span><br><span class="line">            ret ^= ch;<span class="comment">//å¼‚æˆ–è¿ç®—æ—¶chä¼šå…ˆè¢«è½¬æ¢æˆASCIIç (æ­¤å¤„ä¸ºintå‹)</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> ch: t) &#123;</span><br><span class="line">            ret ^= ch;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å› ä¸ºåœ¨så’Œtä¹‹ä¸­éƒ½å‡ºç°çš„ch,åœ¨å¼‚æˆ–è¿ç®—ä¹‹åå˜æˆäº†0ï¼Œç›¸å½“äº<code>ret^s[0]^s[1]...^t[0]^t[1]...=0^(s[0]^t[0])^(s[1]^t[1])^...^t[more]=0^0^0^...^0^t[more]=t[more].</code></p><p>(è¿™é‡Œå‡è®¾s[0]==t[0],s[1]==t[1]â€¦)</p><p>å®¹å™¨è§’åº¦ä¸€èˆ¬çš„ä¼˜åŒ–æ€è·¯ã€‚å®Œæ•´çš„æ˜¯å¤šå®¹å™¨-&gt;å¤šæ¬¡æ–°å»ºå®¹å™¨-&gt;å•å®¹å™¨-&gt;æ•°ç»„-&gt;äºŒè¿›åˆ¶ä½ã€‚</p><h2 id="5-3-å­—æ¯å¼‚ä½è¯åˆ†ç»„ï¼š49"><a href="#5-3-å­—æ¯å¼‚ä½è¯åˆ†ç»„ï¼š49" class="headerlink" title="5-3.å­—æ¯å¼‚ä½è¯åˆ†ç»„ï¼š49"></a>5-3.å­—æ¯å¼‚ä½è¯åˆ†ç»„ï¼š49</h2><p>æ³•ä¸€ï¼šæ’åº(ç”±äºäº’ä¸ºå­—æ¯å¼‚ä½è¯çš„ä¸¤ä¸ªå­—ç¬¦ä¸²åŒ…å«çš„å­—æ¯ç›¸åŒï¼Œå› æ­¤å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²åˆ†åˆ«è¿›è¡Œæ’åºä¹‹åå¾—åˆ°çš„å­—ç¬¦ä¸²ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œæ•…å¯ä»¥å°†<strong>æ’åºä¹‹åçš„å­—ç¬¦ä¸²ä½œä¸ºå“ˆå¸Œè¡¨çš„é”®</strong>ã€‚)å¯ä»¥ä¸ç”¨sort()æ¥æ’åºä»¥èŠ‚çœæ—¶é—´å¼€é”€ï¼Œä½†æ˜¯å¯èƒ½å¢åŠ ç©ºé—´å¼€é”€ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;string&gt;&gt; <span class="built_in">groupAnagrams</span>(vector&lt;string&gt;&amp; strs) &#123;</span><br><span class="line">        unordered_map&lt;string, vector&lt;string&gt;&gt; mp;</span><br><span class="line">        <span class="keyword">for</span> (string&amp; str : strs) &#123;</span><br><span class="line">            string key = str;</span><br><span class="line">            <span class="built_in">sort</span>(key.<span class="built_in">begin</span>(), key.<span class="built_in">end</span>());</span><br><span class="line">            mp[key].<span class="built_in">emplace_back</span>(str);</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;vector&lt;string&gt;&gt; res;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> it = mp.<span class="built_in">begin</span>(); it != mp.<span class="built_in">end</span>(); it++) &#123;</span><br><span class="line">            res.<span class="built_in">emplace_back</span>(it-&gt;second);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šè®¡æ•°(å°†æ¯ä¸ªå­—æ¯å‡ºç°çš„æ¬¡æ•°ä½¿ç”¨å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œä½œä¸ºå“ˆå¸Œè¡¨çš„é”®ã€‚æ—¶é—´å¤æ‚åº¦æ›´ä½ï¼Œç©ºé—´å¤æ‚åº¦æ›´é«˜)</p><h2 id="5-4-æ ¹æ®å­—ç¬¦ä¸²å‡ºç°é¢‘ç‡æ’åºï¼š451"><a href="#5-4-æ ¹æ®å­—ç¬¦ä¸²å‡ºç°é¢‘ç‡æ’åºï¼š451" class="headerlink" title="5-4.æ ¹æ®å­—ç¬¦ä¸²å‡ºç°é¢‘ç‡æ’åºï¼š451"></a>5-4.æ ¹æ®å­—ç¬¦ä¸²å‡ºç°é¢‘ç‡æ’åºï¼š451</h2><p>æ¡¶æ’åºï¼šé€Ÿåº¦æ¯”sort()å¿«</p><p>1.éå†å­—ç¬¦ä¸²ï¼Œç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°çš„é¢‘ç‡ï¼ŒåŒæ—¶è®°å½•æœ€é«˜é¢‘ç‡ maxFreqï¼›</p><p>2.åˆ›å»ºæ¡¶ï¼Œå­˜å‚¨ä» 1 åˆ° maxFreq çš„æ¯ä¸ªå‡ºç°é¢‘ç‡çš„å­—ç¬¦ï¼›</p><p>3.æŒ‰ç…§å‡ºç°é¢‘ç‡ä»å¤§åˆ°å°çš„é¡ºåºéå†æ¡¶ï¼Œå¯¹äºæ¯ä¸ªå‡ºç°é¢‘ç‡ï¼Œè·å¾—å¯¹åº”çš„å­—ç¬¦ï¼Œç„¶åå°†æ¯ä¸ªå­—ç¬¦æŒ‰ç…§å‡ºç°é¢‘ç‡æ‹¼æ¥åˆ°æ’åºåçš„å­—ç¬¦ä¸²ã€‚</p><h2 id="5-5-æ±‚è¿ç»­é€’å¢å­ä¸²çš„ä¸ªæ•°ï¼Œå¹¶å»é‡ï¼š467"><a href="#5-5-æ±‚è¿ç»­é€’å¢å­ä¸²çš„ä¸ªæ•°ï¼Œå¹¶å»é‡ï¼š467" class="headerlink" title="5-5.æ±‚è¿ç»­é€’å¢å­ä¸²çš„ä¸ªæ•°ï¼Œå¹¶å»é‡ï¼š467"></a>5-5.æ±‚è¿ç»­é€’å¢å­ä¸²çš„ä¸ªæ•°ï¼Œå¹¶å»é‡ï¼š467</h2><p>åŠ¨æ€è§„åˆ’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findSubstringInWraproundString</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dp</span><span class="params">(<span class="number">26</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &amp;&amp; (s[i] - s[i - <span class="number">1</span>] + <span class="number">26</span>) % <span class="number">26</span> == <span class="number">1</span>) &#123; <span class="comment">// s[i-1]åœ¨s[i]å‰é¢</span></span><br><span class="line">                k++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                k = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            dp[s[i] - <span class="string">&#x27;a&#x27;</span>] = <span class="built_in">max</span>(dp[s[i] - <span class="string">&#x27;a&#x27;</span>], k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">accumulate</span>(dp.<span class="built_in">begin</span>(), dp.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="5-6-URLçš„è§£å¯†ä¸åŠ å¯†ï¼š535"><a href="#5-6-URLçš„è§£å¯†ä¸åŠ å¯†ï¼š535" class="headerlink" title="5-6.URLçš„è§£å¯†ä¸åŠ å¯†ï¼š535"></a>5-6.URLçš„è§£å¯†ä¸åŠ å¯†ï¼š535</h2><p>å¦‚æœæƒ³è¦å®ç°ç›¸åŒçš„ URL åŠ å¯†æˆåŒä¸€ä¸ª TinyURLï¼Œåˆ™é¢å¤–ä¿å­˜ä¸€ä¸ªä» URLåˆ° TinyURL çš„æ˜ å°„ã€‚</p><p>æ³¨ï¼šint-&gt;string:<code>to_string(intVar);</code></p><p>string-&gt;int:<code>stoi(stringVar);</code></p><h3 id="å…³äºéšæœºæ•°"><a href="#å…³äºéšæœºæ•°" class="headerlink" title="å…³äºéšæœºæ•°"></a>å…³äºéšæœºæ•°</h3><p><code>time(0)</code>å‡½æ•°è¿”å›å½“å‰çš„ç³»ç»Ÿæ—¶é—´ï¼ˆä»æŸä¸€æ—¶åˆ»å¼€å§‹çš„ç§’æ•°ï¼‰ï¼Œè€Œ<code>srand</code>å‡½æ•°æ˜¯ç”¨æ¥è®¾ç½®éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ã€‚å°†<code>time(0)</code>çš„è¿”å›å€¼ä¼ é€’ç»™<code>srand</code>å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å½“å‰æ—¶é—´ä½œä¸ºéšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ï¼Œä»è€Œä½¿å¾—æ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶ç”Ÿæˆçš„éšæœºæ•°åºåˆ—éƒ½ä¸åŒã€‚</p><p>åœ¨C++ä¸­ï¼Œé€šå¸¸åœ¨ä½¿ç”¨éšæœºæ•°ç”Ÿæˆå‡½æ•°<code>rand</code>ä¹‹å‰ï¼Œä¼šè°ƒç”¨<code>srand(time(0))</code>æ¥<u>åˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨</u>ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶éƒ½ä¼šç”Ÿæˆä¸åŒçš„éšæœºæ•°åºåˆ—ï¼Œå› ä¸ºç§å­ä¸åŒä¼šå¯¼è‡´ä¸åŒçš„éšæœºæ•°åºåˆ—ã€‚ä¹‹åå°±å¯ä»¥ä½¿ç”¨<code>randomNumber=rand();</code></p>]]></content>
    
    
    <summary type="html">å­—ç¬¦ä¸²åŸºç¡€éƒ¨åˆ†</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="string" scheme="https://sumikiru.top/tags/string/"/>
    
  </entry>
  
  <entry>
    <title>1.æ•°ç»„ç¯‡</title>
    <link href="https://sumikiru.top/posts/254d58d4.html"/>
    <id>https://sumikiru.top/posts/254d58d4.html</id>
    <published>2024-04-05T18:47:50.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<p>æ•°ç»„çš„éå†:414</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">thirdMax</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//sort(nums.begin(),nums.end(),greater&lt;&gt;());//ä»å¤§åˆ°å°æ’åº</span></span><br><span class="line">        <span class="comment">//ä½¿ç”¨äº†setå°±æ²¡æœ‰å¿…è¦sort()ï¼Œæ’åºéœ€è¦ O(nlogâ¡n)çš„æ—¶é—´</span></span><br><span class="line">        set&lt;<span class="type">int</span>&gt;s;<span class="comment">//setä¼šè‡ªåŠ¨ä»å°åˆ°å¤§æ’åºï¼ˆé»˜è®¤æ—¶ï¼‰,ä¸€ä¸ªå…ƒç´ åªèƒ½å‡ºç°ä¸€æ¬¡</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> num:nums)&#123;</span><br><span class="line">            s.<span class="built_in">insert</span>(num);<span class="comment">//setè‡ªåŠ¨å»é‡</span></span><br><span class="line">            <span class="keyword">if</span>(s.<span class="built_in">size</span>()&gt;<span class="number">3</span>)&#123;</span><br><span class="line">                s.<span class="built_in">erase</span>(s.<span class="built_in">begin</span>());<span class="comment">//æ³¨æ„s.begin()æ˜¯è¿­ä»£å™¨ç±»å‹</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.<span class="built_in">size</span>()==<span class="number">3</span>?*s.<span class="built_in">begin</span>():*s.<span class="built_in">rbegin</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»Ÿè®¡æ•°ç»„ä¸­çš„å…ƒç´ ï¼š645(å“ˆå¸Œè¡¨è§£æ³•)ã€‚å…³é”®æ€æƒ³:<strong>åŸåœ°å“ˆå¸Œ</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">findErrorNums</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;<span class="built_in">res</span>(<span class="number">2</span>);</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; num:nums)&#123;    <span class="comment">//éœ€è¦åˆ©ç”¨è¿­ä»£å™¨è¿›è¡Œéå†</span></span><br><span class="line">            mp[num]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=nums.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="type">int</span> count=mp[i];</span><br><span class="line">            <span class="keyword">if</span>(count==<span class="number">2</span>)&#123;</span><br><span class="line">                res[<span class="number">0</span>]=i;<span class="comment">//é‡å¤çš„æ•°å­—</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(count==<span class="number">0</span>)&#123;</span><br><span class="line">                res[<span class="number">1</span>]=i;<span class="comment">//ç¼ºå¤±çš„æ•°å­—</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>éš¾é¢˜ï¼š41</p><p>äºŒåˆ†æœç´¢ï¼š274</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">hIndex</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; citations)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åŒæŒ‡é’ˆï¼ŒäºŒåˆ†æœç´¢</span></span><br><span class="line">        <span class="type">int</span> left = <span class="number">0</span>, right = citations.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> mid = <span class="number">0</span>, count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            mid = (left + right + <span class="number">1</span>) / <span class="number">2</span>;<span class="comment">//åŠ 1é˜²æ­¢æ­»å¾ªç¯</span></span><br><span class="line">            count = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; citations.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (citations[i] &gt;= mid) &#123;</span><br><span class="line">                    count++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (count &gt;= mid) &#123;</span><br><span class="line">                left = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼minçš„å‡½æ•°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> minNum = *<span class="built_in">min_element</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());</span><br></pre></td></tr></table></figure><p>æ‰«æï¼š419</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countBattleships</span><span class="params">(vector&lt;vector&lt;<span class="type">char</span>&gt;&gt;&amp; board)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> row = board.<span class="built_in">size</span>(), col = board[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; row; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; col; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (board[i][j] == <span class="string">&#x27;X&#x27;</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((i &gt;= <span class="number">1</span> &amp;&amp; board[i - <span class="number">1</span>][j] == <span class="string">&#x27;X&#x27;</span>) ||</span><br><span class="line">                        (j &gt;= <span class="number">1</span> &amp;&amp; board[i][j - <span class="number">1</span>] == <span class="string">&#x27;X&#x27;</span>)) &#123;</span><br><span class="line">                        <span class="comment">//å¦‚æœå‘ç°å…¶ä¸Šæ–¹æˆ–è€…å·¦è¾¹æœ‰è¿‡X,åˆ™ç»§ç»­å‘å³ä¸‹æ‰«æ</span></span><br><span class="line">                        <span class="comment">//æ­¤æ—¶resä¸å¢åŠ ï¼Œç›´æ¥continueè¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯</span></span><br><span class="line">                        <span class="comment">//ç›´åˆ°ç¡®å®èµ°åˆ°å°½å¤´æ‰ä¼šç»“æŸï¼Œç„¶åè®¡æ•°+1</span></span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    res++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿­ä»£ï¼š396</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;climits&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;numeric&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxRotateFunction</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>(), res = INT_MIN, Fk = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> sum = <span class="built_in">accumulate</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            Fk += i * nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        res = Fk; <span class="comment">//ä¹Ÿå°±æ˜¯è®©res=F(0)ï¼Œé¿å…numsåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶return INT_MIN</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">            Fk += sum - n * nums[i];</span><br><span class="line">            res = <span class="built_in">max</span>(res, Fk);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿï¼š54ã€59</p><p>å¯¹è§’çº¿éå†498ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m + n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="type">int</span> x = (i &lt; n ? <span class="number">0</span> : i - n + <span class="number">1</span>);</span><br><span class="line">                <span class="type">int</span> y = (i &lt; n ? i : n - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">while</span> (x &lt; m &amp;&amp; y &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    res.<span class="built_in">emplace_back</span>(mat[x][y]);</span><br><span class="line">                    x++;</span><br><span class="line">                    y--; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> x = (i &lt; m ? i : m - <span class="number">1</span>);</span><br><span class="line">                <span class="type">int</span> y = (i &lt; m ? <span class="number">0</span> : i - m + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">while</span> (x &gt;= <span class="number">0</span> &amp;&amp; y &lt; n) &#123;</span><br><span class="line">                    res.<span class="built_in">emplace_back</span>(mat[x][y]);</span><br><span class="line">                    x--;</span><br><span class="line">                    y++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨é€‰æ‹©ä½¿ç”¨ <code>emplace_back</code> è¿˜æ˜¯ <code>push_back</code> æ—¶ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œ<code>emplace_back</code> æ›´å¥½ä¸€äº›ã€‚è¿™æ˜¯å› ä¸º <code>emplace_back</code> å¯ä»¥é¿å…åˆ›å»ºä¸´æ—¶å¯¹è±¡ï¼Œä»è€Œæé«˜äº†æ€§èƒ½ã€‚</p><p>å¦å¤–ï¼Œ<code>emplace_back</code> ä¹Ÿæ›´åŠ çµæ´»ï¼Œå› ä¸ºå®ƒå…è®¸ä½ ç›´æ¥ä¼ é€’æ„é€ å…ƒç´ æ‰€éœ€çš„å‚æ•°ï¼Œè€Œä¸éœ€è¦æ˜¾å¼åœ°åˆ›å»ºå¯¹è±¡ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå¦‚æœä½ éœ€è¦å‘ <code>vector</code> ä¸­æ·»åŠ æ–°å…ƒç´ ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ <code>emplace_back</code>ã€‚</p><p>äºŒç»´æ•°ç»„å˜æ¢è¡Œåˆ—é•¿å®½ï¼š566</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> m = mat.<span class="built_in">size</span>(), n = mat[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m * n; i++) &#123;</span><br><span class="line">     res[i / c][i % c] =mat[i / n][i % n]; </span><br><span class="line">     <span class="comment">//æ‰¾åˆ°ç¬¬iä¸ªæ•°åˆ°åº•åˆ†åˆ«åœ¨æ•°ç»„çš„å“ªä¸ªä½ç½®</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äºŒç»´çŸ©é˜µé¡ºæ—¶é’ˆæ—‹è½¬ï¼ˆ48ï¼‰=<code>æ°´å¹³</code>ç¿»è½¬(ç«–ç›´çº¿å¯¹ç§°ç¿»è½¬)+(æ²¿)<code>ä¸»å¯¹è§’</code>çº¿ç¿»è½¬</p><p><u>çŸ©é˜µåŸåœ°ç½®æ¢(73)</u>ï¼šç”¨çŸ©é˜µç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—ä»£æ›¿æ ‡è®°è¡Œå’Œåˆ—çš„ä¸¤ä¸ªæ ‡è®°æ•°ç»„ï¼Œä½¿å¾—ç©ºé—´å¤æ‚åº¦ä¸º$O(1)$ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(row*col)$.ä½†è¿™æ ·ä¼šå¯¼è‡´åŸæ•°ç»„çš„ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—è¢«ä¿®æ”¹ï¼Œæ— æ³•è®°å½•å®ƒä»¬æ˜¯å¦åŸæœ¬åŒ…å« 0ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦é¢å¤–ä½¿ç”¨ä¸¤ä¸ªæ ‡è®°å˜é‡åˆ†åˆ«è®°å½•ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—æ˜¯å¦åŸæœ¬åŒ…å« 0ã€‚</p><p>   åœ¨å®é™…ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆé¢„å¤„ç†å‡ºä¸¤ä¸ªæ ‡è®°å˜é‡ï¼Œæ¥ç€ä½¿ç”¨å…¶ä»–è¡Œä¸åˆ—å»å¤„ç†ç¬¬ä¸€è¡Œä¸ç¬¬ä¸€åˆ—ï¼Œç„¶ååè¿‡æ¥ä½¿ç”¨ç¬¬ä¸€è¡Œä¸ç¬¬ä¸€åˆ—å»æ›´æ–°å…¶ä»–è¡Œä¸åˆ—ï¼Œæœ€åä½¿ç”¨ä¸¤ä¸ªæ ‡è®°å˜é‡æ›´æ–°ç¬¬ä¸€è¡Œä¸ç¬¬ä¸€åˆ—å³å¯ã€‚</p><pre><code>æˆ‘ä»¬å¯ä»¥å¯¹æ–¹æ³•äºŒè¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œåªä½¿ç”¨ä¸€ä¸ªæ ‡è®°å˜é‡è®°å½•ç¬¬ä¸€åˆ—æ˜¯å¦åŸæœ¬å­˜åœ¨ 0ã€‚è¿™æ ·ï¼Œç¬¬ä¸€åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ å³å¯ä»¥æ ‡è®°ç¬¬ä¸€è¡Œæ˜¯å¦å‡ºç° 0ã€‚ä½†ä¸ºäº†é˜²æ­¢æ¯ä¸€åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¢«æå‰æ›´æ–°ï¼Œæˆ‘ä»¬éœ€è¦ä»æœ€åä¸€è¡Œå¼€å§‹ï¼Œå€’åºåœ°å¤„ç†çŸ©é˜µå…ƒç´ ã€‚</code></pre><p><u>çŸ©é˜µåŸåœ°ç½®æ¢æ‹“å±•(289)</u>ï¼šåˆ›å»ºå¤åˆçŠ¶æ€2ï¼Œå¯ä»¥çŸ¥é“ä¿®æ”¹å‰æ˜¯0ï¼Œè€Œä¹‹åå˜ä¸º1.å¸¸ç”¨äºéœ€è¦åŒæ­¥æ›´æ–°æƒ…å†µã€‚</p><p>æ¶‰åŠåˆ°ç±»ï¼š303</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NumArray</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; sum;</span><br><span class="line">    <span class="built_in">NumArray</span>(vector&lt;<span class="type">int</span>&gt;&amp; nums) &#123; <span class="comment">//åˆå§‹åŒ–sumæ•°ç»„</span></span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        sum.<span class="built_in">resize</span>(n + <span class="number">1</span>); <span class="comment">//æ³¨æ„</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sum[i + <span class="number">1</span>] = sum[i] + nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sumRange</span><span class="params">(<span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//é”™è¯¯ï¼šnumsæ˜¯ä¸´æ—¶æ•°ç»„ï¼Œåº”è¯¥ç”¨sum</span></span><br><span class="line">        <span class="comment">// return accumulate(nums.begin() + left, nums.begin() + right, 0);</span></span><br><span class="line">        <span class="keyword">return</span> sum[right + <span class="number">1</span>] - sum[left];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>äºŒç»´æ•°ç»„resize:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sums.<span class="built_in">resize</span>(m + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n + <span class="number">1</span>));</span><br></pre></td></tr></table></figure><p>äºŒç»´æ•°ç»„å®šä¹‰ï¼š(åˆ›å»ºnÃ—nçš„æ•°ç»„ï¼Œé»˜è®¤åˆå§‹åŒ–æ‰€æœ‰å…ƒç´ ä¸º0)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">res</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n));</span><br></pre></td></tr></table></figure><p>å‰ç¼€/åç¼€ä¹‹å’Œ/ä¹‹ç§¯ï¼š238</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">productExceptSelf</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">res</span><span class="params">(nums.size())</span></span>;</span><br><span class="line">        res[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            res[i]=res[i<span class="number">-1</span>]*nums[i<span class="number">-1</span>];<span class="comment">//å…ˆç”¨reså­˜å‚¨å‰ç¼€ä¹‹ç§¯</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> r=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=nums.<span class="built_in">size</span>()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            res[i]=res[i]*r;<span class="comment">//æ›´æ–°res,res[i]æœ€ç»ˆåº”ä¸ºnums[i]çš„å‰ç¼€ä¹‹ç§¯Ã—åç¼€ä¹‹ç§¯</span></span><br><span class="line">            r*=nums[i];<span class="comment">//ç”¨Rå­˜å‚¨å½“å‰å¯¹åº”å…ƒç´ çš„åç¼€ä¹‹ç§¯</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æ•°ç»„çš„å¸¸è§ç”¨æ³•ä¸å®æˆ˜</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
    <category term="æ•°ç»„" scheme="https://sumikiru.top/tags/%E6%95%B0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>0.å¸¸ç”¨çš„C++ STLç”¨æ³•</title>
    <link href="https://sumikiru.top/posts/123456.html"/>
    <id>https://sumikiru.top/posts/123456.html</id>
    <published>2024-04-05T14:37:04.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    <content type="html"><![CDATA[<p>è½¬è½½è‡ªgithub.</p><p><strong>C++ æ ‡å‡†æ¨¡æ¿åº“ (STL, Standard Template Library)</strong>ï¼šåŒ…å«ä¸€äº›å¸¸ç”¨æ•°æ®ç»“æ„ä¸ç®—æ³•çš„æ¨¡æ¿çš„ C++ è½¯ä»¶åº“ã€‚å…¶åŒ…å«å››ä¸ªç»„ä»¶â€”â€”ç®—æ³• (Algorithms)ã€å®¹å™¨ (Containers)ã€ä»¿å‡½æ•° (Functors)ã€è¿­ä»£å™¨ (Iterators).</p><span id="more"></span><p>ç¤ºä¾‹ï¼š</p><ul><li>ç®—æ³•ï¼š<code>sort(a.begin(), a.end())</code></li><li>å®¹å™¨ï¼š<code>priority_queue&lt;int&gt; pque</code></li><li>ä»¿å‡½æ•°ï¼š<code>greater&lt;int&gt;()</code></li><li>è¿­ä»£å™¨ï¼š<code>vector&lt;int&gt;::iterator it = a.begin()</code></li></ul><h1 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1 å‰è¨€"></a>1 å‰è¨€</h1><p>STL ä½œä¸ºä¸€ä¸ªå°è£…è‰¯å¥½ï¼Œæ€§èƒ½åˆæ ¼çš„ C++ æ ‡å‡†åº“ï¼Œåœ¨ç®—æ³•ç«èµ›ä¸­è¿ç”¨æå…¶å¸¸è§ã€‚çµæ´»ä¸”æ­£ç¡®ä½¿ç”¨ STL å¯ä»¥èŠ‚çœéå¸¸å¤šè§£é¢˜æ—¶é—´ï¼Œè¿™ä¸€ç‚¹ä¸ä»…æ˜¯ç”±äºå¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œè¿˜æ˜¯å› ä¸ºå®ƒå°è£…è‰¯å¥½ï¼Œå¯ä»¥è®©ä»£ç çš„å¯è¯»æ€§å˜é«˜ï¼Œè§£é¢˜æ€è·¯æ›´æ¸…æ™°ï¼Œè°ƒè¯•è¿‡ç¨‹ <del>å¾€å¾€</del> æ›´é¡ºåˆ©ã€‚</p><p>ä¸è¿‡ STL æ¯•ç«Ÿä½¿ç”¨äº†å¾ˆå¤šå¤æ‚çš„ç»“æ„æ¥å®ç°ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå®ƒçš„æ•ˆç‡å¾€å¾€æ˜¯æ¯”ä¸ä¸Šè‡ªå·±æ‰‹æ“é’ˆå¯¹ç‰¹å®šé¢˜ç›®çš„æ•°æ®ç»“æ„ä¸ç®—æ³•çš„ã€‚å› æ­¤ï¼ŒSTL çš„ä½¿ç”¨ç›¸å½“äºä½¿ç”¨æ›´é•¿çš„è¿è¡Œæ—¶é—´æ¢å–æ›´é«˜çš„ç¼–ç¨‹æ•ˆç‡ã€‚å› æ­¤ï¼Œåœ¨å®é™…æ¯”èµ›ä¸­è¦æƒè¡¡ STL çš„åˆ©å¼Šï¼Œä¸è¿‡è¿™ä¸€ç‚¹å°±å¾—é ç»éªŒäº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šåˆ†äº«åœ¨ç®—æ³•ç«èµ›ä¸­å¸¸ç”¨çš„ STL å®¹å™¨å’Œç®—æ³•ï¼Œå¯¹äºå‡½æ•°å’Œè¿­ä»£å™¨ï¼Œå°±ä¸ç€é‡å±•å¼€è®²äº†ã€‚</p><h1 id="2-å¸¸ç”¨å®¹å™¨"><a href="#2-å¸¸ç”¨å®¹å™¨" class="headerlink" title="2 å¸¸ç”¨å®¹å™¨"></a>2 å¸¸ç”¨å®¹å™¨</h1><h2 id="2-1-å†…å®¹æ€»è§ˆ"><a href="#2-1-å†…å®¹æ€»è§ˆ" class="headerlink" title="2.1 å†…å®¹æ€»è§ˆ"></a>2.1 å†…å®¹æ€»è§ˆ</h2><p>æ‰“å‹¾çš„æ˜¯æœ¬æ¬¡å°†ä¼šè¯¦ç»†è®²è§£çš„ï¼ŒåŠ ç²—çš„æ˜¯ç®—æ³•ç«èµ›ä¸­æœ‰å¿…è¦å­¦ä¹ çš„ã€‚</p><ul><li><p>é¡ºåºå®¹å™¨</p><ul><li><p>[ ] <strong>array</strong></p></li><li><p>[x] <strong>vector</strong></p></li><li><p>[ ] <strong>deque</strong></p></li><li><p>[ ] forward_list</p></li><li><p>[ ] <strong>list</strong></p></li></ul></li><li><p>å…³è”å®¹å™¨</p><ul><li>[x] <strong>set</strong></li><li>[x] <strong>map</strong></li><li>[ ] <strong>multiset</strong></li><li>[ ] <strong>multimap</strong></li></ul></li><li><p>æ— åºå…³è”å®¹å™¨</p><ul><li>[ ] <strong>unordered_set</strong></li><li>[ ] <strong>unordered_map</strong></li><li>[ ] <strong>unordered_multiset</strong></li><li>[ ] <strong>unordered_multimap</strong></li></ul></li><li><p>å®¹å™¨é€‚é…å™¨</p><ul><li>[x] <strong>stack</strong></li><li>[x] <strong>queue</strong></li><li>[x] <strong>priority_queue</strong></li><li>[ ] flat_set</li><li>[ ] flat_map</li><li>[ ] flat_multiset</li><li>[ ] flat_multimap</li></ul></li><li><p>å­—ç¬¦ä¸²</p><ul><li>[x] <strong>string</strong> (basic_string\<char\>)</li></ul></li><li><p>å¯¹ä¸å…ƒç»„</p><ul><li>[x] <strong>pair</strong></li><li>[ ] <strong>tuple</strong></li></ul></li></ul><h2 id="2-2-å‘é‡-vector"><a href="#2-2-å‘é‡-vector" class="headerlink" title="2.2 å‘é‡ vector"></a>2.2 å‘é‡ <a href="https://zh.cppreference.com/w/cpp/container/vector">vector</a></h2><p><strong><code>#include &lt;vector&gt;</code></strong></p><p>è¿ç»­çš„é¡ºåºçš„å‚¨å­˜ç»“æ„ï¼ˆå’Œæ•°ç»„ä¸€æ ·çš„ç±»åˆ«ï¼‰ï¼Œä½†æ˜¯æœ‰é•¿åº¦å¯å˜çš„ç‰¹æ€§ã€‚</p><h3 id="2-2-1-å¸¸ç”¨æ–¹æ³•"><a href="#2-2-1-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.2.1 å¸¸ç”¨æ–¹æ³•"></a>2.2.1 å¸¸ç”¨æ–¹æ³•</h3><h4 id="æ„é€ "><a href="#æ„é€ " class="headerlink" title="æ„é€ "></a>æ„é€ </h4><p><strong><code>vector&lt;ç±»å‹&gt; arr(é•¿åº¦, [åˆå€¼])</code></strong></p><p>æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$</p><p>å¸¸ç”¨çš„ä¸€ç»´å’ŒäºŒç»´æ•°ç»„æ„é€ ç¤ºä¾‹ï¼Œé«˜ç»´ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼ˆå°±æ˜¯ä¼šæœ‰ç‚¹é•¿ï¼‰.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; arr;         <span class="comment">// æ„é€ intæ•°ç»„</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">arr</span><span class="params">(<span class="number">100</span>)</span></span>;    <span class="comment">// æ„é€ åˆå§‹é•¿100çš„intæ•°ç»„</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">arr</span><span class="params">(<span class="number">100</span>, <span class="number">1</span>)</span></span>; <span class="comment">// æ„é€ åˆå§‹é•¿100çš„intæ•°ç»„ï¼Œåˆå€¼ä¸º1</span></span><br><span class="line"></span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">mat</span>(<span class="number">100</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; ());       <span class="comment">// æ„é€ åˆå§‹100è¡Œï¼Œä¸æŒ‡å®šåˆ—æ•°çš„äºŒç»´æ•°ç»„</span></span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">mat</span>(<span class="number">100</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; (<span class="number">666</span>, <span class="number">-1</span>)) <span class="comment">// æ„é€ åˆå§‹100è¡Œï¼Œåˆå§‹666åˆ—çš„äºŒç»´æ•°ç»„ï¼Œåˆå€¼ä¸º-1</span></span><br></pre></td></tr></table></figure><p>æ„é€ äºŒç»´æ•°ç»„çš„å¥‡è‘©å†™æ³•ï¼Œåƒä¸‡åˆ«ç”¨ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; arr[<span class="number">100</span>];         <span class="comment">// æ­£ç¡®ï¼Œæ„é€ åˆå§‹100è¡Œï¼Œä¸æŒ‡å®šåˆ—æ•°çš„äºŒç»´æ•°ç»„ï¼Œå¯ç”¨äºé“¾å¼å‰å‘æ˜Ÿå­˜å›¾</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; arr[<span class="number">100</span>](<span class="number">100</span>, <span class="number">1</span>); <span class="comment">// è¯­æ³•é”™è¯¯ï¼</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">arr</span><span class="params">(<span class="number">100</span>, <span class="number">1</span>)</span>[100]</span>; <span class="comment">// è¯­æ³•é”™è¯¯ï¼</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; arr[<span class="number">100</span>] &#123;&#123;<span class="number">100</span>, <span class="number">1</span>&#125;, è¿™é‡Œçœç•¥<span class="number">98</span>ä¸ª ,&#123;<span class="number">100</span>, <span class="number">1</span>&#125;&#125;; <span class="comment">// æ­£ç¡®ä½†å¥‡è‘©ï¼Œä½¿ç”¨åˆ—è¡¨åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure><h4 id="å°¾æ¥-amp-å°¾åˆ "><a href="#å°¾æ¥-amp-å°¾åˆ " class="headerlink" title="å°¾æ¥ &amp; å°¾åˆ "></a>å°¾æ¥ &amp; å°¾åˆ </h4><ul><li><strong><code>.push_back(å…ƒç´ )</code></strong>ï¼šåœ¨ vector å°¾æ¥ä¸€ä¸ªå…ƒç´ ï¼Œæ•°ç»„é•¿åº¦ $+1$.</li><li><strong><code>.pop_back()</code></strong>ï¼šåˆ é™¤ vector å°¾éƒ¨çš„ä¸€ä¸ªå…ƒç´ ï¼Œæ•°ç»„é•¿åº¦ $-1$</li></ul><p>æ—¶é—´å¤æ‚åº¦ï¼šå‡æ‘Š $O(1)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// init: arr = []</span></span><br><span class="line">arr.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// after: arr = [1]</span></span><br><span class="line">arr.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line"><span class="comment">// after: arr = [1, 2]</span></span><br><span class="line">arr.<span class="built_in">pop_back</span>();</span><br><span class="line"><span class="comment">// after: arr = [1]</span></span><br><span class="line">arr.<span class="built_in">pop_back</span>();</span><br><span class="line"><span class="comment">// after: arr = []</span></span><br></pre></td></tr></table></figure><h4 id="ä¸­æ‹¬å·è¿ç®—ç¬¦"><a href="#ä¸­æ‹¬å·è¿ç®—ç¬¦" class="headerlink" title="ä¸­æ‹¬å·è¿ç®—ç¬¦"></a>ä¸­æ‹¬å·è¿ç®—ç¬¦</h4><p>å’Œä¸€èˆ¬æ•°ç»„ä¸€æ ·çš„ä½œç”¨</p><p>æ—¶é—´å¤æ‚åº¦ï¼š$O(1)$</p><h4 id="è·å–é•¿åº¦"><a href="#è·å–é•¿åº¦" class="headerlink" title="è·å–é•¿åº¦"></a>è·å–é•¿åº¦</h4><p><strong><code>.size()</code></strong></p><p>è·å–å½“å‰ vector çš„é•¿åº¦</p><p>æ—¶é—´å¤æ‚åº¦ï¼š$O(1)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arr.<span class="built_in">size</span>(); i++)</span><br><span class="line">    cout &lt;&lt; a[i] &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h4 id="æ¸…ç©º"><a href="#æ¸…ç©º" class="headerlink" title="æ¸…ç©º"></a>æ¸…ç©º</h4><p><strong><code>.clear()</code></strong></p><p>æ¸…ç©º vector</p><p>æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$</p><h4 id="åˆ¤ç©º"><a href="#åˆ¤ç©º" class="headerlink" title="åˆ¤ç©º"></a>åˆ¤ç©º</h4><p><strong><code>.empty()</code></strong></p><p>å¦‚æœæ˜¯ç©ºè¿”å› <code>true</code> åä¹‹è¿”å› <code>false</code>.</p><p>æ—¶é—´å¤æ‚åº¦ï¼š$O(1)$</p><h4 id="æ”¹å˜é•¿åº¦"><a href="#æ”¹å˜é•¿åº¦" class="headerlink" title="æ”¹å˜é•¿åº¦"></a>æ”¹å˜é•¿åº¦</h4><p><strong><code>.resize(æ–°é•¿åº¦, [é»˜è®¤å€¼])</code></strong></p><p>ä¿®æ”¹ vector çš„é•¿åº¦</p><ul><li>å¦‚æœæ˜¯ç¼©çŸ­ï¼Œåˆ™åˆ é™¤å¤šä½™çš„å€¼</li><li>å¦‚æœæ˜¯æ‰©å¤§ï¼Œä¸”æŒ‡å®šäº†é»˜è®¤å€¼ï¼Œåˆ™æ–°å…ƒç´ å‡ä¸ºé»˜è®¤å€¼<strong>ï¼ˆæ—§å…ƒç´ ä¸å˜ï¼‰</strong></li></ul><p>æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$</p><h3 id="2-2-2-é€‚ç”¨æƒ…å½¢"><a href="#2-2-2-é€‚ç”¨æƒ…å½¢" class="headerlink" title="2.2.2 é€‚ç”¨æƒ…å½¢"></a>2.2.2 é€‚ç”¨æƒ…å½¢</h3><p>ä¸€èˆ¬æƒ…å†µ <code>vector</code> å¯ä»¥æ›¿æ¢æ‰æ™®é€šæ•°ç»„ï¼Œé™¤éè¯¥é¢˜å¡å¸¸ã€‚</p><p>æœ‰äº›æƒ…å†µæ™®é€šæ•°ç»„æ²¡æ³•è§£å†³ï¼š$n\times m$ çš„çŸ©é˜µï¼Œ$1\leq n,m\leq 10^6$ ä¸” $n\times m \leq 10^6$</p><ul><li>å¦‚æœç”¨æ™®é€šæ•°ç»„ <code>int mat[1000010][1000010]</code>ï¼Œæµªè´¹å†…å­˜ï¼Œä¼šå¯¼è‡´ MLEã€‚</li><li>å¦‚æœä½¿ç”¨ <code>vector&lt;vector&lt;int&gt;&gt; mat(n + 10, vector&lt;int&gt; (m + 10))</code>ï¼Œå®Œç¾è§£å†³è¯¥é—®é¢˜ã€‚</li></ul><p>å¦å¤–ï¼Œ<code>vector</code> çš„æ•°æ®å‚¨å­˜åœ¨å †ç©ºé—´ä¸­ï¼Œä¸ä¼šçˆ†æ ˆã€‚</p><h3 id="2-2-3-æ³¨æ„äº‹é¡¹"><a href="#2-2-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.2.3 æ³¨æ„äº‹é¡¹"></a>2.2.3 æ³¨æ„äº‹é¡¹</h3><h4 id="æå‰æŒ‡å®šé•¿åº¦"><a href="#æå‰æŒ‡å®šé•¿åº¦" class="headerlink" title="æå‰æŒ‡å®šé•¿åº¦"></a>æå‰æŒ‡å®šé•¿åº¦</h4><p>å¦‚æœé•¿åº¦å·²ç»ç¡®å®šï¼Œé‚£ä¹ˆåº”å½“ç›´æ¥åœ¨æ„é€ å‡½æ•°æŒ‡å®šé•¿åº¦ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ª <code>.push_back()</code>. å› ä¸º <code>vector</code> é¢å¤–å†…å­˜è€—å°½åçš„é‡åˆ†é…æ˜¯æœ‰æ—¶é—´å¼€é”€çš„ï¼Œç›´æ¥æŒ‡å®šé•¿åº¦å°±ä¸ä¼šå‡ºç°é‡åˆ†é…äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼˜åŒ–å‰: 522ms</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; a;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1e8</span>; i++)</span><br><span class="line">    a.<span class="built_in">push_back</span>(i);</span><br><span class="line"><span class="comment">// ä¼˜åŒ–å: 259ms</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(<span class="number">1e8</span>)</span></span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++)</span><br><span class="line">    a[i] = i;</span><br></pre></td></tr></table></figure><h4 id="å½“å¿ƒ-size-t-æº¢å‡º"><a href="#å½“å¿ƒ-size-t-æº¢å‡º" class="headerlink" title="å½“å¿ƒ size_t æº¢å‡º"></a>å½“å¿ƒ size_t æº¢å‡º</h4><p>vector è·å–é•¿åº¦çš„æ–¹æ³• <code>.size()</code> è¿”å›å€¼ç±»å‹ä¸º <code>size_t</code>ï¼Œé€šå¸¸ OJ å¹³å°ä½¿ç”¨çš„æ˜¯ 32 ä½ç¼–è¯‘å™¨ï¼ˆæœ‰äº›å¹³å°ä¾‹å¦‚ cf å¯é€‰ 64 ä½ï¼‰ï¼Œé‚£ä¹ˆè¯¥ç±»å‹èŒƒå›´ä¸º $[0,2^{32})$.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(<span class="number">65536</span>)</span></span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> a = a.<span class="built_in">size</span>() * a.<span class="built_in">size</span>(); <span class="comment">// ç›´æ¥æº¢å‡ºå˜æˆ0äº†</span></span><br></pre></td></tr></table></figure><h2 id="2-3-æ ˆ-stack"><a href="#2-3-æ ˆ-stack" class="headerlink" title="2.3 æ ˆ stack"></a>2.3 æ ˆ <a href="https://zh.cppreference.com/w/cpp/container/stack">stack</a></h2><p><strong><code>#include &lt;stack&gt;</code></strong></p><p>é€šè¿‡äºŒæ¬¡å°è£…åŒç«¯é˜Ÿåˆ— (deque) å®¹å™¨ï¼Œå®ç°å…ˆè¿›åå‡ºçš„æ ˆæ•°æ®ç»“æ„ã€‚</p><h3 id="2-3-1-å¸¸ç”¨æ–¹æ³•"><a href="#2-3-1-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.3.1 å¸¸ç”¨æ–¹æ³•"></a>2.3.1 å¸¸ç”¨æ–¹æ³•</h3><div class="table-container"><table><thead><tr><th>ä½œç”¨</th><th>ç”¨æ³•</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>æ„é€ </td><td><code>stack&lt;ç±»å‹&gt; stk</code></td><td><code>stack&lt;int&gt; stk;</code></td></tr><tr><td>è¿›æ ˆ</td><td><code>.push(å…ƒç´ )</code></td><td><code>stk.push(1);</code></td></tr><tr><td>å‡ºæ ˆ</td><td><code>.pop()</code></td><td><code>stk.pop();</code></td></tr><tr><td>å–æ ˆé¡¶</td><td><code>.top()</code></td><td><code>int a = stk.top();</code></td></tr><tr><td>æŸ¥çœ‹å¤§å° / æ¸…ç©º / åˆ¤ç©º</td><td>ç•¥</td><td>ç•¥</td></tr></tbody></table></div><h3 id="2-3-2-é€‚ç”¨æƒ…å½¢"><a href="#2-3-2-é€‚ç”¨æƒ…å½¢" class="headerlink" title="2.3.2 é€‚ç”¨æƒ…å½¢"></a>2.3.2 é€‚ç”¨æƒ…å½¢</h3><p>å¦‚æœä¸å¡å¸¸çš„è¯ï¼Œå°±å¯ä»¥ç›´æ¥ç”¨å®ƒè€Œä¸éœ€è¦æ‰‹å†™æ ˆäº†ã€‚</p><p>å¦å¤–ï¼Œvector ä¹Ÿå¯ä»¥å½“æ ˆç”¨ï¼Œvector çš„ <code>.back()</code> å–å°¾éƒ¨å…ƒç´ ï¼Œå°±ç›¸å½“äºå–æ ˆé¡¶ï¼Œ<code>.push_back()</code> ç›¸å½“äºè¿›æ ˆï¼Œ<code>.pop_back()</code> ç›¸å½“äºå‡ºæ ˆã€‚</p><h3 id="2-3-3-æ³¨æ„äº‹é¡¹"><a href="#2-3-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.3.3 æ³¨æ„äº‹é¡¹"></a>2.3.3 æ³¨æ„äº‹é¡¹</h3><p>ä¸å¯è®¿é—®å†…éƒ¨å…ƒç´ ï¼<strong>ä¸‹é¢éƒ½æ˜¯é”™è¯¯ç”¨æ³•</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; stk.<span class="built_in">size</span>(); i++)</span><br><span class="line">    cout &lt;&lt; stk[i] &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> ele : stk)</span><br><span class="line">    cout &lt;&lt; stk &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h2 id="2-4-é˜Ÿåˆ—-queue"><a href="#2-4-é˜Ÿåˆ—-queue" class="headerlink" title="2.4 é˜Ÿåˆ— queue"></a>2.4 é˜Ÿåˆ— <a href="https://zh.cppreference.com/w/cpp/container/queue">queue</a></h2><p><strong><code>#include &lt;queue&gt;</code></strong></p><p>é€šè¿‡äºŒæ¬¡å°è£…åŒç«¯é˜Ÿåˆ— (deque) å®¹å™¨ï¼Œå®ç°å…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—æ•°æ®ç»“æ„ã€‚</p><h3 id="2-4-1-å¸¸ç”¨æ–¹æ³•"><a href="#2-4-1-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.4.1 å¸¸ç”¨æ–¹æ³•"></a>2.4.1 å¸¸ç”¨æ–¹æ³•</h3><div class="table-container"><table><thead><tr><th>ä½œç”¨</th><th>ç”¨æ³•</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>æ„é€ </td><td><code>queue&lt;ç±»å‹&gt; que</code></td><td><code>queue&lt;int&gt; que;</code></td></tr><tr><td>è¿›é˜Ÿ</td><td><code>.push(å…ƒç´ )</code></td><td><code>que.push(1);</code></td></tr><tr><td>å‡ºé˜Ÿ</td><td><code>.pop()</code></td><td><code>que.pop();</code></td></tr><tr><td>å–é˜Ÿé¦–</td><td><code>.front()</code></td><td><code>int a = que.front();</code></td></tr><tr><td>å–é˜Ÿå°¾</td><td><code>.back()</code></td><td><code>int a = que.back();</code></td></tr><tr><td>æŸ¥çœ‹å¤§å° / æ¸…ç©º / åˆ¤ç©º</td><td>ç•¥</td><td>ç•¥</td></tr></tbody></table></div><h3 id="2-4-2-é€‚ç”¨æƒ…å½¢"><a href="#2-4-2-é€‚ç”¨æƒ…å½¢" class="headerlink" title="2.4.2 é€‚ç”¨æƒ…å½¢"></a>2.4.2 é€‚ç”¨æƒ…å½¢</h3><p>å¦‚æœä¸å¡å¸¸çš„è¯ï¼Œå°±å¯ä»¥ç›´æ¥ç”¨å®ƒè€Œä¸éœ€è¦æ‰‹å†™é˜Ÿåˆ—äº†ã€‚</p><h3 id="2-4-3-æ³¨æ„äº‹é¡¹"><a href="#2-4-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.4.3 æ³¨æ„äº‹é¡¹"></a>2.4.3 æ³¨æ„äº‹é¡¹</h3><p>ä¸å¯è®¿é—®å†…éƒ¨å…ƒç´ ï¼<strong>ä¸‹é¢éƒ½æ˜¯é”™è¯¯ç”¨æ³•</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; que.<span class="built_in">size</span>(); i++)</span><br><span class="line">    cout &lt;&lt; que[i] &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> ele : que)</span><br><span class="line">    cout &lt;&lt; ele &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h2 id="2-5-ä¼˜å…ˆé˜Ÿåˆ—-priority-queue"><a href="#2-5-ä¼˜å…ˆé˜Ÿåˆ—-priority-queue" class="headerlink" title="2.5 ä¼˜å…ˆé˜Ÿåˆ— priority_queue"></a>2.5 ä¼˜å…ˆé˜Ÿåˆ— <a href="https://zh.cppreference.com/w/cpp/container/priority_queue">priority_queue</a></h2><p><strong><code>#include &lt;queue&gt;</code></strong></p><p>æä¾›å¸¸æ•°æ—¶é—´çš„æœ€å¤§å…ƒç´ æŸ¥æ‰¾ï¼Œå¯¹æ•°æ—¶é—´çš„æ’å…¥ä¸æå–ï¼Œåº•å±‚åŸç†æ˜¯äºŒå‰å †ã€‚</p><h3 id="2-5-1-å¸¸ç”¨æ–¹æ³•"><a href="#2-5-1-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.5.1 å¸¸ç”¨æ–¹æ³•"></a>2.5.1 å¸¸ç”¨æ–¹æ³•</h3><h4 id="æ„é€ -1"><a href="#æ„é€ -1" class="headerlink" title="æ„é€ "></a>æ„é€ </h4><p><strong><code>priority_queue&lt;ç±»å‹, å®¹å™¨, æ¯”è¾ƒå™¨&gt; pque</code></strong></p><ul><li>ç±»å‹ï¼šè¦å‚¨å­˜çš„æ•°æ®ç±»å‹</li><li>å®¹å™¨ï¼šå‚¨å­˜æ•°æ®çš„åº•å±‚å®¹å™¨ï¼Œé»˜è®¤ä¸º <code>vector&lt;ç±»å‹&gt;</code>ï¼Œç«èµ›ä¸­ä¿æŒé»˜è®¤å³å¯</li><li>æ¯”è¾ƒå™¨ï¼šæ¯”è¾ƒå¤§å°ä½¿ç”¨çš„æ¯”è¾ƒå™¨ï¼Œé»˜è®¤ä¸º <code>less&lt;ç±»å‹&gt;</code>ï¼Œå¯è‡ªå®šä¹‰</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;<span class="type">int</span>&gt; pque1;                            <span class="comment">// å‚¨å­˜intçš„å¤§é¡¶å †</span></span><br><span class="line">priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt;&gt; pque2; <span class="comment">// å‚¨å­˜intçš„å°é¡¶å †</span></span><br></pre></td></tr></table></figure><blockquote><p>å¯¹äºéœ€è¦è‡ªå®šä¹‰æ¯”è¾ƒå™¨çš„æƒ…å†µï¼Œæ¶‰åŠä¸€äº›åˆå­¦æ—¶å®¹æ˜“çœ‹è¿·ç³Šçš„è¯­æ³•ï¼ˆé‡è½½å°æ‹¬å·è¿ç®—ç¬¦ / lambda è¡¨è¾¾å¼ï¼‰ï¼Œåœ¨æ­¤å°±ä¸å±•å¼€è®²äº†ã€‚å¦‚æœæƒ³è¦äº†è§£ï¼Œå¯ä»¥æŸ¥é˜… cppreference ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚</p></blockquote><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><div class="table-container"><table><thead><tr><th>ä½œç”¨</th><th>ç”¨æ³•</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>è¿›å †</td><td><code>.push(å…ƒç´ )</code></td><td><code>que.push(1);</code></td></tr><tr><td>å‡ºå †</td><td><code>.pop()</code></td><td><code>que.pop();</code></td></tr><tr><td>å–å †é¡¶</td><td><code>.top()</code></td><td><code>int a = que.top();</code></td></tr><tr><td>æŸ¥çœ‹å¤§å° / åˆ¤ç©º</td><td>ç•¥</td><td>ç•¥</td></tr></tbody></table></div><p>è¿›å‡ºé˜Ÿå¤æ‚åº¦ $O(\log n)$ï¼Œå–å †é¡¶ $O(1)$.</p><h3 id="2-5-2-é€‚ç”¨æƒ…å½¢"><a href="#2-5-2-é€‚ç”¨æƒ…å½¢" class="headerlink" title="2.5.2 é€‚ç”¨æƒ…å½¢"></a>2.5.2 é€‚ç”¨æƒ…å½¢</h3><p>æŒç»­ç»´æŠ¤å…ƒç´ çš„æœ‰åºæ€§ï¼šæ¯æ¬¡å‘é˜Ÿåˆ—æ’å…¥å¤§å°ä¸å®šçš„å…ƒç´ ï¼Œæˆ–è€…æ¯æ¬¡ä»é˜Ÿåˆ—é‡Œå–å‡ºå¤§å°æœ€å°/æœ€å¤§çš„å…ƒç´ ï¼Œå…ƒç´ æ•°é‡ $n$ï¼Œæ’å…¥æ“ä½œæ•°é‡ $k$.</p><ul><li>æ¯æ¬¡æ’å…¥åè¿›è¡Œå¿«é€Ÿæ’åºï¼š$k\cdot n\log n$</li><li>ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤ï¼š$k\cdot\log n$</li></ul><h3 id="2-5-3-æ³¨æ„äº‹é¡¹"><a href="#2-5-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.5.3 æ³¨æ„äº‹é¡¹"></a>2.5.3 æ³¨æ„äº‹é¡¹</h3><h4 id="ä»…å †é¡¶å¯è¯»"><a href="#ä»…å †é¡¶å¯è¯»" class="headerlink" title="ä»…å †é¡¶å¯è¯»"></a>ä»…å †é¡¶å¯è¯»</h4><p>åªå¯è®¿é—®å †é¡¶ï¼Œå…¶ä»–å…ƒç´ éƒ½æ— æ³•è¯»å–åˆ°ã€‚<strong>ä¸‹é¢æ˜¯é”™è¯¯ç”¨æ³•ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; pque[<span class="number">1</span>] &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h4 id="æ‰€æœ‰å…ƒç´ ä¸å¯å†™"><a href="#æ‰€æœ‰å…ƒç´ ä¸å¯å†™" class="headerlink" title="æ‰€æœ‰å…ƒç´ ä¸å¯å†™"></a>æ‰€æœ‰å…ƒç´ ä¸å¯å†™</h4><p>å †ä¸­æ‰€æœ‰å…ƒç´ æ˜¯ä¸å¯ä¿®æ”¹çš„ã€‚<strong>ä¸‹é¢æ˜¯é”™è¯¯ç”¨æ³•ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pque[<span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line">pque.<span class="built_in">top</span>() = <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æ°å¥½è¦ä¿®æ”¹çš„æ˜¯å †é¡¶å…ƒç´ ï¼Œé‚£ä¹ˆæ˜¯å¯ä»¥å®Œæˆçš„ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> tp = pque.<span class="built_in">top</span>();</span><br><span class="line">pque.<span class="built_in">pop</span>();</span><br><span class="line">pque.<span class="built_in">push</span>(tp + <span class="number">1</span>);</span><br></pre></td></tr></table></figure><h2 id="2-6-é›†åˆ-set"><a href="#2-6-é›†åˆ-set" class="headerlink" title="2.6 é›†åˆ set"></a>2.6 é›†åˆ <a href="https://zh.cppreference.com/w/cpp/container/set">set</a></h2><p><strong><code>#include &lt;set&gt;</code></strong></p><p>æä¾›å¯¹æ•°æ—¶é—´çš„æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾çš„é›†åˆæ•°æ®ç»“æ„ã€‚åº•å±‚åŸç†æ˜¯çº¢é»‘æ ‘ã€‚</p><div class="table-container"><table><thead><tr><th>é›†åˆä¸‰è¦ç´ </th><th>è§£é‡Š</th><th>set</th><th>multiset</th><th>unordered_set</th></tr></thead><tbody><tr><td>ç¡®å®šæ€§</td><td>ä¸€ä¸ªå…ƒç´ è¦ä¹ˆåœ¨é›†åˆä¸­ï¼Œè¦ä¹ˆä¸åœ¨</td><td>âœ”</td><td>âœ”</td><td>âœ”</td></tr><tr><td>äº’å¼‚æ€§</td><td>ä¸€ä¸ªå…ƒç´ ä»…å¯ä»¥åœ¨é›†åˆä¸­å‡ºç°ä¸€æ¬¡</td><td>âœ”</td><td>âŒï¼ˆä»»æ„æ¬¡ï¼‰</td><td>âœ”</td></tr><tr><td>æ— åºæ€§</td><td>é›†åˆä¸­çš„å…ƒç´ æ˜¯æ²¡æœ‰é¡ºåºçš„</td><td>âŒï¼ˆä»å°åˆ°å¤§ï¼‰</td><td>âŒï¼ˆä»å°åˆ°å¤§ï¼‰</td><td>âœ”</td></tr></tbody></table></div><h3 id="2-6-1-å¸¸ç”¨æ–¹æ³•"><a href="#2-6-1-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.6.1 å¸¸ç”¨æ–¹æ³•"></a>2.6.1 å¸¸ç”¨æ–¹æ³•</h3><h4 id="æ„é€ -2"><a href="#æ„é€ -2" class="headerlink" title="æ„é€ "></a>æ„é€ </h4><p><strong><code>set&lt;ç±»å‹, æ¯”è¾ƒå™¨&gt; st</code></strong></p><ul><li>ç±»å‹ï¼šè¦å‚¨å­˜çš„æ•°æ®ç±»å‹</li><li>æ¯”è¾ƒå™¨ï¼šæ¯”è¾ƒå¤§å°ä½¿ç”¨çš„æ¯”è¾ƒå™¨ï¼Œé»˜è®¤ä¸º <code>less&lt;ç±»å‹&gt;</code>ï¼Œå¯è‡ªå®šä¹‰</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set&lt;<span class="type">int</span>&gt; st1;               <span class="comment">// å‚¨å­˜intçš„é›†åˆï¼ˆä»å°åˆ°å¤§ï¼‰</span></span><br><span class="line">set&lt;<span class="type">int</span>, greater&lt;<span class="type">int</span>&gt;&gt; st2; <span class="comment">// å‚¨å­˜intçš„é›†åˆï¼ˆä»å¤§åˆ°å°ï¼‰</span></span><br></pre></td></tr></table></figure><blockquote><p>å¯¹äºéœ€è¦è‡ªå®šä¹‰æ¯”è¾ƒå™¨çš„æƒ…å†µï¼Œæ¶‰åŠä¸€äº›åˆå­¦æ—¶å®¹æ˜“çœ‹è¿·ç³Šçš„è¯­æ³•ï¼ˆé‡è½½å°æ‹¬å·è¿ç®—ç¬¦ / lambda è¡¨è¾¾å¼ï¼‰ï¼Œåœ¨æ­¤å°±ä¸å±•å¼€è®²äº†ã€‚</p></blockquote><h4 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h4><p>å¯ä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œéå†ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (set&lt;<span class="type">int</span>&gt;::iterator it = st.<span class="built_in">begin</span>(); it != st.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    cout &lt;&lt; *it &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>åŸºäºèŒƒå›´çš„å¾ªç¯ï¼ˆC++ 11ï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> &amp;ele : st)</span><br><span class="line">    cout &lt;&lt; ele &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–-1"><a href="#å…¶ä»–-1" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><div class="table-container"><table><thead><tr><th>ä½œç”¨</th><th>ç”¨æ³•</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>æ’å…¥å…ƒç´ </td><td><code>.insert(å…ƒç´ )</code></td><td><code>st.insert(1);</code></td></tr><tr><td>åˆ é™¤å…ƒç´ </td><td><code>.erase(å…ƒç´ )</code></td><td><code>st.erase(2);</code></td></tr><tr><td>æŸ¥æ‰¾å…ƒç´ </td><td><code>.find(å…ƒç´ )</code></td><td><code>auto it = st.find(1);</code></td></tr><tr><td>åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨</td><td><code>.count(å…ƒç´ )</code></td><td><code>st.count(3);</code></td></tr><tr><td>æŸ¥çœ‹å¤§å° / æ¸…ç©º / åˆ¤ç©º</td><td>ç•¥</td><td>ç•¥</td></tr></tbody></table></div><p>å¢åˆ æŸ¥æ—¶é—´å¤æ‚åº¦å‡ä¸º $O(\log n)$</p><h3 id="2-6-2-é€‚ç”¨æƒ…å½¢"><a href="#2-6-2-é€‚ç”¨æƒ…å½¢" class="headerlink" title="2.6.2 é€‚ç”¨æƒ…å½¢"></a>2.6.2 é€‚ç”¨æƒ…å½¢</h3><ul><li>å…ƒç´ å»é‡ï¼š$[1,1,3,2,4,4]\to[1,2,3,4]$</li><li>ç»´æŠ¤é¡ºåºï¼š$[1,5,3,7,9]\to[1,3,5,7,9]$</li><li>å…ƒç´ æ˜¯å¦å‡ºç°è¿‡ï¼šå…ƒç´ å¤§å° $[-10^{18},10^{18}]$ï¼Œå…ƒç´ æ•°é‡ $10^6$ï¼Œvis æ•°ç»„æ— æ³•å®ç°ï¼Œé€šè¿‡ set å¯ä»¥å®Œæˆã€‚</li></ul><h3 id="2-6-3-æ³¨æ„äº‹é¡¹"><a href="#2-6-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.6.3 æ³¨æ„äº‹é¡¹"></a>2.6.3 æ³¨æ„äº‹é¡¹</h3><h4 id="ä¸å­˜åœ¨ä¸‹æ ‡ç´¢å¼•"><a href="#ä¸å­˜åœ¨ä¸‹æ ‡ç´¢å¼•" class="headerlink" title="ä¸å­˜åœ¨ä¸‹æ ‡ç´¢å¼•"></a>ä¸å­˜åœ¨ä¸‹æ ‡ç´¢å¼•</h4><p>set è™½è¯´å¯éå†ï¼Œä½†ä»…å¯ä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œéå†ï¼Œå®ƒä¸å­˜åœ¨ä¸‹æ ‡è¿™ä¸€æ¦‚å¿µï¼Œæ— æ³•é€šè¿‡ä¸‹æ ‡è®¿é—®åˆ°æ•°æ®ã€‚<strong>ä¸‹é¢æ˜¯é”™è¯¯ç”¨æ³•ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; st[<span class="number">0</span>] &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h4 id="å…ƒç´ åªè¯»"><a href="#å…ƒç´ åªè¯»" class="headerlink" title="å…ƒç´ åªè¯»"></a>å…ƒç´ åªè¯»</h4><p>set çš„è¿­ä»£å™¨å–åˆ°çš„å…ƒç´ æ˜¯åªè¯»çš„ï¼ˆå› ä¸ºæ˜¯ const è¿­ä»£å™¨ï¼‰ï¼Œä¸å¯ä¿®æ”¹å…¶å€¼ã€‚å¦‚æœè¦æ”¹ï¼Œéœ€è¦å…ˆ erase å† insert. <strong>ä¸‹é¢æ˜¯é”™è¯¯ç”¨æ³•ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; *st.<span class="built_in">begin</span>() &lt;&lt; endl; <span class="comment">// æ­£ç¡®ã€‚å¯è¯»ã€‚</span></span><br><span class="line">*st.<span class="built_in">begin</span>() = <span class="number">1</span>;             <span class="comment">// é”™è¯¯ï¼ä¸å¯å†™ï¼</span></span><br></pre></td></tr></table></figure><h4 id="ä¸å¯ç”¨è¿­ä»£å™¨è®¡ç®—ä¸‹æ ‡"><a href="#ä¸å¯ç”¨è¿­ä»£å™¨è®¡ç®—ä¸‹æ ‡" class="headerlink" title="ä¸å¯ç”¨è¿­ä»£å™¨è®¡ç®—ä¸‹æ ‡"></a>ä¸å¯ç”¨è¿­ä»£å™¨è®¡ç®—ä¸‹æ ‡</h4><p>set çš„è¿­ä»£å™¨ä¸èƒ½åƒ vector ä¸€æ ·ç›¸å‡å¾—åˆ°ä¸‹æ ‡ã€‚<strong>ä¸‹é¢æ˜¯é”™è¯¯ç”¨æ³•ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> it = st.<span class="built_in">find</span>(<span class="number">2</span>);      <span class="comment">// æ­£ç¡®ï¼Œè¿”å›2æ‰€åœ¨ä½ç½®çš„è¿­ä»£å™¨ã€‚</span></span><br><span class="line"><span class="type">int</span> idx = it - st.<span class="built_in">begin</span>(); <span class="comment">// é”™è¯¯ï¼ä¸å¯ç›¸å‡å¾—åˆ°ä¸‹æ ‡ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="2-7-æ˜ å°„-map"><a href="#2-7-æ˜ å°„-map" class="headerlink" title="2.7 æ˜ å°„ map"></a>2.7 æ˜ å°„ <a href="https://zh.cppreference.com/w/cpp/container/map">map</a></h2><p><strong><code>#include &lt;map&gt;</code></strong></p><p>æä¾›å¯¹æ•°æ—¶é—´çš„æœ‰åºé”®å€¼å¯¹ç»“æ„ã€‚åº•å±‚åŸç†æ˜¯çº¢é»‘æ ‘ã€‚</p><p>æ˜ å°„ï¼š</p><script type="math/tex; mode=display">\begin{matrix}1&\to&2\\2&\to&2\\3&\to&1\\4&\to&5\\&\vdots\end{matrix}</script><div class="table-container"><table><thead><tr><th>æ€§è´¨</th><th>è§£é‡Š</th><th>map</th><th>multimap</th><th>unordered_map</th></tr></thead><tbody><tr><td>äº’å¼‚æ€§</td><td>ä¸€ä¸ªé”®ä»…å¯ä»¥åœ¨æ˜ å°„ä¸­å‡ºç°ä¸€æ¬¡</td><td>âœ”</td><td>âŒï¼ˆä»»æ„æ¬¡ï¼‰</td><td>âœ”</td></tr><tr><td>æ— åºæ€§</td><td>é”®æ˜¯æ²¡æœ‰é¡ºåºçš„</td><td>âŒï¼ˆä»å°åˆ°å¤§ï¼‰</td><td>âŒï¼ˆä»å°åˆ°å¤§ï¼‰</td><td>âœ”</td></tr></tbody></table></div><h3 id="2-7-1-å¸¸ç”¨æ–¹æ³•"><a href="#2-7-1-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.7.1 å¸¸ç”¨æ–¹æ³•"></a>2.7.1 å¸¸ç”¨æ–¹æ³•</h3><h4 id="æ„é€ -3"><a href="#æ„é€ -3" class="headerlink" title="æ„é€ "></a>æ„é€ </h4><p><strong><code>map&lt;é”®ç±»å‹, å€¼ç±»å‹, æ¯”è¾ƒå™¨&gt; mp</code></strong></p><ul><li>é”®ç±»å‹ï¼šè¦å‚¨å­˜é”®çš„æ•°æ®ç±»å‹</li><li>å€¼ç±»å‹ï¼šè¦å‚¨å­˜å€¼çš„æ•°æ®ç±»å‹</li><li>æ¯”è¾ƒå™¨ï¼šé”®æ¯”è¾ƒå¤§å°ä½¿ç”¨çš„æ¯”è¾ƒå™¨ï¼Œé»˜è®¤ä¸º <code>less&lt;ç±»å‹&gt;</code>ï¼Œå¯è‡ªå®šä¹‰</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp1;               <span class="comment">// int-&gt;int çš„æ˜ å°„ï¼ˆé”®ä»å°åˆ°å¤§ï¼‰</span></span><br><span class="line">map&lt;<span class="type">int</span>, <span class="type">int</span>, greater&lt;<span class="type">int</span>&gt;&gt; st2; <span class="comment">// int-&gt;int çš„æ˜ å°„ï¼ˆé”®ä»å¤§åˆ°å°ï¼‰</span></span><br></pre></td></tr></table></figure><blockquote><p>å¯¹äºéœ€è¦è‡ªå®šä¹‰æ¯”è¾ƒå™¨çš„æƒ…å†µï¼Œæ¶‰åŠä¸€äº›åˆå­¦æ—¶å®¹æ˜“çœ‹è¿·ç³Šçš„è¯­æ³•ï¼ˆé‡è½½å°æ‹¬å·è¿ç®—ç¬¦ / lambda è¡¨è¾¾å¼ï¼‰ï¼Œåœ¨æ­¤å°±ä¸å±•å¼€è®²äº†ã€‚</p></blockquote><h4 id="éå†-1"><a href="#éå†-1" class="headerlink" title="éå†"></a>éå†</h4><p>å¯ä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œéå†ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (map&lt;<span class="type">int</span>, <span class="type">int</span>&gt;::iterator it = mp.<span class="built_in">begin</span>(); it != mp.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    cout &lt;&lt; it-&gt;first &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; it-&gt;second &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>åŸºäºèŒƒå›´çš„å¾ªç¯ï¼ˆC++ 11ï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> &amp;pr : mp)</span><br><span class="line">    cout &lt;&lt; pr.first &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; pr.second &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>ç»“æ„åŒ–ç»‘å®š + åŸºäºèŒƒå›´çš„å¾ªç¯ï¼ˆC++17ï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[key, val] : mp)</span><br><span class="line">    cout &lt;&lt; key &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; val &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–-2"><a href="#å…¶ä»–-2" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><div class="table-container"><table><thead><tr><th>ä½œç”¨</th><th>ç”¨æ³•</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>å¢ / æ”¹ / æŸ¥å…ƒç´ </td><td>ä¸­æ‹¬å·</td><td><code>mp[1] = 2;</code></td></tr><tr><td>æŸ¥å…ƒç´ ï¼ˆè¿”å›è¿­ä»£å™¨ï¼‰</td><td><code>.find(å…ƒç´ )</code></td><td><code>auto it = mp.find(1);</code></td></tr><tr><td>åˆ é™¤å…ƒç´ </td><td><code>.erase(å…ƒç´ )</code></td><td><code>mp.erase(2);</code></td></tr><tr><td>åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨</td><td><code>.count(å…ƒç´ )</code></td><td><code>mp.count(3);</code></td></tr><tr><td>æŸ¥çœ‹å¤§å° / æ¸…ç©º / åˆ¤ç©º</td><td>ç•¥</td><td>ç•¥</td></tr></tbody></table></div><p>å¢åˆ æ”¹æŸ¥æ—¶é—´å¤æ‚åº¦å‡ä¸º $O(\log n)$</p><h3 id="2-7-2-é€‚ç”¨æƒ…å½¢"><a href="#2-7-2-é€‚ç”¨æƒ…å½¢" class="headerlink" title="2.7.2 é€‚ç”¨æƒ…å½¢"></a>2.7.2 é€‚ç”¨æƒ…å½¢</h3><p>éœ€è¦ç»´æŠ¤æ˜ å°„çš„åœºæ™¯å¯ä»¥ä½¿ç”¨ï¼šè¾“å…¥è‹¥å¹²å­—ç¬¦ä¸²ï¼Œç»Ÿè®¡æ¯ç§å­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°ã€‚(<code>map&lt;string, int&gt; mp</code>)</p><h3 id="2-7-3-æ³¨æ„äº‹é¡¹"><a href="#2-7-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.7.3 æ³¨æ„äº‹é¡¹"></a>2.7.3 æ³¨æ„äº‹é¡¹</h3><h4 id="ä¸­æ‹¬å·è®¿é—®æ—¶é»˜è®¤å€¼"><a href="#ä¸­æ‹¬å·è®¿é—®æ—¶é»˜è®¤å€¼" class="headerlink" title="ä¸­æ‹¬å·è®¿é—®æ—¶é»˜è®¤å€¼"></a>ä¸­æ‹¬å·è®¿é—®æ—¶é»˜è®¤å€¼</h4><p>å¦‚æœä½¿ç”¨ä¸­æ‹¬å·è®¿é—® map æ—¶å¯¹åº”çš„é”®ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¼šæ–°å¢è¿™ä¸ªé”®ï¼Œå¹¶ä¸”å€¼ä¸ºé»˜è®¤å€¼ï¼Œå› æ­¤ä¸­æ‹¬å·ä¼šå½±å“é”®çš„å­˜åœ¨æ€§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line">cout &lt;&lt; mp.<span class="built_in">count</span>(<span class="string">&#x27;a&#x27;</span>) &lt;&lt; endl; <span class="comment">// 0</span></span><br><span class="line">mp[<span class="string">&#x27;a&#x27;</span>];                       <span class="comment">// å³ä½¿ä»€ä¹ˆéƒ½æ²¡åšï¼Œæ­¤æ—¶mp[&#x27;a&#x27;]=0å·²ç»æ’å…¥äº†</span></span><br><span class="line">cout &lt;&lt; mp.<span class="built_in">count</span>(<span class="string">&#x27;a&#x27;</span>) &lt;&lt; endl; <span class="comment">// 1</span></span><br><span class="line">cout &lt;&lt; mp[<span class="string">&#x27;a&#x27;</span>] &lt;&lt; endl;       <span class="comment">// 0</span></span><br></pre></td></tr></table></figure><h4 id="ä¸å¯ç”¨è¿­ä»£å™¨è®¡ç®—ä¸‹æ ‡-1"><a href="#ä¸å¯ç”¨è¿­ä»£å™¨è®¡ç®—ä¸‹æ ‡-1" class="headerlink" title="ä¸å¯ç”¨è¿­ä»£å™¨è®¡ç®—ä¸‹æ ‡"></a>ä¸å¯ç”¨è¿­ä»£å™¨è®¡ç®—ä¸‹æ ‡</h4><p>map çš„è¿­ä»£å™¨ä¸èƒ½åƒ vector ä¸€æ ·ç›¸å‡å¾—åˆ°ä¸‹æ ‡ã€‚<strong>ä¸‹é¢æ˜¯é”™è¯¯ç”¨æ³•ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> it = mp.<span class="built_in">find</span>(<span class="string">&#x27;a&#x27;</span>);      <span class="comment">// æ­£ç¡®ï¼Œè¿”å›2æ‰€åœ¨ä½ç½®çš„è¿­ä»£å™¨ã€‚</span></span><br><span class="line"><span class="type">int</span> idx = it - mp.<span class="built_in">begin</span>();   <span class="comment">// é”™è¯¯ï¼ä¸å¯ç›¸å‡å¾—åˆ°ä¸‹æ ‡ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="2-8-å­—ç¬¦ä¸²-string"><a href="#2-8-å­—ç¬¦ä¸²-string" class="headerlink" title="2.8 å­—ç¬¦ä¸² string"></a>2.8 å­—ç¬¦ä¸² <a href="https://zh.cppreference.com/w/cpp/string">string</a></h2><p><strong><code>#include &lt;string&gt;</code></strong></p><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å‚¨å­˜å­—ç¬¦ä¸²çš„ã€‚</p><h3 id="2-8-1-å¸¸ç”¨æ–¹æ³•"><a href="#2-8-1-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.8.1 å¸¸ç”¨æ–¹æ³•"></a>2.8.1 å¸¸ç”¨æ–¹æ³•</h3><h4 id="æ„é€ -4"><a href="#æ„é€ -4" class="headerlink" title="æ„é€ "></a>æ„é€ </h4><p>æ„é€ å‡½æ•°ï¼š<code>string(é•¿åº¦, åˆå€¼)</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string s1;           <span class="comment">// æ„é€ å­—ç¬¦ä¸²ï¼Œä¸ºç©º</span></span><br><span class="line">string s2 = <span class="string">&quot;awa!&quot;</span>;  <span class="comment">// æ„é€ å­—ç¬¦ä¸²ï¼Œå¹¶èµ‹å€¼awa!</span></span><br><span class="line"><span class="function">string <span class="title">s3</span><span class="params">(<span class="number">10</span>, <span class="string">&#x27;6&#x27;</span>)</span></span>;  <span class="comment">// æ„é€ å­—ç¬¦ä¸²ï¼Œé€šè¿‡æ„é€ å‡½æ•°æ„é€ ä¸º6666666666</span></span><br></pre></td></tr></table></figure><h4 id="è¾“å…¥è¾“å‡º"><a href="#è¾“å…¥è¾“å‡º" class="headerlink" title="è¾“å…¥è¾“å‡º"></a>è¾“å…¥è¾“å‡º</h4><p>C++</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string s;</span><br><span class="line">cin &gt;&gt; s;</span><br><span class="line">cout &lt;&lt; s;</span><br></pre></td></tr></table></figure><p>C</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string s;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;buf);</span><br><span class="line">s = buf;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, s.<span class="built_in">c_str</span>());</span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–-3"><a href="#å…¶ä»–-3" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><div class="table-container"><table><thead><tr><th>ä½œç”¨</th><th>ç”¨æ³•</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>ä¿®æ”¹ã€æŸ¥è¯¢æŒ‡å®šä¸‹æ ‡å­—ç¬¦</td><td><code>[]</code></td><td><code>s[1] = &#39;a&#39;;</code></td></tr><tr><td>æ˜¯å¦ç›¸åŒ</td><td><code>==</code></td><td><code>if (s1 == s2) ...</code></td></tr><tr><td>å­—ç¬¦ä¸²è¿æ¥</td><td><code>+</code></td><td><code>string s = s1 + s2;</code></td></tr><tr><td>å°¾æ¥å­—ç¬¦ä¸²</td><td><code>+=</code></td><td><code>s += &quot;awa&quot;;</code></td></tr><tr><td>å–å­ä¸²</td><td><code>.substr(èµ·å§‹ä¸‹æ ‡, å­ä¸²é•¿åº¦)</code></td><td><code>string sub = s.substr(2, 10);</code></td></tr><tr><td>æŸ¥æ‰¾å­—ç¬¦ä¸²</td><td><code>.find(å­—ç¬¦ä¸², èµ·å§‹ä¸‹æ ‡)</code></td><td><code>int pos = s.find(&quot;awa&quot;);</code></td></tr></tbody></table></div><h4 id="æ•°å€¼ä¸å­—ç¬¦ä¸²äº’è½¬ï¼ˆC-11ï¼‰"><a href="#æ•°å€¼ä¸å­—ç¬¦ä¸²äº’è½¬ï¼ˆC-11ï¼‰" class="headerlink" title="æ•°å€¼ä¸å­—ç¬¦ä¸²äº’è½¬ï¼ˆC++11ï¼‰"></a>æ•°å€¼ä¸å­—ç¬¦ä¸²äº’è½¬ï¼ˆC++11ï¼‰</h4><div class="table-container"><table><thead><tr><th>æº</th><th>ç›®çš„</th><th>å‡½æ•°</th></tr></thead><tbody><tr><td>int / long long / float / double / long double</td><td>string</td><td>to_string()</td></tr><tr><td>string</td><td>int</td><td>stoi()</td></tr><tr><td>string</td><td>long long</td><td>stoll()</td></tr><tr><td>string</td><td>float</td><td>stof()</td></tr><tr><td>string</td><td>double</td><td>stod()</td></tr><tr><td>string</td><td>long double</td><td>stold()</td></tr></tbody></table></div><h3 id="2-8-2-é€‚ç”¨æƒ…å½¢"><a href="#2-8-2-é€‚ç”¨æƒ…å½¢" class="headerlink" title="2.8.2 é€‚ç”¨æƒ…å½¢"></a>2.8.2 é€‚ç”¨æƒ…å½¢</h3><p>éå¸¸å¥½ç”¨ï¼<del>å»ºè®®ç›´æ¥æŠŠå­—ç¬¦æ•°ç»„æ‰”äº†ï¼Œèµ¶å¿«æŠ•å…¥ string çš„æ€€æŠ±ã€‚</del></p><h3 id="2-8-3-æ³¨æ„äº‹é¡¹"><a href="#2-8-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.8.3 æ³¨æ„äº‹é¡¹"></a>2.8.3 æ³¨æ„äº‹é¡¹</h3><h4 id="å°¾æ¥å­—ç¬¦ä¸²ä¸€å®šè¦ç”¨"><a href="#å°¾æ¥å­—ç¬¦ä¸²ä¸€å®šè¦ç”¨" class="headerlink" title="å°¾æ¥å­—ç¬¦ä¸²ä¸€å®šè¦ç”¨ +="></a>å°¾æ¥å­—ç¬¦ä¸²ä¸€å®šè¦ç”¨ <code>+=</code></h4><p>string çš„ += è¿ç®—ç¬¦ï¼Œå°†ä¼šåœ¨åŸå­—ç¬¦ä¸²åŸåœ°å°¾æ¥å­—ç¬¦ä¸²ã€‚è€Œ + äº†å† = èµ‹å€¼ï¼Œä¼šå…ˆç”Ÿæˆä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œåœ¨å¤åˆ¶ç»™ string.</p><p>é€šå¸¸å­—ç¬¦ä¸²é•¿åº¦å¯ä»¥å¾ˆé•¿ï¼Œå¦‚æœä½¿ç”¨ + å­—ç¬¦ä¸²å¾ˆå®¹æ˜“å°± TLE äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼˜åŒ–å‰: 15139ms</span></span><br><span class="line">string s;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5e5</span>; i++)</span><br><span class="line">    s = s + <span class="string">&quot;a&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼˜åŒ–å: &lt; 1ms (è®¡æ—¶å™¨æ˜¾ç¤º0)</span></span><br><span class="line">string s;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5e5</span>; i++)</span><br><span class="line">    s += <span class="string">&quot;a&quot;</span>;</span><br></pre></td></tr></table></figure><h4 id="substr-æ–¹æ³•çš„å¥‡è‘©å‚æ•°"><a href="#substr-æ–¹æ³•çš„å¥‡è‘©å‚æ•°" class="headerlink" title=".substr() æ–¹æ³•çš„å¥‡è‘©å‚æ•°"></a><code>.substr()</code> æ–¹æ³•çš„å¥‡è‘©å‚æ•°</h4><p>ä¸€å®šè¦æ³¨æ„ï¼ŒC++ string çš„å–å­ä¸²çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<strong>å­ä¸²èµ·ç‚¹ä¸‹æ ‡</strong>ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯<strong>å­ä¸²é•¿åº¦</strong>ã€‚</p><p>ç¬¬äºŒä¸ªå‚æ•°ä¸æ˜¯å­ä¸²ç»ˆç‚¹ï¼ä¸æ˜¯å­ä¸²ç»ˆç‚¹ï¼è¦ä¸ java ç­‰å…¶ä»–è¯­è¨€åŒºåˆ†å¼€æ¥ã€‚</p><h4 id="find-æ–¹æ³•çš„å¤æ‚åº¦"><a href="#find-æ–¹æ³•çš„å¤æ‚åº¦" class="headerlink" title=".find() æ–¹æ³•çš„å¤æ‚åº¦"></a><code>.find()</code> æ–¹æ³•çš„å¤æ‚åº¦</h4><p>è¯¥æ–¹æ³•å®ç°ä¸ºæš´åŠ›å®ç°ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$.</p><p><del>ä¸è¦å¹»æƒ³ STL å†…ç½®äº†ä¸ª $O(n)$ çš„ KMP ç®—æ³•</del></p><h2 id="2-9-äºŒå…ƒç»„-pair"><a href="#2-9-äºŒå…ƒç»„-pair" class="headerlink" title="2.9 äºŒå…ƒç»„ pair"></a>2.9 äºŒå…ƒç»„ <a href="https://zh.cppreference.com/w/cpp/utility/pair">pair</a></h2><p><strong><code>#include &lt;utility&gt;</code></strong></p><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å‚¨å­˜äºŒå…ƒç»„çš„ã€‚</p><h3 id="2-9-1-å¸¸ç”¨æ–¹æ³•"><a href="#2-9-1-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.9.1 å¸¸ç”¨æ–¹æ³•"></a>2.9.1 å¸¸ç”¨æ–¹æ³•</h3><h4 id="æ„é€ -5"><a href="#æ„é€ -5" class="headerlink" title="æ„é€ "></a>æ„é€ </h4><p><strong><code>pair&lt;ç¬¬ä¸€ä¸ªå€¼ç±»å‹, ç¬¬äºŒä¸ªå€¼ç±»å‹&gt; pr</code></strong></p><ul><li>ç¬¬ä¸€ä¸ªå€¼ç±»å‹ï¼šè¦å‚¨å­˜çš„ç¬¬ä¸€ä¸ªå€¼çš„æ•°æ®ç±»å‹</li><li>ç¬¬äºŒä¸ªå€¼ç±»å‹ï¼šè¦å‚¨å­˜çš„ç¬¬äºŒä¸ªå€¼çš„æ•°æ®ç±»å‹</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; p1;</span><br><span class="line">pair&lt;<span class="type">int</span>, <span class="type">long</span> <span class="type">long</span>&gt; p2;</span><br><span class="line">pair&lt;<span class="type">char</span>, <span class="type">int</span>&gt; p3;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><h4 id="èµ‹å€¼"><a href="#èµ‹å€¼" class="headerlink" title="èµ‹å€¼"></a>èµ‹å€¼</h4><p>è€å¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pair&lt;<span class="type">int</span>, <span class="type">char</span>&gt; pr = <span class="built_in">make_pair</span>(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>);</span><br></pre></td></tr></table></figure><p>åˆ—è¡¨æ„é€  C++11</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pair&lt;<span class="type">int</span>, <span class="type">char</span>&gt; pr = &#123;<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>&#125;;</span><br></pre></td></tr></table></figure><h4 id="å–å€¼"><a href="#å–å€¼" class="headerlink" title="å–å€¼"></a>å–å€¼</h4><p>ç›´æ¥å–å€¼</p><ul><li>å–ç¬¬ä¸€ä¸ªå€¼ï¼š<code>.first</code></li><li>å–ç¬¬äºŒä¸ªå€¼ï¼š<code>.second</code></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pair&lt;<span class="type">int</span>, <span class="type">char</span>&gt; pr = &#123;<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>&#125;;</span><br><span class="line"><span class="type">int</span> awa = pr.first;</span><br><span class="line"><span class="type">char</span> bwb = pr.second;</span><br></pre></td></tr></table></figure><p>ç»“æ„åŒ–ç»‘å®š C++17</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pair&lt;<span class="type">int</span>, <span class="type">char</span>&gt; pr = &#123;<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span> &amp;[awa, bwb] = pr;</span><br></pre></td></tr></table></figure><h4 id="åˆ¤åŒ"><a href="#åˆ¤åŒ" class="headerlink" title="åˆ¤åŒ"></a>åˆ¤åŒ</h4><p>ç›´æ¥ç”¨ <code>==</code> è¿ç®—ç¬¦</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; p1 = &#123;<span class="number">1</span>, <span class="number">2</span>&#125;;</span><br><span class="line">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; p2 = &#123;<span class="number">1</span>, <span class="number">3</span>&#125;;</span><br><span class="line"><span class="keyword">if</span> (p1 == p2) &#123; ... &#125; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h3 id="2-9-2-é€‚ç”¨åœºæ™¯"><a href="#2-9-2-é€‚ç”¨åœºæ™¯" class="headerlink" title="2.9.2 é€‚ç”¨åœºæ™¯"></a>2.9.2 é€‚ç”¨åœºæ™¯</h3><p>æ‰€æœ‰éœ€è¦äºŒå…ƒç»„çš„åœºæ™¯å‡å¯ä½¿ç”¨ï¼Œæ•ˆç‡å’Œè‡ªå·±å®šä¹‰ç»“æ„ä½“å·®ä¸å¤šã€‚</p><h3 id="2-9-3-æ³¨æ„äº‹é¡¹"><a href="#2-9-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.9.3 æ³¨æ„äº‹é¡¹"></a>2.9.3 æ³¨æ„äº‹é¡¹</h3><p>æ— </p><h1 id="3-è¿­ä»£å™¨ç®€ä»‹"><a href="#3-è¿­ä»£å™¨ç®€ä»‹" class="headerlink" title="3 è¿­ä»£å™¨ç®€ä»‹"></a>3 è¿­ä»£å™¨ç®€ä»‹</h1><h2 id="3-1-è¿­ä»£å™¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-1-è¿­ä»£å™¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3.1 è¿­ä»£å™¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3.1 è¿­ä»£å™¨æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>ä¸ææŠ½è±¡ï¼Œç›´æ¥ä¸¾ä¾‹ã€‚</p><p>å¯¹äºä¸€ä¸ª vectorï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹æ ‡éå†ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++)</span><br><span class="line">    cout &lt;&lt; a[i] &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åŒæ—¶ä¹Ÿå¯ä»¥ç”¨è¿­ä»£å™¨æ¥éå†ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (vector&lt;<span class="type">int</span>&gt;::iterator it = a.<span class="built_in">begin</span>(); it != a.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    cout &lt;&lt; *it &lt;&lt; endl;</span><br></pre></td></tr></table></figure><ul><li><code>a.begin()</code> æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘çš„æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ </li><li><code>a.end()</code> æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘çš„æ˜¯æœ€åä¸€ä¸ªå…ƒç´ <strong>å†åé¢ä¸€ä½</strong></li><li>ä¸Šè¿°è¿­ä»£å™¨å…·æœ‰è‡ªå¢è¿ç®—ç¬¦ï¼Œè‡ªå¢åˆ™è¿­ä»£å™¨å‘ä¸‹ä¸€ä¸ªå…ƒç´ ç§»åŠ¨</li><li>è¿­ä»£å™¨ä¸æŒ‡é’ˆç›¸ä¼¼ï¼Œå¦‚æœå¯¹å®ƒä½¿ç”¨è§£å¼•ç”¨è¿ç®—ç¬¦ï¼Œå³ <code>*it</code>ï¼Œå°±èƒ½å–åˆ°å¯¹åº”å€¼äº†</li></ul><h2 id="3-2-ä¸ºä½•éœ€è¦è¿­ä»£å™¨ï¼Ÿ"><a href="#3-2-ä¸ºä½•éœ€è¦è¿­ä»£å™¨ï¼Ÿ" class="headerlink" title="3.2 ä¸ºä½•éœ€è¦è¿­ä»£å™¨ï¼Ÿ"></a>3.2 ä¸ºä½•éœ€è¦è¿­ä»£å™¨ï¼Ÿ</h2><p>å¾ˆå¤šæ•°æ®ç»“æ„å¹¶ä¸æ˜¯çº¿æ€§çš„ï¼ˆä¾‹å¦‚çº¢é»‘æ ‘ï¼‰ï¼Œå¯¹äºéçº¿æ€§æ•°æ®ç»“æ„ï¼Œä¸‹æ ‡æ˜¯æ— æ„ä¹‰çš„ã€‚æ— æ³•ä½¿ç”¨ä¸‹æ ‡æ¥éå†æ•´ä¸ªæ•°æ®ç»“æ„ã€‚</p><p>è¿­ä»£å™¨çš„ä½œç”¨å°±æ˜¯å®šä¹‰æŸä¸ªæ•°æ®ç»“æ„çš„éå†æ–¹å¼ï¼Œé€šè¿‡è¿­ä»£å™¨çš„å¢å‡ï¼Œä»£è¡¨éå†åˆ°çš„ä½ç½®ï¼Œé€šè¿‡è¿­ä»£å™¨ä¾¿èƒ½æˆåŠŸéå†éçº¿æ€§ç»“æ„äº†ã€‚</p><p>ä¾‹å¦‚ï¼Œset çš„å®ç°æ˜¯çº¢é»‘æ ‘ï¼Œæˆ‘ä»¬æ˜¯æ²¡æ³•ç”¨ä¸‹æ ‡æ¥è®¿é—®å…ƒç´ çš„ã€‚ä½†æ˜¯é€šè¿‡è¿­ä»£å™¨ï¼Œæˆ‘ä»¬å°±èƒ½éå† set ä¸­çš„å…ƒç´ äº†ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (set&lt;<span class="type">int</span>&gt;::iterator it = st.<span class="built_in">begin</span>(); it != st.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    cout &lt;&lt; *it &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h2 id="3-3-è¿­ä»£å™¨ç”¨æ³•"><a href="#3-3-è¿­ä»£å™¨ç”¨æ³•" class="headerlink" title="3.3 è¿­ä»£å™¨ç”¨æ³•"></a>3.3 è¿­ä»£å™¨ç”¨æ³•</h2><p>å¯¹äº vector å®¹å™¨ï¼Œå®ƒçš„è¿­ä»£å™¨åŠŸèƒ½æ¯”è¾ƒå®Œæ•´ï¼Œä»¥å®ƒä¸¾ä¾‹ï¼š</p><ul><li><code>.begin()</code>ï¼šå¤´è¿­ä»£å™¨</li><li><code>.end()</code>ï¼šå°¾è¿­ä»£å™¨</li><li><code>.rbegin()</code>ï¼šåå‘å¤´è¿­ä»£å™¨</li><li><code>.rend()</code>ï¼šåå‘å°¾è¿­ä»£å™¨</li><li>è¿­ä»£å™¨ <code>+</code> æ•´å‹ï¼šå°†è¿­ä»£å™¨å‘åç§»åŠ¨</li><li>è¿­ä»£å™¨ <code>-</code> æ•´å‹ï¼šå°†è¿­ä»£å™¨å‘å‰ç§»åŠ¨</li><li>è¿­ä»£å™¨ <code>++</code>ï¼šå°†è¿­ä»£å™¨å‘åç§»åŠ¨ 1 ä½</li><li>è¿­ä»£å™¨ <code>--</code>ï¼šå°†è¿­ä»£å™¨å‘å‰ç§»åŠ¨ 1 ä½</li><li>è¿­ä»£å™¨ <code>-</code> è¿­ä»£å™¨ï¼šä¸¤ä¸ªè¿­ä»£å™¨çš„è·ç¦»</li><li><code>prev(it)</code>ï¼šè¿”å› it çš„å‰ä¸€ä¸ªè¿­ä»£å™¨</li><li><code>next(it)</code>ï¼šè¿”å› it çš„åä¸€ä¸ªè¿­ä»£å™¨</li></ul><p>å¯¹äºå…¶ä»–å®¹å™¨ï¼Œç”±äºå…¶ç»“æ„ç‰¹æ€§ï¼Œä¸Šé¢çš„åŠŸèƒ½ä¸ä¸€å®šéƒ½æœ‰ï¼ˆä¾‹å¦‚ set çš„è¿­ä»£å™¨æ˜¯ä¸èƒ½ç›¸å‡æ±‚è·ç¦»çš„ï¼‰</p><h2 id="3-4-å¸¸è§é—®é¢˜"><a href="#3-4-å¸¸è§é—®é¢˜" class="headerlink" title="3.4 å¸¸è§é—®é¢˜"></a>3.4 å¸¸è§é—®é¢˜</h2><p><strong><code>.end()</code> å’Œ <code>.rend()</code> æŒ‡å‘çš„ä½ç½®æ˜¯æ— æ„ä¹‰çš„å€¼</strong></p><p>å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º 10 çš„æ•°ç»„ï¼š<code>for (int i = 0; i &lt; 10; i++)</code>ï¼Œç¬¬ 10 ä½æ˜¯ä¸å¯è®¿é—®çš„</p><p>å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º 10 çš„å®¹å™¨ï¼š<code>for (auto it = a.begin(); it != a.end(); ++it)</code>ï¼Œ.end æ˜¯ä¸å¯è®¿é—®çš„</p><p><strong>ä¸åŒå®¹å™¨çš„è¿­ä»£å™¨åŠŸèƒ½å¯èƒ½ä¸ä¸€æ ·</strong></p><p>è¿­ä»£å™¨ç»†åŒ–çš„è¯æœ‰æ­£å‘ã€åå‘ã€åŒå‘ï¼Œæ¯ä¸ªå®¹å™¨çš„è¿­ä»£å™¨æ”¯æŒçš„è¿ç®—ç¬¦ä¹Ÿå¯èƒ½ä¸åŒï¼Œå› æ­¤ä¸åŒå®¹å™¨çš„è¿­ä»£å™¨ç»†èŠ‚å¾ˆæœ‰å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p><strong>åˆ é™¤æ“ä½œæ—¶éœ€è¦è­¦æƒ•</strong></p><p>ä¸ºä»€ä¹ˆ 3 æ²¡åˆ æ‰ï¼Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; a&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = a.<span class="built_in">begin</span>(); it != a.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    <span class="keyword">if</span> (*it == <span class="number">2</span> || *it == <span class="number">3</span>)</span><br><span class="line">        a.<span class="built_in">erase</span>(it);</span><br><span class="line"><span class="comment">// a = [1, 3, 4]</span></span><br></pre></td></tr></table></figure><p>ä¸ºå•¥ RE äº†ï¼Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; a&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = a.<span class="built_in">begin</span>(); it != a.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    <span class="keyword">if</span> (*it == <span class="number">4</span>)</span><br><span class="line">        a.<span class="built_in">erase</span>(it);</span><br></pre></td></tr></table></figure><center><b>å»ºè®®ï¼šå¦‚æ— å¿…è¦ï¼Œåˆ«ç”¨è¿­ä»£å™¨æ“ä½œå®¹å™¨ã€‚ï¼ˆéå†ä¸è®¿é—®æ²¡å…³ç³»ï¼‰</b></center><h1 id="4-å¸¸ç”¨ç®—æ³•"><a href="#4-å¸¸ç”¨ç®—æ³•" class="headerlink" title="4 å¸¸ç”¨ç®—æ³•"></a>4 å¸¸ç”¨ç®—æ³•</h1><h2 id="4-1-å†…å®¹æ€»è§ˆ"><a href="#4-1-å†…å®¹æ€»è§ˆ" class="headerlink" title="4.1 å†…å®¹æ€»è§ˆ"></a>4.1 å†…å®¹æ€»è§ˆ</h2><p>æ‰“å‹¾çš„æ˜¯æœ¬æ¬¡å°†ä¼šè¯¦ç»†è®²è§£çš„ï¼Œå…¶ä»–çš„æ˜¯ç®—æ³•ç«èµ›ä¸­å»ºè®®å­¦ä¹ çš„ï¼Œä¸åœ¨ä¸‹è¡¨åˆ—å‡ºçš„åœ¨æ¯”èµ›ä¸­åŸºæœ¬ç”¨ä¸åˆ°ã€‚</p><p>ï¼ˆå¾ˆå¤šå‡½æ•°çš„åŠŸèƒ½å¾ˆç®€å•ï¼Œè‡ªå·±éƒ½èƒ½å¿«é€Ÿå†™å‡ºæ¥ï¼Œä½†æ˜¯ä½¿ç”¨å‡½æ•°å¯ä»¥è®©ä»£ç å¯è¯»æ€§å˜å¾—æ›´é«˜ï¼Œè¿™åœ¨æ¯”èµ›ä¸­æ˜¯è‡³å…³ç´§è¦çš„ï¼‰</p><ul><li><p>ç®—æ³•åº“ Algorithm</p><ul><li>[ ] <code>count()</code></li><li>[ ] <code>find()</code></li><li>[ ] <code>fill()</code></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/algorithm/swap"><code>swap()</code></a></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/algorithm/reverse"><code>reverse()</code></a></li><li>[ ] <code>shuffle()</code> C++11</li><li>[x] <a href="https://zh.cppreference.com/w/cpp/algorithm/unique"><code>unique()</code></a></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/algorithm/sort"><code>sort()</code></a></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/algorithm/lower_bound"><code>lower_bound()</code></a> / <a href="https://zh.cppreference.com/w/cpp/algorithm/upper_bound"><code>upper_bound()</code></a></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/algorithm/max"><code>max()</code></a> / <a href="https://zh.cppreference.com/w/cpp/algorithm/min"><code>min()</code></a></li><li>[ ] <code>max_element()</code> / <code>min_element()</code></li><li>[ ] <code>prev_permutation()</code> / <code>next_permutation()</code></li></ul></li><li><p>æ•°å­¦å‡½æ•° cmath</p><ul><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/math/fabs"><code>abs()</code></a></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/math/exp"><code>exp()</code></a></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/math/log"><code>log()</code></a> / <code>log10()</code> / <code>log2()</code></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/math/pow"><code>pow()</code></a></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/math/sqrt"><code>sqrt()</code></a></li><li>[ ] <code>sin()</code> / <code>cos()</code> / <code>tan()</code></li><li>[ ] <code>asin()</code> / <code>acos()</code> / <code>atan()</code></li><li>[ ] <code>sinh()</code> / <code>cosh()</code> / <code>tanh()</code></li><li>[ ] <code>asinh()</code> / <code>acosh()</code> / <code>atanh()</code> C++11</li><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/math/ceil"><code>ceil()</code></a> / <a href="https://zh.cppreference.com/w/cpp/numeric/math/floor"><code>floor()</code></a></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/math/round"><code>round()</code></a> C++11</li></ul></li><li><p>æ•°å€¼ç®—æ³• numeric</p><ul><li>[ ] <code>iota()</code> C++11</li><li>[ ] <code>accumulate()</code></li><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/gcd"><code>gcd()</code></a> C++17</li><li>[x] <a href="https://zh.cppreference.com/w/cpp/numeric/lcm"><code>lcm()</code></a> C++17</li></ul></li><li><p>ä¼ªéšæœºæ•°ç”Ÿæˆ random</p><ul><li>[ ] <code>mt19937</code></li><li>[ ] <code>random_device()</code></li></ul></li></ul><h2 id="4-2-swap"><a href="#4-2-swap" class="headerlink" title="4.2 swap()"></a>4.2 <code>swap()</code></h2><p>äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼</p><p><strong>ç”¨æ³•ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> T &gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">( T&amp; a, T&amp; b )</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">0</span>, b = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">swap</span>(a, b);</span><br><span class="line"><span class="comment">// now a = 1, b = 0</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;;</span><br><span class="line"><span class="built_in">swap</span>(arr[<span class="number">4</span>], arr[<span class="number">6</span>]);</span><br><span class="line"><span class="comment">// now arr = &#123;0, 1, 2, 3, 6, 5, 4, 7, 8, 9&#125;</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹</strong></p><p>è¿™ä¸ª swap å‚æ•°æ˜¯å¼•ç”¨çš„ï¼Œä¸éœ€è¦åƒ C è¯­è¨€ä¸€æ ·å–åœ°å€ã€‚</p><h2 id="4-3-sort"><a href="#4-3-sort" class="headerlink" title="4.3 sort()"></a>4.3 <code>sort()</code></h2><p>ä½¿ç”¨å¿«é€Ÿæ’åºç»™ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æ’åº</p><p><strong>ç”¨æ³•ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> RandomIt, <span class="keyword">class</span> Compare &gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sort</span><span class="params">( RandomIt first, RandomIt last, Compare comp )</span></span>;</span><br></pre></td></tr></table></figure><p>é»˜è®¤æ’åºä»å°åˆ°å¤§</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; arr&#123;<span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>());</span><br><span class="line"><span class="comment">// arr = [0, 1, 1, 1, 8, 9, 9]</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè¦ä»å¤§åˆ°å°ï¼Œåˆ™éœ€è¦ä¼ æ¯”è¾ƒå™¨è¿›å»ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; arr&#123;<span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;());</span><br><span class="line"><span class="comment">// arr = [9, 9, 8, 1, 1, 1, 0]</span></span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦å®Œæˆç‰¹æ®Šæ¯”è¾ƒï¼Œåˆ™éœ€è¦æ‰‹å†™æ¯”è¾ƒå™¨ã€‚</p><p>æ¯”è¾ƒå™¨å‡½æ•°è¿”å›å€¼æ˜¯ bool ç±»å‹ï¼Œä¼ å‚æ˜¯éœ€è¦æ¯”è¾ƒçš„ä¸¤ä¸ªå…ƒç´ ã€‚è®°æˆ‘ä»¬å®šä¹‰çš„è¯¥æ¯”è¾ƒæ“ä½œä¸º $\star$ï¼š</p><ul><li>è‹¥ $a\star b$ï¼Œåˆ™æ¯”è¾ƒå™¨å‡½æ•°åº”å½“è¿”å› <code>true</code></li><li>è‹¥ $a\not\star b$ï¼Œåˆ™æ¯”è¾ƒå™¨å‡½æ•°åº”å½“è¿”å› <code>false</code></li></ul><p><strong>æ³¨æ„ï¼š</strong>å¦‚æœ $a=b$ï¼Œæ¯”è¾ƒå™¨å‡½æ•°å¿…é¡»è¿”å› <code>false</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; a, pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.second != b.second)</span><br><span class="line">        <span class="keyword">return</span> a.second &lt; b.second;</span><br><span class="line">    <span class="keyword">return</span> a.first &gt; b.first;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; arr&#123;&#123;<span class="number">1</span>, <span class="number">9</span>&#125;, &#123;<span class="number">2</span>, <span class="number">9</span>&#125;, &#123;<span class="number">8</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), cmp);</span><br><span class="line">    <span class="comment">// arr = [(0, 0), (8, 1), (2, 9), (1, 9)]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-4-lower-bound-upper-bound"><a href="#4-4-lower-bound-upper-bound" class="headerlink" title="4.4 lower_bound() / upper_bound()"></a>4.4 <code>lower_bound()</code> / <code>upper_bound()</code></h2><p>åœ¨<strong>å·²å‡åºæ’åº</strong>çš„å…ƒç´ ä¸­ï¼Œåº”ç”¨äºŒåˆ†æŸ¥æ‰¾æ£€ç´¢æŒ‡å®šå…ƒç´ ï¼Œè¿”å›å¯¹åº”å…ƒç´ è¿­ä»£å™¨ä½ç½®ã€‚<strong>æ‰¾ä¸åˆ°åˆ™è¿”å›å°¾è¿­ä»£å™¨ã€‚</strong></p><ul><li><code>lower_bound()</code>: å¯»æ‰¾ $\geq x$ çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®</li><li><code>upper_bound()</code>: å¯»æ‰¾ $&gt;x$ çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®</li></ul><p>æ€ä¹ˆæ‰¾ $\leq x$ / $&lt; x$ çš„ç¬¬ä¸€ä¸ªå…ƒç´ å‘¢ï¼Ÿ</p><ul><li>$&gt;x$ çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´ ï¼ˆå¦‚æœæœ‰ï¼‰ä¾¿æ˜¯ $\leq x$ çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>$\geq x$ çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´ ï¼ˆå¦‚æœæœ‰ï¼‰ä¾¿æ˜¯ $&lt;x$ çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li></ul><p>è¿”å›çš„æ˜¯è¿­ä»£å™¨ï¼Œå¦‚ä½•è½¬æˆä¸‹æ ‡ç´¢å¼•å‘¢ï¼Ÿå‡å»å¤´è¿­ä»£å™¨å³å¯ã€‚</p><p><strong>ç”¨æ³•ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> ForwardIt, <span class="keyword">class</span> T &gt;</span></span><br><span class="line"><span class="function">ForwardIt <span class="title">lower_bound</span><span class="params">( ForwardIt first, ForwardIt last, <span class="type">const</span> T&amp; value )</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; arr&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>&#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;::iterator it = <span class="built_in">lower_bound</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), <span class="number">7</span>);</span><br><span class="line"><span class="type">int</span> idx = it - arr.<span class="built_in">begin</span>();</span><br><span class="line"><span class="comment">// idx = 4</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šå¸¸å†™æˆä¸€è¡Œï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; arr&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>&#125;;</span><br><span class="line">idx = <span class="built_in">lower_bound</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), <span class="number">7</span>) - arr.<span class="built_in">begin</span>(); <span class="comment">// 4</span></span><br><span class="line">idx = <span class="built_in">lower_bound</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), <span class="number">8</span>) - arr.<span class="built_in">begin</span>(); <span class="comment">// 4</span></span><br><span class="line">idx = <span class="built_in">upper_bound</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), <span class="number">7</span>) - arr.<span class="built_in">begin</span>(); <span class="comment">// 4</span></span><br><span class="line">idx = <span class="built_in">upper_bound</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), <span class="number">8</span>) - arr.<span class="built_in">begin</span>(); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure><h2 id="4-5-reverse"><a href="#4-5-reverse" class="headerlink" title="4.5 reverse()"></a>4.5 <code>reverse()</code></h2><p>åè½¬ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡çš„å…ƒç´ é¡ºåº</p><p><strong>ç”¨æ³•ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> BidirIt &gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">( BidirIt first, BidirIt last )</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">arr</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"><span class="built_in">iota</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), <span class="number">1</span>);</span><br><span class="line"><span class="comment">// 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</span></span><br><span class="line"><span class="built_in">reverse</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>());</span><br><span class="line"><span class="comment">// 10, 9, 8, 7, 6, 5, 4, 3, 2, 1</span></span><br></pre></td></tr></table></figure><h2 id="4-6-max-min"><a href="#4-6-max-min" class="headerlink" title="4.6 max() / min()"></a>4.6 <code>max()</code> / <code>min()</code></h2><p>è¿”å›æœ€å¤§å€¼ / æœ€å°å€¼çš„<strong>æ•°å€¼</strong></p><p><strong>ç”¨æ³•ç¤ºä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> mx = <span class="built_in">max</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 2</span></span><br><span class="line"><span class="type">int</span> mn = <span class="built_in">min</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p>åœ¨ C++11 ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨åˆ—è¡¨æ„é€ è¯­æ³•ä¼ å…¥ä¸€ä¸ªåˆ—è¡¨ï¼Œè¿™æ ·å°±èƒ½ä¸€æ¬¡æ€§ç»™å¤šä¸ªå…ƒç´ æ‰¾æœ€å¤§å€¼è€Œä¸ç”¨å¥—å¨ƒäº†ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before C++11</span></span><br><span class="line"><span class="type">int</span> mx = <span class="built_in">max</span>(<span class="built_in">max</span>(<span class="number">1</span>, <span class="number">2</span>), <span class="built_in">max</span>(<span class="number">3</span>, <span class="number">4</span>)); <span class="comment">// 4</span></span><br><span class="line"><span class="type">int</span> mn = <span class="built_in">min</span>(<span class="built_in">min</span>(<span class="number">1</span>, <span class="number">2</span>), <span class="built_in">min</span>(<span class="number">3</span>, <span class="number">4</span>)); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// After C++11</span></span><br><span class="line"><span class="type">int</span> mx = <span class="built_in">max</span>(&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;); <span class="comment">// 4</span></span><br><span class="line"><span class="type">int</span> mn = <span class="built_in">min</span>(&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><h2 id="4-7-unique"><a href="#4-7-unique" class="headerlink" title="4.7 unique()"></a>4.7 <code>unique()</code></h2><p>æ¶ˆé™¤æ•°ç»„çš„é‡å¤<strong>ç›¸é‚»</strong>å…ƒç´ ï¼Œæ•°ç»„é•¿åº¦ä¸å˜ï¼Œä½†æ˜¯æœ‰æ•ˆæ•°æ®ç¼©çŸ­ï¼Œè¿”å›çš„æ˜¯æœ‰æ•ˆæ•°æ®ä½ç½®çš„ç»“å°¾è¿­ä»£å™¨ã€‚</p><p>ä¾‹å¦‚ï¼š$[1,1,4,5,1,4]\to[1,4,5,1,4,\underline?]$ï¼Œä¸‹åˆ’çº¿ä½ç½®ä¸ºè¿”å›çš„è¿­ä»£å™¨æŒ‡å‘ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> ForwardIt &gt;</span></span><br><span class="line"><span class="function">ForwardIt <span class="title">unique</span><span class="params">( ForwardIt first, ForwardIt last )</span></span>;</span><br></pre></td></tr></table></figure><p><strong>ç”¨æ³•ç¤ºä¾‹</strong></p><p>å•ç‹¬ä½¿ç”¨ unique å¹¶ä¸èƒ½è¾¾æˆå»é‡æ•ˆæœï¼Œå› ä¸ºå®ƒåªæ¶ˆé™¤<strong>ç›¸é‚»</strong>çš„é‡å¤å…ƒç´ ã€‚ä½†æ˜¯å¦‚æœåºåˆ—æœ‰åºï¼Œé‚£ä¹ˆå®ƒå°±èƒ½å»é‡äº†ã€‚</p><p>ä½†æ˜¯å®ƒå»é‡åï¼Œåºåˆ—å°¾éƒ¨ä¼šäº§ç”Ÿä¸€äº›æ— æ•ˆæ•°æ®ï¼š$[1,1,2,4,4,4,5]\to[1,2,4,5,\underline?,?,?]$ï¼Œä¸ºäº†åˆ æ‰è¿™äº›æ— æ•ˆæ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ç»“åˆ erase.</p><p>æœ€ç»ˆï¼Œç»™ vector å»é‡çš„å†™æ³•ä¾¿æ˜¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; arr&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">4</span>&#125;;</span><br><span class="line"><span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>());</span><br><span class="line">arr.<span class="built_in">erase</span>(<span class="built_in">unique</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>()), arr.<span class="built_in">end</span>());</span><br></pre></td></tr></table></figure><h2 id="4-8-æ•°å­¦å‡½æ•°"><a href="#4-8-æ•°å­¦å‡½æ•°" class="headerlink" title="4.8 æ•°å­¦å‡½æ•°"></a>4.8 æ•°å­¦å‡½æ•°</h2><p>æ‰€æœ‰å‡½æ•°å‚æ•°å‡æ”¯æŒ <code>int</code> / <code>long long</code> / <code>float</code> / <code>double</code> / <code>long double</code></p><div class="table-container"><table><thead><tr><th>å…¬å¼</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>$f(x)=\lvert x\rvert$</td><td><code>abs(-1.0)</code></td></tr><tr><td>$f(x)=e^x$</td><td><code>exp(2)</code></td></tr><tr><td>$f(x)=\ln x$</td><td><code>log(3)</code></td></tr><tr><td>$f(x,y)=x^y$</td><td><code>pow(2, 3)</code></td></tr><tr><td>$f(x)=\sqrt x$</td><td><code>sqrt(2)</code></td></tr><tr><td>$f(x)=\lceil x\rceil$</td><td><code>ceil(2.1)</code></td></tr><tr><td>$f(x)=\lfloor x\rfloor$</td><td><code>floor(2.1)</code></td></tr><tr><td>$f(x)=\left<x\right>$</td><td><code>rount(2.1)</code></td></tr></tbody></table></div><p><strong>æ³¨æ„äº‹é¡¹</strong></p><p>ç”±äºæµ®ç‚¹è¯¯å·®ï¼Œæœ‰äº›çš„æ•°å­¦å‡½æ•°çš„è¡Œä¸ºå¯èƒ½ä¸é¢„æœŸä¸ç¬¦ï¼Œå¯¼è‡´ WAã€‚å¦‚æœä½ çš„æ“ä½œæ•°éƒ½æ˜¯æ•´å‹ï¼Œé‚£ä¹ˆç”¨ä¸‹é¢çš„å†™æ³•ä¼šæ›´ç¨³å¦¥ã€‚</p><blockquote><p>åŸæ–‡åœ°å€ï¼š<a href="https://codeforces.com/blog/entry/107717">https://codeforces.com/blog/entry/107717</a></p></blockquote><ul><li>$\lfloor\frac{a}{b}\rfloor$<ul><li>åˆ«ç”¨ï¼š<code>floor(1.0 * a / b)</code></li><li>è¦ç”¨ï¼š<code>a / b</code></li></ul></li><li>$\lceil\frac{a}{b}\rceil$<ul><li>åˆ«ç”¨ï¼š<code>ceil(1.0 * a / b)</code></li><li>è¦ç”¨ï¼š<code>(a + b - 1) / b</code>  ï¼ˆ$\lceil\frac{a}{b}\rceil=\lfloor\frac{a+b-1}{b}\rfloor$ï¼‰</li></ul></li><li>$\lfloor\sqrt a\rfloor$<ul><li>åˆ«ç”¨ï¼š<code>(int) sqrt(a)</code></li><li>è¦ç”¨ï¼šäºŒåˆ†æŸ¥æ‰¾ <a href="https://io.zouht.com/7.html">https://io.zouht.com/7.html</a></li></ul></li><li>$a^b$<ul><li>åˆ«ç”¨ï¼š<code>pow(a, b)</code></li><li>è¦ç”¨ï¼šå¿«é€Ÿå¹‚ <a href="https://io.zouht.com/18.html">https://io.zouht.com/18.html</a></li></ul></li><li>$\lfloor\log_2 a\rfloor$<ul><li>åˆ«ç”¨ï¼š<code>log2(a)</code></li><li>è¦ç”¨ï¼š<code>__lg</code> ï¼ˆä¸è§„èŒƒï¼Œä½†æ˜¯è¿™æ˜¯ç«èµ›ï¼‰/ <code>bit_width</code>ï¼ˆC++20 å¯ç”¨ï¼‰</li></ul></li></ul><h2 id="4-9-gcd-lcm"><a href="#4-9-gcd-lcm" class="headerlink" title="4.9 gcd() / lcm()"></a>4.9 <code>gcd()</code> / <code>lcm()</code></h2><p>ï¼ˆC++17ï¼‰è¿”å›æœ€å¤§å…¬å› æ•° / æœ€å°å…¬å€æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x = <span class="built_in">gcd</span>(<span class="number">8</span>, <span class="number">12</span>); <span class="comment">// 4</span></span><br><span class="line"><span class="type">int</span> y = <span class="built_in">lcm</span>(<span class="number">8</span>, <span class="number">12</span>); <span class="comment">// 24</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸æ˜¯ C++17ï¼Œä½†æ˜¯æ˜¯ GNU ç¼–è¯‘å™¨ï¼ˆg++ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨å†…ç½®å‡½æ•° <code>__gcd()</code>.</p><p>å½“ç„¶ï¼Œ<code>gcd</code> / <code>lcm</code> å‡½æ•°ä¹ŸæŒºå¥½å†™ï¼Œç›´æ¥å†™ä¹Ÿè¡Œï¼ˆæ¬§å‡ é‡Œå¾—ç®—æ³•ï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b)</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">gcd</span>(b, a % b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a / <span class="built_in">gcd</span>(a, b) * b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è½¬è½½è‡ªgithub</summary>
    
    
    
    <category term="leetcodeåˆ·é¢˜ç¬”è®°" scheme="https://sumikiru.top/categories/leetcode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="STL" scheme="https://sumikiru.top/tags/STL/"/>
    
    <category term="C++" scheme="https://sumikiru.top/tags/C/"/>
    
    <category term="leetcode" scheme="https://sumikiru.top/tags/leetcode/"/>
    
  </entry>
  
  <entry>
    <title>æ¬¢è¿æ¥åˆ°æœ¬ç«™</title>
    <link href="https://sumikiru.top/posts/9b94e219.html"/>
    <id>https://sumikiru.top/posts/9b94e219.html</id>
    <published>2024-04-05T00:00:00.000Z</published>
    <updated>2024-12-12T05:10:58.033Z</updated>
    
    
    <summary type="html">æ¬¢è¿ï¼Œä¸€èµ·æ¥ç ”ç©¶C++å§~</summary>
    
    
    
    
  </entry>
  
</feed>
